{"version":3,"file":"index.cjs.js","sources":["../node_modules/tslib/tslib.es6.js","../src/components/Attachment/AttachmentActions.tsx","../src/components/Attachment/Audio.tsx","../src/components/SafeAnchor/SafeAnchor.tsx","../src/context/utils/getDisplayName.ts","../src/context/TranslationContext.tsx","../src/components/Attachment/Card.tsx","../src/components/Attachment/FileAttachment.tsx","../src/components/Modal/Modal.tsx","../src/components/Gallery/ModalWrapper.tsx","../src/components/Gallery/Gallery.tsx","../src/components/Gallery/Image.tsx","../src/components/Attachment/utils.tsx","../src/components/Attachment/Attachment.tsx","../src/components/AutoCompleteTextarea/Item.js","../src/context/ComponentContext.tsx","../src/utils.tsx","../src/components/AutoCompleteTextarea/Header.tsx","../src/components/AutoCompleteTextarea/listener.js","../src/components/AutoCompleteTextarea/List.js","../src/components/AutoCompleteTextarea/utils.js","../src/components/CommandItem/CommandItem.tsx","../src/components/Avatar/Avatar.tsx","../src/components/UserItem/UserItem.tsx","../src/components/AutoCompleteTextarea/Textarea.js","../src/components/Channel/channelState.ts","../src/components/Channel/emojiData.ts","../src/components/Channel/hooks/useCreateChannelStateContext.ts","../src/components/Channel/hooks/useCreateTypingContext.ts","../src/context/ChatContext.tsx","../src/components/Channel/hooks/useEditMessageHandler.ts","../src/components/Channel/hooks/useIsMounted.ts","../src/components/Channel/hooks/useMentionsHandlers.ts","../src/components/Loading/LoadingChannels.tsx","../src/components/Loading/LoadingErrorIndicator.tsx","../src/components/Loading/LoadingIndicator.tsx","../src/context/ChannelStateContext.tsx","../src/components/Message/hooks/useUserRole.ts","../src/components/Message/MessageDeleted.tsx","../src/components/Message/icons.tsx","../src/components/Message/utils.tsx","../src/context/ChannelActionContext.tsx","../src/context/MessageContext.tsx","../src/components/MessageActions/MessageActionsBox.tsx","../src/components/MessageActions/MessageActions.tsx","../src/components/Message/MessageOptions.tsx","../src/components/Message/MessageRepliesCountButton.tsx","../src/components/Tooltip/Tooltip.tsx","../src/components/Message/MessageStatus.tsx","../src/components/Message/hooks/useActionHandler.ts","../src/components/Message/hooks/useBreakpoint.ts","../src/components/Message/hooks/useDeleteHandler.ts","../src/components/Message/hooks/useEditHandler.ts","../src/components/Message/hooks/useFlagHandler.ts","../src/components/Message/hooks/useMentionsHandler.ts","../src/components/Message/hooks/useMobilePress.ts","../src/components/Message/hooks/useMuteHandler.ts","../src/components/Message/hooks/useOpenThreadHandler.ts","../src/components/Message/hooks/usePinHandler.ts","../src/components/Message/hooks/useReactionHandler.ts","../src/components/Message/hooks/useRetryHandler.ts","../src/components/Message/hooks/useUserHandler.ts","../src/components/Message/QuotedMessage.tsx","../src/components/Message/MessageText.tsx","../src/components/Message/MessageTimestamp.tsx","../src/components/MessageInput/hooks/useCommandTrigger.ts","../src/components/EmoticonItem/EmoticonItem.tsx","../src/components/MessageInput/hooks/useEmojiTrigger.ts","../src/components/MessageInput/hooks/utils.ts","../src/components/MessageInput/hooks/useUserTrigger.ts","../src/context/MessageInputContext.tsx","../src/components/MessageInput/DefaultTriggerProvider.tsx","../src/context/EmojiContext.tsx","../src/components/MessageInput/EmojiPicker.tsx","../src/components/MessageInput/icons.tsx","../src/components/MessageInput/UploadsPreview.tsx","../src/components/ChatAutoComplete/ChatAutoComplete.tsx","../src/components/MessageInput/EditMessageForm.tsx","../src/components/MessageInput/hooks/useCooldownTimer.tsx","../src/components/MessageInput/hooks/useEmojiIndex.ts","../src/components/MessageInput/hooks/useImageUploads.ts","../src/components/MessageInput/hooks/useFileUploads.ts","../src/components/MessageInput/hooks/useAttachments.ts","../src/components/MessageInput/hooks/useMessageInputText.ts","../src/components/MessageInput/hooks/useEmojiPicker.ts","../src/components/MessageInput/hooks/useSubmitHandler.ts","../src/components/MessageInput/hooks/usePasteHandler.ts","../src/components/MessageInput/hooks/useMessageInputState.ts","../src/components/MessageInput/QuotedMessagePreview.tsx","../src/components/MessageInput/MessageInputFlat.tsx","../src/components/MessageInput/hooks/useCreateMessageInputContext.ts","../src/components/MessageInput/MessageInput.tsx","../src/components/MessageInput/MessageInputSmall.tsx","../src/components/MML/MML.tsx","../src/components/Reactions/utils/utils.ts","../src/components/Reactions/ReactionSelector.tsx","../src/components/Reactions/ReactionsList.tsx","../src/components/Reactions/SimpleReactionsList.tsx","../src/components/Message/MessageSimple.tsx","../src/components/MessageInput/DropzoneProvider.tsx","../src/context/TypingContext.tsx","../src/components/Channel/Channel.tsx","../src/components/ChannelHeader/ChannelHeader.tsx","../src/assets/str-chat__connection-error.svg","../src/components/ChatDown/ChatDown.tsx","../src/components/ChannelList/ChannelListMessenger.tsx","../src/components/ChannelList/hooks/useChannelDeletedListener.ts","../src/components/ChannelList/hooks/useChannelHiddenListener.ts","../src/components/ChannelList/hooks/useChannelTruncatedListener.ts","../src/components/ChannelList/hooks/useChannelUpdatedListener.ts","../src/components/ChannelList/utils.ts","../src/components/ChannelList/hooks/useChannelVisibleListener.ts","../src/components/ChannelList/hooks/useConnectionRecoveredListener.ts","../src/components/ChannelList/hooks/useMessageNewListener.ts","../src/components/ChannelList/hooks/useMobileNavigation.ts","../src/components/ChannelList/hooks/useNotificationAddedToChannelListener.ts","../src/components/ChannelList/hooks/useNotificationMessageNewListener.ts","../src/components/ChannelList/hooks/useNotificationRemovedFromChannelListener.ts","../src/components/ChannelList/hooks/usePaginatedChannels.ts","../src/components/ChannelList/hooks/useUserPresenceChangedListener.ts","../src/components/ChannelPreview/ChannelPreviewMessenger.tsx","../src/components/ChannelPreview/hooks/useIsChannelMuted.ts","../src/components/ChannelPreview/utils.tsx","../src/components/ChannelPreview/ChannelPreview.tsx","../src/components/ChannelSearch/SearchInput.tsx","../src/components/ChannelSearch/utils.ts","../src/components/ChannelSearch/SearchResults.tsx","../src/components/ChannelSearch/ChannelSearch.tsx","../src/components/EmptyStateIndicator/EmptyStateIndicator.tsx","../src/components/LoadMore/LoadMoreButton.tsx","../src/components/LoadMore/LoadMorePaginator.tsx","../src/components/ChannelList/ChannelList.tsx","../src/i18n/Streami18n.ts","../src/version.ts","../src/components/Chat/hooks/useChat.ts","../src/components/Chat/hooks/useCreateChatContext.ts","../src/components/Chat/hooks/useCustomStyles.ts","../src/components/Chat/Chat.tsx","../src/components/DateSeparator/DateSeparator.tsx","../src/components/EventComponent/EventComponent.tsx","../src/components/InfiniteScrollPaginator/InfiniteScroll.tsx","../src/components/InfiniteScrollPaginator/InfiniteScrollPaginator.tsx","../src/components/InfiniteScrollPaginator/ReverseInfiniteScroll.tsx","../src/components/Message/FixedHeightMessage.tsx","../src/components/Message/Message.tsx","../src/components/Message/MessageCommerce.tsx","../src/components/Message/MessageLivestream.tsx","../src/components/Message/MessageTeam.tsx","../src/components/MessageList/CustomNotification.tsx","../src/components/MessageList/ConnectionStatus.tsx","../src/components/MessageList/GiphyPreviewMessage.tsx","../src/components/MessageList/hooks/useCallLoadMore.ts","../src/components/MessageList/utils.ts","../src/components/MessageList/hooks/useEnrichedMessages.ts","../src/components/MessageList/hooks/useLastReadData.ts","../src/components/MessageList/hooks/useMessageListElements.tsx","../src/components/MessageList/hooks/useMessageListScrollManager.ts","../src/components/MessageList/hooks/useScrollLocationLogic.tsx","../src/components/MessageList/Center.tsx","../src/components/MessageList/MessageNotification.tsx","../src/components/MessageList/MessageListNotifications.tsx","../src/components/TypingIndicator/TypingIndicator.tsx","../src/components/MessageList/MessageList.tsx","../src/components/MessageList/hooks/useGiphyPreview.ts","../src/components/MessageList/hooks/useNewMessageNotification.ts","../src/components/MessageList/hooks/usePrependMessagesCount.ts","../src/components/MessageList/hooks/useShouldForceScrollToBottom.ts","../src/components/MessageList/VirtualizedMessageList.tsx","../src/components/Thread/Thread.tsx","../src/components/Window/Window.tsx"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    if (typeof b !== \"function\" && b !== null)\r\n        throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\n/** @deprecated */\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\r\n\r\nexport function __spreadArray(to, from, pack) {\r\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\r\n        if (ar || !(i in from)) {\r\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\r\n            ar[i] = from[i];\r\n        }\r\n    }\r\n    return to.concat(ar || from);\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\r\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\r\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\r\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\r\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\r\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\r\n}\r\n","import React from 'react';\n\nimport type { Action, Attachment } from 'stream-chat';\n\nimport type { ActionHandlerReturnType } from '../Message/hooks/useActionHandler';\n\nimport type { DefaultAttachmentType } from '../../types/types';\n\nexport type AttachmentActionsProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType\n> = Attachment<At> & {\n  /** A list of actions */\n  actions: Action[];\n  /** Unique id for action button key. Key is generated by concatenating this id with action value - {`${id}-${action.value}`} */\n  id: string;\n  /** The text for the form input */\n  text: string;\n  /** Click event handler */\n  actionHandler?: ActionHandlerReturnType;\n};\n\nconst UnMemoizedAttachmentActions = <At extends DefaultAttachmentType = DefaultAttachmentType>(\n  props: AttachmentActionsProps<At>,\n) => {\n  const { actionHandler, actions, id, text } = props;\n\n  const handleActionClick = (\n    event: React.MouseEvent<HTMLButtonElement, MouseEvent>,\n    name?: string,\n    value?: string,\n  ) => {\n    if (actionHandler) {\n      actionHandler(name, value, event);\n    }\n  };\n\n  return (\n    <div className='str-chat__message-attachment-actions'>\n      <div className='str-chat__message-attachment-actions-form'>\n        <span key={0}>{text}</span>\n        {actions.map((action) => (\n          <button\n            className={`str-chat__message-attachment-actions-button str-chat__message-attachment-actions-button--${action.style}`}\n            data-testid={`${action.name}`}\n            data-value={action.value}\n            key={`${id}-${action.value}`}\n            onClick={(event) => handleActionClick(event, action.name, action.value)}\n          >\n            {action.text}\n          </button>\n        ))}\n      </div>\n    </div>\n  );\n};\n\n/**\n * A component for rendering the actions you can take on an attachment.\n */\nexport const AttachmentActions = React.memo(\n  UnMemoizedAttachmentActions,\n) as typeof UnMemoizedAttachmentActions;\n","import React, { useCallback, useEffect, useRef, useState } from 'react';\n\nimport type { Attachment } from 'stream-chat';\n\nimport type { DefaultAttachmentType } from '../../types/types';\n\nconst progressUpdateInterval = 500;\n\nexport type AudioProps<At extends DefaultAttachmentType = DefaultAttachmentType> = {\n  og: Attachment<At>;\n};\n\nconst UnMemoizedAudio = <At extends DefaultAttachmentType = DefaultAttachmentType>(\n  props: AudioProps<At>,\n) => {\n  const { og } = props;\n\n  const [isPlaying, setIsPlaying] = useState(false);\n  const [progress, setProgress] = useState(0);\n\n  const audioRef = useRef<HTMLAudioElement | null>(null);\n\n  const updateProgress = useCallback(() => {\n    if (audioRef.current !== null) {\n      const position = audioRef.current.currentTime;\n      const { duration } = audioRef.current;\n      const currentProgress = (100 / duration) * position;\n      setProgress(currentProgress);\n      if (position === duration) {\n        setIsPlaying(false);\n      }\n    }\n  }, [audioRef]);\n\n  useEffect(() => {\n    if (audioRef.current !== null) {\n      if (isPlaying) {\n        audioRef.current.play();\n        const interval = setInterval(updateProgress, progressUpdateInterval);\n        return () => clearInterval(interval);\n      }\n      audioRef.current.pause();\n    }\n    return;\n  }, [isPlaying, updateProgress]);\n\n  const { asset_url, description, image_url, text, title } = og;\n\n  return (\n    <div className='str-chat__audio'>\n      <div className='str-chat__audio__wrapper'>\n        <audio ref={audioRef}>\n          <source data-testid='audio-source' src={asset_url} type='audio/mp3' />\n        </audio>\n        <div className='str-chat__audio__image'>\n          <div className='str-chat__audio__image--overlay'>\n            {!isPlaying ? (\n              <button\n                className='str-chat__audio__image--button'\n                data-testid='play-audio'\n                onClick={() => setIsPlaying(true)}\n              >\n                <svg height='40' viewBox='0 0 64 64' width='40' xmlns='http://www.w3.org/2000/svg'>\n                  <path\n                    d='M32 58c14.36 0 26-11.64 26-26S46.36 6 32 6 6 17.64 6 32s11.64 26 26 26zm0 6C14.327 64 0 49.673 0 32 0 14.327 14.327 0 32 0c17.673 0 32 14.327 32 32 0 17.673-14.327 32-32 32zm13.237-28.412L26.135 45.625a3.27 3.27 0 0 1-4.426-1.4 3.319 3.319 0 0 1-.372-1.47L21 23.36c-.032-1.823 1.41-3.327 3.222-3.358a3.263 3.263 0 0 1 1.473.322l19.438 9.36a3.311 3.311 0 0 1 .103 5.905z'\n                    fillRule='nonzero'\n                  />\n                </svg>\n              </button>\n            ) : (\n              <button\n                className='str-chat__audio__image--button'\n                data-testid='pause-audio'\n                onClick={() => setIsPlaying(false)}\n              >\n                <svg height='40' viewBox='0 0 64 64' width='40' xmlns='http://www.w3.org/2000/svg'>\n                  <path\n                    d='M32 58.215c14.478 0 26.215-11.737 26.215-26.215S46.478 5.785 32 5.785 5.785 17.522 5.785 32 17.522 58.215 32 58.215zM32 64C14.327 64 0 49.673 0 32 0 14.327 14.327 0 32 0c17.673 0 32 14.327 32 32 0 17.673-14.327 32-32 32zm-7.412-45.56h2.892a2.17 2.17 0 0 1 2.17 2.17v23.865a2.17 2.17 0 0 1-2.17 2.17h-2.892a2.17 2.17 0 0 1-2.17-2.17V20.61a2.17 2.17 0 0 1 2.17-2.17zm12.293 0h2.893a2.17 2.17 0 0 1 2.17 2.17v23.865a2.17 2.17 0 0 1-2.17 2.17h-2.893a2.17 2.17 0 0 1-2.17-2.17V20.61a2.17 2.17 0 0 1 2.17-2.17z'\n                    fillRule='nonzero'\n                  />\n                </svg>\n              </button>\n            )}\n          </div>\n          {image_url && <img alt={`${description}`} src={image_url} />}\n        </div>\n        <div className='str-chat__audio__content'>\n          <span className='str-chat__audio__content--title'>\n            <strong>{title}</strong>\n          </span>\n          <span className='str-chat__audio__content--subtitle'>{text}</span>\n          <div className='str-chat__audio__content--progress'>\n            <div data-testid='audio-progress' style={{ width: `${progress}%` }} />\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\n/**\n * Audio attachment with play/pause button and progress bar\n */\nexport const Audio = React.memo(UnMemoizedAudio) as typeof UnMemoizedAudio;\n","import React from 'react';\nimport { sanitizeUrl } from '@braintree/sanitize-url';\n\n/**\n * Similar to a regular anchor tag, but it sanitizes the href value and prevents XSS\n */\nexport type SafeAnchorProps = {\n  /** Set the className for the anchor tag element */\n  className?: string;\n  /** Specifies that the target (href attribute) will be downloaded instead of navigating to a file */\n  download?: boolean;\n  /** Set the href attribute for the anchor tag element */\n  href?: string;\n  /** Set the rel attribute for the anchor tag element */\n  rel?: string;\n  /** Set the target attribute for the anchor tag element */\n  target?: string;\n};\n\nconst UnMemoizedSafeAnchor: React.FC<SafeAnchorProps> = (props) => {\n  const { children, className, download, href, rel, target } = props;\n  if (!href) return null;\n  const sanitized = sanitizeUrl(href);\n  return (\n    <a\n      aria-label='Attachment'\n      className={className}\n      download={download}\n      href={sanitized}\n      rel={rel}\n      target={target}\n    >\n      {children}\n    </a>\n  );\n};\n\nexport const SafeAnchor = React.memo(UnMemoizedSafeAnchor) as typeof UnMemoizedSafeAnchor;\n","import type { UnknownType } from '../../types/types';\n\nexport const getDisplayName = <P extends UnknownType>(Component: React.ComponentType<P>) =>\n  Component.displayName || Component.name || 'Component';\n","import React, { useContext } from 'react';\nimport Dayjs from 'dayjs';\nimport calendar from 'dayjs/plugin/calendar';\nimport localizedFormat from 'dayjs/plugin/localizedFormat';\n\nimport { getDisplayName } from './utils/getDisplayName';\n\nimport type { TFunction } from 'i18next';\nimport type { Moment } from 'moment';\nimport type { TranslationLanguages } from 'stream-chat';\n\nimport type { UnknownType } from '../types/types';\n\nDayjs.extend(calendar);\nDayjs.extend(localizedFormat);\n\nexport type SupportedTranslations =\n  | 'de'\n  | 'en'\n  | 'es'\n  | 'fr'\n  | 'hi'\n  | 'it'\n  | 'ja'\n  | 'ko'\n  | 'nl'\n  | 'pt'\n  | 'ru'\n  | 'tr';\n\nexport const isLanguageSupported = (language: string): language is SupportedTranslations => {\n  const translations = ['de', 'en', 'es', 'fr', 'hi', 'it', 'ja', 'ko', 'nl', 'pt', 'ru', 'tr'];\n  return translations.some((translation) => language === translation);\n};\n\nexport const isDayOrMoment = (output: TDateTimeParserOutput): output is Dayjs.Dayjs | Moment =>\n  (output as Dayjs.Dayjs | Moment).isSame != null;\n\nexport const isDate = (output: TDateTimeParserOutput): output is Date =>\n  (output as Date).getMonth != null;\n\nexport const isNumberOrString = (output: TDateTimeParserOutput): output is number | string =>\n  typeof output === 'string' || typeof output === 'number';\n\nexport type TDateTimeParserInput = string | number | Date;\n\nexport type TDateTimeParserOutput = string | number | Date | Dayjs.Dayjs | Moment;\n\nexport type TDateTimeParser = (input?: TDateTimeParserInput) => TDateTimeParserOutput;\n\nexport type TranslationContextValue = {\n  t: TFunction | ((key: string) => string);\n  tDateTimeParser: TDateTimeParser;\n  userLanguage: TranslationLanguages;\n};\n\nexport const TranslationContext = React.createContext<TranslationContextValue>({\n  t: (key: string) => key,\n  tDateTimeParser: (input) => Dayjs(input),\n  userLanguage: 'en',\n});\n\nexport const TranslationProvider: React.FC<{\n  value: TranslationContextValue;\n}> = ({ children, value }) => (\n  <TranslationContext.Provider value={value}>{children}</TranslationContext.Provider>\n);\n\nexport const useTranslationContext = (componentName?: string) => {\n  const contextValue = useContext(TranslationContext);\n\n  if (!contextValue) {\n    console.warn(\n      `The useTranslationContext hook was called outside of the TranslationContext provider. Make sure this hook is called within a child of the Chat component. The errored call is located in the ${componentName} component.`,\n    );\n\n    return {} as TranslationContextValue;\n  }\n\n  return contextValue;\n};\n\nexport const withTranslationContext = <P extends UnknownType>(\n  Component: React.ComponentType<P>,\n): React.FC<Omit<P, keyof TranslationContextValue>> => {\n  const WithTranslationContextComponent = (props: Omit<P, keyof TranslationContextValue>) => {\n    const translationContext = useTranslationContext();\n\n    return <Component {...(props as P)} {...translationContext} />;\n  };\n\n  WithTranslationContextComponent.displayName = `WithTranslationContext${getDisplayName(\n    Component,\n  )}`;\n\n  return WithTranslationContextComponent;\n};\n","import React from 'react';\n\nimport { SafeAnchor } from '../SafeAnchor';\n\nimport { useTranslationContext } from '../../context/TranslationContext';\n\nexport type CardProps = {\n  /** The url of the full sized image */\n  image_url?: string;\n  /** The scraped url, used as a fallback if the OG-data doesn't include a link */\n  og_scrape_url?: string;\n  /** Description returned by the OG scraper */\n  text?: string;\n  /** The url for thumbnail sized image */\n  thumb_url?: string;\n  /** Title returned by the OG scraper */\n  title?: string;\n  /** Link returned by the OG scraper */\n  title_link?: string;\n  /** The card type used in the className attribute */\n  type?: string;\n};\n\nconst UnMemoizedCard: React.FC<CardProps> = (props) => {\n  const { image_url, og_scrape_url, text, thumb_url, title, title_link, type } = props;\n\n  const { t } = useTranslationContext('Card');\n\n  const image = thumb_url || image_url;\n\n  const trimUrl = (url?: string | null) => {\n    if (url !== undefined && url !== null) {\n      const [trimmedUrl] = url.replace(/^(?:https?:\\/\\/)?(?:www\\.)?/i, '').split('/');\n\n      return trimmedUrl;\n    }\n    return null;\n  };\n\n  if (!title && !title_link && !image) {\n    return (\n      <div\n        className={`str-chat__message-attachment-card str-chat__message-attachment-card--${type}`}\n      >\n        <div className='str-chat__message-attachment-card--content'>\n          <div className='str-chat__message-attachment-card--text'>\n            {t('this content could not be displayed')}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  if (!title_link && !og_scrape_url) {\n    return null;\n  }\n\n  return (\n    <div className={`str-chat__message-attachment-card str-chat__message-attachment-card--${type}`}>\n      {image && (\n        <div className='str-chat__message-attachment-card--header'>\n          <img alt={image} src={image} />\n        </div>\n      )}\n      <div className='str-chat__message-attachment-card--content'>\n        <div className='str-chat__message-attachment-card--flex'>\n          {title && <div className='str-chat__message-attachment-card--title'>{title}</div>}\n          {text && <div className='str-chat__message-attachment-card--text'>{text}</div>}\n          {(title_link || og_scrape_url) && (\n            <SafeAnchor\n              className='str-chat__message-attachment-card--url'\n              href={title_link || og_scrape_url}\n              rel='noopener noreferrer'\n              target='_blank'\n            >\n              {trimUrl(title_link || og_scrape_url)}\n            </SafeAnchor>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n};\n\n/**\n * Simple Card Layout for displaying links\n */\nexport const Card = React.memo(UnMemoizedCard) as typeof UnMemoizedCard;\n","import React from 'react';\nimport prettybytes from 'pretty-bytes';\nimport { FileIcon } from 'react-file-utils';\n\nimport { SafeAnchor } from '../SafeAnchor';\n\nimport type { Attachment } from 'stream-chat';\n\nimport type { DefaultAttachmentType } from '../../types/types';\n\nexport type FileAttachmentProps<At extends DefaultAttachmentType = DefaultAttachmentType> = {\n  attachment: Attachment<At>;\n};\n\nconst UnMemoizedFileAttachment = <At extends DefaultAttachmentType = DefaultAttachmentType>(\n  props: FileAttachmentProps<At>,\n) => {\n  const { attachment } = props;\n\n  return (\n    <div className='str-chat__message-attachment-file--item' data-testid='attachment-file'>\n      <FileIcon big={true} filename={attachment.title} mimeType={attachment.mime_type} size={30} />\n      <div className='str-chat__message-attachment-file--item-text'>\n        <SafeAnchor download href={attachment.asset_url} target='_blank'>\n          {attachment.title}\n        </SafeAnchor>\n        {attachment.file_size && Number.isFinite(Number(attachment.file_size)) && (\n          <span>{prettybytes(attachment.file_size)}</span>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport const FileAttachment = React.memo(\n  UnMemoizedFileAttachment,\n) as typeof UnMemoizedFileAttachment;\n","import React, { useEffect, useRef } from 'react';\n\nimport { useTranslationContext } from '../../context/TranslationContext';\n\nexport type ModalProps = {\n  /** If true, modal is opened or visible. */\n  open: boolean;\n  /** Callback handler for closing of modal. */\n  onClose?: () => void | ((event?: React.BaseSyntheticEvent) => void);\n};\n\nexport const Modal: React.FC<ModalProps> = (props) => {\n  const { children, onClose, open } = props;\n\n  const { t } = useTranslationContext('Modal');\n\n  const innerRef = useRef<HTMLDivElement | null>(null);\n  const closeRef = useRef<HTMLButtonElement | null>(null);\n\n  const handleClick = (event: React.MouseEvent<HTMLDivElement>) => {\n    if (\n      (event.target instanceof HTMLDivElement &&\n        !innerRef.current?.contains(event.target) &&\n        onClose) ||\n      (event.target instanceof HTMLButtonElement &&\n        closeRef.current?.contains(event.target) &&\n        onClose)\n    ) {\n      onClose();\n    }\n  };\n\n  useEffect(() => {\n    if (!open) return () => null;\n\n    const handleEscKey: EventListener = (event) => {\n      if (event instanceof KeyboardEvent && event.key === 'Escape' && onClose) {\n        onClose();\n      }\n    };\n\n    document.addEventListener('keypress', handleEscKey);\n    return () => document.removeEventListener('keypress', handleEscKey);\n  }, [onClose, open]);\n\n  const openClasses = open ? 'str-chat__modal--open' : 'str-chat__modal--closed';\n\n  return (\n    <div className={`str-chat__modal ${openClasses}`} onClick={handleClick}>\n      <button className='str-chat__modal__close-button' ref={closeRef} title='Close'>\n        {t('Close')}\n        <svg height='10' width='10' xmlns='http://www.w3.org/2000/svg'>\n          <path\n            d='M9.916 1.027L8.973.084 5 4.058 1.027.084l-.943.943L4.058 5 .084 8.973l.943.943L5 5.942l3.973 3.974.943-.943L5.942 5z'\n            fillRule='evenodd'\n          />\n        </svg>\n      </button>\n      <div className='str-chat__modal__inner' ref={innerRef}>\n        {children}\n      </div>\n    </div>\n  );\n};\n","import React from 'react';\nimport ImageGallery, { ReactImageGalleryItem } from 'react-image-gallery';\n\nimport { Modal } from '../Modal';\n\nexport type ModalWrapperProps = {\n  /** The images for the Carousel component */\n  images: ReactImageGalleryItem[];\n  /** Boolean for if modal is open*/\n  modalIsOpen: boolean;\n  /** click event handler for toggling modal */\n  toggleModal: () => void | ((event?: React.BaseSyntheticEvent) => void);\n  /** The index for the component */\n  index?: number;\n};\n\nexport const ModalComponent: React.FC<ModalWrapperProps> = (props) => {\n  const { images, index, modalIsOpen, toggleModal } = props;\n\n  return (\n    <Modal onClose={toggleModal} open={modalIsOpen}>\n      <ImageGallery\n        items={images}\n        showIndex={true}\n        showPlayButton={false}\n        showThumbnails={false}\n        startIndex={index}\n      />\n    </Modal>\n  );\n};\n","import React, { useMemo, useState } from 'react';\n\nimport { ModalComponent as ModalWrapper } from './ModalWrapper';\n\nimport { useTranslationContext } from '../../context/TranslationContext';\n\nimport type { Attachment } from 'stream-chat';\n\nimport type { DefaultAttachmentType } from '../../types/types';\n\nexport type GalleryProps<At extends DefaultAttachmentType = DefaultAttachmentType> = {\n  images:\n    | {\n        image_url?: string | undefined;\n        thumb_url?: string | undefined;\n      }[]\n    | Attachment<At>[];\n};\n\nconst UnMemoizedGallery = <At extends DefaultAttachmentType = DefaultAttachmentType>(\n  props: GalleryProps<At>,\n) => {\n  const { images } = props;\n\n  const [index, setIndex] = useState(0);\n  const [modalOpen, setModalOpen] = useState(false);\n\n  const { t } = useTranslationContext('Gallery');\n\n  const toggleModal = (selectedIndex: number) => {\n    if (modalOpen) {\n      setModalOpen(false);\n    } else {\n      setIndex(selectedIndex);\n      setModalOpen(true);\n    }\n  };\n\n  const formattedArray = useMemo(\n    () =>\n      images.map((image) => ({\n        original: image.image_url || image.thumb_url || '',\n        originalAlt: 'User uploaded content',\n        source: image.image_url || image.thumb_url || '',\n      })),\n    [images],\n  );\n\n  const renderImages = images.slice(0, 3).map((image, i) => (\n    <button\n      className='str-chat__gallery-image'\n      data-testid='gallery-image'\n      key={`gallery-image-${i}`}\n      onClick={() => toggleModal(i)}\n    >\n      <img alt='User uploaded content' src={image.image_url || image.thumb_url} />\n    </button>\n  ));\n\n  return (\n    <div className={`str-chat__gallery ${images.length > 3 ? 'str-chat__gallery--square' : ''}`}>\n      {renderImages}\n      {images.length > 3 && (\n        <button\n          className='str-chat__gallery-placeholder'\n          onClick={() => toggleModal(3)}\n          style={{\n            backgroundImage: `url(${images[3].image_url})`,\n          }}\n        >\n          <p>\n            {t('{{ imageCount }} more', {\n              imageCount: images.length - 3,\n            })}\n          </p>\n        </button>\n      )}\n      <ModalWrapper\n        images={formattedArray}\n        index={index}\n        modalIsOpen={modalOpen}\n        toggleModal={() => setModalOpen(!modalOpen)}\n      />\n    </div>\n  );\n};\n\n/**\n * Displays images in a simple responsive grid with a light box to view the images.\n */\nexport const Gallery = React.memo(UnMemoizedGallery) as typeof UnMemoizedGallery;\n","import React, { useState } from 'react';\nimport { sanitizeUrl } from '@braintree/sanitize-url';\n\nimport { ModalComponent as ModalWrapper } from './ModalWrapper';\n\nexport type ImageProps = {\n  /** The text fallback for the image */\n  fallback?: string;\n  /** The full size image url */\n  image_url?: string;\n  /** The thumb url */\n  thumb_url?: string;\n};\n\n/**\n * A simple component that displays an image.\n */\nexport const ImageComponent: React.FC<ImageProps> = (props) => {\n  const [modalIsOpen, setModalIsOpen] = useState(false);\n\n  const { fallback, image_url, thumb_url } = props;\n  const imageSrc = sanitizeUrl(image_url || thumb_url);\n  const formattedArray = [\n    { original: imageSrc, originalAlt: 'User uploaded content', source: imageSrc },\n  ];\n\n  const toggleModal = () => setModalIsOpen(!modalIsOpen);\n\n  return (\n    <>\n      <img\n        alt={fallback}\n        className='str-chat__message-attachment--img'\n        data-testid='image-test'\n        onClick={toggleModal}\n        onKeyPress={toggleModal}\n        src={imageSrc}\n        tabIndex={0}\n      />\n\n      <ModalWrapper\n        images={formattedArray}\n        index={0}\n        modalIsOpen={modalIsOpen}\n        toggleModal={toggleModal}\n      />\n    </>\n  );\n};\n","import React, { PropsWithChildren } from 'react';\nimport ReactPlayer from 'react-player';\n\nimport { AttachmentActions as DefaultAttachmentActions } from './AttachmentActions';\nimport { Audio as DefaultAudio } from './Audio';\nimport { Card as DefaultCard } from './Card';\nimport { FileAttachment as DefaultFile } from './FileAttachment';\nimport { Gallery as DefaultGallery, ImageComponent as DefaultImage } from '../Gallery';\n\nimport type { Attachment } from 'stream-chat';\nimport type { AttachmentProps } from './Attachment';\nimport type { DefaultAttachmentType } from '../../types/types';\n\nexport const SUPPORTED_VIDEO_FORMATS = ['video/mp4', 'video/ogg', 'video/webm', 'video/quicktime'];\n\nexport type GalleryAttachment<At extends DefaultAttachmentType = DefaultAttachmentType> = {\n  images: Attachment<At>[];\n  type: string;\n};\n\nexport type AttachmentContainerProps<At extends DefaultAttachmentType = DefaultAttachmentType> = {\n  attachment: Attachment<At> | GalleryAttachment<At>;\n  componentType: string;\n};\n\nexport type RenderAttachmentProps<At extends DefaultAttachmentType = DefaultAttachmentType> = Omit<\n  AttachmentProps<At>,\n  'attachments'\n> & {\n  attachment: Attachment<At>;\n};\n\nexport type RenderGalleryProps<At extends DefaultAttachmentType = DefaultAttachmentType> = Omit<\n  AttachmentProps<At>,\n  'attachments'\n> & {\n  attachment: GalleryAttachment<At>;\n};\n\nexport const isGalleryAttachmentType = <At extends DefaultAttachmentType = DefaultAttachmentType>(\n  output: Attachment<At> | GalleryAttachment<At>,\n): output is GalleryAttachment<At> => (output as GalleryAttachment<At>).images != null;\n\nexport const isAudioAttachment = <At extends DefaultAttachmentType = DefaultAttachmentType>(\n  attachment: Attachment<At>,\n) => attachment.type === 'audio';\n\nexport const isFileAttachment = <At extends DefaultAttachmentType = DefaultAttachmentType>(\n  attachment: Attachment<At>,\n) =>\n  attachment.type === 'file' ||\n  (attachment.mime_type &&\n    SUPPORTED_VIDEO_FORMATS.indexOf(attachment.mime_type) === -1 &&\n    attachment.type !== 'video');\n\nexport const isImageAttachment = <At extends DefaultAttachmentType = DefaultAttachmentType>(\n  attachment: Attachment<At>,\n) => attachment.type === 'image' && !attachment.title_link && !attachment.og_scrape_url;\n\nexport const isMediaAttachment = <At extends DefaultAttachmentType = DefaultAttachmentType>(\n  attachment: Attachment<At>,\n) =>\n  (attachment.mime_type && SUPPORTED_VIDEO_FORMATS.indexOf(attachment.mime_type) !== -1) ||\n  attachment.type === 'video';\n\nexport const renderAttachmentWithinContainer = <\n  At extends DefaultAttachmentType = DefaultAttachmentType\n>(\n  props: PropsWithChildren<AttachmentContainerProps<At>>,\n) => {\n  const { attachment, children, componentType } = props;\n\n  let extra = '';\n\n  if (!isGalleryAttachmentType(attachment)) {\n    extra =\n      componentType === 'card' && !attachment?.image_url && !attachment?.thumb_url\n        ? 'no-image'\n        : attachment && attachment.actions && attachment.actions.length\n        ? 'actions'\n        : '';\n  }\n\n  return (\n    <div\n      className={`str-chat__message-attachment str-chat__message-attachment--${componentType} str-chat__message-attachment--${\n        attachment?.type || ''\n      } str-chat__message-attachment--${componentType}--${extra}`}\n      key={`${isGalleryAttachmentType(attachment) ? '' : attachment?.id}-${\n        attachment?.type || 'none'\n      } `}\n    >\n      {children}\n    </div>\n  );\n};\n\nexport const renderAttachmentActions = <At extends DefaultAttachmentType = DefaultAttachmentType>(\n  props: RenderAttachmentProps<At>,\n) => {\n  const { actionHandler, attachment, AttachmentActions = DefaultAttachmentActions } = props;\n\n  if (!attachment.actions?.length) return null;\n\n  return (\n    <AttachmentActions\n      {...attachment}\n      actionHandler={(event, name, value) => actionHandler?.(event, name, value)}\n      actions={attachment.actions}\n      id={attachment.id || ''}\n      key={`key-actions-${attachment.id}`}\n      text={attachment.text || ''}\n    />\n  );\n};\n\nexport const renderGallery = <At extends DefaultAttachmentType = DefaultAttachmentType>(\n  props: RenderGalleryProps<At>,\n) => {\n  const { attachment, Gallery = DefaultGallery } = props;\n\n  return renderAttachmentWithinContainer({\n    attachment,\n    children: <Gallery images={attachment.images || []} key='gallery' />,\n    componentType: 'gallery',\n  });\n};\n\nexport const renderImage = <At extends DefaultAttachmentType = DefaultAttachmentType>(\n  props: RenderAttachmentProps<At>,\n) => {\n  const { attachment, Image = DefaultImage } = props;\n\n  if (attachment.actions && attachment.actions.length) {\n    return renderAttachmentWithinContainer({\n      attachment,\n      children: (\n        <div className='str-chat__attachment' key={`key-image-${attachment.id}`}>\n          {<Image {...attachment} />}\n          {renderAttachmentActions(props)}\n        </div>\n      ),\n      componentType: 'image',\n    });\n  }\n\n  return renderAttachmentWithinContainer({\n    attachment,\n    children: <Image {...attachment} key={`key-image-${attachment.id}`} />,\n    componentType: 'image',\n  });\n};\n\nexport const renderCard = <At extends DefaultAttachmentType = DefaultAttachmentType>(\n  props: RenderAttachmentProps<At>,\n) => {\n  const { attachment, Card = DefaultCard } = props;\n\n  if (attachment.actions && attachment.actions.length) {\n    return renderAttachmentWithinContainer({\n      attachment,\n      children: (\n        <div className='str-chat__attachment' key={`key-image-${attachment.id}`}>\n          <Card {...attachment} key={`key-card-${attachment.id}`} />\n          {renderAttachmentActions(props)}\n        </div>\n      ),\n      componentType: 'card',\n    });\n  }\n\n  return renderAttachmentWithinContainer({\n    attachment,\n    children: <Card {...attachment} key={`key-card-${attachment.id}`} />,\n    componentType: 'card',\n  });\n};\n\nexport const renderFile = <At extends DefaultAttachmentType = DefaultAttachmentType>(\n  props: RenderAttachmentProps<At>,\n) => {\n  const { attachment, File = DefaultFile } = props;\n\n  if (!attachment.asset_url) return null;\n\n  return renderAttachmentWithinContainer({\n    attachment,\n    children: <File attachment={attachment} key={`key-file-${attachment.id}`} />,\n    componentType: 'file',\n  });\n};\n\nexport const renderAudio = <At extends DefaultAttachmentType = DefaultAttachmentType>(\n  props: RenderAttachmentProps<At>,\n) => {\n  const { attachment, Audio = DefaultAudio } = props;\n\n  return renderAttachmentWithinContainer({\n    attachment,\n    children: (\n      <div className='str-chat__attachment' key={`key-video-${attachment.id}`}>\n        <Audio og={attachment} />\n      </div>\n    ),\n    componentType: 'audio',\n  });\n};\n\nexport const renderMedia = <At extends DefaultAttachmentType = DefaultAttachmentType>(\n  props: RenderAttachmentProps<At>,\n) => {\n  const { attachment, Media = ReactPlayer } = props;\n\n  if (attachment.actions?.length) {\n    return renderAttachmentWithinContainer({\n      attachment,\n      children: (\n        <div\n          className='str-chat__attachment str-chat__attachment-media'\n          key={`key-video-${attachment.id}`}\n        >\n          <div className='str-chat__player-wrapper'>\n            <Media\n              className='react-player'\n              controls\n              height='100%'\n              url={attachment.asset_url}\n              width='100%'\n            />\n          </div>\n          {renderAttachmentActions(props)}\n        </div>\n      ),\n      componentType: 'media',\n    });\n  }\n\n  return renderAttachmentWithinContainer({\n    attachment,\n    children: (\n      <div className='str-chat__player-wrapper' key={`key-video-${attachment.id}`}>\n        <Media\n          className='react-player'\n          controls\n          height='100%'\n          url={attachment.asset_url}\n          width='100%'\n        />\n      </div>\n    ),\n    componentType: 'media',\n  });\n};\n","import React from 'react';\n\nimport {\n  isAudioAttachment,\n  isFileAttachment,\n  isGalleryAttachmentType,\n  isImageAttachment,\n  isMediaAttachment,\n  renderAudio,\n  renderCard,\n  renderFile,\n  renderGallery,\n  renderImage,\n  renderMedia,\n} from './utils';\n\nimport type { ReactPlayerProps } from 'react-player';\nimport type { Attachment as StreamAttachment } from 'stream-chat';\n\nimport type { AttachmentActionsProps } from './AttachmentActions';\nimport type { AudioProps } from './Audio';\nimport type { CardProps } from './Card';\nimport type { FileAttachmentProps } from './FileAttachment';\nimport type { GalleryProps, ImageProps } from '../Gallery';\nimport type { ActionHandlerReturnType } from '../Message/hooks/useActionHandler';\n\nimport type { DefaultAttachmentType } from '../../types/types';\n\nexport type AttachmentProps<At extends DefaultAttachmentType = DefaultAttachmentType> = {\n  /** The message attachments to render, see [attachment structure](https://getstream.io/chat/docs/javascript/message_format/?language=javascript) **/\n  attachments: StreamAttachment<At>[];\n  /**\tThe handler function to call when an action is performed on an attachment, examples include canceling a \\/giphy command or shuffling the results. */\n  actionHandler?: ActionHandlerReturnType;\n  /** Custom UI component for displaying attachment actions, defaults to and accepts same props as: [AttachmentActions](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Attachment/AttachmentActions.tsx) */\n  AttachmentActions?: React.ComponentType<AttachmentActionsProps<At>>;\n  /** Custom UI component for displaying an audio type attachment, defaults to and accepts same props as: [Audio](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Attachment/Audio.tsx) */\n  Audio?: React.ComponentType<AudioProps<At>>;\n  /** Custom UI component for displaying a card type attachment, defaults to and accepts same props as: [Card](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Attachment/Card.tsx) */\n  Card?: React.ComponentType<CardProps>;\n  /** Custom UI component for displaying a file type attachment, defaults to and accepts same props as: [File](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Attachment/FileAttachment.tsx) */\n  File?: React.ComponentType<FileAttachmentProps<At>>;\n  /** Custom UI component for displaying a gallery of image type attachments, defaults to and accepts same props as: [Gallery](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Gallery/Gallery.tsx) */\n  Gallery?: React.ComponentType<GalleryProps<At>>;\n  /** Custom UI component for displaying an image type attachment, defaults to and accepts same props as: [Image](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Gallery/Image.tsx) */\n  Image?: React.ComponentType<ImageProps>;\n  /** Custom UI component for displaying a media type attachment, defaults to `ReactPlayer` from 'react-player' */\n  Media?: React.ComponentType<ReactPlayerProps>;\n};\n\n/**\n * A component used for rendering message attachments. By default, the component supports: AttachmentActions, Audio, Card, File, Gallery, Image, and Video\n */\nexport const Attachment = <At extends DefaultAttachmentType = DefaultAttachmentType>(\n  props: AttachmentProps<At>,\n) => {\n  const { attachments, ...rest } = props;\n\n  const gallery = {\n    images: attachments?.filter(\n      (attachment) =>\n        attachment.type === 'image' && !(attachment.og_scrape_url || attachment.title_link),\n    ),\n    type: 'gallery',\n  };\n\n  const newAttachments =\n    gallery.images.length >= 2\n      ? [\n          ...attachments.filter(\n            (attachment) =>\n              !(\n                attachment.type === 'image' && !(attachment.og_scrape_url || attachment.title_link)\n              ),\n          ),\n          gallery,\n        ]\n      : attachments;\n\n  return (\n    <>\n      {newAttachments.map((attachment) => {\n        if (isGalleryAttachmentType(attachment)) {\n          return renderGallery({ ...rest, attachment });\n        }\n\n        if (isImageAttachment(attachment)) {\n          return renderImage({ ...rest, attachment });\n        }\n\n        if (isAudioAttachment(attachment)) {\n          return renderAudio({ ...rest, attachment });\n        }\n\n        if (isFileAttachment(attachment)) {\n          return renderFile({ ...rest, attachment });\n        }\n\n        if (isMediaAttachment(attachment)) {\n          return renderMedia({ ...rest, attachment });\n        }\n\n        return renderCard({ ...rest, attachment });\n      })}\n    </>\n  );\n};\n","import React from 'react';\n\nexport const Item = React.forwardRef(function Item(props, innerRef) {\n  const {\n    className,\n    component: Component,\n    item,\n    onClickHandler,\n    onSelectHandler,\n    selected,\n    style,\n  } = props;\n\n  const selectItem = () => onSelectHandler(item);\n\n  return (\n    <li className={`rta__item ${className || ''}`} style={style}>\n      <button\n        className={`rta__entity ${selected ? 'rta__entity--selected' : ''}`}\n        onClick={onClickHandler}\n        onFocus={selectItem}\n        onMouseEnter={selectItem}\n        ref={innerRef}\n      >\n        <Component entity={item} selected={selected} />\n      </button>\n    </li>\n  );\n});\n","import React, { PropsWithChildren, useContext } from 'react';\n\nimport type { AttachmentProps } from '../components/Attachment/Attachment';\nimport type { AvatarProps } from '../components/Avatar/Avatar';\nimport type { DateSeparatorProps } from '../components/DateSeparator/DateSeparator';\nimport type { EmptyStateIndicatorProps } from '../components/EmptyStateIndicator/EmptyStateIndicator';\nimport type { EventComponentProps } from '../components/EventComponent/EventComponent';\nimport type { LoadingIndicatorProps } from '../components/Loading/LoadingIndicator';\nimport type { FixedHeightMessageProps } from '../components/Message/FixedHeightMessage';\nimport type { MessageUIComponentProps, PinIndicatorProps } from '../components/Message/types';\nimport type { MessageDeletedProps } from '../components/Message/MessageDeleted';\nimport type { GiphyPreviewMessageProps } from '../components/MessageList/GiphyPreviewMessage';\nimport type { MessageListNotificationsProps } from '../components/MessageList/MessageListNotifications';\nimport type { MessageNotificationProps } from '../components/MessageList/MessageNotification';\nimport type { MessageOptionsProps } from '../components/Message/MessageOptions';\nimport type { CooldownTimerProps } from '../components/MessageInput/hooks/useCooldownTimer';\nimport type { MessageInputProps } from '../components/MessageInput/MessageInput';\nimport type { QuotedMessagePreviewProps } from '../components/MessageInput/QuotedMessagePreview';\nimport type { MessageRepliesCountButtonProps } from '../components/Message/MessageRepliesCountButton';\nimport type { MessageStatusProps } from '../components/Message/MessageStatus';\nimport type { MessageTimestampProps } from '../components/Message/MessageTimestamp';\nimport type { ReactionSelectorProps } from '../components/Reactions/ReactionSelector';\nimport type { ReactionsListProps } from '../components/Reactions/ReactionsList';\nimport type {\n  SuggestionItemProps,\n  SuggestionListProps,\n} from '../components/ChatAutoComplete/ChatAutoComplete';\nimport type { SuggestionListHeaderProps } from '../components/AutoCompleteTextarea';\nimport type { SendButtonProps } from '../components/MessageInput/icons';\nimport type { ThreadHeaderProps } from '../components/Thread/Thread';\nimport type { TypingIndicatorProps } from '../components/TypingIndicator/TypingIndicator';\n\nimport type {\n  CustomTrigger,\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n  UnknownType,\n} from '../types/types';\n\nexport type ComponentContextValue<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n> = {\n  Attachment: React.ComponentType<AttachmentProps<At>>;\n  Message: React.ComponentType<MessageUIComponentProps<At, Ch, Co, Ev, Me, Re, Us>>;\n  AutocompleteSuggestionHeader?: React.ComponentType<SuggestionListHeaderProps>;\n  AutocompleteSuggestionItem?: React.ComponentType<SuggestionItemProps<Co, Us>>;\n  AutocompleteSuggestionList?: React.ComponentType<SuggestionListProps<Co, Us, V>>;\n  Avatar?: React.ComponentType<AvatarProps<Us>>;\n  CooldownTimer?: React.ComponentType<CooldownTimerProps>;\n  DateSeparator?: React.ComponentType<DateSeparatorProps>;\n  EditMessageInput?: React.ComponentType<MessageInputProps<At, Ch, Co, Ev, Me, Re, Us>>;\n  EmojiIcon?: React.ComponentType;\n  EmptyStateIndicator?: React.ComponentType<EmptyStateIndicatorProps>;\n  FileUploadIcon?: React.ComponentType;\n  GiphyPreviewMessage?: React.ComponentType<GiphyPreviewMessageProps<At, Ch, Co, Ev, Me, Re, Us>>;\n  HeaderComponent?: React.ComponentType;\n  Input?: React.ComponentType<MessageInputProps<At, Ch, Co, Ev, Me, Re, Us, V>>;\n  LoadingIndicator?: React.ComponentType<LoadingIndicatorProps>;\n  MessageDeleted?: React.ComponentType<MessageDeletedProps<At, Ch, Co, Ev, Me, Re, Us>>;\n  MessageListNotifications?: React.ComponentType<MessageListNotificationsProps>;\n  MessageNotification?: React.ComponentType<MessageNotificationProps>;\n  MessageOptions?: React.ComponentType<MessageOptionsProps<At, Ch, Co, Ev, Me, Re, Us>>;\n  MessageRepliesCountButton?: React.ComponentType<MessageRepliesCountButtonProps>;\n  MessageStatus?: React.ComponentType<MessageStatusProps>;\n  MessageSystem?: React.ComponentType<EventComponentProps<At, Ch, Co, Ev, Me, Re, Us>>;\n  MessageTimestamp?: React.ComponentType<MessageTimestampProps<At, Ch, Co, Ev, Me, Re, Us>>;\n  PinIndicator?: React.ComponentType<PinIndicatorProps<At, Ch, Co, Ev, Me, Re, Us>>;\n  QuotedMessage?: React.ComponentType;\n  QuotedMessagePreview?: React.ComponentType<QuotedMessagePreviewProps<At, Ch, Co, Ev, Me, Re, Us>>;\n  ReactionSelector?: React.ForwardRefExoticComponent<ReactionSelectorProps<Re, Us>>;\n  ReactionsList?: React.ComponentType<ReactionsListProps<Re, Us>>;\n  SendButton?: React.ComponentType<SendButtonProps<At, Me, Us>>;\n  ThreadHeader?: React.ComponentType<ThreadHeaderProps<At, Ch, Co, Ev, Me, Re, Us>>;\n  ThreadInput?: React.ComponentType<MessageInputProps<At, Ch, Co, Ev, Me, Re, Us, V>>;\n  ThreadStart?: React.ComponentType;\n  TriggerProvider?: React.ComponentType;\n  TypingIndicator?: React.ComponentType<TypingIndicatorProps>;\n  VirtualMessage?: React.ComponentType<FixedHeightMessageProps<At, Ch, Co, Ev, Me, Re, Us>>;\n};\n\nexport const ComponentContext = React.createContext<ComponentContextValue | undefined>(undefined);\n\nexport const ComponentProvider = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>({\n  children,\n  value,\n}: PropsWithChildren<{\n  value: Partial<ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us, V>>;\n}>) => (\n  <ComponentContext.Provider value={(value as unknown) as ComponentContextValue}>\n    {children}\n  </ComponentContext.Provider>\n);\n\nexport const useComponentContext = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>(\n  componentName?: string,\n) => {\n  const contextValue = useContext(ComponentContext);\n\n  if (!contextValue) {\n    console.warn(\n      `The useComponentContext hook was called outside of the ComponentContext provider. Make sure this hook is called within a child of the Channel component. The errored call is located in the ${componentName} component.`,\n    );\n\n    return {} as ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us, V>;\n  }\n\n  return contextValue as ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us, V>;\n};\n\n/**\n * Typescript currently does not support partial inference, so if ComponentContext\n * typing is desired while using the HOC withComponentContext, the Props for the\n * wrapped component must be provided as the first generic.\n */\nexport const withComponentContext = <\n  P extends UnknownType,\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>(\n  Component: React.ComponentType<P>,\n): React.FC<Omit<P, keyof ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us, V>>> => {\n  const WithComponentContextComponent = (\n    props: Omit<P, keyof ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us, V>>,\n  ) => {\n    const componentContext = useComponentContext<At, Ch, Co, Ev, Me, Re, Us, V>();\n\n    return <Component {...(props as P)} {...componentContext} />;\n  };\n\n  WithComponentContextComponent.displayName = (\n    Component.displayName ||\n    Component.name ||\n    'Component'\n  ).replace('Base', '');\n\n  return WithComponentContextComponent;\n};\n","import React, { PropsWithChildren } from 'react';\nimport emojiRegex from 'emoji-regex';\nimport * as linkify from 'linkifyjs';\n//@ts-expect-error\nimport findAndReplace from 'mdast-util-find-and-replace';\nimport RootReactMarkdown, { NodeType } from 'react-markdown';\nimport ReactMarkdown from 'react-markdown/with-html';\nimport uniqBy from 'lodash.uniqby';\n\nimport type { UserResponse } from 'stream-chat';\n\nimport type { DefaultUserType } from './types/types';\n\nexport const isOnlyEmojis = (text?: string) => {\n  if (!text) return false;\n\n  const noEmojis = text.replace(emojiRegex(), '');\n  const noSpace = noEmojis.replace(/[\\s\\n]/gm, '');\n\n  return !noSpace;\n};\n\nconst allowedMarkups: NodeType[] = [\n  'html',\n  // @ts-expect-error\n  'root',\n  'text',\n  'break',\n  'paragraph',\n  'emphasis',\n  'strong',\n  'link',\n  'list',\n  'listItem',\n  'code',\n  'inlineCode',\n  'blockquote',\n  'delete',\n];\n\nexport const matchMarkdownLinks = (message: string) => {\n  const regexMdLinks = /\\[([^[]+)\\](\\(.*\\))/gm;\n  const matches = message.match(regexMdLinks);\n  const singleMatch = /\\[([^[]+)\\]\\((.*)\\)/;\n\n  const links = matches\n    ? matches.map((match) => {\n        const i = singleMatch.exec(match);\n        return i && [i[1], i[2]];\n      })\n    : [];\n\n  return links.flat();\n};\n\nexport const messageCodeBlocks = (message: string) => {\n  const codeRegex = /```[a-z]*\\n[\\s\\S]*?\\n```|`[a-z]*[\\s\\S]*?`/gm;\n  const matches = message.match(codeRegex);\n  return matches || [];\n};\n\ntype MarkDownRenderers = {\n  children: React.ReactElement;\n  href?: string;\n};\n\nconst detectHttp = /(http(s?):\\/\\/)?(www\\.)?/;\n\nfunction formatUrlForDisplay(url: string) {\n  try {\n    return decodeURIComponent(url).replace(detectHttp, '');\n  } catch (e) {\n    return url;\n  }\n}\n\nfunction encodeDecode(url: string) {\n  try {\n    return encodeURI(decodeURIComponent(url));\n  } catch (error) {\n    return url;\n  }\n}\n\nexport const markDownRenderers: { [nodeType: string]: React.ElementType } = {\n  // eslint-disable-next-line react/display-name\n  link: (props: MarkDownRenderers) => {\n    const { children, href } = props;\n\n    const isEmail = href?.startsWith('mailto:');\n    const isUrl = href?.startsWith('http');\n\n    if (!href || (!isEmail && !isUrl)) {\n      return children;\n    }\n\n    return (\n      <a\n        className={`${isUrl ? 'str-chat__message-url-link' : ''}`}\n        href={href}\n        rel='nofollow noreferrer noopener'\n        target='_blank'\n      >\n        {children}\n      </a>\n    );\n  },\n  span: 'span',\n};\n\nexport const emojiMarkdownPlugin = () => {\n  function replace(match: RegExpMatchArray | null) {\n    return {\n      children: [{ type: 'text', value: match }],\n      className: 'inline-text-emoji',\n      type: 'span',\n    };\n  }\n\n  const transform = <T extends unknown>(markdownAST: T) => {\n    findAndReplace(markdownAST, emojiRegex(), replace);\n    return markdownAST;\n  };\n\n  return transform;\n};\n\nexport const mentionsMarkdownPlugin = <Us extends DefaultUserType<Us> = DefaultUserType>(\n  mentioned_users: UserResponse<Us>[],\n) => () => {\n  const mentioned_usernames = mentioned_users\n    .map((user) => user.name || user.id)\n    .filter(Boolean)\n    .map(escapeRegExp);\n\n  function replace(match: string) {\n    const usernameOrId = match.replace('@', '');\n    const user = mentioned_users.find(\n      ({ id, name }) => name === usernameOrId || id === usernameOrId,\n    );\n    return {\n      children: [{ type: 'text', value: match }],\n      mentioned_user: user,\n      type: 'mention',\n    };\n  }\n\n  const transform = <T extends unknown>(markdownAST: T) => {\n    if (!mentioned_usernames.length) {\n      return markdownAST;\n    }\n    const mentionedUsersRegex = new RegExp(\n      mentioned_usernames.map((username) => `@${username}`).join('|'),\n      'g',\n    );\n    findAndReplace(markdownAST, mentionedUsersRegex, replace);\n    return markdownAST;\n  };\n\n  return transform;\n};\n\nexport type MentionProps<Us extends DefaultUserType<Us> = DefaultUserType> = {\n  mentioned_user: UserResponse<Us>;\n};\n\nconst Mention = <Us extends DefaultUserType<Us> = DefaultUserType>(\n  props: PropsWithChildren<Us>,\n) => <span className='str-chat__message-mention'>{props.children}</span>;\n\nexport type RenderTextOptions = {\n  customMarkDownRenderers?: {\n    [nodeType: string]: React.ElementType;\n  };\n};\n\nexport const renderText = <Us extends DefaultUserType<Us> = DefaultUserType>(\n  text?: string,\n  mentioned_users?: UserResponse<Us>[],\n  options: RenderTextOptions = {},\n) => {\n  // take the @ mentions and turn them into markdown?\n  // translate links\n  if (!text) return null;\n\n  let newText = text;\n  const markdownLinks = matchMarkdownLinks(newText);\n  const codeBlocks = messageCodeBlocks(newText);\n\n  // extract all valid links/emails within text and replace it with proper markup\n  uniqBy(linkify.find(newText), 'value').forEach(({ href, type, value }) => {\n    const linkIsInBlock = codeBlocks.some((block) => block?.includes(value));\n\n    // check if message is already  markdown\n    const noParsingNeeded =\n      markdownLinks &&\n      markdownLinks.filter((text) => {\n        const strippedHref = href?.replace(detectHttp, '');\n        const strippedText = text?.replace(detectHttp, '');\n\n        if (!strippedHref || !strippedText) return false;\n\n        return strippedHref.includes(strippedText) || strippedText.includes(strippedHref);\n      });\n\n    if (noParsingNeeded.length > 0 || linkIsInBlock) return;\n\n    try {\n      const displayLink = type === 'email' ? value : formatUrlForDisplay(href);\n\n      newText = newText.replace(\n        new RegExp(escapeRegExp(value), 'g'),\n        `[${displayLink}](${encodeDecode(href)})`,\n      );\n    } catch (e) {\n      void e;\n    }\n  });\n\n  const plugins = [emojiMarkdownPlugin];\n\n  if (mentioned_users?.length) {\n    plugins.push(mentionsMarkdownPlugin(mentioned_users));\n  }\n\n  const renderers = {\n    mention: Mention,\n    ...markDownRenderers,\n    ...options.customMarkDownRenderers,\n  };\n\n  return (\n    <ReactMarkdown\n      allowedTypes={allowedMarkups}\n      escapeHtml={true}\n      plugins={plugins}\n      renderers={renderers}\n      source={newText}\n      transformLinkUri={(uri) =>\n        uri.startsWith('app://') ? uri : RootReactMarkdown.uriTransformer(uri)\n      }\n      unwrapDisallowed={true}\n    />\n  );\n};\n\nexport function escapeRegExp(text: string) {\n  return text.replace(/[-[\\]{}()*+?.,\\\\^$|#]/g, '\\\\$&');\n}\n\nfunction S4() {\n  return (((1 + Math.random()) * 0x10000) | 0).toString(16).substring(1);\n}\n\n// https://stackoverflow.com/a/6860916/2570866\nexport function generateRandomId() {\n  // prettier-ignore\n  return (S4()+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+\"-\"+S4()+S4()+S4());\n}\n\n// https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/charAt#getting_whole_characters\nexport const getWholeChar = (str: string, i: number) => {\n  const code = str.charCodeAt(i);\n\n  if (Number.isNaN(code)) return '';\n\n  if (code < 0xd800 || code > 0xdfff) return str.charAt(i);\n\n  if (0xd800 <= code && code <= 0xdbff) {\n    if (str.length <= i + 1) {\n      throw 'High surrogate without following low surrogate';\n    }\n\n    const next = str.charCodeAt(i + 1);\n\n    if (0xdc00 > next || next > 0xdfff) {\n      throw 'High surrogate without following low surrogate';\n    }\n\n    return str.charAt(i) + str.charAt(i + 1);\n  }\n\n  if (i === 0) {\n    throw 'Low surrogate without preceding high surrogate';\n  }\n\n  const prev = str.charCodeAt(i - 1);\n\n  if (0xd800 > prev || prev > 0xdbff) {\n    throw 'Low surrogate without preceding high surrogate';\n  }\n\n  return '';\n};\n","import React from 'react';\n\nimport { useTranslationContext } from '../../context/TranslationContext';\n\nexport type CurrentTrigger<T extends string = string> = '/' | '@' | ':' | T;\n\nexport type SuggestionListHeaderProps = {\n  currentTrigger: CurrentTrigger;\n  value: string;\n};\n\nexport const DefaultSuggestionListHeader: React.FC<SuggestionListHeaderProps> = (props) => {\n  const { currentTrigger, value } = props;\n\n  const { t } = useTranslationContext('DefaultSuggestionListHeader');\n\n  const triggerIndex = value.lastIndexOf(currentTrigger);\n\n  if (currentTrigger === '/') {\n    return (\n      <>\n        {t('Commands matching')} <strong>{value.slice(triggerIndex + 1)}</strong>\n      </>\n    );\n  }\n\n  if (currentTrigger === ':') {\n    return (\n      <>\n        {t('Emoji matching')} <strong>{value.slice(triggerIndex + 1)}</strong>\n      </>\n    );\n  }\n\n  if (currentTrigger === '@') {\n    return (\n      <>\n        {t('People matching')} <strong>{value.slice(triggerIndex + 1)}</strong>\n      </>\n    );\n  }\n\n  return null;\n};\n","/* eslint-disable */\nexport const KEY_CODES = {\n  ESC: 27,\n  UP: 38,\n  DOWN: 40,\n  ENTER: 13,\n  TAB: 9,\n  SPACE: 32,\n};\n\nconst keycodeMap = {};\n\n// This is self-made key shortcuts manager, used for caching key strokes\nclass Listener {\n  constructor() {\n    this.index = 0;\n    this.listeners = {};\n    this.refCount = 0;\n\n    this.f = (e) => {\n      const code = e.keyCode || e.which;\n\n      keycodeMap[code] = e.type === 'keydown';\n      if (e.type !== 'keydown') {\n        keycodeMap[code] = false;\n        return;\n      }\n\n      Object.values(this.listeners).forEach(({ keyCode, fn }) => {\n        if (keyCode.length > 1) {\n          if (keyCode.every((keycode) => keycodeMap[keycode])) {\n            fn(e);\n          }\n        } else if (keyCode.includes(code) && keycodeMap[code]) {\n          fn(e);\n        }\n      });\n    };\n  }\n\n  startListen = () => {\n    if (!this.refCount) {\n      // prevent multiple listeners in case of multiple TextareaAutocomplete components on page\n      document.addEventListener('keydown', this.f);\n      document.addEventListener('keyup', this.f);\n    }\n    this.refCount++;\n  };\n\n  stopListen = () => {\n    this.refCount--;\n    if (!this.refCount) {\n      // prevent disable listening in case of multiple TextareaAutocomplete components on page\n      document.removeEventListener('keydown', this.f);\n      document.removeEventListener('keyup', this.f);\n    }\n  };\n\n  add = (keyCodes, fn) => {\n    let keyCode = keyCodes;\n\n    if (typeof keyCode !== 'object') keyCode = [keyCode];\n\n    this.listeners[this.index] = {\n      keyCode,\n      fn,\n    };\n\n    this.index += 1;\n\n    return this.index;\n  };\n\n  remove = (ids) => {\n    for (const key of Object.entries(ids)) {\n      delete this.listeners[key];\n    }\n  };\n\n  removeAll = () => {\n    this.listeners = {};\n    this.index = 0;\n  };\n}\n\nexport default new Listener();\n","import React, { useCallback, useEffect, useState } from 'react';\n\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { escapeRegExp } from '../../utils';\n\nimport { Item } from './Item';\nimport { DefaultSuggestionListHeader } from './Header';\nimport { KEY_CODES } from './listener';\n\nexport const List = (props) => {\n  const {\n    className,\n    component,\n    currentTrigger,\n    dropdownScroll,\n    getSelectedItem,\n    getTextToReplace,\n    Header: PropHeader,\n    itemClassName,\n    itemStyle,\n    onSelect,\n    selectionEnd,\n    style,\n    SuggestionItem: PropSuggestionItem,\n    value: propValue,\n    values,\n  } = props;\n\n  const { AutocompleteSuggestionHeader, AutocompleteSuggestionItem } = useComponentContext();\n  const SuggestionItem = PropSuggestionItem || AutocompleteSuggestionItem || Item;\n  const SuggestionHeader =\n    PropHeader || AutocompleteSuggestionHeader || DefaultSuggestionListHeader;\n\n  const [selectedItem, setSelectedItem] = useState(undefined);\n\n  const itemsRef = [];\n\n  const isSelected = (item) =>\n    selectedItem === values.findIndex((value) => getId(value) === getId(item));\n\n  const getId = (item) => {\n    const textToReplace = getTextToReplace(item);\n    if (textToReplace.key) {\n      return textToReplace.key;\n    }\n\n    if (typeof item === 'string' || !item.key) {\n      return textToReplace.text;\n    }\n\n    return item.key;\n  };\n\n  const modifyText = (value) => {\n    if (!value) return;\n\n    onSelect(getTextToReplace(value));\n    if (getSelectedItem) getSelectedItem(value);\n  };\n\n  const handleClick = (e) => {\n    if (e) e.preventDefault?.();\n    modifyText(values[selectedItem]);\n  };\n\n  const selectItem = (item) => {\n    const index = values.findIndex((value) =>\n      value.id ? value.id === item.id : value.name === item.name,\n    );\n    setSelectedItem(index);\n  };\n\n  const handleKeyDown = useCallback(\n    (event) => {\n      if (event.which === KEY_CODES.UP) {\n        setSelectedItem((prevSelected) => {\n          if (prevSelected === undefined) return 0;\n          const newID = prevSelected === 0 ? values.length - 1 : prevSelected - 1;\n          dropdownScroll(itemsRef[newID]);\n          return newID;\n        });\n      }\n\n      if (event.which === KEY_CODES.DOWN) {\n        setSelectedItem((prevSelected) => {\n          if (prevSelected === undefined) return 0;\n          const newID = prevSelected === values.length - 1 ? 0 : prevSelected + 1;\n          dropdownScroll(itemsRef[newID]);\n          return newID;\n        });\n      }\n\n      if (\n        (event.which === KEY_CODES.ENTER || event.which === KEY_CODES.TAB) &&\n        selectedItem !== undefined\n      ) {\n        handleClick(event);\n      }\n\n      return null;\n    },\n    [selectedItem, values], // eslint-disable-line\n  );\n\n  useEffect(() => {\n    document.addEventListener('keydown', handleKeyDown, false);\n    return () => document.removeEventListener('keydown', handleKeyDown);\n  }, [handleKeyDown]);\n\n  useEffect(() => {\n    if (values?.length) selectItem(values[0]);\n  }, [values]); // eslint-disable-line\n\n  const restructureItem = (item) => {\n    const matched = item.name || item.id;\n\n    const textBeforeCursor = propValue.slice(0, selectionEnd);\n    const triggerIndex = textBeforeCursor.lastIndexOf(currentTrigger);\n    const editedPropValue = escapeRegExp(textBeforeCursor.slice(triggerIndex + 1));\n\n    const parts = matched.split(new RegExp(`(${editedPropValue})`, 'gi'));\n\n    const itemNameParts = { match: editedPropValue, parts };\n\n    return { ...item, itemNameParts };\n  };\n\n  return (\n    <ul className={`rta__list ${className || ''}`} style={style}>\n      <li className='rta__list-header'>\n        <SuggestionHeader currentTrigger={currentTrigger} value={propValue} />\n      </li>\n      {values.map((item, i) => (\n        <SuggestionItem\n          className={itemClassName}\n          component={component}\n          item={restructureItem(item)}\n          key={getId(item)}\n          onClickHandler={handleClick}\n          onSelectHandler={selectItem}\n          ref={(ref) => {\n            itemsRef[i] = ref;\n          }}\n          selected={isSelected(item)}\n          style={itemStyle}\n          value={propValue}\n        />\n      ))}\n    </ul>\n  );\n};\n","import { isValidElementType } from 'react-is';\n\nexport const DEFAULT_CARET_POSITION = 'next';\n\nexport function defaultScrollToItem(container, item) {\n  if (!item) return;\n\n  const itemHeight = parseInt(getComputedStyle(item).getPropertyValue('height'), 10);\n\n  const containerHight =\n    parseInt(getComputedStyle(container).getPropertyValue('height'), 10) - itemHeight;\n\n  const actualScrollTop = container.scrollTop;\n  const itemOffsetTop = item.offsetTop;\n\n  if (itemOffsetTop < actualScrollTop + containerHight && actualScrollTop < itemOffsetTop) {\n    return;\n  }\n\n  // eslint-disable-next-line\n  container.scrollTop = itemOffsetTop;\n}\n\nexport const errorMessage = (message) =>\n  console.error(\n    `RTA: dataProvider fails: ${message}\n    \\nCheck the documentation or create issue if you think it's bug. https://github.com/webscopeio/react-textarea-autocomplete/issues`,\n  );\n\nexport const triggerPropsCheck = ({ trigger }) => {\n  if (!trigger) return Error('Invalid prop trigger. Prop missing.');\n\n  const triggers = Object.entries(trigger);\n\n  for (let i = 0; i < triggers.length; i += 1) {\n    const [triggerChar, settings] = triggers[i];\n\n    if (typeof triggerChar !== 'string' || triggerChar.length !== 1) {\n      return Error('Invalid prop trigger. Keys of the object has to be string / one character.');\n    }\n\n    // $FlowFixMe\n    const triggerSetting = settings;\n\n    const { callback, component, dataProvider, output } = triggerSetting;\n\n    if (!isValidElementType(component)) {\n      return Error('Invalid prop trigger: component should be defined.');\n    }\n\n    if (!dataProvider || typeof dataProvider !== 'function') {\n      return Error('Invalid prop trigger: dataProvider should be defined.');\n    }\n\n    if (output && typeof output !== 'function') {\n      return Error('Invalid prop trigger: output should be a function.');\n    }\n\n    if (callback && typeof callback !== 'function') {\n      return Error('Invalid prop trigger: callback should be a function.');\n    }\n  }\n\n  return null;\n};\n","import React from 'react';\n\nexport type CommandItemProps = {\n  entity: {\n    /** Arguments of command */\n    args?: string;\n    /** Description of command */\n    description?: string;\n    /** Name of the command */\n    name?: string;\n  };\n};\n\nconst UnMemoizedCommandItem: React.FC<CommandItemProps> = (props) => {\n  const { entity } = props;\n\n  return (\n    <div className='str-chat__slash-command'>\n      <span className='str-chat__slash-command-header'>\n        <strong>{entity.name}</strong> {entity.args}\n      </span>\n      <br />\n      <span className='str-chat__slash-command-description'>{entity.description}</span>\n    </div>\n  );\n};\n\nexport const CommandItem = React.memo(UnMemoizedCommandItem) as typeof UnMemoizedCommandItem;\n","import React, { useEffect, useState } from 'react';\n\nimport { getWholeChar } from '../../utils';\n\nimport type { UserResponse } from 'stream-chat';\n\nimport type { DefaultUserType } from '../../types/types';\n\nexport type AvatarProps<Us extends DefaultUserType<Us> = DefaultUserType> = {\n  /** Image URL or default is an image of the first initial of the name if there is one  */\n  image?: string | null;\n  /** Name of the image, used for title tag fallback */\n  name?: string;\n  /** click event handler */\n  onClick?: (event: React.BaseSyntheticEvent) => void;\n  /** mouseOver event handler */\n  onMouseOver?: (event: React.BaseSyntheticEvent) => void;\n  /** Shape of the avatar - circle, rounded or square\n   * @default circle\n   */\n  shape?: 'circle' | 'rounded' | 'square';\n  /** Size in pixels\n   * @default 32px\n   */\n  size?: number;\n  /** The entire user object for the chat user displayed in the component */\n  user?: UserResponse<Us>;\n};\n\n/**\n * A round avatar image with fallback to username's first letter\n */\nexport const Avatar = <Us extends DefaultUserType<Us> = DefaultUserType>(\n  props: AvatarProps<Us>,\n) => {\n  const {\n    image,\n    name,\n    onClick = () => undefined,\n    onMouseOver = () => undefined,\n    shape = 'circle',\n    size = 32,\n  } = props;\n\n  const [error, setError] = useState(false);\n  const [loaded, setLoaded] = useState(false);\n\n  useEffect(() => {\n    setError(false);\n    setLoaded(false);\n  }, [image]);\n\n  const nameStr = name?.toString() || '';\n  const initials = getWholeChar(nameStr, 0);\n\n  return (\n    <div\n      className={`str-chat__avatar str-chat__avatar--${shape}`}\n      data-testid='avatar'\n      onClick={onClick}\n      onMouseOver={onMouseOver}\n      style={{\n        flexBasis: `${size}px`,\n        fontSize: `${size / 2}px`,\n        height: `${size}px`,\n        lineHeight: `${size}px`,\n        width: `${size}px`,\n      }}\n      title={name}\n    >\n      {image && !error ? (\n        <img\n          alt={initials}\n          className={`str-chat__avatar-image${loaded ? ' str-chat__avatar-image--loaded' : ''}`}\n          data-testid='avatar-img'\n          onError={() => setError(true)}\n          onLoad={() => setLoaded(true)}\n          src={image}\n          style={{\n            flexBasis: `${size}px`,\n            height: `${size}px`,\n            objectFit: 'cover',\n            width: `${size}px`,\n          }}\n        />\n      ) : (\n        <div className='str-chat__avatar-fallback' data-testid='avatar-fallback'>\n          {initials}\n        </div>\n      )}\n    </div>\n  );\n};\n","import React from 'react';\n\nimport { AvatarProps, Avatar as DefaultAvatar } from '../Avatar';\n\nexport type UserItemProps = {\n  /** The user */\n  entity: {\n    /** The parts of the Name property of the entity (or id if no name) that can be matched to the user input value.\n     * Default is bold for matches, but can be overwritten in css.\n     * */\n    itemNameParts: { match: string; parts: string[] };\n    /** Id of the user */\n    id?: string;\n    /** Image of the user */\n    image?: string;\n    /** Name of the user */\n    name?: string;\n  };\n  /** Custom UI component to display user avatar, defaults to and accepts same props as: [Avatar](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Avatar/Avatar.tsx) */\n  Avatar?: React.ComponentType<AvatarProps>;\n};\n\n/**\n * UI component for mentions rendered in suggestion list\n */\nconst UnMemoizedUserItem: React.FC<UserItemProps> = (props) => {\n  const { Avatar = DefaultAvatar, entity } = props;\n\n  const hasEntity = Object.keys(entity).length;\n  const itemParts = entity?.itemNameParts;\n\n  const renderName = () => {\n    if (!hasEntity) return null;\n\n    return (\n      hasEntity &&\n      itemParts.parts.map((part, i) =>\n        part.toLowerCase() === itemParts.match.toLowerCase() ? (\n          <span className='str-chat__emoji-item--highlight' key={`part-${i}`}>\n            {part}\n          </span>\n        ) : (\n          <span className='str-chat__emoji-item--part' key={`part-${i}`}>\n            {part}\n          </span>\n        ),\n      )\n    );\n  };\n\n  return (\n    <div className='str-chat__user-item'>\n      <Avatar image={entity.image} name={entity.name || entity.id} size={20} />\n      <span className='str-chat__user-item--name' data-testid={'user-item-name'}>\n        {renderName()}\n      </span>\n    </div>\n  );\n};\n\nexport const UserItem = React.memo(UnMemoizedUserItem) as typeof UnMemoizedUserItem;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport Textarea from 'react-textarea-autosize';\nimport getCaretCoordinates from 'textarea-caret';\nimport CustomEvent from 'custom-event';\nimport { isValidElementType } from 'react-is';\n\nimport Listeners, { KEY_CODES } from './listener';\nimport { List as DefaultSuggestionList } from './List';\nimport {\n  DEFAULT_CARET_POSITION,\n  defaultScrollToItem,\n  errorMessage,\n  triggerPropsCheck,\n} from './utils';\n\nimport { CommandItem } from '../CommandItem/CommandItem';\nimport { UserItem } from '../UserItem/UserItem';\n\nexport class ReactTextareaAutocomplete extends React.Component {\n  static defaultProps = {\n    closeOnClickOutside: true,\n    maxRows: 10,\n    minChar: 1,\n    movePopupAsYouType: false,\n    scrollToItem: true,\n    value: '',\n  };\n\n  constructor(props) {\n    super(props);\n\n    const { loadingComponent, trigger, value } = this.props;\n\n    // TODO: it would be better to have the parent control state...\n    // if (value) this.state.value = value;\n\n    if (!loadingComponent) {\n      throw new Error('RTA: loadingComponent is not defined');\n    }\n\n    if (!trigger) {\n      throw new Error('RTA: trigger is not defined');\n    }\n    this.state = {\n      actualToken: '',\n      component: null,\n      currentTrigger: null,\n      data: null,\n      dataLoading: false,\n      keycodeSubmitShiftE: false,\n      left: null,\n      listenerIndex: {},\n      selectionEnd: 0,\n      selectionStart: 0,\n      top: null,\n      value: value || '',\n    };\n  }\n\n  componentDidMount() {\n    Listeners.add(KEY_CODES.ESC, () => this._closeAutocomplete());\n    Listeners.add(KEY_CODES.SPACE, () => this._onSpace());\n\n    const listenerIndex = {};\n    const newSubmitKeys = this.props.keycodeSubmitKeys;\n\n    if (newSubmitKeys) {\n      const keycodeIndex = this.addKeycodeSubmitListeners(newSubmitKeys);\n      listenerIndex[keycodeIndex] = keycodeIndex;\n    } else {\n      const enterIndex = Listeners.add(KEY_CODES.ENTER, (e) => this._onEnter(e));\n      listenerIndex[enterIndex] = enterIndex;\n    }\n\n    this.setState({\n      listenerIndex,\n    });\n\n    Listeners.startListen();\n  }\n\n  componentWillUnmount() {\n    Listeners.stopListen();\n    Listeners.remove(this.state.listenerIndex);\n  }\n\n  getSelectionPosition = () => {\n    if (!this.textareaRef) return null;\n\n    return {\n      selectionEnd: this.textareaRef.selectionEnd,\n      selectionStart: this.textareaRef.selectionStart,\n    };\n  };\n\n  getSelectedText = () => {\n    if (!this.textareaRef) return null;\n    const { selectionEnd, selectionStart } = this.textareaRef;\n\n    if (selectionStart === selectionEnd) return null;\n\n    return this.state.value.substr(selectionStart, selectionEnd - selectionStart);\n  };\n\n  setCaretPosition = (position = 0) => {\n    if (!this.textareaRef) return;\n\n    this.textareaRef.focus();\n    this.textareaRef.setSelectionRange(position, position);\n  };\n\n  getCaretPosition = () => {\n    if (!this.textareaRef) return 0;\n\n    return this.textareaRef.selectionEnd;\n  };\n\n  addKeycodeSubmitListeners = (keyCodes) => {\n    keyCodes.forEach((arrayOfCodes) => {\n      let submitValue = arrayOfCodes;\n      if (submitValue.length === 1) {\n        submitValue = submitValue[0];\n      }\n\n      // does submitted keycodes include shift+Enter?\n      const shiftE = arrayOfCodes.every((code) => [16, 13].includes(code));\n      if (shiftE) this.keycodeSubmitShiftE = true;\n\n      return Listeners.add(submitValue, (e) => this._onEnter(e));\n    });\n  };\n\n  _onEnter = (event) => {\n    if (!this.textareaRef) return;\n\n    const trigger = this.state.currentTrigger;\n    const hasFocus = this.textareaRef.matches(':focus');\n\n    // Don't submit if the element doesn't have focus or the shift key is pressed, unless shift+Enter were provided as submit keys\n    if (\n      !hasFocus ||\n      (event.shiftKey === true && !this.keycodeSubmitShiftE) ||\n      (event.shiftKey === true && !this.props.keycodeSubmitKeys)\n    ) {\n      return;\n    }\n\n    if (!trigger || !this.state.data) {\n      // trigger a submit\n      this._replaceWord();\n      if (this.textareaRef) {\n        this.textareaRef.selectionEnd = 0;\n      }\n      this.props.handleSubmit(event);\n      this._closeAutocomplete();\n    }\n  };\n\n  _onSpace = () => {\n    if (!this.props.replaceWord || !this.textareaRef) return;\n\n    // don't change characters if the element doesn't have focus\n    const hasFocus = this.textareaRef.matches(':focus');\n    if (!hasFocus) return;\n\n    this._replaceWord();\n  };\n\n  _replaceWord = () => {\n    const { value } = this.state;\n\n    const lastWordRegex = /([^\\s]+)(\\s*)$/;\n    const match = lastWordRegex.exec(value.slice(0, this.getCaretPosition()));\n    const lastWord = match && match[1];\n\n    if (!lastWord) return;\n\n    const spaces = match[2];\n\n    const newWord = this.props.replaceWord(lastWord);\n    if (newWord == null) return;\n\n    const textBeforeWord = value.slice(0, this.getCaretPosition() - match[0].length);\n    const textAfterCaret = value.slice(this.getCaretPosition(), -1);\n    const newText = textBeforeWord + newWord + spaces + textAfterCaret;\n\n    this.setState(\n      {\n        value: newText,\n      },\n      () => {\n        // fire onChange event after successful selection\n        const e = new CustomEvent('change', { bubbles: true });\n        this.textareaRef.dispatchEvent(e);\n        if (this.props.onChange) this.props.onChange(e);\n      },\n    );\n  };\n\n  _onSelect = (newToken) => {\n    const {\n      closeCommandsList,\n      closeMentionsList,\n      onChange,\n      showCommandsList,\n      showMentionsList,\n    } = this.props;\n    const { currentTrigger: stateTrigger, selectionEnd, value: textareaValue } = this.state;\n\n    const currentTrigger = showCommandsList ? '/' : showMentionsList ? '@' : stateTrigger;\n\n    if (!currentTrigger) return;\n\n    const computeCaretPosition = (position, token, startToken) => {\n      switch (position) {\n        case 'start':\n          return startToken;\n        case 'next':\n        case 'end':\n          return startToken + token.length;\n        default:\n          if (!Number.isInteger(position)) {\n            throw new Error('RTA: caretPosition should be \"start\", \"next\", \"end\" or number.');\n          }\n\n          return position;\n      }\n    };\n\n    const textToModify = showCommandsList\n      ? '/'\n      : showMentionsList\n      ? '@'\n      : textareaValue.slice(0, selectionEnd);\n\n    const startOfTokenPosition = textToModify.lastIndexOf(currentTrigger);\n\n    // we add space after emoji is selected if a caret position is next\n    const newTokenString = newToken.caretPosition === 'next' ? `${newToken.text} ` : newToken.text;\n\n    const newCaretPosition = computeCaretPosition(\n      newToken.caretPosition,\n      newTokenString,\n      startOfTokenPosition,\n    );\n\n    const modifiedText = textToModify.substring(0, startOfTokenPosition) + newTokenString;\n    const valueToReplace = textareaValue.replace(textToModify, modifiedText);\n\n    // set the new textarea value and after that set the caret back to its position\n    this.setState(\n      {\n        dataLoading: false,\n        value: valueToReplace,\n      },\n      () => {\n        // fire onChange event after successful selection\n        const e = new CustomEvent('change', { bubbles: true });\n        this.textareaRef.dispatchEvent(e);\n        if (onChange) onChange(e);\n\n        this.setCaretPosition(newCaretPosition);\n      },\n    );\n\n    this._closeAutocomplete();\n    if (showCommandsList) closeCommandsList();\n    if (showMentionsList) closeMentionsList();\n  };\n\n  _getItemOnSelect = (paramTrigger) => {\n    const { currentTrigger: stateTrigger } = this.state;\n    const triggerSettings = this._getCurrentTriggerSettings(paramTrigger);\n\n    const currentTrigger = paramTrigger || stateTrigger;\n\n    if (!currentTrigger || !triggerSettings) return null;\n\n    const { callback } = triggerSettings;\n\n    if (!callback) return null;\n\n    return (item) => {\n      if (typeof callback !== 'function') {\n        throw new Error(\n          'Output functor is not defined! You have to define \"output\" function. https://github.com/webscopeio/react-textarea-autocomplete#trigger-type',\n        );\n      }\n      if (callback) {\n        return callback(item, currentTrigger);\n      }\n      return null;\n    };\n  };\n\n  _getTextToReplace = (paramTrigger) => {\n    const { actualToken, currentTrigger: stateTrigger } = this.state;\n    const triggerSettings = this._getCurrentTriggerSettings(paramTrigger);\n\n    const currentTrigger = paramTrigger || stateTrigger;\n\n    if (!currentTrigger || !triggerSettings) return null;\n\n    const { output } = triggerSettings;\n\n    return (item) => {\n      if (typeof item === 'object' && (!output || typeof output !== 'function')) {\n        throw new Error(\n          'Output functor is not defined! If you are using items as object you have to define \"output\" function. https://github.com/webscopeio/react-textarea-autocomplete#trigger-type',\n        );\n      }\n\n      if (output) {\n        const textToReplace = output(item, currentTrigger);\n\n        if (!textToReplace || typeof textToReplace === 'number') {\n          throw new Error(\n            `Output functor should return string or object in shape {text: string, caretPosition: string | number}.\\nGot \"${String(\n              textToReplace,\n            )}\". Check the implementation for trigger \"${currentTrigger}\" and its token \"${actualToken}\"\\n\\nSee https://github.com/webscopeio/react-textarea-autocomplete#trigger-type for more informations.\\n`,\n          );\n        }\n\n        if (typeof textToReplace === 'string') {\n          return {\n            caretPosition: DEFAULT_CARET_POSITION,\n            text: textToReplace,\n          };\n        }\n\n        if (!textToReplace.text && currentTrigger !== ':') {\n          throw new Error(\n            `Output \"text\" is not defined! Object should has shape {text: string, caretPosition: string | number}. Check the implementation for trigger \"${currentTrigger}\" and its token \"${actualToken}\"\\n`,\n          );\n        }\n\n        if (!textToReplace.caretPosition) {\n          throw new Error(\n            `Output \"caretPosition\" is not defined! Object should has shape {text: string, caretPosition: string | number}. Check the implementation for trigger \"${currentTrigger}\" and its token \"${actualToken}\"\\n`,\n          );\n        }\n\n        return textToReplace;\n      }\n\n      if (typeof item !== 'string') {\n        throw new Error('Output item should be string\\n');\n      }\n\n      return {\n        caretPosition: DEFAULT_CARET_POSITION,\n        text: `${currentTrigger}${item}${currentTrigger}`,\n      };\n    };\n  };\n\n  _getCurrentTriggerSettings = (paramTrigger) => {\n    const { currentTrigger: stateTrigger } = this.state;\n\n    const currentTrigger = paramTrigger || stateTrigger;\n\n    if (!currentTrigger) return null;\n\n    return this.props.trigger[currentTrigger];\n  };\n\n  _getValuesFromProvider = () => {\n    const { actualToken, currentTrigger } = this.state;\n    const triggerSettings = this._getCurrentTriggerSettings();\n\n    if (!currentTrigger || !triggerSettings) return;\n\n    const { component, dataProvider } = triggerSettings;\n\n    if (typeof dataProvider !== 'function') {\n      throw new Error('Trigger provider has to be a function!');\n    }\n\n    this.setState({ dataLoading: true });\n\n    // Modified: send the full text to support / style commands\n    dataProvider(actualToken, this.state.value, (data, token) => {\n      // Make sure that the result is still relevant for current query\n      if (token !== this.state.actualToken) return;\n\n      if (!Array.isArray(data)) {\n        throw new Error('Trigger provider has to provide an array!');\n      }\n\n      if (!isValidElementType(component)) {\n        throw new Error('Component should be defined!');\n      }\n\n      // throw away if we resolved old trigger\n      if (currentTrigger !== this.state.currentTrigger) return;\n\n      // if we haven't resolved any data let's close the autocomplete\n      if (!data.length) {\n        this._closeAutocomplete();\n        return;\n      }\n\n      this.setState({\n        component,\n        data,\n        dataLoading: false,\n      });\n    });\n  };\n\n  _getSuggestions = (paramTrigger) => {\n    const { currentTrigger: stateTrigger, data } = this.state;\n\n    const currentTrigger = paramTrigger || stateTrigger;\n\n    if (!currentTrigger || !data || (data && !data.length)) return null;\n\n    return data;\n  };\n\n  /**\n   * setup to emulate the UNSAFE_componentWillReceiveProps\n   */\n  static getDerivedStateFromProps(props, state) {\n    if (props.value !== state.propsValue || !state.value) {\n      return { propsValue: props.value, value: props.value };\n    } else {\n      return null;\n    }\n  }\n  /**\n   * Close autocomplete, also clean up trigger (to avoid slow promises)\n   */\n  _closeAutocomplete = () => {\n    this.setState({\n      currentTrigger: null,\n      data: null,\n      dataLoading: false,\n      left: null,\n      top: null,\n    });\n  };\n\n  _cleanUpProps = () => {\n    const props = { ...this.props };\n    const notSafe = [\n      'additionalTextareaProps',\n      'className',\n      'closeCommandsList',\n      'closeMentionsList',\n      'closeOnClickOutside',\n      'containerClassName',\n      'containerStyle',\n      'disableMentions',\n      'dropdownClassName',\n      'dropdownStyle',\n      'grow',\n      'handleSubmit',\n      'innerRef',\n      'itemClassName',\n      'itemStyle',\n      'keycodeSubmitKeys',\n      'listClassName',\n      'listStyle',\n      'loaderClassName',\n      'loaderStyle',\n      'loadingComponent',\n      'minChar',\n      'movePopupAsYouType',\n      'onCaretPositionChange',\n      'onChange',\n      'ref',\n      'replaceWord',\n      'scrollToItem',\n      'showCommandsList',\n      'showMentionsList',\n      'SuggestionItem',\n      'SuggestionList',\n      'trigger',\n      'value',\n    ];\n\n    // eslint-disable-next-line\n    for (const prop in props) {\n      if (notSafe.includes(prop)) delete props[prop];\n    }\n\n    return props;\n  };\n\n  _isCommand = (text) => {\n    if (text[0] !== '/') return false;\n\n    const tokens = text.split(' ');\n\n    if (tokens.length > 1) return false;\n\n    return true;\n  };\n\n  _changeHandler = (e) => {\n    const { minChar, movePopupAsYouType, onCaretPositionChange, onChange, trigger } = this.props;\n    const { left, top } = this.state;\n\n    const textarea = e.target;\n    const { selectionEnd, selectionStart, value } = textarea;\n\n    if (onChange) {\n      e.persist();\n      onChange(e);\n    }\n\n    if (onCaretPositionChange) onCaretPositionChange(this.getCaretPosition());\n\n    this.setState({ value });\n\n    let currentTrigger;\n    let lastToken;\n\n    if (this._isCommand(value)) {\n      currentTrigger = '/';\n      lastToken = value;\n    } else {\n      const triggerTokens = Object.keys(trigger).join().replace('/', '');\n      const triggerNorWhitespace = `[^\\\\s${triggerTokens}]*`;\n      const regex = new RegExp(\n        `(?!^|\\\\W)?[${triggerTokens}]${triggerNorWhitespace}\\\\s?${triggerNorWhitespace}$`,\n        'g',\n      );\n      const tokenMatch = value.slice(0, selectionEnd).match(regex);\n\n      lastToken = tokenMatch && tokenMatch[tokenMatch.length - 1].trim();\n\n      currentTrigger = (lastToken && Object.keys(trigger).find((a) => a === lastToken[0])) || null;\n    }\n\n    /*\n     if we lost the trigger token or there is no following character we want to close\n     the autocomplete\n    */\n    if (!lastToken || lastToken.length <= minChar) {\n      this._closeAutocomplete();\n      return;\n    }\n\n    const actualToken = lastToken.slice(1);\n\n    // if trigger is not configured step out from the function, otherwise proceed\n    if (!currentTrigger) return;\n\n    if (\n      movePopupAsYouType ||\n      (top === null && left === null) ||\n      // if we have single char - trigger it means we want to re-position the autocomplete\n      lastToken.length === 1\n    ) {\n      const { left: newLeft, top: newTop } = getCaretCoordinates(textarea, selectionEnd);\n\n      this.setState({\n        // make position relative to textarea\n        left: newLeft,\n        top: newTop - this.textareaRef.scrollTop || 0,\n      });\n    }\n    this.setState(\n      {\n        actualToken,\n        currentTrigger,\n        selectionEnd,\n        selectionStart,\n      },\n      () => {\n        try {\n          this._getValuesFromProvider();\n        } catch (err) {\n          errorMessage(err.message);\n        }\n      },\n    );\n  };\n\n  _selectHandler = (e) => {\n    const { onCaretPositionChange, onSelect } = this.props;\n\n    if (onCaretPositionChange) onCaretPositionChange(this.getCaretPosition());\n\n    if (onSelect) {\n      e.persist();\n      onSelect(e);\n    }\n  };\n\n  // The textarea itself is outside the auto-select dropdown.\n  _onClickAndBlurHandler = (e) => {\n    const { closeOnClickOutside, onBlur } = this.props;\n\n    // If this is a click: e.target is the textarea, and e.relatedTarget is the thing\n    // that was actually clicked. If we clicked inside the auto-select dropdown, then\n    // that's not a blur, from the auto-select point of view, so then do nothing.\n    const el = e.relatedTarget;\n    if (this.dropdownRef && el instanceof Node && this.dropdownRef.contains(el)) {\n      return;\n    }\n\n    if (closeOnClickOutside) this._closeAutocomplete();\n\n    if (onBlur) {\n      e.persist();\n      onBlur(e);\n    }\n  };\n\n  _onScrollHandler = () => this._closeAutocomplete();\n\n  _dropdownScroll = (item) => {\n    const { scrollToItem } = this.props;\n\n    if (!scrollToItem) return;\n\n    if (scrollToItem === true) {\n      defaultScrollToItem(this.dropdownRef, item);\n      return;\n    }\n\n    if (typeof scrollToItem !== 'function' || scrollToItem.length !== 2) {\n      throw new Error(\n        '`scrollToItem` has to be boolean (true for default implementation) or function with two parameters: container, item.',\n      );\n    }\n\n    scrollToItem(this.dropdownRef, item);\n  };\n\n  getTriggerProps = () => {\n    const { showCommandsList, showMentionsList, trigger } = this.props;\n    const { component, currentTrigger, selectionEnd, value } = this.state;\n\n    const selectedItem = this._getItemOnSelect();\n    const suggestionData = this._getSuggestions();\n    const textToReplace = this._getTextToReplace();\n\n    const triggerProps = {\n      component,\n      currentTrigger,\n      getSelectedItem: selectedItem,\n      getTextToReplace: textToReplace,\n      selectionEnd,\n      value,\n      values: suggestionData,\n    };\n\n    if ((showCommandsList && trigger['/']) || (showMentionsList && trigger['@'])) {\n      let currentCommands;\n      const getCommands = trigger[showCommandsList ? '/' : '@'].dataProvider;\n\n      getCommands?.('', showCommandsList ? '/' : '@', (data) => {\n        currentCommands = data;\n      });\n\n      triggerProps.component = showCommandsList ? CommandItem : UserItem;\n      triggerProps.currentTrigger = showCommandsList ? '/' : '@';\n      triggerProps.getTextToReplace = this._getTextToReplace(showCommandsList ? '/' : '@');\n      triggerProps.getSelectedItem = this._getItemOnSelect(showCommandsList ? '/' : '@');\n      triggerProps.selectionEnd = 1;\n      triggerProps.value = showCommandsList ? '/' : '@';\n      triggerProps.values = currentCommands;\n    }\n\n    return triggerProps;\n  };\n\n  renderSuggestionListContainer() {\n    const {\n      disableMentions,\n      dropdownClassName,\n      dropdownStyle,\n      itemClassName,\n      itemStyle,\n      listClassName,\n      SuggestionItem,\n      SuggestionList = DefaultSuggestionList,\n    } = this.props;\n\n    const triggerProps = this.getTriggerProps();\n\n    if (\n      triggerProps.values &&\n      triggerProps.currentTrigger &&\n      !(disableMentions && triggerProps.currentTrigger === '@')\n    ) {\n      return (\n        <div\n          className={`rta__autocomplete ${dropdownClassName || ''}`}\n          ref={(ref) => {\n            this.dropdownRef = ref;\n          }}\n          style={dropdownStyle}\n        >\n          <SuggestionList\n            className={listClassName}\n            dropdownScroll={this._dropdownScroll}\n            itemClassName={itemClassName}\n            itemStyle={itemStyle}\n            onSelect={this._onSelect}\n            SuggestionItem={SuggestionItem}\n            {...triggerProps}\n          />\n        </div>\n      );\n    }\n\n    return null;\n  }\n\n  render() {\n    const { className, containerClassName, containerStyle, style } = this.props;\n\n    let { maxRows } = this.props;\n\n    const { dataLoading, value } = this.state;\n\n    if (!this.props.grow) maxRows = 1;\n\n    return (\n      <div\n        className={`rta ${dataLoading === true ? 'rta--loading' : ''} ${containerClassName || ''}`}\n        style={containerStyle}\n      >\n        {this.renderSuggestionListContainer()}\n        <Textarea\n          {...this._cleanUpProps()}\n          className={`rta__textarea ${className || ''}`}\n          maxRows={maxRows}\n          onBlur={this._onClickAndBlurHandler}\n          onChange={this._changeHandler}\n          onClick={this._onClickAndBlurHandler}\n          onFocus={this.props.onFocus}\n          onScroll={this._onScrollHandler}\n          onSelect={this._selectHandler}\n          ref={(ref) => {\n            if (this.props.innerRef) this.props.innerRef(ref);\n            this.textareaRef = ref;\n          }}\n          style={style}\n          value={value}\n          {...this.props.additionalTextareaProps}\n        />\n      </div>\n    );\n  }\n}\n\nReactTextareaAutocomplete.propTypes = {\n  className: PropTypes.string,\n  closeOnClickOutside: PropTypes.bool,\n  containerClassName: PropTypes.string,\n  containerStyle: PropTypes.object,\n  disableMentions: PropTypes.bool,\n  dropdownClassName: PropTypes.string,\n  dropdownStyle: PropTypes.object,\n  itemClassName: PropTypes.string,\n  itemStyle: PropTypes.object,\n  keycodeSubmitKeys: PropTypes.array,\n  listClassName: PropTypes.string,\n  listStyle: PropTypes.object,\n  loaderClassName: PropTypes.string,\n  loaderStyle: PropTypes.object,\n  loadingComponent: PropTypes.elementType,\n  minChar: PropTypes.number,\n  onBlur: PropTypes.func,\n  onCaretPositionChange: PropTypes.func,\n  onChange: PropTypes.func,\n  onSelect: PropTypes.func,\n  style: PropTypes.object,\n  SuggestionList: PropTypes.elementType,\n  trigger: triggerPropsCheck,\n  value: PropTypes.string,\n};\n","import type { Reducer } from 'react';\nimport type { Channel, MessageResponse, ChannelState as StreamChannelState } from 'stream-chat';\n\nimport type { ChannelState, StreamMessage } from '../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type ChannelStateReducerAction<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> =\n  | {\n      type: 'closeThread';\n    }\n  | {\n      channel: Channel<At, Ch, Co, Ev, Me, Re, Us>;\n      type: 'copyMessagesFromChannel';\n      parentId?: string | null;\n    }\n  | {\n      channel: Channel<At, Ch, Co, Ev, Me, Re, Us>;\n      type: 'copyStateFromChannelOnEvent';\n    }\n  | {\n      channel: Channel<At, Ch, Co, Ev, Me, Re, Us>;\n      type: 'initStateFromChannel';\n    }\n  | {\n      hasMore: boolean;\n      messages: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>[];\n      type: 'loadMoreFinished';\n    }\n  | {\n      threadHasMore: boolean;\n      threadMessages: Array<\n        ReturnType<StreamChannelState<At, Ch, Co, Ev, Me, Re, Us>['formatMessage']>\n      >;\n      type: 'loadMoreThreadFinished';\n    }\n  | {\n      channel: Channel<At, Ch, Co, Ev, Me, Re, Us>;\n      message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>;\n      type: 'openThread';\n    }\n  | {\n      error: Error;\n      type: 'setError';\n    }\n  | {\n      loadingMore: boolean;\n      type: 'setLoadingMore';\n    }\n  | {\n      message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>;\n      type: 'setThread';\n    }\n  | {\n      channel: Channel<At, Ch, Co, Ev, Me, Re, Us>;\n      type: 'setTyping';\n    }\n  | {\n      type: 'startLoadingThread';\n    }\n  | {\n      channel: Channel<At, Ch, Co, Ev, Me, Re, Us>;\n      message: MessageResponse<At, Ch, Co, Me, Re, Us>;\n      type: 'updateThreadOnEvent';\n    };\n\nexport type ChannelStateReducer<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = Reducer<\n  ChannelState<At, Ch, Co, Ev, Me, Re, Us>,\n  ChannelStateReducerAction<At, Ch, Co, Ev, Me, Re, Us>\n>;\n\nexport const channelReducer = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  state: ChannelState<At, Ch, Co, Ev, Me, Re, Us>,\n  action: ChannelStateReducerAction<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  switch (action.type) {\n    case 'closeThread': {\n      return {\n        ...state,\n        thread: null,\n        threadLoadingMore: false,\n        threadMessages: [],\n      };\n    }\n\n    case 'copyMessagesFromChannel': {\n      const { channel, parentId } = action;\n      return {\n        ...state,\n        messages: [...channel.state.messages],\n        pinnedMessages: [...channel.state.pinnedMessages],\n        threadMessages: parentId\n          ? { ...channel.state.threads }[parentId] || []\n          : state.threadMessages,\n      };\n    }\n\n    case 'copyStateFromChannelOnEvent': {\n      const { channel } = action;\n      return {\n        ...state,\n        members: { ...channel.state.members },\n        messages: [...channel.state.messages],\n        pinnedMessages: [...channel.state.pinnedMessages],\n        read: { ...channel.state.read },\n        watcherCount: channel.state.watcher_count,\n        watchers: { ...channel.state.watchers },\n      };\n    }\n\n    case 'initStateFromChannel': {\n      const { channel } = action;\n      return {\n        ...state,\n        loading: false,\n        members: { ...channel.state.members },\n        messages: [...channel.state.messages],\n        pinnedMessages: [...channel.state.pinnedMessages],\n        read: { ...channel.state.read },\n        watcherCount: channel.state.watcher_count,\n        watchers: { ...channel.state.watchers },\n      };\n    }\n\n    case 'loadMoreFinished': {\n      const { hasMore, messages } = action;\n      return {\n        ...state,\n        hasMore,\n        loadingMore: false,\n        messages,\n      };\n    }\n\n    case 'loadMoreThreadFinished': {\n      const { threadHasMore, threadMessages } = action;\n      return {\n        ...state,\n        threadHasMore,\n        threadLoadingMore: false,\n        threadMessages,\n      };\n    }\n\n    case 'openThread': {\n      const { channel, message } = action;\n      return {\n        ...state,\n        thread: message,\n        threadMessages: message.id ? { ...channel.state.threads }[message.id] || [] : [],\n      };\n    }\n\n    case 'setError': {\n      const { error } = action;\n      return { ...state, error };\n    }\n\n    case 'setLoadingMore': {\n      const { loadingMore } = action;\n      return { ...state, loadingMore };\n    }\n\n    case 'setThread': {\n      const { message } = action;\n      return { ...state, thread: message };\n    }\n\n    case 'setTyping': {\n      const { channel } = action;\n      return {\n        ...state,\n        typing: { ...channel.state.typing },\n      };\n    }\n\n    case 'startLoadingThread': {\n      return {\n        ...state,\n        threadLoadingMore: true,\n      };\n    }\n\n    case 'updateThreadOnEvent': {\n      const { channel, message } = action;\n      if (!state.thread) return state;\n      return {\n        ...state,\n        thread:\n          message?.id === state.thread.id ? channel.state.formatMessage(message) : state.thread,\n        threadMessages: state.thread?.id ? { ...channel.state.threads }[state.thread.id] || [] : [],\n      };\n    }\n\n    default:\n      return state;\n  }\n};\n\nexport const initialState = {\n  error: null,\n  hasMore: true,\n  loading: true,\n  loadingMore: false,\n  members: {},\n  messages: [],\n  pinnedMessages: [],\n  read: {},\n  thread: null,\n  threadHasMore: true,\n  threadLoadingMore: false,\n  threadMessages: [],\n  typing: {},\n  watcherCount: 0,\n  watchers: {},\n};\n","import type { BaseEmoji, Data as EmojiData } from 'emoji-mart';\n\nimport type { CommonEmoji, EmojiSetDef, MinimalEmoji } from '../../context/EmojiContext';\n\nexport type ReactionEmoji = BaseEmoji | MinimalEmoji;\n\nexport const commonEmoji: CommonEmoji = {\n  custom: true,\n  emoticons: [],\n  short_names: [],\n};\n\nexport const emojiSetDef: EmojiSetDef = {\n  imageUrl: '',\n  sheetColumns: 2,\n  sheetRows: 3,\n  sheetSize: 64,\n  spriteUrl: 'https://getstream.imgix.net/images/emoji-sprite.png',\n};\n\nexport const defaultMinimalEmojis: MinimalEmoji[] = [\n  {\n    colons: ':+1:',\n    id: 'like',\n    name: 'like',\n    sheet_x: 0,\n    sheet_y: 0,\n    ...commonEmoji,\n    ...emojiSetDef,\n  },\n  {\n    colons: ':heart:',\n    id: 'love',\n    name: 'love',\n    sheet_x: 1,\n    sheet_y: 2,\n    ...commonEmoji,\n    ...emojiSetDef,\n  },\n  {\n    colons: ':joy:',\n    id: 'haha',\n    name: 'haha',\n    sheet_x: 1,\n    sheet_y: 0,\n    ...commonEmoji,\n    ...emojiSetDef,\n  },\n  {\n    colons: ':astonished:',\n    id: 'wow',\n    name: 'wow',\n    sheet_x: 0,\n    sheet_y: 2,\n    ...commonEmoji,\n    ...emojiSetDef,\n  },\n  {\n    colons: ':pensive:',\n    id: 'sad',\n    name: 'sad',\n    sheet_x: 0,\n    sheet_y: 1,\n    ...commonEmoji,\n    ...emojiSetDef,\n  },\n  {\n    colons: ':angry:',\n    id: 'angry',\n    name: 'angry',\n    sheet_x: 1,\n    sheet_y: 1,\n    ...commonEmoji,\n    ...emojiSetDef,\n  },\n];\n\n// use this only for small lists like in ReactionSelector\nexport const getStrippedEmojiData = (data: EmojiData) => ({\n  ...data,\n  emojis: {},\n});\n","import { useMemo } from 'react';\n\nimport { isDate, isDayOrMoment } from '../../../context/TranslationContext';\n\nimport type { ChannelStateContextValue } from '../../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useCreateChannelStateContext = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  value: Omit<ChannelStateContextValue<At, Ch, Co, Ev, Me, Re, Us>, 'channelCapabilities'> & {\n    channelCapabilitiesArray: string[];\n    skipMessageDataMemoization?: boolean;\n  },\n) => {\n  const {\n    acceptedFiles,\n    channel,\n    channelCapabilitiesArray = [],\n    channelConfig,\n    dragAndDropWindow,\n    error,\n    hasMore,\n    loading,\n    loadingMore,\n    maxNumberOfFiles,\n    members,\n    messages = [],\n    multipleUploads,\n    mutes,\n    notifications,\n    pinnedMessages,\n    quotedMessage,\n    read = {},\n    skipMessageDataMemoization,\n    thread,\n    threadHasMore,\n    threadLoadingMore,\n    threadMessages = [],\n    watcherCount,\n    watcher_count,\n    watchers,\n  } = value;\n\n  const channelId = channel.cid;\n  const lastRead = channel.initialized && channel.lastRead()?.getTime();\n  const membersLength = Object.keys(members || []).length;\n  const notificationsLength = notifications.length;\n  const readUsers = Object.values(read);\n  const readUsersLength = readUsers.length;\n  const readUsersLastReads = readUsers.map(({ last_read }) => last_read.toISOString()).join();\n  const threadMessagesLength = threadMessages?.length;\n\n  const channelCapabilities: Record<string, boolean> = {};\n\n  channelCapabilitiesArray.forEach((capability) => {\n    channelCapabilities[capability] = true;\n  });\n\n  const memoizedMessageData = skipMessageDataMemoization\n    ? messages\n    : messages\n        .map(\n          ({ deleted_at, latest_reactions, pinned, reply_count, status, updated_at, user }) =>\n            `${deleted_at}${\n              latest_reactions ? latest_reactions.map(({ type }) => type).join() : ''\n            }${pinned}${reply_count}${status}${\n              updated_at && (isDayOrMoment(updated_at) || isDate(updated_at))\n                ? updated_at.toISOString()\n                : updated_at || ''\n            }${user?.image}${user?.name}`,\n        )\n        .join();\n\n  const memoizedThreadMessageData = threadMessages\n    .map(\n      ({ deleted_at, latest_reactions, pinned, status, updated_at, user }) =>\n        `${deleted_at}${\n          latest_reactions ? latest_reactions.map(({ type }) => type).join() : ''\n        }${pinned}${status}${\n          updated_at && (isDayOrMoment(updated_at) || isDate(updated_at))\n            ? updated_at.toISOString()\n            : updated_at || ''\n        }${user?.image}${user?.name}`,\n    )\n    .join();\n\n  const channelStateContext: ChannelStateContextValue<At, Ch, Co, Ev, Me, Re, Us> = useMemo(\n    () => ({\n      acceptedFiles,\n      channel,\n      channelCapabilities,\n      channelConfig,\n      dragAndDropWindow,\n      error,\n      hasMore,\n      loading,\n      loadingMore,\n      maxNumberOfFiles,\n      members,\n      messages,\n      multipleUploads,\n      mutes,\n      notifications,\n      pinnedMessages,\n      quotedMessage,\n      read,\n      thread,\n      threadHasMore,\n      threadLoadingMore,\n      threadMessages,\n      watcher_count,\n      watcherCount,\n      watchers,\n    }),\n    [\n      channelId,\n      error,\n      hasMore,\n      lastRead,\n      loading,\n      loadingMore,\n      membersLength,\n      memoizedMessageData,\n      memoizedThreadMessageData,\n      notificationsLength,\n      quotedMessage,\n      readUsersLength,\n      readUsersLastReads,\n      skipMessageDataMemoization,\n      thread,\n      threadHasMore,\n      threadLoadingMore,\n      threadMessagesLength,\n      watcherCount,\n    ],\n  );\n\n  return channelStateContext;\n};\n","import { useMemo } from 'react';\n\nimport type { TypingContextValue } from '../../../context/TypingContext';\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useCreateTypingContext = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  value: TypingContextValue<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const { typing } = value;\n\n  const typingValue = Object.keys(typing || {}).join();\n\n  const typingContext: TypingContextValue<At, Ch, Co, Ev, Me, Re, Us> = useMemo(\n    () => ({\n      typing,\n    }),\n    [typingValue],\n  );\n\n  return typingContext;\n};\n","import React, { PropsWithChildren, useContext } from 'react';\n\nimport type { AppSettingsAPIResponse, Channel, Mute, StreamChat } from 'stream-chat';\n\nimport { getDisplayName } from './utils/getDisplayName';\nimport type { Theme } from '../components/Chat/Chat';\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n  UnknownType,\n} from '../types/types';\n\ntype CSSClasses =\n  | 'chat'\n  | 'chatContainer'\n  | 'channel'\n  | 'channelList'\n  | 'message'\n  | 'messageList'\n  | 'thread'\n  | 'threadList'\n  | 'virtualMessage'\n  | 'virtualizedMessageList';\n\nexport type CustomClasses = Partial<Record<CSSClasses, string>>;\n\nexport type ChatContextValue<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  client: StreamChat<At, Ch, Co, Ev, Me, Re, Us>;\n  closeMobileNav: () => void;\n  getAppSettings: () => Promise<AppSettingsAPIResponse<Co>> | null;\n  mutes: Mute<Us>[];\n  openMobileNav: () => void;\n  setActiveChannel: (\n    newChannel?: Channel<At, Ch, Co, Ev, Me, Re, Us>,\n    watchers?: { limit?: number; offset?: number },\n    event?: React.BaseSyntheticEvent,\n  ) => void;\n  /** @deprecated */\n  theme: Theme;\n  useImageFlagEmojisOnWindows: boolean;\n  channel?: Channel<At, Ch, Co, Ev, Me, Re, Us>;\n  customClasses?: CustomClasses;\n  navOpen?: boolean;\n};\n\nexport const ChatContext = React.createContext<ChatContextValue | undefined>(undefined);\n\nexport const ChatProvider = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>({\n  children,\n  value,\n}: PropsWithChildren<{\n  value: ChatContextValue<At, Ch, Co, Ev, Me, Re, Us>;\n}>) => (\n  <ChatContext.Provider value={(value as unknown) as ChatContextValue}>\n    {children}\n  </ChatContext.Provider>\n);\n\nexport const useChatContext = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  componentName?: string,\n) => {\n  const contextValue = useContext(ChatContext);\n\n  if (!contextValue) {\n    console.warn(\n      `The useChatContext hook was called outside of the ChatContext provider. Make sure this hook is called within a child of the Chat component. The errored call is located in the ${componentName} component.`,\n    );\n\n    return {} as ChatContextValue<At, Ch, Co, Ev, Me, Re, Us>;\n  }\n\n  return (contextValue as unknown) as ChatContextValue<At, Ch, Co, Ev, Me, Re, Us>;\n};\n\n/**\n * Typescript currently does not support partial inference so if ChatContext\n * typing is desired while using the HOC withChatContext the Props for the\n * wrapped component must be provided as the first generic.\n */\nexport const withChatContext = <\n  P extends UnknownType,\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  Component: React.ComponentType<P>,\n): React.FC<Omit<P, keyof ChatContextValue<At, Ch, Co, Ev, Me, Re, Us>>> => {\n  const WithChatContextComponent = (\n    props: Omit<P, keyof ChatContextValue<At, Ch, Co, Ev, Me, Re, Us>>,\n  ) => {\n    const chatContext = useChatContext<At, Ch, Co, Ev, Me, Re, Us>();\n\n    return <Component {...(props as P)} {...chatContext} />;\n  };\n  WithChatContextComponent.displayName = `WithChatContext${getDisplayName(Component)}`;\n  return WithChatContextComponent;\n};\n","import { useChatContext } from '../../../context/ChatContext';\n\nimport type { StreamChat, UpdatedMessage } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\ntype UpdateHandler<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = (\n  cid: string,\n  updatedMessage: UpdatedMessage<At, Ch, Co, Me, Re, Us>,\n) => ReturnType<StreamChat<At, Ch, Co, Ev, Me, Re, Us>['updateMessage']>;\n\nexport const useEditMessageHandler = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  doUpdateMessageRequest?: UpdateHandler<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const { channel, client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('useEditMessageHandler');\n\n  return (updatedMessage: UpdatedMessage<At, Ch, Co, Me, Re, Us>) => {\n    if (doUpdateMessageRequest && channel) {\n      return Promise.resolve(doUpdateMessageRequest(channel.cid, updatedMessage));\n    }\n    return client.updateMessage(updatedMessage);\n  };\n};\n","import { useEffect, useRef } from 'react';\n\nexport const useIsMounted = () => {\n  const isMounted = useRef(true);\n\n  useEffect(\n    () => () => {\n      isMounted.current = false;\n    },\n    [],\n  );\n\n  return isMounted;\n};\n","import React, { useCallback } from 'react';\n\nimport type { UserResponse } from 'stream-chat';\n\nimport type { DefaultUserType } from '../../../types/types';\n\nexport type OnMentionAction<Us extends DefaultUserType<Us> = DefaultUserType> = (\n  event: React.BaseSyntheticEvent,\n  user?: UserResponse<Us>,\n) => void;\n\nexport const useMentionsHandlers = <Us extends DefaultUserType<Us> = DefaultUserType>(\n  onMentionsHover?: OnMentionAction<Us>,\n  onMentionsClick?: OnMentionAction<Us>,\n) =>\n  useCallback(\n    (event: React.BaseSyntheticEvent, mentioned_users: UserResponse<Us>[]) => {\n      if ((!onMentionsHover && !onMentionsClick) || !(event.target instanceof HTMLElement)) {\n        return;\n      }\n\n      const target = event.target;\n      const textContent = target.innerHTML.replace('*', '');\n\n      if (textContent[0] === '@') {\n        const userName = textContent.replace('@', '');\n        const user = mentioned_users?.find(({ id, name }) => name === userName || id === userName);\n\n        if (\n          onMentionsHover &&\n          typeof onMentionsHover === 'function' &&\n          event.type === 'mouseover'\n        ) {\n          onMentionsHover(event, user);\n        }\n\n        if (onMentionsClick && event.type === 'click' && typeof onMentionsClick === 'function') {\n          onMentionsClick(event, user);\n        }\n      }\n    },\n    [onMentionsClick, onMentionsHover],\n  );\n","import React from 'react';\n\nconst LoadingItems: React.FC = () => (\n  <div className='str-chat__loading-channels-item'>\n    <div className='str-chat__loading-channels-avatar' />\n    <div className='str-chat__loading-channels-meta'>\n      <div className='str-chat__loading-channels-username' />\n      <div className='str-chat__loading-channels-status' />\n    </div>\n  </div>\n);\n\nconst UnMemoizedLoadingChannels: React.FC = () => (\n  <div className='str-chat__loading-channels'>\n    <LoadingItems />\n    <LoadingItems />\n    <LoadingItems />\n  </div>\n);\n\n/**\n * Loading indicator for the ChannelList\n */\nexport const LoadingChannels = React.memo(\n  UnMemoizedLoadingChannels,\n) as typeof UnMemoizedLoadingChannels;\n","import React from 'react';\n\nimport { useTranslationContext } from '../../context/TranslationContext';\n\nexport type LoadingErrorIndicatorProps = {\n  /** Error object */\n  error?: Error;\n};\n\n/**\n * UI component for error indicator in a Channel\n */\nconst UnMemoizedLoadingErrorIndicator: React.FC<LoadingErrorIndicatorProps> = ({ error }) => {\n  const { t } = useTranslationContext('LoadingErrorIndicator');\n\n  if (!error) return null;\n\n  return <div>{t('Error: {{ errorMessage }}', { errorMessage: error.message })}</div>;\n};\n\nexport const LoadingErrorIndicator = React.memo(\n  UnMemoizedLoadingErrorIndicator,\n  (prevProps, nextProps) => prevProps.error?.message === nextProps.error?.message,\n) as typeof UnMemoizedLoadingErrorIndicator;\n","import React from 'react';\n\nexport type LoadingIndicatorProps = {\n  /** Set the color of the LoadingIndicator */\n  color?: string;\n  /** The size of the loading icon, @default 15px */\n  size?: number;\n};\n\nconst UnMemoizedLoadingIndicator: React.FC<LoadingIndicatorProps> = (props) => {\n  const { color = '#006CFF', size = 15 } = props;\n\n  return (\n    <div\n      className={`str-chat__loading-indicator ${color}`}\n      data-testid='loading-indicator-wrapper'\n      style={{ height: size, width: size }}\n    >\n      <svg height={size} viewBox={`0 0 30 30`} width={size} xmlns='http://www.w3.org/2000/svg'>\n        <defs>\n          <linearGradient id='a' x1='50%' x2='50%' y1='0%' y2='100%'>\n            <stop offset='0%' stopColor='#FFF' stopOpacity='0' />\n            <stop\n              data-testid='loading-indicator-circle'\n              offset='100%'\n              stopColor={color}\n              stopOpacity='1'\n              style={{ stopColor: color }}\n            />\n          </linearGradient>\n        </defs>\n        <path\n          d='M2.518 23.321l1.664-1.11A12.988 12.988 0 0 0 15 28c7.18 0 13-5.82 13-13S22.18 2 15 2V0c8.284 0 15 6.716 15 15 0 8.284-6.716 15-15 15-5.206 0-9.792-2.652-12.482-6.679z'\n          fill='url(#a)'\n          fillRule='evenodd'\n        />\n      </svg>\n    </div>\n  );\n};\n\n/**\n * Simple loading spinner\n */\nexport const LoadingIndicator = React.memo(\n  UnMemoizedLoadingIndicator,\n  (prevProps, nextProps) =>\n    prevProps.color === nextProps.color && prevProps.size === nextProps.size,\n) as typeof UnMemoizedLoadingIndicator;\n","import React, { PropsWithChildren, useContext } from 'react';\n\nimport type {\n  Channel,\n  ChannelConfigWithInfo,\n  MessageResponse,\n  Mute,\n  ChannelState as StreamChannelState,\n} from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n  UnknownType,\n} from '../types/types';\n\nexport type ChannelNotifications = Array<{\n  id: string;\n  text: string;\n  type: 'success' | 'error';\n}>;\n\nexport type StreamMessage<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> =\n  | ReturnType<StreamChannelState<At, Ch, Co, Ev, Me, Re, Us>['formatMessage']>\n  | MessageResponse<At, Ch, Co, Me, Re, Us>;\n\nexport type ChannelState<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  error?: Error | null;\n  hasMore?: boolean;\n  loading?: boolean;\n  loadingMore?: boolean;\n  members?: StreamChannelState<At, Ch, Co, Ev, Me, Re, Us>['members'];\n  messages?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>[];\n  pinnedMessages?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>[];\n  quotedMessage?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>;\n  read?: StreamChannelState<At, Ch, Co, Ev, Me, Re, Us>['read'];\n  thread?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us> | null;\n  threadHasMore?: boolean;\n  threadLoadingMore?: boolean;\n  threadMessages?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>[];\n  typing?: StreamChannelState<At, Ch, Co, Ev, Me, Re, Us>['typing'];\n  watcherCount?: number;\n  watchers?: StreamChannelState<At, Ch, Co, Ev, Me, Re, Us>['watchers'];\n};\n\nexport type ChannelStateContextValue<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = Omit<ChannelState<At, Ch, Co, Ev, Me, Re, Us>, 'typing'> & {\n  channel: Channel<At, Ch, Co, Ev, Me, Re, Us>;\n  channelCapabilities: Record<string, boolean>;\n  channelConfig: ChannelConfigWithInfo<Co> | undefined;\n  multipleUploads: boolean;\n  notifications: ChannelNotifications;\n  acceptedFiles?: string[];\n  dragAndDropWindow?: boolean;\n  maxNumberOfFiles?: number;\n  mutes?: Mute<Us>[];\n  watcher_count?: number;\n};\n\nexport const ChannelStateContext = React.createContext<ChannelStateContextValue | undefined>(\n  undefined,\n);\n\nexport const ChannelStateProvider = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>({\n  children,\n  value,\n}: PropsWithChildren<{\n  value: ChannelStateContextValue<At, Ch, Co, Ev, Me, Re, Us>;\n}>) => (\n  <ChannelStateContext.Provider value={(value as unknown) as ChannelStateContextValue}>\n    {children}\n  </ChannelStateContext.Provider>\n);\n\nexport const useChannelStateContext = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  componentName?: string,\n) => {\n  const contextValue = useContext(ChannelStateContext);\n\n  if (!contextValue) {\n    console.warn(\n      `The useChannelStateContext hook was called outside of the ChannelStateContext provider. Make sure this hook is called within a child of the Channel component. The errored call is located in the ${componentName} component.`,\n    );\n\n    return {} as ChannelStateContextValue<At, Ch, Co, Ev, Me, Re, Us>;\n  }\n\n  return (contextValue as unknown) as ChannelStateContextValue<At, Ch, Co, Ev, Me, Re, Us>;\n};\n\n/**\n * Typescript currently does not support partial inference, so if ChannelStateContext\n * typing is desired while using the HOC withChannelStateContext, the Props for the\n * wrapped component must be provided as the first generic.\n */\nexport const withChannelStateContext = <\n  P extends UnknownType,\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  Component: React.ComponentType<P>,\n): React.FC<Omit<P, keyof ChannelStateContextValue<At, Ch, Co, Ev, Me, Re, Us>>> => {\n  const WithChannelStateContextComponent = (\n    props: Omit<P, keyof ChannelStateContextValue<At, Ch, Co, Ev, Me, Re, Us>>,\n  ) => {\n    const channelStateContext = useChannelStateContext<At, Ch, Co, Ev, Me, Re, Us>();\n\n    return <Component {...(props as P)} {...channelStateContext} />;\n  };\n\n  WithChannelStateContextComponent.displayName = (\n    Component.displayName ||\n    Component.name ||\n    'Component'\n  ).replace('Base', '');\n\n  return WithChannelStateContextComponent;\n};\n","import { StreamMessage, useChannelStateContext } from '../../../context/ChannelStateContext';\nimport { useChatContext } from '../../../context/ChatContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useUserRole = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n  onlySenderCanEdit?: boolean,\n  disableQuotedMessages?: boolean,\n) => {\n  const { channel, channelCapabilities = {}, channelConfig } = useChannelStateContext<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us\n  >('useUserRole');\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('useUserRole');\n\n  const isAdmin = client.user?.role === 'admin' || channel.state.membership.role === 'admin';\n  const isMyMessage = client.userID === message.user?.id;\n  const isOwner = channel.state.membership.role === 'owner';\n\n  const isModerator =\n    client.user?.role === 'channel_moderator' ||\n    channel.state.membership.role === 'channel_moderator' ||\n    channel.state.membership.role === 'moderator';\n\n  const canEdit =\n    (!onlySenderCanEdit && channelCapabilities['update-any-message']) ||\n    (isMyMessage && channelCapabilities['update-own-message']);\n\n  const canDelete =\n    channelCapabilities['delete-any-message'] ||\n    (isMyMessage && channelCapabilities['delete-own-message']);\n\n  const canFlag = !isMyMessage;\n  const canMute = !isMyMessage && channelConfig?.mutes;\n  const canQuote = !disableQuotedMessages && channelCapabilities['quote-message'];\n  const canReact = channelConfig?.reactions !== false && channelCapabilities['send-reaction'];\n  const canReply = channelConfig?.replies !== false && channelCapabilities['send-reply'];\n\n  return {\n    canDelete,\n    canEdit,\n    canFlag,\n    canMute,\n    canQuote,\n    canReact,\n    canReply,\n    isAdmin,\n    isModerator,\n    isMyMessage,\n    isOwner,\n  };\n};\n","import React from 'react';\n\nimport { useUserRole } from './hooks/useUserRole';\n\nimport { useTranslationContext } from '../../context/TranslationContext';\n\nimport type { StreamMessage } from '../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type MessageDeletedProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>;\n};\n\nexport const MessageDeleted = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: MessageDeletedProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const { message } = props;\n\n  const { t } = useTranslationContext('MessageDeleted');\n\n  const { isMyMessage } = useUserRole(message);\n\n  const messageClasses = isMyMessage\n    ? 'str-chat__message str-chat__message--me str-chat__message-simple str-chat__message-simple--me'\n    : 'str-chat__message str-chat__message-simple';\n\n  return (\n    <div\n      className={`${messageClasses} str-chat__message--deleted ${message.type} `}\n      data-testid={'message-deleted-component'}\n      key={message.id}\n    >\n      <div className='str-chat__message--deleted-inner'>{t('This message was deleted...')}</div>\n    </div>\n  );\n};\n","import React from 'react';\n\nimport type { PinIndicatorProps } from './types';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport const ActionsIcon = () => (\n  <svg height='4' viewBox='0 0 11 4' width='11' xmlns='http://www.w3.org/2000/svg'>\n    <path\n      d='M1.5 3a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm4 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm4 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z'\n      fillRule='nonzero'\n    />\n  </svg>\n);\n\nexport const ReplyIcon = () => (\n  <svg height='15' width='18' xmlns='http://www.w3.org/2000/svg'>\n    <path\n      d='M.56 10.946H.06l-.002-.498L.025.92a.5.5 0 1 1 1-.004l.032 9.029H9.06v-4l9 4.5-9 4.5v-4H.56z'\n      fillRule='nonzero'\n    />\n  </svg>\n);\n\nexport const DeliveredCheckIcon = () => (\n  <svg height='16' width='16' xmlns='http://www.w3.org/2000/svg'>\n    <path\n      d='M8 0a8 8 0 1 1 0 16A8 8 0 0 1 8 0zm3.72 6.633a.955.955 0 1 0-1.352-1.352L6.986 8.663 5.633 7.31A.956.956 0 1 0 4.28 8.663l2.029 2.028a.956.956 0 0 0 1.353 0l4.058-4.058z'\n      fill='#006CFF'\n      fillRule='evenodd'\n    />\n  </svg>\n);\n\nexport const ReactionIcon = () => (\n  <svg height='12' viewBox='0 0 12 12' width='12' xmlns='http://www.w3.org/2000/svg'>\n    <g clipRule='evenodd' fillRule='evenodd'>\n      <path d='M6 1.2C3.3 1.2 1.2 3.3 1.2 6c0 2.7 2.1 4.8 4.8 4.8 2.7 0 4.8-2.1 4.8-4.8 0-2.7-2.1-4.8-4.8-4.8zM0 6c0-3.3 2.7-6 6-6s6 2.7 6 6-2.7 6-6 6-6-2.7-6-6z'></path>\n      <path d='M5.4 4.5c0 .5-.4.9-.9.9s-.9-.4-.9-.9.4-.9.9-.9.9.4.9.9zM8.4 4.5c0 .5-.4.9-.9.9s-.9-.4-.9-.9.4-.9.9-.9.9.4.9.9zM3.3 6.7c.3-.2.6-.1.8.1.3.4.8.9 1.5 1 .6.2 1.4.1 2.4-1 .2-.2.6-.3.8 0 .2.2.3.6 0 .8-1.1 1.3-2.4 1.7-3.5 1.5-1-.2-1.8-.9-2.2-1.5-.2-.3-.1-.7.2-.9z'></path>\n    </g>\n  </svg>\n);\n\nexport const ThreadIcon = () => (\n  <svg height='10' width='14' xmlns='http://www.w3.org/2000/svg'>\n    <path\n      d='M8.516 3c4.78 0 4.972 6.5 4.972 6.5-1.6-2.906-2.847-3.184-4.972-3.184v2.872L3.772 4.994 8.516.5V3zM.484 5l4.5-4.237v1.78L2.416 5l2.568 2.125v1.828L.484 5z'\n      fillRule='evenodd'\n    />\n  </svg>\n);\n\nexport const ErrorIcon = () => (\n  <svg height='14' width='14' xmlns='http://www.w3.org/2000/svg'>\n    <path\n      d='M7 0a7 7 0 1 0 0 14A7 7 0 0 0 7 0zm.875 10.938a.438.438 0 0 1-.438.437h-.875a.438.438 0 0 1-.437-.438v-.874c0-.242.196-.438.438-.438h.875c.241 0 .437.196.437.438v.874zm0-2.626a.438.438 0 0 1-.438.438h-.875a.438.438 0 0 1-.437-.438v-5.25c0-.241.196-.437.438-.437h.875c.241 0 .437.196.437.438v5.25z'\n      fill='#EA152F'\n      fillRule='evenodd'\n    />\n  </svg>\n);\n\nexport const PinIcon = () => (\n  <svg height='13' viewBox='0 0 14 13' width='14' xmlns='http://www.w3.org/2000/svg'>\n    <path\n      d='M13.3518 6.686L6.75251 0.0866699L5.80984 1.02867L6.75318 1.972V1.97334L3.45318 5.272L3.45251 5.27334L2.50984 4.32934L1.56718 5.27267L4.39584 8.10067L0.624512 11.8713L1.56718 12.814L5.33851 9.04334L8.16718 11.8713L9.10984 10.9293L8.16718 9.986L11.4672 6.686L12.4098 7.62867L13.3518 6.686ZM7.22451 9.04267L7.22385 9.04334L4.39584 6.21467L7.69518 2.91467L10.5232 5.74267L7.22451 9.04267Z'\n      fillRule='evenodd'\n    />\n  </svg>\n);\n\nexport const PinIndicator = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>({\n  message,\n  t,\n}: PinIndicatorProps<At, Ch, Co, Ev, Me, Re, Us>) => {\n  if (!message || !t) return null;\n\n  return (\n    <div style={{ alignItems: 'center', display: 'flex' }}>\n      <PinIcon />\n      <div\n        style={{\n          fontSize: '14px',\n          marginBottom: '0',\n          marginLeft: '8px',\n          marginTop: '0',\n        }}\n      >\n        {message.pinned_by\n          ? `${t('Pinned by')} ${message.pinned_by?.name || message.pinned_by?.id}`\n          : t('Message pinned')}\n      </div>\n    </div>\n  );\n};\n","import deepequal from 'react-fast-compare';\n\nimport type { TFunction } from 'i18next';\nimport type { MessageResponse, Mute, StreamChat, UserResponse } from 'stream-chat';\n\nimport type { PinPermissions } from './hooks';\nimport type { MessageProps } from './types';\n\nimport type { StreamMessage } from '../../context/ChannelStateContext';\nimport type { MessageContextValue } from '../../context/MessageContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\n/**\n * Following function validates a function which returns notification message.\n * It validates if the first parameter is function and also if return value of function is string or no.\n */\nexport const validateAndGetMessage = <T extends unknown[]>(\n  func: (...args: T) => unknown,\n  args: T,\n) => {\n  if (!func || typeof func !== 'function') return null;\n\n  // below is due to tests passing a single argument\n  // rather than an array.\n  if (!(args instanceof Array)) {\n    // @ts-expect-error\n    args = [args];\n  }\n\n  const returnValue = func(...args);\n\n  if (typeof returnValue !== 'string') return null;\n\n  return returnValue;\n};\n\n/**\n * Tell if the owner of the current message is muted\n */\nexport const isUserMuted = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n  mutes?: Mute<Us>[],\n) => {\n  if (!mutes || !message) return false;\n\n  const userMuted = mutes.filter((el) => el.target.id === message.user?.id);\n  return !!userMuted.length;\n};\n\nexport const MESSAGE_ACTIONS = {\n  delete: 'delete',\n  edit: 'edit',\n  flag: 'flag',\n  mute: 'mute',\n  pin: 'pin',\n  quote: 'quote',\n  react: 'react',\n  reply: 'reply',\n};\n\nexport type MessageActionsArray<T extends string = string> = Array<\n  'delete' | 'edit' | 'flag' | 'mute' | 'pin' | 'quote' | 'react' | 'reply' | T\n>;\n\n// @deprecated in favor of `channelCapabilities` - TODO: remove in next major release\nexport const defaultPinPermissions: PinPermissions = {\n  commerce: {\n    admin: true,\n    anonymous: false,\n    channel_member: false,\n    channel_moderator: true,\n    guest: false,\n    member: false,\n    moderator: true,\n    owner: true,\n    user: false,\n  },\n  gaming: {\n    admin: true,\n    anonymous: false,\n    channel_member: false,\n    channel_moderator: true,\n    guest: false,\n    member: false,\n    moderator: true,\n    owner: false,\n    user: false,\n  },\n  livestream: {\n    admin: true,\n    anonymous: false,\n    channel_member: false,\n    channel_moderator: true,\n    guest: false,\n    member: false,\n    moderator: true,\n    owner: true,\n    user: false,\n  },\n  messaging: {\n    admin: true,\n    anonymous: false,\n    channel_member: true,\n    channel_moderator: true,\n    guest: false,\n    member: true,\n    moderator: true,\n    owner: true,\n    user: false,\n  },\n  team: {\n    admin: true,\n    anonymous: false,\n    channel_member: true,\n    channel_moderator: true,\n    guest: false,\n    member: true,\n    moderator: true,\n    owner: true,\n    user: false,\n  },\n};\n\nexport type Capabilities = {\n  canDelete?: boolean;\n  canEdit?: boolean;\n  canFlag?: boolean;\n  canMute?: boolean;\n  canPin?: boolean;\n  canQuote?: boolean;\n  canReact?: boolean;\n  canReply?: boolean;\n};\n\nexport const getMessageActions = (\n  actions: MessageActionsArray | boolean,\n  { canDelete, canEdit, canFlag, canMute, canPin, canQuote, canReact, canReply }: Capabilities,\n): MessageActionsArray => {\n  const messageActionsAfterPermission: MessageActionsArray = [];\n  let messageActions: MessageActionsArray = [];\n\n  if (actions && typeof actions === 'boolean') {\n    // If value of actions is true, then populate all the possible values\n    messageActions = Object.keys(MESSAGE_ACTIONS);\n  } else if (actions && actions.length > 0) {\n    messageActions = [...actions];\n  } else {\n    return [];\n  }\n\n  if (canDelete && messageActions.indexOf(MESSAGE_ACTIONS.delete) > -1) {\n    messageActionsAfterPermission.push(MESSAGE_ACTIONS.delete);\n  }\n\n  if (canEdit && messageActions.indexOf(MESSAGE_ACTIONS.edit) > -1) {\n    messageActionsAfterPermission.push(MESSAGE_ACTIONS.edit);\n  }\n\n  if (canFlag && messageActions.indexOf(MESSAGE_ACTIONS.flag) > -1) {\n    messageActionsAfterPermission.push(MESSAGE_ACTIONS.flag);\n  }\n\n  if (canMute && messageActions.indexOf(MESSAGE_ACTIONS.mute) > -1) {\n    messageActionsAfterPermission.push(MESSAGE_ACTIONS.mute);\n  }\n\n  if (canPin && messageActions.indexOf(MESSAGE_ACTIONS.pin) > -1) {\n    messageActionsAfterPermission.push(MESSAGE_ACTIONS.pin);\n  }\n\n  if (canQuote && messageActions.indexOf(MESSAGE_ACTIONS.quote) > -1) {\n    messageActionsAfterPermission.push(MESSAGE_ACTIONS.quote);\n  }\n\n  if (canReact && messageActions.indexOf(MESSAGE_ACTIONS.react) > -1) {\n    messageActionsAfterPermission.push(MESSAGE_ACTIONS.react);\n  }\n\n  if (canReply && messageActions.indexOf(MESSAGE_ACTIONS.reply) > -1) {\n    messageActionsAfterPermission.push(MESSAGE_ACTIONS.reply);\n  }\n\n  return messageActionsAfterPermission;\n};\n\nexport const showMessageActionsBox = (actions: MessageActionsArray) => {\n  if (actions.length === 0) {\n    return false;\n  }\n\n  if (actions.length === 1 && (actions.includes('react') || actions.includes('reply'))) {\n    return false;\n  }\n\n  if (actions.length === 2 && actions.includes('react') && actions.includes('reply')) {\n    return false;\n  }\n\n  return true;\n};\n\nexport const areMessagePropsEqual = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  prevProps: MessageProps<At, Ch, Co, Ev, Me, Re, Us> & {\n    mutes?: Mute<Us>[];\n    showDetailedReactions?: boolean;\n  },\n  nextProps: MessageProps<At, Ch, Co, Ev, Me, Re, Us> & {\n    mutes?: Mute<Us>[];\n    showDetailedReactions?: boolean;\n  },\n) => {\n  const { message: prevMessage, Message: prevMessageUI } = prevProps;\n  const { message: nextMessage, Message: nextMessageUI } = nextProps;\n\n  if (prevMessageUI !== nextMessageUI) return false;\n  if (prevProps.endOfGroup !== nextProps.endOfGroup) return false;\n\n  if (nextProps.showDetailedReactions !== prevProps.showDetailedReactions) {\n    return false;\n  }\n\n  const messagesAreEqual =\n    prevMessage.deleted_at === nextMessage.deleted_at &&\n    prevMessage.latest_reactions?.length === nextMessage.latest_reactions?.length &&\n    prevMessage.own_reactions?.length === nextMessage.own_reactions?.length &&\n    prevMessage.pinned === nextMessage.pinned &&\n    prevMessage.reply_count === nextMessage.reply_count &&\n    prevMessage.status === nextMessage.status &&\n    prevMessage.text === nextMessage.text &&\n    prevMessage.type === nextMessage.type &&\n    prevMessage.updated_at === nextMessage.updated_at &&\n    prevMessage.user?.image === nextMessage.user?.image &&\n    prevMessage.user?.name === nextMessage.user?.name;\n\n  if (!messagesAreEqual) return false;\n\n  const deepEqualProps =\n    deepequal(nextProps.readBy, prevProps.readBy) &&\n    deepequal(nextProps.groupStyles, prevProps.groupStyles) && // last 3 messages can have different group styles\n    deepequal(nextProps.mutes, prevProps.mutes) &&\n    deepequal(nextProps.lastReceivedId, prevProps.lastReceivedId);\n\n  if (!deepEqualProps) return false;\n\n  return (\n    prevProps.messageListRect === nextProps.messageListRect // MessageList wrapper layout changes\n  );\n};\n\nexport const areMessageUIPropsEqual = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  prevProps: MessageContextValue<At, Ch, Co, Ev, Me, Re, Us> & {\n    showDetailedReactions?: boolean;\n  },\n  nextProps: MessageContextValue<At, Ch, Co, Ev, Me, Re, Us> & {\n    showDetailedReactions?: boolean;\n  },\n) => {\n  const { lastReceivedId: prevLastReceivedId, message: prevMessage } = prevProps;\n  const { lastReceivedId: nextLastReceivedId, message: nextMessage } = nextProps;\n\n  if (prevProps.editing !== nextProps.editing) return false;\n  if (prevProps.endOfGroup !== nextProps.endOfGroup) return false;\n  if (prevProps.mutes?.length !== nextProps.mutes?.length) return false;\n  if (prevProps.readBy?.length !== nextProps.readBy?.length) return false;\n\n  if (prevProps.showDetailedReactions !== nextProps.showDetailedReactions) {\n    return false;\n  }\n\n  if (\n    (prevMessage.id === prevLastReceivedId || prevMessage.id === nextLastReceivedId) &&\n    prevLastReceivedId !== nextLastReceivedId\n  ) {\n    return false;\n  }\n\n  const messagesAreEqual =\n    prevMessage.deleted_at === nextMessage.deleted_at &&\n    prevMessage.latest_reactions?.length === nextMessage.latest_reactions?.length &&\n    prevMessage.own_reactions?.length === nextMessage.own_reactions?.length &&\n    prevMessage.pinned === nextMessage.pinned &&\n    prevMessage.reply_count === nextMessage.reply_count &&\n    prevMessage.status === nextMessage.status &&\n    prevMessage.text === nextMessage.text &&\n    prevMessage.type === nextMessage.type &&\n    prevMessage.updated_at === nextMessage.updated_at &&\n    prevMessage.user?.image === nextMessage.user?.image &&\n    prevMessage.user?.name === nextMessage.user?.name;\n\n  if (!messagesAreEqual) return false;\n\n  return true;\n};\n\nexport const messageHasReactions = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  message?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n) => !!message?.latest_reactions && !!message.latest_reactions.length;\n\nexport const messageHasAttachments = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  message?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n) => !!message?.attachments && !!message.attachments.length;\n\nexport const getImages = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  message?: MessageResponse<At, Ch, Co, Me, Re, Us>,\n) => {\n  if (!message?.attachments) {\n    return [];\n  }\n  return message.attachments.filter((item) => item.type === 'image');\n};\n\nexport const getNonImageAttachments = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  message?: MessageResponse<At, Ch, Co, Me, Re, Us>,\n) => {\n  if (!message?.attachments) {\n    return [];\n  }\n  return message.attachments.filter((item) => item.type !== 'image');\n};\n\nexport const getReadByTooltipText = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  users: UserResponse<Us>[],\n  t: TFunction,\n  client: StreamChat<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  let outStr = '';\n\n  if (!t) {\n    throw new Error('`getReadByTooltipText was called, but translation function is not available`');\n  }\n\n  // first filter out client user, so restLength won't count it\n  const otherUsers = users\n    .filter((item) => item && client?.user && item.id !== client.user.id)\n    .map((item) => item.name || item.id);\n\n  const slicedArr = otherUsers.slice(0, 5);\n  const restLength = otherUsers.length - slicedArr.length;\n\n  if (slicedArr.length === 1) {\n    outStr = `${slicedArr[0]} `;\n  } else if (slicedArr.length === 2) {\n    // joins all with \"and\" but =no commas\n    // example: \"bob and sam\"\n    outStr = t('{{ firstUser }} and {{ secondUser }}', {\n      firstUser: slicedArr[0],\n      secondUser: slicedArr[1],\n    });\n  } else if (slicedArr.length > 2) {\n    // joins all with commas, but last one gets \", and\" (oxford comma!)\n    // example: \"bob, joe, sam and 4 more\"\n    if (restLength === 0) {\n      // mutate slicedArr to remove last user to display it separately\n      const lastUser = slicedArr.splice(slicedArr.length - 2, 1);\n      outStr = t('{{ commaSeparatedUsers }}, and {{ lastUser }}', {\n        commaSeparatedUsers: slicedArr.join(', '),\n        lastUser,\n      });\n    } else {\n      outStr = t('{{ commaSeparatedUsers }} and {{ moreCount }} more', {\n        commaSeparatedUsers: slicedArr.join(', '),\n        moreCount: restLength,\n      });\n    }\n  }\n\n  return outStr;\n};\n","import React, { PropsWithChildren, useContext } from 'react';\n\nimport type {\n  Attachment,\n  Message,\n  UpdatedMessage,\n  UpdateMessageAPIResponse,\n  UserResponse,\n} from 'stream-chat';\n\nimport type { StreamMessage } from './ChannelStateContext';\n\nimport type { ChannelStateReducerAction } from '../components/Channel/channelState';\nimport type { CustomMentionHandler } from '../components/Message/hooks/useMentionsHandler';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n  UnknownType,\n} from '../types/types';\n\nexport type MessageAttachments<At extends DefaultAttachmentType = DefaultAttachmentType> = Array<\n  Attachment<At> & { file_size?: number; mime_type?: string }\n>;\n\nexport type MessageToSend<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  attachments?: MessageAttachments<At>;\n  errorStatusCode?: number;\n  id?: string;\n  mentioned_users?: UserResponse<Us>[];\n  parent?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>;\n  parent_id?: string;\n  status?: string;\n  text?: string;\n};\n\nexport type RetrySendMessage<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = (message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>) => Promise<void>;\n\nexport type ChannelActionContextValue<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  addNotification: (text: string, type: 'success' | 'error') => void;\n  closeThread: (event: React.BaseSyntheticEvent) => void;\n  dispatch: React.Dispatch<ChannelStateReducerAction<At, Ch, Co, Ev, Me, Re, Us>>;\n  editMessage: (\n    message: UpdatedMessage<At, Ch, Co, Me, Re, Us>,\n  ) => Promise<UpdateMessageAPIResponse<At, Ch, Co, Me, Re, Us> | void>;\n  loadMore: (limit?: number) => Promise<number>;\n  loadMoreThread: () => Promise<void>;\n  onMentionsClick: CustomMentionHandler<Us>;\n  onMentionsHover: CustomMentionHandler<Us>;\n  openThread: (\n    message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n    event: React.BaseSyntheticEvent,\n  ) => void;\n  removeMessage: (message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>) => void;\n  retrySendMessage: RetrySendMessage<At, Ch, Co, Ev, Me, Re, Us>;\n  sendMessage: (\n    message: MessageToSend<At, Ch, Co, Ev, Me, Re, Us>,\n    customMessageData?: Partial<Message<At, Me, Us>>,\n  ) => Promise<void>;\n  setQuotedMessage: React.Dispatch<\n    React.SetStateAction<StreamMessage<At, Ch, Co, Ev, Me, Re, Us> | undefined>\n  >;\n  updateMessage: (message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>) => void;\n};\n\nexport const ChannelActionContext = React.createContext<ChannelActionContextValue | undefined>(\n  undefined,\n);\n\nexport const ChannelActionProvider = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>({\n  children,\n  value,\n}: PropsWithChildren<{\n  value: ChannelActionContextValue<At, Ch, Co, Ev, Me, Re, Us>;\n}>) => (\n  <ChannelActionContext.Provider value={(value as unknown) as ChannelActionContextValue}>\n    {children}\n  </ChannelActionContext.Provider>\n);\n\nexport const useChannelActionContext = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  componentName?: string,\n) => {\n  const contextValue = useContext(ChannelActionContext);\n\n  if (!contextValue) {\n    console.warn(\n      `The useChannelActionContext hook was called outside of the ChannelActionContext provider. Make sure this hook is called within a child of the Channel component. The errored call is located in the ${componentName} component.`,\n    );\n\n    return {} as ChannelActionContextValue<At, Ch, Co, Ev, Me, Re, Us>;\n  }\n\n  return (contextValue as unknown) as ChannelActionContextValue<At, Ch, Co, Ev, Me, Re, Us>;\n};\n\n/**\n * Typescript currently does not support partial inference, so if ChannelActionContext\n * typing is desired while using the HOC withChannelActionContext, the Props for the\n * wrapped component must be provided as the first generic.\n */\nexport const withChannelActionContext = <\n  P extends UnknownType,\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  Component: React.ComponentType<P>,\n): React.FC<Omit<P, keyof ChannelActionContextValue<At, Ch, Co, Ev, Me, Re, Us>>> => {\n  const WithChannelActionContextComponent = (\n    props: Omit<P, keyof ChannelActionContextValue<At, Ch, Co, Ev, Me, Re, Us>>,\n  ) => {\n    const channelActionContext = useChannelActionContext<At, Ch, Co, Ev, Me, Re, Us>();\n\n    return <Component {...(props as P)} {...channelActionContext} />;\n  };\n\n  WithChannelActionContextComponent.displayName = (\n    Component.displayName ||\n    Component.name ||\n    'Component'\n  ).replace('Base', '');\n\n  return WithChannelActionContextComponent;\n};\n","import React, { PropsWithChildren, useContext } from 'react';\n\nimport type { Mute, UserResponse } from 'stream-chat';\n\nimport type { ChannelActionContextValue } from './ChannelActionContext';\nimport type { StreamMessage } from './ChannelStateContext';\n\nimport type { ActionHandlerReturnType } from '../components/Message/hooks/useActionHandler';\nimport type { PinPermissions } from '../components/Message/hooks/usePinHandler';\nimport type { ReactEventHandler } from '../components/Message/types';\nimport type { MessageActionsArray } from '../components/Message/utils';\nimport type { MessageInputProps } from '../components/MessageInput/MessageInput';\nimport type { GroupStyle } from '../components/MessageList/utils';\nimport type { RenderTextOptions } from '../utils';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n  UnknownType,\n} from '../types/types';\n\nexport type CustomMessageActions<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  [key: string]: (\n    message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n    event: React.BaseSyntheticEvent,\n  ) => Promise<void> | void;\n};\n\nexport type MessageContextValue<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  /** If actions such as edit, delete, flag, mute are enabled on Message */\n  actionsEnabled: boolean;\n  /** Function to exit edit state */\n  clearEditingState: (event?: React.BaseSyntheticEvent) => void;\n  /** If the Message is in edit state */\n  editing: boolean;\n  /**\n   * Returns all allowed actions on message by current user e.g., ['edit', 'delete', 'flag', 'mute', 'pin', 'quote', 'react', 'reply'].\n   * Please check [Message](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Message.tsx) component for default implementation.\n   */\n  getMessageActions: () => MessageActionsArray<string>;\n  /** Function to send an action in a Channel */\n  handleAction: ActionHandlerReturnType;\n  /** Function to delete a message in a Channel */\n  handleDelete: ReactEventHandler;\n  /** Function to edit a message in a Channel */\n  handleEdit: ReactEventHandler;\n  /** Function to flag a message in a Channel */\n  handleFlag: ReactEventHandler;\n  /** Function to mute a user in a Channel */\n  handleMute: ReactEventHandler;\n  /** Function to open a Thread on a Message */\n  handleOpenThread: ReactEventHandler;\n  /** Function to pin a Message in a Channel */\n  handlePin: ReactEventHandler;\n  /** Function to post a reaction on a Message */\n  handleReaction: (reactionType: string, event: React.BaseSyntheticEvent) => Promise<void>;\n  /** Function to retry sending a Message */\n  handleRetry: ChannelActionContextValue<At, Ch, Co, Ev, Me, Re, Us>['retrySendMessage'];\n  /** Function that returns whether or not the Message belongs to the current user */\n  isMyMessage: () => boolean;\n  /** Whether or not reactions are enabled for the active channel */\n  isReactionEnabled: boolean;\n  /** The message object */\n  message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>;\n  /** Handler function for a click event on an @mention in Message */\n  onMentionsClickMessage: ReactEventHandler;\n  /** Handler function for a hover event on an @mention in Message */\n  onMentionsHoverMessage: ReactEventHandler;\n  /** Handler function for a click event on the reaction list */\n  onReactionListClick: ReactEventHandler;\n  /** Handler function for a click event on the user that posted the Message */\n  onUserClick: ReactEventHandler;\n  /** Handler function for a hover event on the user that posted the Message */\n  onUserHover: ReactEventHandler;\n  /** Ref to be placed on the reaction selector component */\n  reactionSelectorRef: React.MutableRefObject<HTMLDivElement | null>;\n  /** Function to toggle the edit state on a Message */\n  setEditingState: ReactEventHandler;\n  /** Whether or not to show reaction list details */\n  showDetailedReactions: boolean;\n  /** Additional props for underlying MessageInput component, [available props](https://getstream.io/chat/docs/sdk/react/message-input-components/message_input/#props) */\n  additionalMessageInputProps?: MessageInputProps<At, Ch, Co, Ev, Me, Re, Us>;\n  /** Object containing custom message actions and function handlers */\n  customMessageActions?: CustomMessageActions<At, Ch, Co, Ev, Me, Re, Us>;\n  /** If true, the message is the last one in a group sent by a specific user (only used in the `VirtualizedMessageList`) */\n  endOfGroup?: boolean;\n  /** If true, the message is the first one in a group sent by a specific user (only used in the `VirtualizedMessageList`) */\n  firstOfGroup?: boolean;\n  /** Override the default formatting of the date. This is a function that has access to the original date object, returns a string  */\n  formatDate?: (date: Date) => string;\n  /** If true, group messages sent by each user (only used in the `VirtualizedMessageList`) */\n  groupedByUser?: boolean;\n  /** A list of styles to apply to this message, ie. top, bottom, single */\n  groupStyles?: GroupStyle[];\n  /** Whether the threaded message is the first in the thread list */\n  initialMessage?: boolean;\n  /** Latest message id on current channel */\n  lastReceivedId?: string | null;\n  /** DOMRect object for parent MessageList component */\n  messageListRect?: DOMRect;\n  /** Array of muted users coming from [ChannelStateContext](https://getstream.io/chat/docs/sdk/react/contexts/channel_state_context/#mutes) */\n  mutes?: Mute<Us>[];\n  /** @deprecated in favor of `channelCapabilities - The user roles allowed to pin Messages in various channel types */\n  pinPermissions?: PinPermissions;\n  /** A list of users that have read this Message */\n  readBy?: UserResponse<Us>[];\n  /** Custom function to render message text content, defaults to the renderText function: [utils](https://github.com/GetStream/stream-chat-react/blob/master/src/utils.tsx) */\n  renderText?: (\n    text?: string,\n    mentioned_users?: UserResponse<Us>[],\n    options?: RenderTextOptions,\n  ) => JSX.Element | null;\n  /** Whether or not the Message is in a Thread */\n  threadList?: boolean;\n  /** render HTML instead of markdown. Posting HTML is only allowed server-side */\n  unsafeHTML?: boolean;\n};\n\nexport const MessageContext = React.createContext<MessageContextValue | undefined>(undefined);\n\nexport const MessageProvider = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>({\n  children,\n  value,\n}: PropsWithChildren<{\n  value: MessageContextValue<At, Ch, Co, Ev, Me, Re, Us>;\n}>) => (\n  <MessageContext.Provider value={(value as unknown) as MessageContextValue}>\n    {children}\n  </MessageContext.Provider>\n);\n\nexport const useMessageContext = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  componentName?: string,\n) => {\n  const contextValue = useContext(MessageContext);\n\n  if (!contextValue) {\n    console.warn(\n      `The useMessageContext hook was called outside of the MessageContext provider. Make sure this hook is called within the Message's UI component. The errored call is located in the ${componentName} component.`,\n    );\n\n    return {} as MessageContextValue<At, Ch, Co, Ev, Me, Re, Us>;\n  }\n\n  return (contextValue as unknown) as MessageContextValue<At, Ch, Co, Ev, Me, Re, Us>;\n};\n\n/**\n * Typescript currently does not support partial inference, so if MessageContext\n * typing is desired while using the HOC withMessageContext, the Props for the\n * wrapped component must be provided as the first generic.\n */\nexport const withMessageContext = <\n  P extends UnknownType,\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  Component: React.ComponentType<P>,\n): React.FC<Omit<P, keyof MessageContextValue<At, Ch, Co, Ev, Me, Re, Us>>> => {\n  const WithMessageContextComponent = (\n    props: Omit<P, keyof MessageContextValue<At, Ch, Co, Ev, Me, Re, Us>>,\n  ) => {\n    const messageContext = useMessageContext<At, Ch, Co, Ev, Me, Re, Us>();\n\n    return <Component {...(props as P)} {...messageContext} />;\n  };\n\n  WithMessageContextComponent.displayName = (\n    Component.displayName ||\n    Component.name ||\n    'Component'\n  ).replace('Base', '');\n\n  return WithMessageContextComponent;\n};\n","import React, { useCallback, useState } from 'react';\n\nimport { MESSAGE_ACTIONS } from '../Message/utils';\n\nimport { useChannelActionContext } from '../../context/ChannelActionContext';\nimport {\n  CustomMessageActions,\n  MessageContextValue,\n  useMessageContext,\n} from '../../context/MessageContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\n\nimport type { StreamMessage } from '../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type CustomMessageActionsType<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  customMessageActions: CustomMessageActions<At, Ch, Co, Ev, Me, Re, Us>;\n  message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>;\n};\n\nconst CustomMessageActionsList = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: CustomMessageActionsType<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const { customMessageActions, message } = props;\n  const customActionsArray = Object.keys(customMessageActions);\n\n  return (\n    <>\n      {customActionsArray.map((customAction) => {\n        const customHandler = customMessageActions[customAction];\n\n        return (\n          <button\n            aria-selected='false'\n            className='str-chat__message-actions-list-item'\n            key={customAction}\n            onClick={(event) => customHandler(message, event)}\n            role='option'\n          >\n            {customAction}\n          </button>\n        );\n      })}\n    </>\n  );\n};\n\ntype PropsDrilledToMessageActionsBox =\n  | 'getMessageActions'\n  | 'handleDelete'\n  | 'handleEdit'\n  | 'handleFlag'\n  | 'handleMute'\n  | 'handlePin';\n\nexport type MessageActionsBoxProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = Pick<MessageContextValue<At, Ch, Co, Ev, Me, Re, Us>, PropsDrilledToMessageActionsBox> & {\n  isUserMuted: () => boolean;\n  mine: boolean;\n  open: boolean;\n};\n\nconst UnMemoizedMessageActionsBox = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: MessageActionsBoxProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const {\n    getMessageActions,\n    handleDelete,\n    handleEdit,\n    handleFlag,\n    handleMute,\n    handlePin,\n    isUserMuted,\n    mine,\n    open = false,\n  } = props;\n\n  const { setQuotedMessage } = useChannelActionContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'MessageActionsBox',\n  );\n  const { customMessageActions, message, messageListRect } = useMessageContext<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us\n  >('MessageActionsBox');\n\n  const { t } = useTranslationContext('MessageActionsBox');\n\n  const [reverse, setReverse] = useState(false);\n\n  const messageActions = getMessageActions();\n\n  const checkIfReverse = useCallback(\n    (containerElement: HTMLDivElement) => {\n      if (!containerElement) {\n        setReverse(false);\n        return;\n      }\n\n      if (open) {\n        const containerRect = containerElement.getBoundingClientRect();\n\n        if (mine) {\n          setReverse(!!messageListRect && containerRect.left < messageListRect.left);\n        } else {\n          setReverse(!!messageListRect && containerRect.right + 5 > messageListRect.right);\n        }\n      }\n    },\n    [messageListRect, mine, open],\n  );\n\n  const handleQuote = () => {\n    setQuotedMessage(message);\n\n    const elements = message.parent_id\n      ? document.querySelectorAll('.str-chat__thread .str-chat__textarea__textarea')\n      : document.getElementsByClassName('str-chat__textarea__textarea');\n    const textarea = elements.item(0);\n\n    if (textarea instanceof HTMLTextAreaElement) {\n      textarea.focus();\n    }\n  };\n\n  return (\n    <div\n      className={`str-chat__message-actions-box\n        ${open ? 'str-chat__message-actions-box--open' : ''}\n        ${mine ? 'str-chat__message-actions-box--mine' : ''}\n        ${reverse ? 'str-chat__message-actions-box--reverse' : ''}\n      `}\n      data-testid='message-actions-box'\n      ref={checkIfReverse}\n    >\n      <div aria-label='Message Options' className='str-chat__message-actions-list' role='listbox'>\n        {customMessageActions && (\n          <CustomMessageActionsList customMessageActions={customMessageActions} message={message} />\n        )}\n        {messageActions.indexOf(MESSAGE_ACTIONS.quote) > -1 && !message.quoted_message && (\n          <button\n            aria-selected='false'\n            className='str-chat__message-actions-list-item'\n            onClick={handleQuote}\n            role='option'\n          >\n            {t('Reply')}\n          </button>\n        )}\n        {messageActions.indexOf(MESSAGE_ACTIONS.pin) > -1 && !message.parent_id && (\n          <button\n            aria-selected='false'\n            className='str-chat__message-actions-list-item'\n            onClick={handlePin}\n            role='option'\n          >\n            {!message.pinned ? t('Pin') : t('Unpin')}\n          </button>\n        )}\n        {messageActions.indexOf(MESSAGE_ACTIONS.flag) > -1 && (\n          <button\n            aria-selected='false'\n            className='str-chat__message-actions-list-item'\n            onClick={handleFlag}\n            role='option'\n          >\n            {t('Flag')}\n          </button>\n        )}\n        {messageActions.indexOf(MESSAGE_ACTIONS.mute) > -1 && (\n          <button\n            aria-selected='false'\n            className='str-chat__message-actions-list-item'\n            onClick={handleMute}\n            role='option'\n          >\n            {isUserMuted() ? t('Unmute') : t('Mute')}\n          </button>\n        )}\n        {messageActions.indexOf(MESSAGE_ACTIONS.edit) > -1 && (\n          <button\n            aria-selected='false'\n            className='str-chat__message-actions-list-item'\n            onClick={handleEdit}\n            role='option'\n          >\n            {t('Edit Message')}\n          </button>\n        )}\n        {messageActions.indexOf(MESSAGE_ACTIONS.delete) > -1 && (\n          <button\n            aria-selected='false'\n            className='str-chat__message-actions-list-item'\n            onClick={handleDelete}\n            role='option'\n          >\n            {t('Delete')}\n          </button>\n        )}\n      </div>\n    </div>\n  );\n};\n\n/**\n * A popup box that displays the available actions on a message, such as edit, delete, pin, etc.\n */\nexport const MessageActionsBox = React.memo(\n  UnMemoizedMessageActionsBox,\n) as typeof UnMemoizedMessageActionsBox;\n","import React, { useCallback, useEffect, useState } from 'react';\n\nimport { MessageActionsBox } from './MessageActionsBox';\n\nimport { ActionsIcon as DefaultActionsIcon } from '../Message/icons';\nimport { isUserMuted } from '../Message/utils';\n\nimport { useChatContext } from '../../context/ChatContext';\nimport { MessageContextValue, useMessageContext } from '../../context/MessageContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\ntype MessageContextPropsToPick =\n  | 'getMessageActions'\n  | 'handleDelete'\n  | 'handleFlag'\n  | 'handleMute'\n  | 'handlePin'\n  | 'message';\n\nexport type MessageActionsProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = Partial<Pick<MessageContextValue<At, Ch, Co, Ev, Me, Re, Us>, MessageContextPropsToPick>> & {\n  ActionsIcon?: React.FunctionComponent;\n  customWrapperClass?: string;\n  inline?: boolean;\n  messageWrapperRef?: React.RefObject<HTMLDivElement>;\n  mine?: () => boolean;\n};\n\nexport const MessageActions = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: MessageActionsProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const {\n    ActionsIcon = DefaultActionsIcon,\n    customWrapperClass = '',\n    getMessageActions: propGetMessageActions,\n    handleDelete: propHandleDelete,\n    handleFlag: propHandleFlag,\n    handleMute: propHandleMute,\n    handlePin: propHandlePin,\n    inline,\n    message: propMessage,\n    messageWrapperRef,\n    mine,\n  } = props;\n\n  const { mutes } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('MessageActions');\n  const {\n    customMessageActions,\n    getMessageActions: contextGetMessageActions,\n    handleDelete: contextHandleDelete,\n    handleFlag: contextHandleFlag,\n    handleMute: contextHandleMute,\n    handlePin: contextHandlePin,\n    isMyMessage,\n    message: contextMessage,\n    setEditingState,\n  } = useMessageContext<At, Ch, Co, Ev, Me, Re, Us>('MessageActions');\n\n  const getMessageActions = propGetMessageActions || contextGetMessageActions;\n  const handleDelete = propHandleDelete || contextHandleDelete;\n  const handleFlag = propHandleFlag || contextHandleFlag;\n  const handleMute = propHandleMute || contextHandleMute;\n  const handlePin = propHandlePin || contextHandlePin;\n  const message = propMessage || contextMessage;\n\n  const [actionsBoxOpen, setActionsBoxOpen] = useState(false);\n\n  const isMuted = useCallback(() => isUserMuted(message, mutes), [message, mutes]);\n\n  const hideOptions = useCallback(() => setActionsBoxOpen(false), []);\n  const messageActions = getMessageActions();\n  const messageDeletedAt = !!message?.deleted_at;\n\n  useEffect(() => {\n    if (messageWrapperRef?.current) {\n      messageWrapperRef.current.addEventListener('mouseleave', hideOptions);\n    }\n  }, [hideOptions, messageWrapperRef]);\n\n  useEffect(() => {\n    if (messageDeletedAt) {\n      document.removeEventListener('click', hideOptions);\n    }\n  }, [hideOptions, messageDeletedAt]);\n\n  useEffect(() => {\n    if (actionsBoxOpen) {\n      document.addEventListener('click', hideOptions);\n    } else {\n      document.removeEventListener('click', hideOptions);\n    }\n\n    return () => document.removeEventListener('click', hideOptions);\n  }, [actionsBoxOpen, hideOptions]);\n\n  if (!messageActions.length && !customMessageActions) return null;\n\n  return (\n    <MessageActionsWrapper\n      customWrapperClass={customWrapperClass}\n      inline={inline}\n      setActionsBoxOpen={setActionsBoxOpen}\n    >\n      <MessageActionsBox\n        getMessageActions={getMessageActions}\n        handleDelete={handleDelete}\n        handleEdit={setEditingState}\n        handleFlag={handleFlag}\n        handleMute={handleMute}\n        handlePin={handlePin}\n        isUserMuted={isMuted}\n        mine={mine ? mine() : isMyMessage()}\n        open={actionsBoxOpen}\n      />\n      <button\n        aria-expanded={actionsBoxOpen}\n        aria-haspopup='true'\n        aria-label='Open Message Actions Menu'\n      >\n        <ActionsIcon />\n      </button>\n    </MessageActionsWrapper>\n  );\n};\n\nexport type MessageActionsWrapperProps = {\n  setActionsBoxOpen: React.Dispatch<React.SetStateAction<boolean>>;\n  customWrapperClass?: string;\n  inline?: boolean;\n};\n\nconst MessageActionsWrapper: React.FC<MessageActionsWrapperProps> = (props) => {\n  const { children, customWrapperClass, inline, setActionsBoxOpen } = props;\n\n  const defaultWrapperClass =\n    'str-chat__message-simple__actions__action str-chat__message-simple__actions__action--options';\n\n  const wrapperClass = customWrapperClass || defaultWrapperClass;\n\n  const onClickOptionsAction = (event: React.BaseSyntheticEvent) => {\n    event.stopPropagation();\n    setActionsBoxOpen(true);\n  };\n\n  const wrapperProps = {\n    className: wrapperClass,\n    'data-testid': 'message-actions',\n    onClick: onClickOptionsAction,\n  };\n\n  if (inline) return <span {...wrapperProps}>{children}</span>;\n\n  return <div {...wrapperProps}>{children}</div>;\n};\n","import React from 'react';\n\nimport {\n  ActionsIcon as DefaultActionsIcon,\n  ReactionIcon as DefaultReactionIcon,\n  ThreadIcon as DefaultThreadIcon,\n} from './icons';\nimport { MESSAGE_ACTIONS, showMessageActionsBox } from './utils';\n\nimport { MessageActions } from '../MessageActions';\n\nimport { MessageContextValue, useMessageContext } from '../../context/MessageContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type MessageOptionsProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = Partial<Pick<MessageContextValue<At, Ch, Co, Ev, Me, Re, Us>, 'handleOpenThread'>> & {\n  ActionsIcon?: React.FunctionComponent;\n  displayLeft?: boolean;\n  displayReplies?: boolean;\n  messageWrapperRef?: React.RefObject<HTMLDivElement>;\n  ReactionIcon?: React.FunctionComponent;\n  theme?: string;\n  ThreadIcon?: React.FunctionComponent;\n};\n\nconst UnMemoizedMessageOptions = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: MessageOptionsProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const {\n    ActionsIcon = DefaultActionsIcon,\n    displayLeft = true,\n    displayReplies = true,\n    handleOpenThread: propHandleOpenThread,\n    messageWrapperRef,\n    ReactionIcon = DefaultReactionIcon,\n    theme = 'simple',\n    ThreadIcon = DefaultThreadIcon,\n  } = props;\n\n  const {\n    customMessageActions,\n    getMessageActions,\n    handleOpenThread: contextHandleOpenThread,\n    initialMessage,\n    isMyMessage,\n    message,\n    onReactionListClick,\n    threadList,\n  } = useMessageContext<At, Ch, Co, Ev, Me, Re, Us>('MessageOptions');\n\n  const handleOpenThread = propHandleOpenThread || contextHandleOpenThread;\n\n  const messageActions = getMessageActions();\n  const showActionsBox = showMessageActionsBox(messageActions) || !!customMessageActions;\n\n  const shouldShowReactions = messageActions.indexOf(MESSAGE_ACTIONS.react) > -1;\n  const shouldShowReplies =\n    messageActions.indexOf(MESSAGE_ACTIONS.reply) > -1 && displayReplies && !threadList;\n\n  if (\n    !message.type ||\n    message.type === 'error' ||\n    message.type === 'system' ||\n    message.type === 'ephemeral' ||\n    message.status === 'failed' ||\n    message.status === 'sending' ||\n    initialMessage\n  ) {\n    return null;\n  }\n\n  if (isMyMessage() && displayLeft) {\n    return (\n      <div className={`str-chat__message-${theme}__actions`} data-testid='message-options-left'>\n        {showActionsBox && (\n          <MessageActions ActionsIcon={ActionsIcon} messageWrapperRef={messageWrapperRef} />\n        )}\n        {shouldShowReplies && (\n          <button\n            aria-label='Open Thread'\n            className={`str-chat__message-${theme}__actions__action str-chat__message-${theme}__actions__action--thread`}\n            data-testid='thread-action'\n            onClick={handleOpenThread}\n          >\n            <ThreadIcon />\n          </button>\n        )}\n        {shouldShowReactions && (\n          <button\n            aria-label='Open Reaction Selector'\n            className={`str-chat__message-${theme}__actions__action str-chat__message-${theme}__actions__action--reactions`}\n            data-testid='message-reaction-action'\n            onClick={onReactionListClick}\n          >\n            <ReactionIcon />\n          </button>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <div className={`str-chat__message-${theme}__actions`} data-testid='message-options'>\n      {shouldShowReactions && (\n        <button\n          aria-label='Open Reaction Selector'\n          className={`str-chat__message-${theme}__actions__action str-chat__message-${theme}__actions__action--reactions`}\n          data-testid='message-reaction-action'\n          onClick={onReactionListClick}\n        >\n          <ReactionIcon />\n        </button>\n      )}\n      {shouldShowReplies && (\n        <button\n          aria-label='Open Thread'\n          className={`str-chat__message-${theme}__actions__action str-chat__message-${theme}__actions__action--thread`}\n          data-testid='thread-action'\n          onClick={handleOpenThread}\n        >\n          <ThreadIcon />\n        </button>\n      )}\n      {showActionsBox && (\n        <MessageActions ActionsIcon={ActionsIcon} messageWrapperRef={messageWrapperRef} />\n      )}\n    </div>\n  );\n};\n\nexport const MessageOptions = React.memo(\n  UnMemoizedMessageOptions,\n) as typeof UnMemoizedMessageOptions;\n","import React from 'react';\n\nimport { ReplyIcon } from './icons';\n\nimport { useTranslationContext } from '../../context/TranslationContext';\n\nimport type { ReactEventHandler } from './types';\n\nexport type MessageRepliesCountButtonProps = {\n  labelPlural?: string;\n  labelSingle?: string;\n  onClick?: ReactEventHandler;\n  reply_count?: number;\n};\n\nconst UnMemoizedMessageRepliesCountButton: React.FC<MessageRepliesCountButtonProps> = (props) => {\n  const { labelPlural, labelSingle, onClick, reply_count = 0 } = props;\n\n  const { t } = useTranslationContext('MessageRepliesCountButton');\n\n  let singleReplyText;\n  let pluralReplyText;\n\n  if (reply_count === 1) {\n    if (labelSingle) {\n      singleReplyText = `1 ${labelSingle}`;\n    } else {\n      singleReplyText = t('1 reply');\n    }\n  }\n\n  if (reply_count && reply_count > 1) {\n    if (labelPlural) {\n      pluralReplyText = `${reply_count} ${labelPlural}`;\n    } else {\n      pluralReplyText = t('{{ replyCount }} replies', {\n        replyCount: reply_count,\n      });\n    }\n  }\n\n  if (reply_count && reply_count !== 0) {\n    return (\n      <button\n        className='str-chat__message-replies-count-button'\n        data-testid='replies-count-button'\n        onClick={onClick}\n      >\n        <ReplyIcon />\n        {reply_count === 1 ? singleReplyText : pluralReplyText}\n      </button>\n    );\n  }\n\n  return null;\n};\n\nexport const MessageRepliesCountButton = React.memo(\n  UnMemoizedMessageRepliesCountButton,\n) as typeof UnMemoizedMessageRepliesCountButton;\n","import React from 'react';\n\nexport const Tooltip: React.FC<React.HTMLAttributes<HTMLDivElement>> = (props) => {\n  const { children, ...rest } = props;\n  return (\n    <div className='str-chat__tooltip' {...rest}>\n      {children}\n    </div>\n  );\n};\n","import React from 'react';\n\nimport { DeliveredCheckIcon } from './icons';\nimport { getReadByTooltipText } from './utils';\n\nimport { AvatarProps, Avatar as DefaultAvatar } from '../Avatar';\nimport { LoadingIndicator } from '../Loading';\nimport { Tooltip } from '../Tooltip';\n\nimport { useChatContext } from '../../context/ChatContext';\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { useMessageContext } from '../../context/MessageContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type MessageStatusProps = {\n  Avatar?: React.ComponentType<AvatarProps>;\n  messageType?: string;\n};\n\nconst UnMemoizedMessageStatus = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: MessageStatusProps,\n) => {\n  const { Avatar: propAvatar, messageType = 'simple' } = props;\n\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('MessageStatus');\n  const { Avatar: contextAvatar } = useComponentContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'MessageStatus',\n  );\n  const { isMyMessage, lastReceivedId, message, readBy, threadList } = useMessageContext<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us\n  >('MessageStatus');\n  const { t } = useTranslationContext('MessageStatus');\n\n  const Avatar = propAvatar || contextAvatar || DefaultAvatar;\n\n  if (!isMyMessage() || message.type === 'error') {\n    return null;\n  }\n\n  const justReadByMe = readBy?.length === 1 && readBy[0].id === client.user?.id;\n\n  if (message.status === 'sending') {\n    return (\n      <span\n        className={`str-chat__message-${messageType}-status`}\n        data-testid='message-status-sending'\n      >\n        <Tooltip>{t('Sending...')}</Tooltip>\n        <LoadingIndicator />\n      </span>\n    );\n  }\n\n  if (readBy?.length && !threadList && !justReadByMe) {\n    const lastReadUser = readBy.filter((item) => item.id !== client.user?.id)[0];\n\n    return (\n      <span\n        className={`str-chat__message-${messageType}-status`}\n        data-testid='message-status-read-by'\n      >\n        <Tooltip>{getReadByTooltipText(readBy, t, client)}</Tooltip>\n        <Avatar\n          image={lastReadUser.image}\n          name={lastReadUser.name || lastReadUser.id}\n          size={15}\n          user={lastReadUser}\n        />\n        {readBy.length > 2 && (\n          <span\n            className={`str-chat__message-${messageType}-status-number`}\n            data-testid='message-status-read-by-many'\n          >\n            {readBy.length - 1}\n          </span>\n        )}\n      </span>\n    );\n  }\n\n  if (message.status === 'received' && message.id === lastReceivedId && !threadList) {\n    return (\n      <span\n        className={`str-chat__message-${messageType}-status`}\n        data-testid='message-status-received'\n      >\n        <Tooltip>{t('Delivered')}</Tooltip>\n        <DeliveredCheckIcon />\n      </span>\n    );\n  }\n\n  return null;\n};\n\nexport const MessageStatus = React.memo(UnMemoizedMessageStatus) as typeof UnMemoizedMessageStatus;\n","import { useChannelActionContext } from '../../../context/ChannelActionContext';\nimport { StreamMessage, useChannelStateContext } from '../../../context/ChannelStateContext';\n\nimport type React from 'react';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport type FormData = Record<string, string>;\n\nexport type ActionHandlerReturnType = (\n  dataOrName?: string | FormData,\n  value?: string,\n  event?: React.BaseSyntheticEvent,\n) => Promise<void> | void;\n\nexport const handleActionWarning = `Action handler was called, but it is missing one of its required arguments. \nMake sure the ChannelAction and ChannelState contexts are properly set and the hook is initialized with a valid message.`;\n\nexport function useActionHandler<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(message?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>): ActionHandlerReturnType {\n  const { removeMessage, updateMessage } = useChannelActionContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'useActionHandler',\n  );\n  const { channel } = useChannelStateContext<At, Ch, Co, Ev, Me, Re, Us>('useActionHandler');\n\n  return async (dataOrName, value, event) => {\n    if (event) event.preventDefault();\n\n    if (!message || !updateMessage || !removeMessage || !channel) {\n      console.warn(handleActionWarning);\n      return;\n    }\n\n    const messageID = message.id;\n    let formData: FormData = {};\n\n    // deprecated: value&name should be removed in favor of data obj\n    if (typeof dataOrName === 'string') {\n      formData[dataOrName] = value as string;\n    } else {\n      formData = { ...dataOrName };\n    }\n\n    if (messageID) {\n      const data = await channel.sendAction(messageID, formData);\n\n      if (data?.message) {\n        updateMessage(data.message);\n      } else {\n        removeMessage(message);\n      }\n    }\n  };\n}\n","import { useEffect, useState } from 'react';\nimport throttle from 'lodash.throttle';\n\nexport type DeviceWidth = {\n  device: 'mobile' | 'tablet' | 'full';\n  width: number;\n};\n\nconst getDeviceWidth = (width: number): DeviceWidth => {\n  if (width < 768) return { device: 'mobile', width };\n  if (width < 1024) return { device: 'tablet', width };\n  return { device: 'full', width };\n};\n\nexport const useBreakpoint = () => {\n  const [breakpoint, setBreakpoint] = useState(getDeviceWidth(window.innerWidth));\n\n  useEffect(() => {\n    const getInnerWidth = throttle(() => setBreakpoint(getDeviceWidth(window.innerWidth)), 200);\n\n    window.addEventListener('resize', getInnerWidth);\n    return () => window.removeEventListener('resize', getInnerWidth);\n  }, []);\n\n  return breakpoint;\n};\n","import { validateAndGetMessage } from '../utils';\n\nimport { useChannelActionContext } from '../../../context/ChannelActionContext';\nimport { useChatContext } from '../../../context/ChatContext';\nimport { useTranslationContext } from '../../../context/TranslationContext';\n\nimport type { ReactEventHandler } from '../types';\n\nimport type { StreamMessage } from '../../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport type DeleteMessageNotifications<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  getErrorNotification?: (message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>) => string;\n  notify?: (notificationText: string, type: 'success' | 'error') => void;\n};\n\nexport const useDeleteHandler = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  message?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n  notifications: DeleteMessageNotifications<At, Ch, Co, Ev, Me, Re, Us> = {},\n): ReactEventHandler => {\n  const { getErrorNotification, notify } = notifications;\n\n  const { updateMessage } = useChannelActionContext<At, Ch, Co, Ev, Me, Re, Us>('useDeleteHandler');\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('useDeleteHandler');\n  const { t } = useTranslationContext('useDeleteHandler');\n\n  return async (event) => {\n    event.preventDefault();\n    if (!message?.id || !client || !updateMessage) {\n      return;\n    }\n\n    try {\n      const data = await client.deleteMessage(message.id);\n      updateMessage(data.message);\n    } catch (e) {\n      const errorMessage =\n        getErrorNotification && validateAndGetMessage(getErrorNotification, [message]);\n\n      if (notify) notify(errorMessage || t('Error deleting message'), 'error');\n    }\n  };\n};\n","import { useState } from 'react';\n\nimport type { ReactEventHandler } from '../types';\n\nexport type EditHandlerReturnType = {\n  clearEdit: (event?: React.BaseSyntheticEvent) => void;\n  editing: boolean;\n  setEdit: ReactEventHandler;\n};\n\nexport const useEditHandler = (\n  customInitialState = false,\n  customSetEditing?: (event?: React.BaseSyntheticEvent) => void,\n  customClearEditingHandler?: (event?: React.BaseSyntheticEvent) => void,\n): EditHandlerReturnType => {\n  const [editing, setEditing] = useState(customInitialState);\n\n  const setEdit =\n    customSetEditing ||\n    ((event) => {\n      if (event?.preventDefault) {\n        event.preventDefault();\n      }\n      setEditing(true);\n    });\n\n  const clearEdit =\n    customClearEditingHandler ||\n    ((event) => {\n      if (event?.preventDefault) {\n        event.preventDefault();\n      }\n      setEditing(false);\n    });\n\n  return { clearEdit, editing, setEdit };\n};\n","import { validateAndGetMessage } from '../utils';\n\nimport { useChatContext } from '../../../context/ChatContext';\nimport { useTranslationContext } from '../../../context/TranslationContext';\n\nimport type { ReactEventHandler } from '../types';\n\nimport type { StreamMessage } from '../../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const missingUseFlagHandlerParameterWarning =\n  'useFlagHandler was called but it is missing one or more necessary parameters.';\n\nexport type FlagMessageNotifications<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  getErrorNotification?: (message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>) => string;\n  getSuccessNotification?: (message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>) => string;\n  notify?: (notificationText: string, type: 'success' | 'error') => void;\n};\n\nexport const useFlagHandler = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  message?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n  notifications: FlagMessageNotifications<At, Ch, Co, Ev, Me, Re, Us> = {},\n): ReactEventHandler => {\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('useFlagHandler');\n  const { t } = useTranslationContext('useFlagHandler');\n\n  return async (event) => {\n    event.preventDefault();\n\n    const { getErrorNotification, getSuccessNotification, notify } = notifications;\n\n    if (!client || !t || !notify || !message?.id) {\n      console.warn(missingUseFlagHandlerParameterWarning);\n      return;\n    }\n\n    if (client.user?.banned) {\n      return notify(t('Error adding flag'), 'error');\n    }\n\n    try {\n      await client.flagMessage(message.id);\n\n      const successMessage =\n        getSuccessNotification && validateAndGetMessage(getSuccessNotification, [message]);\n\n      notify(successMessage || t('Message has been successfully flagged'), 'success');\n    } catch (e) {\n      const errorMessage =\n        getErrorNotification && validateAndGetMessage(getErrorNotification, [message]);\n\n      notify(errorMessage || t('Error adding flag'), 'error');\n    }\n  };\n};\n","import { useChannelActionContext } from '../../../context/ChannelActionContext';\n\nimport type React from 'react';\nimport type { UserResponse } from 'stream-chat';\n\nimport type { ReactEventHandler } from '../types';\n\nimport type { StreamMessage } from '../../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport type CustomMentionHandler<Us extends DefaultUserType<Us> = DefaultUserType> = (\n  event: React.BaseSyntheticEvent,\n  mentioned_users: UserResponse<Us>[],\n) => void;\n\nexport type MentionedUserEventHandler<Us extends DefaultUserType<Us> = DefaultUserType> = (\n  event: React.BaseSyntheticEvent,\n  mentionedUsers: UserResponse<Us>[],\n) => void;\n\nfunction createEventHandler<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  fn?: CustomMentionHandler<Us>,\n  message?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n): ReactEventHandler {\n  return (event) => {\n    if (typeof fn !== 'function' || !message?.mentioned_users?.length) {\n      return;\n    }\n    fn(event, message.mentioned_users);\n  };\n}\n\nexport const useMentionsHandler = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  message?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n  customMentionHandler?: {\n    onMentionsClick?: CustomMentionHandler<Us>;\n    onMentionsHover?: CustomMentionHandler<Us>;\n  },\n) => {\n  const {\n    onMentionsClick: contextOnMentionsClick,\n    onMentionsHover: contextOnMentionsHover,\n  } = useChannelActionContext<At, Ch, Co, Ev, Me, Re, Us>('useMentionsHandler');\n\n  const onMentionsClick =\n    customMentionHandler?.onMentionsClick || contextOnMentionsClick || (() => null);\n\n  const onMentionsHover =\n    customMentionHandler?.onMentionsHover || contextOnMentionsHover || (() => null);\n\n  return {\n    onMentionsClick: createEventHandler(onMentionsClick, message),\n    onMentionsHover: createEventHandler(onMentionsHover, message),\n  };\n};\n","import { useEffect, useState } from 'react';\n\nimport { useBreakpoint } from './useBreakpoint';\n\nimport type { ReactEventHandler } from '../types';\n\nexport const useMobilePress = () => {\n  const [targetMessage, setTargetMessage] = useState<Element | null>(null);\n\n  const breakpoint = useBreakpoint();\n\n  const handleMobilePress: ReactEventHandler = (event) => {\n    if (event.target instanceof HTMLElement && breakpoint.device === 'mobile') {\n      const closestMessage = event.target.closest('.str-chat__message-simple');\n\n      if (!closestMessage) return;\n\n      setTargetMessage(closestMessage);\n\n      if (closestMessage.classList.contains('mobile-press')) {\n        closestMessage.classList.remove('mobile-press');\n      } else {\n        closestMessage.classList.add('mobile-press');\n      }\n    }\n  };\n\n  useEffect(() => {\n    function handleClick(event: globalThis.MouseEvent) {\n      const isClickInside = targetMessage?.contains(event.target as HTMLElement);\n\n      if (!isClickInside && targetMessage) {\n        targetMessage.classList.remove('mobile-press');\n      }\n    }\n\n    if (breakpoint.device === 'mobile') {\n      document.addEventListener('click', handleClick);\n    }\n    return () => document.removeEventListener('click', handleClick);\n  }, [breakpoint, targetMessage]);\n\n  return { handleMobilePress };\n};\n","import { isUserMuted, validateAndGetMessage } from '../utils';\n\nimport { StreamMessage, useChannelStateContext } from '../../../context/ChannelStateContext';\nimport { useChatContext } from '../../../context/ChatContext';\nimport { useTranslationContext } from '../../../context/TranslationContext';\n\nimport type { UserResponse } from 'stream-chat';\n\nimport type { ReactEventHandler } from '../types';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const missingUseMuteHandlerParamsWarning =\n  'useMuteHandler was called but it is missing one or more necessary parameter.';\n\nexport type MuteUserNotifications<Us extends DefaultUserType<Us> = DefaultUserType> = {\n  getErrorNotification?: (user: UserResponse<Us>) => string;\n  getSuccessNotification?: (user: UserResponse<Us>) => string;\n  notify?: (notificationText: string, type: 'success' | 'error') => void;\n};\n\nexport const useMuteHandler = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  message?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n  notifications: MuteUserNotifications<Us> = {},\n): ReactEventHandler => {\n  const { mutes } = useChannelStateContext<At, Ch, Co, Ev, Me, Re, Us>('useMuteHandler');\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('useMuteHandler');\n  const { t } = useTranslationContext('useMuteHandler');\n\n  return async (event) => {\n    event.preventDefault();\n\n    const { getErrorNotification, getSuccessNotification, notify } = notifications;\n\n    if (!t || !message?.user || !notify || !client) {\n      console.warn(missingUseMuteHandlerParamsWarning);\n      return;\n    }\n\n    if (!isUserMuted(message, mutes)) {\n      try {\n        await client.muteUser(message.user.id);\n\n        const successMessage =\n          getSuccessNotification && validateAndGetMessage(getSuccessNotification, [message.user]);\n\n        notify(\n          successMessage ||\n            t(`{{ user }} has been muted`, {\n              user: message.user.name || message.user.id,\n            }),\n          'success',\n        );\n      } catch (e) {\n        const errorMessage =\n          getErrorNotification && validateAndGetMessage(getErrorNotification, [message.user]);\n\n        notify(errorMessage || t('Error muting a user ...'), 'error');\n      }\n    } else {\n      try {\n        await client.unmuteUser(message.user.id);\n\n        const fallbackMessage = t(`{{ user }} has been unmuted`, {\n          user: message.user.name || message.user.id,\n        });\n\n        const successMessage =\n          (getSuccessNotification &&\n            validateAndGetMessage(getSuccessNotification, [message.user])) ||\n          fallbackMessage;\n\n        if (typeof successMessage === 'string') {\n          notify(successMessage, 'success');\n        }\n      } catch (e) {\n        const errorMessage =\n          (getErrorNotification && validateAndGetMessage(getErrorNotification, [message.user])) ||\n          t('Error unmuting a user ...');\n\n        if (typeof errorMessage === 'string') {\n          notify(errorMessage, 'error');\n        }\n      }\n    }\n  };\n};\n","import { useChannelActionContext } from '../../../context/ChannelActionContext';\n\nimport type { ReactEventHandler } from '../types';\n\nimport type { StreamMessage } from '../../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useOpenThreadHandler = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  message?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n  customOpenThread?: (\n    message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n    event: React.BaseSyntheticEvent,\n  ) => void,\n): ReactEventHandler => {\n  const { openThread: channelOpenThread } = useChannelActionContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'useOpenThreadHandler',\n  );\n\n  const openThread = customOpenThread || channelOpenThread;\n\n  return (event) => {\n    if (!openThread || !message) {\n      console.warn('Open thread handler was called but it is missing one of its parameters');\n      return;\n    }\n\n    openThread(message, event);\n  };\n};\n","import { defaultPinPermissions, validateAndGetMessage } from '../utils';\n\nimport { useChannelActionContext } from '../../../context/ChannelActionContext';\nimport { StreamMessage, useChannelStateContext } from '../../../context/ChannelStateContext';\nimport { useChatContext } from '../../../context/ChatContext';\nimport { useTranslationContext } from '../../../context/TranslationContext';\n\nimport type { ReactEventHandler } from '../types';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\n// @deprecated in favor of `channelCapabilities` - TODO: remove in next major release\nexport type PinEnabledUserRoles<T extends string = string> = Partial<Record<T, boolean>> & {\n  admin?: boolean;\n  anonymous?: boolean;\n  channel_member?: boolean;\n  channel_moderator?: boolean;\n  guest?: boolean;\n  member?: boolean;\n  moderator?: boolean;\n  owner?: boolean;\n  user?: boolean;\n};\n\n// @deprecated in favor of `channelCapabilities` - TODO: remove in next major release\nexport type PinPermissions<T extends string = string, U extends string = string> = Partial<\n  Record<T, PinEnabledUserRoles<U>>\n> & {\n  commerce?: PinEnabledUserRoles<U>;\n  gaming?: PinEnabledUserRoles<U>;\n  livestream?: PinEnabledUserRoles<U>;\n  messaging?: PinEnabledUserRoles<U>;\n  team?: PinEnabledUserRoles<U>;\n};\n\nexport type PinMessageNotifications<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  getErrorNotification?: (message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>) => string;\n  notify?: (notificationText: string, type: 'success' | 'error') => void;\n};\n\nexport const usePinHandler = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n  // @ts-expect-error @deprecated in favor of `channelCapabilities` - TODO: remove in next major release\n  permissions: PinPermissions = defaultPinPermissions, // eslint-disable-line\n  notifications: PinMessageNotifications<At, Ch, Co, Ev, Me, Re, Us> = {},\n) => {\n  const { getErrorNotification, notify } = notifications;\n\n  const { updateMessage } = useChannelActionContext<At, Ch, Co, Ev, Me, Re, Us>('usePinHandler');\n  const { channelCapabilities = {} } = useChannelStateContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'usePinHandler',\n  );\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('usePinHandler');\n  const { t } = useTranslationContext('usePinHandler');\n\n  const canPin = !!channelCapabilities['pin-message'];\n\n  const handlePin: ReactEventHandler = async (event) => {\n    event.preventDefault();\n\n    if (!message) return;\n\n    if (!message.pinned) {\n      try {\n        const optimisticMessage = {\n          ...message,\n          pinned: true,\n          pinned_at: new Date(),\n          pinned_by: client.user,\n        };\n\n        updateMessage(optimisticMessage);\n\n        const messageResponse = await client.pinMessage(message);\n\n        updateMessage(messageResponse.message);\n      } catch (e) {\n        const errorMessage =\n          getErrorNotification && validateAndGetMessage(getErrorNotification, [message]);\n\n        if (notify) notify(errorMessage || t('Error pinning message'), 'error');\n        updateMessage(message);\n      }\n    } else {\n      try {\n        const optimisticMessage = {\n          ...message,\n          pin_expires: null,\n          pinned: false,\n          pinned_at: null,\n          pinned_by: null,\n        };\n\n        updateMessage(optimisticMessage);\n\n        const messageResponse = await client.unpinMessage(message);\n\n        updateMessage(messageResponse.message);\n      } catch (e) {\n        const errorMessage =\n          getErrorNotification && validateAndGetMessage(getErrorNotification, [message]);\n\n        if (notify) notify(errorMessage || t('Error removing message pin'), 'error');\n        updateMessage(message);\n      }\n    }\n  };\n\n  return { canPin, handlePin };\n};\n","import React, { RefObject, useCallback, useEffect, useRef, useState } from 'react';\nimport throttle from 'lodash.throttle';\n\nimport { useChannelActionContext } from '../../../context/ChannelActionContext';\nimport { StreamMessage, useChannelStateContext } from '../../../context/ChannelStateContext';\nimport { useChatContext } from '../../../context/ChatContext';\n\nimport type { ReactEventHandler } from '../types';\n\nimport type { Reaction, ReactionResponse } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const reactionHandlerWarning = `Reaction handler was called, but it is missing one of its required arguments.\nMake sure the ChannelAction and ChannelState contexts are properly set and the hook is initialized with a valid message.`;\n\nexport const useReactionHandler = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  message?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const { updateMessage } = useChannelActionContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'useReactionHandler',\n  );\n  const { channel } = useChannelStateContext<At, Ch, Co, Ev, Me, Re, Us>('useReactionHandler');\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('useReactionHandler');\n\n  const createMessagePreview = useCallback(\n    (\n      add: boolean,\n      reaction: ReactionResponse<Re, Us>,\n      message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n    ): StreamMessage<At, Ch, Co, Ev, Me, Re, Us> => {\n      const newReactionCounts = message?.reaction_counts || {};\n      const reactionType = reaction.type;\n      const hasReaction = !!newReactionCounts[reactionType];\n\n      if (add) {\n        newReactionCounts[reactionType] = hasReaction ? newReactionCounts[reactionType] + 1 : 1;\n      } else {\n        if (hasReaction && newReactionCounts[reactionType] > 1) {\n          newReactionCounts[reactionType]--;\n        } else {\n          delete newReactionCounts[reactionType];\n        }\n      }\n\n      const newReactions: Reaction<Re, Us>[] | undefined = add\n        ? [reaction, ...(message?.latest_reactions || [])]\n        : message.latest_reactions?.filter(\n            (item) => !(item.type === reaction.type && item.user_id === reaction.user_id),\n          );\n\n      const newOwnReactions = add\n        ? [reaction, ...(message?.own_reactions || [])]\n        : message?.own_reactions?.filter((item) => item.type !== reaction.type);\n\n      return {\n        ...message,\n        latest_reactions: newReactions || message.latest_reactions,\n        own_reactions: newOwnReactions,\n        reaction_counts: newReactionCounts,\n        reaction_scores: newReactionCounts,\n      } as StreamMessage<At, Ch, Co, Ev, Me, Re, Us>;\n    },\n    [client.user, client.userID],\n  );\n\n  const creatReactionPreview = (type: string) => ({\n    message_id: message?.id,\n    score: 1,\n    type,\n    user: client.user,\n    user_id: client.user?.id,\n  });\n\n  const toggleReaction = throttle(async (id: string, type: string, add: boolean) => {\n    if (!message || channel.data?.frozen) return;\n\n    const newReaction = creatReactionPreview(type) as ReactionResponse<Re, Us>;\n    const tempMessage = createMessagePreview(add, newReaction, message);\n\n    try {\n      updateMessage(tempMessage);\n\n      const messageResponse = add\n        ? await channel.sendReaction(id, { type } as Reaction<Re, Us>)\n        : await channel.deleteReaction(id, type);\n\n      updateMessage(messageResponse.message);\n    } catch (error) {\n      // revert to the original message if the API call fails\n      updateMessage(message);\n    }\n  }, 1000);\n\n  return async (reactionType: string, event?: React.BaseSyntheticEvent) => {\n    if (event?.preventDefault) {\n      event.preventDefault();\n    }\n\n    if (!message) {\n      return console.warn(reactionHandlerWarning);\n    }\n\n    let userExistingReaction = (null as unknown) as ReactionResponse<Re, Us>;\n\n    if (message.own_reactions) {\n      message.own_reactions.forEach((reaction) => {\n        // own user should only ever contain the current user id\n        // just in case we check to prevent bugs with message updates from breaking reactions\n        if (reaction.user && client.userID === reaction.user.id && reaction.type === reactionType) {\n          userExistingReaction = reaction;\n        } else if (reaction.user && client.userID !== reaction.user.id) {\n          console.warn(\n            `message.own_reactions contained reactions from a different user, this indicates a bug`,\n          );\n        }\n      });\n    }\n\n    try {\n      if (userExistingReaction) {\n        await toggleReaction(message.id, userExistingReaction.type, false);\n      } else {\n        await toggleReaction(message.id, reactionType, true);\n      }\n    } catch (error) {\n      console.log({ error });\n    }\n  };\n};\n\nexport const useReactionClick = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  message?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n  reactionSelectorRef?: RefObject<HTMLDivElement | null>,\n  messageWrapperRef?: RefObject<HTMLDivElement | null>,\n  closeReactionSelectorOnClick?: boolean,\n) => {\n  const { channel, channelCapabilities = {}, channelConfig } = useChannelStateContext<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us\n  >('useReactionClick');\n\n  const [showDetailedReactions, setShowDetailedReactions] = useState(false);\n\n  const hasListener = useRef(false);\n\n  const isFrozen = !!channel.data?.frozen;\n\n  const isReactionEnabled =\n    (channelConfig?.reactions !== false && channelCapabilities['send-reaction']) || isFrozen;\n\n  const messageDeleted = !!message?.deleted_at;\n\n  const closeDetailedReactions: EventListener = useCallback(\n    (event) => {\n      if (\n        event.target instanceof HTMLElement &&\n        reactionSelectorRef?.current?.contains(event.target) &&\n        !closeReactionSelectorOnClick\n      ) {\n        return;\n      }\n\n      setShowDetailedReactions(false);\n    },\n    [setShowDetailedReactions, reactionSelectorRef],\n  );\n\n  useEffect(() => {\n    const messageWrapper = messageWrapperRef?.current;\n\n    if (showDetailedReactions && !hasListener.current) {\n      hasListener.current = true;\n      document.addEventListener('click', closeDetailedReactions);\n\n      if (messageWrapper) {\n        messageWrapper.addEventListener('mouseleave', closeDetailedReactions);\n      }\n    }\n\n    if (!showDetailedReactions && hasListener.current) {\n      document.removeEventListener('click', closeDetailedReactions);\n\n      if (messageWrapper) {\n        messageWrapper.removeEventListener('mouseleave', closeDetailedReactions);\n      }\n\n      hasListener.current = false;\n    }\n\n    return () => {\n      if (hasListener.current) {\n        document.removeEventListener('click', closeDetailedReactions);\n\n        if (messageWrapper) {\n          messageWrapper.removeEventListener('mouseleave', closeDetailedReactions);\n        }\n\n        hasListener.current = false;\n      }\n    };\n  }, [showDetailedReactions, closeDetailedReactions, messageWrapperRef]);\n\n  useEffect(() => {\n    const messageWrapper = messageWrapperRef?.current;\n\n    if (messageDeleted && hasListener.current) {\n      document.removeEventListener('click', closeDetailedReactions);\n\n      if (messageWrapper) {\n        messageWrapper.removeEventListener('mouseleave', closeDetailedReactions);\n      }\n\n      hasListener.current = false;\n    }\n  }, [messageDeleted, closeDetailedReactions, messageWrapperRef]);\n\n  const onReactionListClick: ReactEventHandler = (event) => {\n    if (event?.stopPropagation) {\n      event.stopPropagation();\n    }\n    setShowDetailedReactions(true);\n  };\n\n  return {\n    isReactionEnabled,\n    onReactionListClick,\n    showDetailedReactions,\n  };\n};\n","import { RetrySendMessage, useChannelActionContext } from '../../../context/ChannelActionContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useRetryHandler = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  customRetrySendMessage?: RetrySendMessage<At, Ch, Co, Ev, Me, Re, Us>,\n): RetrySendMessage<At, Ch, Co, Ev, Me, Re, Us> => {\n  const { retrySendMessage: contextRetrySendMessage } = useChannelActionContext<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us\n  >('useRetryHandler');\n\n  const retrySendMessage = customRetrySendMessage || contextRetrySendMessage;\n\n  return async (message) => {\n    if (message) {\n      await retrySendMessage(message);\n    }\n  };\n};\n","import type { User } from 'stream-chat';\n\nimport type { ReactEventHandler } from '../types';\n\nimport type { StreamMessage } from '../../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport type UserEventHandler<Us extends DefaultUserType<Us> = DefaultUserType> = (\n  event: React.BaseSyntheticEvent,\n  user: User<Us>,\n) => void;\n\nexport const useUserHandler = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  message?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n  eventHandlers?: {\n    onUserClickHandler?: UserEventHandler<Us>;\n    onUserHoverHandler?: UserEventHandler<Us>;\n  },\n): {\n  onUserClick: ReactEventHandler;\n  onUserHover: ReactEventHandler;\n} => ({\n  onUserClick: (event) => {\n    if (typeof eventHandlers?.onUserClickHandler !== 'function' || !message?.user) {\n      return;\n    }\n    eventHandlers.onUserClickHandler(event, message.user);\n  },\n  onUserHover: (event) => {\n    if (typeof eventHandlers?.onUserHoverHandler !== 'function' || !message?.user) {\n      return;\n    }\n\n    eventHandlers.onUserHoverHandler(event, message.user);\n  },\n});\n","import React from 'react';\n\nimport { Avatar as DefaultAvatar } from '../Avatar';\n\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { useMessageContext } from '../../context/MessageContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\n\nimport type { TranslationLanguages } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport const QuotedMessage = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>() => {\n  const { Attachment, Avatar: ContextAvatar } = useComponentContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'QuotedMessage',\n  );\n  const { isMyMessage, message } = useMessageContext<At, Ch, Co, Ev, Me, Re, Us>('QuotedMessage');\n  const { userLanguage } = useTranslationContext('QuotedMessage');\n\n  const Avatar = ContextAvatar || DefaultAvatar;\n\n  const { quoted_message } = message;\n  if (!quoted_message) return null;\n\n  const quotedMessageText =\n    quoted_message.i18n?.[`${userLanguage}_text` as `${TranslationLanguages}_text`] ||\n    quoted_message.text;\n\n  // @ts-expect-error\n  const quotedMessageAttachment = quoted_message.attachments.length\n    ? // @ts-expect-error\n      quoted_message.attachments[0]\n    : null;\n\n  if (!quotedMessageText && !quotedMessageAttachment) return null;\n\n  return (\n    <>\n      <div className={`${isMyMessage() ? 'quoted-message mine' : 'quoted-message'}`}>\n        {quoted_message.user && (\n          <Avatar\n            image={quoted_message.user.image}\n            name={quoted_message.user.name || quoted_message.user.id}\n            size={20}\n            user={quoted_message.user}\n          />\n        )}\n        <div className='quoted-message-inner'>\n          {quotedMessageAttachment && <Attachment attachments={[quotedMessageAttachment]} />}\n          <div>{quotedMessageText}</div>\n        </div>\n      </div>\n      {message.attachments?.length && message.quoted_message ? (\n        <Attachment attachments={message.attachments} />\n      ) : null}\n    </>\n  );\n};\n","import React, { useMemo } from 'react';\n\nimport { useMobilePress } from './hooks';\nimport { QuotedMessage as DefaultQuotedMessage } from './QuotedMessage';\nimport { messageHasAttachments } from './utils';\n\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { useMessageContext } from '../../context/MessageContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\nimport { renderText as defaultRenderText, isOnlyEmojis } from '../../utils';\n\nimport type { TranslationLanguages } from 'stream-chat';\n\nimport type { StreamMessage } from '../../context/ChannelStateContext';\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type MessageTextProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  customInnerClass?: string;\n  customWrapperClass?: string;\n  message?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>;\n  theme?: string;\n};\n\nconst UnMemoizedMessageTextComponent = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: MessageTextProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const {\n    customInnerClass,\n    customWrapperClass = '',\n    message: propMessage,\n    theme = 'simple',\n  } = props;\n\n  const { QuotedMessage = DefaultQuotedMessage } = useComponentContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'MessageText',\n  );\n\n  const {\n    message: contextMessage,\n    onMentionsClickMessage,\n    onMentionsHoverMessage,\n    renderText = defaultRenderText,\n    unsafeHTML,\n  } = useMessageContext<At, Ch, Co, Ev, Me, Re, Us>('MessageText');\n\n  const { t, userLanguage } = useTranslationContext('MessageText');\n\n  const { handleMobilePress } = useMobilePress();\n\n  const message = propMessage || contextMessage;\n\n  const hasAttachment = messageHasAttachments(message);\n\n  const messageTextToRender =\n    message.i18n?.[`${userLanguage}_text` as `${TranslationLanguages}_text`] || message.text;\n\n  const messageText = useMemo(() => renderText(messageTextToRender, message.mentioned_users), [\n    message.mentioned_users,\n    messageTextToRender,\n  ]);\n\n  const wrapperClass = customWrapperClass || 'str-chat__message-text';\n  const innerClass =\n    customInnerClass || `str-chat__message-text-inner str-chat__message-${theme}-text-inner`;\n\n  if (!messageTextToRender && !message.quoted_message) return null;\n\n  return (\n    <div className={wrapperClass}>\n      <div\n        className={`\n          ${innerClass}\n          ${hasAttachment ? ` str-chat__message-${theme}-text-inner--has-attachment` : ''}\n          ${\n            isOnlyEmojis(message.text) && !message.quoted_message\n              ? ` str-chat__message-${theme}-text-inner--is-emoji`\n              : ''\n          }\n        `.trim()}\n        data-testid='message-text-inner-wrapper'\n        onClick={onMentionsClickMessage}\n        onMouseOver={onMentionsHoverMessage}\n      >\n        {message.quoted_message && <QuotedMessage />}\n        {message.type === 'error' && (\n          <div className={`str-chat__${theme}-message--error-message`}>{t('Error  Unsent')}</div>\n        )}\n        {message.status === 'failed' && (\n          <div className={`str-chat__${theme}-message--error-message`}>\n            {message.errorStatusCode !== 403\n              ? t('Message Failed  Click to try again')\n              : t('Message Failed  Unauthorized')}\n          </div>\n        )}\n        {unsafeHTML && message.html ? (\n          <div dangerouslySetInnerHTML={{ __html: message.html }} />\n        ) : (\n          <div onClick={handleMobilePress}>{messageText}</div>\n        )}\n      </div>\n    </div>\n  );\n};\n\nexport const MessageText = React.memo(\n  UnMemoizedMessageTextComponent,\n) as typeof UnMemoizedMessageTextComponent;\n","import React, { useMemo } from 'react';\n\nimport { MessageContextValue, useMessageContext } from '../../context/MessageContext';\nimport {\n  isDate,\n  isDayOrMoment,\n  isNumberOrString,\n  TDateTimeParser,\n  TDateTimeParserInput,\n  useTranslationContext,\n} from '../../context/TranslationContext';\n\nimport type { StreamMessage } from '../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport const defaultTimestampFormat = 'h:mmA';\n\nexport const notValidDateWarning =\n  'MessageTimestamp was called without a message, or message has invalid created_at date.';\n\nexport const noParsingFunctionWarning =\n  'MessageTimestamp was called but there is no datetime parsing function available';\n\nfunction getDateString(\n  messageCreatedAt?: string,\n  formatDate?: MessageContextValue['formatDate'],\n  calendar?: boolean,\n  tDateTimeParser?: TDateTimeParser,\n  format?: string,\n): TDateTimeParserInput | null {\n  if (!messageCreatedAt || !Date.parse(messageCreatedAt)) {\n    console.warn(notValidDateWarning);\n    return null;\n  }\n\n  if (typeof formatDate === 'function') {\n    return formatDate(new Date(messageCreatedAt));\n  }\n\n  if (!tDateTimeParser) {\n    console.warn(noParsingFunctionWarning);\n    return null;\n  }\n\n  const parsedTime = tDateTimeParser(messageCreatedAt);\n\n  if (isDayOrMoment(parsedTime)) {\n    /**\n     * parsedTime.calendar is guaranteed on the type but is only\n     * available when a user calls dayjs.extend(calendar)\n     */\n    return calendar && parsedTime.calendar ? parsedTime.calendar() : parsedTime.format(format);\n  }\n\n  if (isDate(parsedTime)) {\n    return parsedTime.toDateString();\n  }\n\n  if (isNumberOrString(parsedTime)) {\n    return parsedTime;\n  }\n\n  return null;\n}\n\nexport type MessageTimestampProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  calendar?: boolean;\n  customClass?: string;\n  format?: string;\n  message?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>;\n};\n\nconst UnMemoizedMessageTimestamp = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: MessageTimestampProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const {\n    calendar = false,\n    customClass = '',\n    format = defaultTimestampFormat,\n    message: propMessage,\n  } = props;\n\n  const { formatDate, message: contextMessage } = useMessageContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'MessageTimestamp',\n  );\n  const { tDateTimeParser } = useTranslationContext('MessageTimestamp');\n\n  const message = propMessage || contextMessage;\n\n  const createdAt = message.created_at as string;\n\n  const when = useMemo(\n    () => getDateString(createdAt, formatDate, calendar, tDateTimeParser, format),\n    [formatDate, calendar, tDateTimeParser, format, createdAt],\n  );\n\n  if (!when) return null;\n\n  return (\n    <time className={customClass} dateTime={createdAt} title={createdAt}>\n      {when}\n    </time>\n  );\n};\n\nexport const MessageTimestamp = React.memo(\n  UnMemoizedMessageTimestamp,\n) as typeof UnMemoizedMessageTimestamp;\n","import { CommandItem } from '../../CommandItem/CommandItem';\n\nimport { useChannelStateContext } from '../../../context/ChannelStateContext';\nimport type { CommandResponse } from 'stream-chat';\n\nimport type { CommandTriggerSetting } from '../DefaultTriggerProvider';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useCommandTrigger = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(): CommandTriggerSetting<Co> => {\n  const { channelConfig } = useChannelStateContext<At, Ch, Co, Ev, Me, Re, Us>('useCommandTrigger');\n\n  const commands = channelConfig?.commands;\n\n  return {\n    component: CommandItem,\n    dataProvider: (query, text, onReady) => {\n      if (text.indexOf('/') !== 0 || !commands) {\n        return [];\n      }\n      const selectedCommands = commands.filter((command) => command.name?.indexOf(query) !== -1);\n\n      // sort alphabetically unless the you're matching the first char\n      selectedCommands.sort((a, b) => {\n        let nameA = a.name?.toLowerCase();\n        let nameB = b.name?.toLowerCase();\n        if (nameA?.indexOf(query) === 0) {\n          nameA = `0${nameA}`;\n        }\n        if (nameB?.indexOf(query) === 0) {\n          nameB = `0${nameB}`;\n        }\n        // Should confirm possible null / undefined when TS is fully implemented\n        if (nameA != null && nameB != null) {\n          if (nameA < nameB) {\n            return -1;\n          }\n          if (nameA > nameB) {\n            return 1;\n          }\n        }\n\n        return 0;\n      });\n\n      const result = selectedCommands.slice(0, 10);\n      if (onReady)\n        onReady(\n          result.filter(\n            (result): result is CommandResponse<Co> & { name: string } => result.name !== undefined,\n          ),\n          query,\n        );\n\n      return result;\n    },\n    output: (entity) => ({\n      caretPosition: 'next',\n      key: entity.name,\n      text: `/${entity.name}`,\n    }),\n  };\n};\n","import React from 'react';\n\nexport type EmoticonItemProps = {\n  entity: {\n    /** The parts of the Name property of the entity (or id if no name) that can be matched to the user input value.\n     * Default is bold for matches, but can be overwritten in css.\n     * */\n    itemNameParts: { match: string; parts: string[] };\n    /** Name for emoticon */\n    name: string;\n    /** Native value or actual emoticon */\n    native: string;\n  };\n};\n\nconst UnMemoizedEmoticonItem: React.FC<EmoticonItemProps> = (props) => {\n  const { entity } = props;\n\n  const hasEntity = Object.keys(entity).length;\n  const itemParts = entity?.itemNameParts;\n\n  const renderName = () => {\n    if (!hasEntity) return null;\n    return (\n      hasEntity &&\n      itemParts.parts.map((part, i) =>\n        part.toLowerCase() === itemParts.match.toLowerCase() ? (\n          <span className='str-chat__emoji-item--highlight' key={`part-${i}`}>\n            {part}\n          </span>\n        ) : (\n          <span className='str-chat__emoji-item--part' key={`part-${i}`}>\n            {part}\n          </span>\n        ),\n      )\n    );\n  };\n\n  return (\n    <div className='str-chat__emoji-item'>\n      <span className='str-chat__emoji-item--entity'>{entity.native}</span>\n      <span className='str-chat__emoji-item--name'>{renderName()}</span>\n    </div>\n  );\n};\n\nexport const EmoticonItem = React.memo(UnMemoizedEmoticonItem) as typeof UnMemoizedEmoticonItem;\n","import { EmoticonItem } from '../../EmoticonItem/EmoticonItem';\n\nimport type { NimbleEmojiIndex } from 'emoji-mart';\n\nimport type { EmojiTriggerSetting } from '../DefaultTriggerProvider';\n\nexport const useEmojiTrigger = (emojiIndex?: NimbleEmojiIndex): EmojiTriggerSetting => ({\n  component: EmoticonItem,\n  dataProvider: (query, _, onReady) => {\n    if (query.length === 0 || query.charAt(0).match(/[^a-zA-Z0-9+-]/)) {\n      return [];\n    }\n    const emojis = emojiIndex?.search(query) || [];\n    // emojiIndex.search sometimes returns undefined values, so filter those out first\n    const result = emojis.filter(Boolean).slice(0, 10);\n    if (onReady) onReady(result, query);\n\n    return result;\n  },\n  output: (entity) => ({\n    caretPosition: 'next',\n    key: entity.id,\n    text: `${'native' in entity ? entity.native : ''}`,\n  }),\n});\n","import type { ImageUpload } from 'react-file-utils';\nimport type { AppSettingsAPIResponse, FileUploadConfig, UserResponse } from 'stream-chat';\n\nimport type { ChannelActionContextValue } from '../../../context/ChannelActionContext';\nimport type { ChatContextValue } from '../../../context/ChatContext';\nimport type { TranslationContextValue } from '../../../context/TranslationContext';\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const accentsMap: { [key: string]: string } = {\n  a: '|||||||',\n  c: '|',\n  e: '|||||',\n  i: '|||||',\n  n: '|',\n  o: '||||||||',\n  u: '|||||||',\n};\n\nexport const removeDiacritics = (text?: string) => {\n  if (!text) return '';\n  return Object.keys(accentsMap).reduce(\n    (acc, current) => acc.replace(new RegExp(accentsMap[current], 'g'), current),\n    text,\n  );\n};\n\nexport const calculateLevenshtein = (query: string, name: string) => {\n  if (query.length === 0) return name.length;\n  if (name.length === 0) return query.length;\n\n  const matrix = [];\n\n  let i;\n  for (i = 0; i <= name.length; i++) {\n    matrix[i] = [i];\n  }\n\n  let j;\n  for (j = 0; j <= query.length; j++) {\n    matrix[0][j] = j;\n  }\n\n  for (i = 1; i <= name.length; i++) {\n    for (j = 1; j <= query.length; j++) {\n      if (name.charAt(i - 1) === query.charAt(j - 1)) {\n        matrix[i][j] = matrix[i - 1][j - 1];\n      } else {\n        matrix[i][j] = Math.min(\n          matrix[i - 1][j - 1] + 1, // substitution\n          Math.min(\n            matrix[i][j - 1] + 1, // insertion\n            matrix[i - 1][j] + 1,\n          ),\n        ); // deletion\n      }\n    }\n  }\n\n  return matrix[name.length][query.length];\n};\n\nexport type SearchLocalUserParams<Us extends DefaultUserType<Us> = DefaultUserType> = {\n  ownUserId: string | undefined;\n  query: string;\n  text: string;\n  users: UserResponse<Us>[];\n  useMentionsTransliteration?: boolean;\n};\n\nexport const searchLocalUsers = <Us extends DefaultUserType<Us> = DefaultUserType>(\n  params: SearchLocalUserParams<Us>,\n): UserResponse<Us>[] => {\n  const { ownUserId, query, text, useMentionsTransliteration, users } = params;\n\n  const matchingUsers = users.filter((user) => {\n    if (user.id === ownUserId) return false;\n    if (!query) return true;\n\n    let updatedId = removeDiacritics(user.id).toLowerCase();\n    let updatedName = removeDiacritics(user.name).toLowerCase();\n    let updatedQuery = removeDiacritics(query).toLowerCase();\n\n    if (useMentionsTransliteration) {\n      (async () => {\n        const { default: transliterate } = await import('@stream-io/transliterate');\n        updatedName = transliterate(user.name || '').toLowerCase();\n        updatedQuery = transliterate(query).toLowerCase();\n        updatedId = transliterate(user.id).toLowerCase();\n      })();\n    }\n\n    const maxDistance = 3;\n    const lastDigits = text.slice(-(maxDistance + 1)).includes('@');\n\n    if (updatedName) {\n      const levenshtein = calculateLevenshtein(updatedQuery, updatedName);\n      if (updatedName.includes(updatedQuery) || (levenshtein <= maxDistance && lastDigits)) {\n        return true;\n      }\n    }\n\n    const levenshtein = calculateLevenshtein(updatedQuery, updatedId);\n\n    return updatedId.includes(updatedQuery) || (levenshtein <= maxDistance && lastDigits);\n  });\n\n  return matchingUsers;\n};\n\ntype CheckUploadPermissionsParams<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  addNotification: ChannelActionContextValue<At, Ch, Co, Ev, Me, Re, Us>['addNotification'];\n  file: ImageUpload['file'];\n  getAppSettings: ChatContextValue<At, Ch, Co, Ev, Me, Re, Us>['getAppSettings'];\n  t: TranslationContextValue['t'];\n  uploadType: 'image' | 'file';\n};\n\nexport const checkUploadPermissions = async <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  params: CheckUploadPermissionsParams<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const { addNotification, file, getAppSettings, t, uploadType } = params;\n\n  let appSettings: AppSettingsAPIResponse<Co> | null = null;\n  appSettings = await getAppSettings();\n\n  const {\n    allowed_file_extensions,\n    allowed_mime_types,\n    blocked_file_extensions,\n    blocked_mime_types,\n  } =\n    ((uploadType === 'image'\n      ? appSettings?.app?.image_upload_config\n      : appSettings?.app?.file_upload_config) as FileUploadConfig) || {};\n\n  const sendErrorNotification = () =>\n    addNotification(\n      t(`Upload type: \"{{ type }}\" is not allowed`, { type: file.type || 'unknown type' }),\n      'error',\n    );\n\n  if (allowed_file_extensions?.length) {\n    const allowed = allowed_file_extensions.some((ext) =>\n      file.name.toLowerCase().endsWith(ext.toLowerCase()),\n    );\n\n    if (!allowed) {\n      sendErrorNotification();\n      return false;\n    }\n  }\n\n  if (blocked_file_extensions?.length) {\n    const blocked = blocked_file_extensions.some((ext) =>\n      file.name.toLowerCase().endsWith(ext.toLowerCase()),\n    );\n\n    if (blocked) {\n      sendErrorNotification();\n      return false;\n    }\n  }\n\n  if (allowed_mime_types?.length) {\n    const allowed = allowed_mime_types.some(\n      (type) => type.toLowerCase() === file.type?.toLowerCase(),\n    );\n\n    if (!allowed) {\n      sendErrorNotification();\n      return false;\n    }\n  }\n\n  if (blocked_mime_types?.length) {\n    const blocked = blocked_mime_types.some(\n      (type) => type.toLowerCase() === file.type?.toLowerCase(),\n    );\n\n    if (blocked) {\n      sendErrorNotification();\n      return false;\n    }\n  }\n\n  return true;\n};\n","import { useCallback, useState } from 'react';\nimport throttle from 'lodash.throttle';\n\nimport { SearchLocalUserParams, searchLocalUsers } from './utils';\n\nimport { UserItem } from '../../UserItem/UserItem';\n\nimport { useChatContext } from '../../../context/ChatContext';\nimport { useChannelStateContext } from '../../../context/ChannelStateContext';\n\nimport type { SearchQueryParams } from '../../ChannelSearch/ChannelSearch';\nimport type { UserResponse } from 'stream-chat';\n\nimport type { UserTriggerSetting } from '../../MessageInput/DefaultTriggerProvider';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport type UserTriggerParams<Us extends DefaultUserType<Us> = DefaultUserType> = {\n  onSelectUser: (item: UserResponse<Us>) => void;\n  disableMentions?: boolean;\n  mentionAllAppUsers?: boolean;\n  mentionQueryParams?: SearchQueryParams<Us>['userFilters'];\n  useMentionsTransliteration?: boolean;\n};\n\nexport const useUserTrigger = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  params: UserTriggerParams<Us>,\n): UserTriggerSetting<Us> => {\n  const {\n    disableMentions,\n    mentionAllAppUsers,\n    mentionQueryParams = {},\n    onSelectUser,\n    useMentionsTransliteration,\n  } = params;\n\n  const [searching, setSearching] = useState(false);\n\n  const { client, mutes } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('useUserTrigger');\n  const { channel } = useChannelStateContext<At, Ch, Co, Ev, Me, Re, Us>('useUserTrigger');\n\n  const { members } = channel.state;\n  const { watchers } = channel.state;\n\n  const getMembersAndWatchers = useCallback(() => {\n    const memberUsers = members ? Object.values(members).map(({ user }) => user) : [];\n    const watcherUsers = watchers ? Object.values(watchers) : [];\n    const users = [...memberUsers, ...watcherUsers];\n\n    // make sure we don't list users twice\n    const uniqueUsers = {} as Record<string, UserResponse<Us>>;\n\n    users.forEach((user) => {\n      if (user && !uniqueUsers[user.id]) {\n        uniqueUsers[user.id] = user;\n      }\n    });\n\n    return Object.values(uniqueUsers);\n  }, [members, watchers]);\n\n  const queryMembersThrottled = useCallback(\n    throttle(async (query: string, onReady: (users: UserResponse<Us>[]) => void) => {\n      try {\n        // @ts-expect-error\n        const response = await channel.queryMembers({\n          name: { $autocomplete: query },\n        });\n\n        const users = response.members.map((member) => member.user) as UserResponse<Us>[];\n\n        if (onReady && users.length) {\n          onReady(users);\n        } else {\n          onReady([]);\n        }\n      } catch (error) {\n        console.log({ error });\n      }\n    }, 200),\n    [channel],\n  );\n\n  const queryUsers = async (query: string, onReady: (users: UserResponse<Us>[]) => void) => {\n    if (!query || searching) return;\n    setSearching(true);\n\n    try {\n      const { users } = await client.queryUsers(\n        // @ts-expect-error\n        {\n          $or: [{ id: { $autocomplete: query } }, { name: { $autocomplete: query } }],\n          id: { $ne: client.userID },\n          ...mentionQueryParams.filters,\n        },\n        { id: 1, ...mentionQueryParams.sort },\n        { limit: 10, ...mentionQueryParams.options },\n      );\n\n      if (onReady && users.length) {\n        onReady(users);\n      } else {\n        onReady([]);\n      }\n    } catch (error) {\n      console.log({ error });\n    }\n\n    setSearching(false);\n  };\n\n  const queryUsersThrottled = throttle(queryUsers, 200);\n\n  return {\n    callback: (item) => onSelectUser(item),\n    component: UserItem,\n    dataProvider: (query, text, onReady) => {\n      if (disableMentions) return;\n\n      const filterMutes = (data: UserResponse<Us>[]) => {\n        if (text.includes('/unmute') && !mutes.length) {\n          return [];\n        }\n        if (!mutes.length) return data;\n\n        if (text.includes('/unmute')) {\n          return data.filter((suggestion) =>\n            mutes.some((mute) => mute.target.id === suggestion.id),\n          );\n        }\n        return data.filter((suggestion) => mutes.every((mute) => mute.target.id !== suggestion.id));\n      };\n\n      if (mentionAllAppUsers) {\n        return queryUsersThrottled(query, (data: UserResponse<Us>[]) => {\n          if (onReady) onReady(filterMutes(data), query);\n        });\n      }\n\n      /**\n       * By default, we return maximum 100 members via queryChannels api call.\n       * Thus it is safe to assume, that if number of members in channel.state is < 100,\n       * then all the members are already available on client side and we don't need to\n       * make any api call to queryMembers endpoint.\n       */\n      if (!query || Object.values(members || {}).length < 100) {\n        const users = getMembersAndWatchers();\n\n        const params: SearchLocalUserParams<Us> = {\n          ownUserId: client.userID,\n          query,\n          text,\n          useMentionsTransliteration,\n          users,\n        };\n\n        const matchingUsers = searchLocalUsers<Us>(params);\n\n        const usersToShow = mentionQueryParams.options?.limit || 10;\n        const data = matchingUsers.slice(0, usersToShow);\n\n        if (onReady) onReady(filterMutes(data), query);\n        return data;\n      }\n\n      return queryMembersThrottled(query, (data: UserResponse<Us>[]) => {\n        if (onReady) onReady(filterMutes(data), query);\n      });\n    },\n    output: (entity) => ({\n      caretPosition: 'next',\n      key: entity.id,\n      text: `@${entity.name || entity.id}`,\n    }),\n  };\n};\n","import React, { createContext, PropsWithChildren, useContext } from 'react';\n\nimport type { TriggerSettings } from '../components/MessageInput/DefaultTriggerProvider';\nimport type { CooldownTimerState, MessageInputProps } from '../components/MessageInput';\nimport type {\n  CommandsListState,\n  MentionsListState,\n  MessageInputHookProps,\n  MessageInputState,\n} from '../components/MessageInput/hooks/useMessageInputState';\n\nimport type {\n  CustomTrigger,\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../types/types';\n\nexport type MessageInputContextValue<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n> = MessageInputState<At, Us> &\n  MessageInputHookProps<At, Me, Us> &\n  Omit<MessageInputProps<At, Ch, Co, Ev, Me, Re, Us, V>, 'Input'> &\n  CooldownTimerState & { autocompleteTriggers?: TriggerSettings<Co, Us, V> } & CommandsListState &\n  MentionsListState;\n\nexport const MessageInputContext = createContext<\n  (MessageInputState & MessageInputHookProps) | undefined\n>(undefined);\n\nexport const MessageInputContextProvider = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>({\n  children,\n  value,\n}: PropsWithChildren<{\n  value: MessageInputContextValue<At, Ch, Co, Ev, Me, Re, Us, V>;\n}>) => (\n  <MessageInputContext.Provider value={value as MessageInputContextValue}>\n    {children}\n  </MessageInputContext.Provider>\n);\n\nexport const useMessageInputContext = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>(\n  componentName?: string,\n) => {\n  const contextValue = useContext(MessageInputContext);\n\n  if (!contextValue) {\n    console.warn(\n      `The useMessageInputContext hook was called outside of the MessageInputContext provider. Make sure this hook is called within the MessageInput's UI component. The errored call is located in the ${componentName} component.`,\n    );\n\n    return {} as MessageInputContextValue<At, Ch, Co, Ev, Me, Re, Us, V>;\n  }\n\n  return contextValue as MessageInputContextValue<At, Ch, Co, Ev, Me, Re, Us, V>;\n};\n","import React, { PropsWithChildren } from 'react';\n\nimport { useCommandTrigger } from './hooks/useCommandTrigger';\nimport { useEmojiTrigger } from './hooks/useEmojiTrigger';\nimport { useUserTrigger } from './hooks/useUserTrigger';\n\nimport {\n  MessageInputContextProvider,\n  useMessageInputContext,\n} from '../../context/MessageInputContext';\n\nimport type { EmojiData } from 'emoji-mart';\n\nimport type { SuggestionCommand, SuggestionUser } from '../ChatAutoComplete/ChatAutoComplete';\nimport type { CommandItemProps } from '../CommandItem/CommandItem';\nimport type { EmoticonItemProps } from '../EmoticonItem/EmoticonItem';\nimport type { UserItemProps } from '../UserItem/UserItem';\n\nimport type {\n  CustomTrigger,\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n  UnknownType,\n} from '../../types/types';\n\nexport type AutocompleteMinimalData = {\n  id?: string;\n  name?: string;\n} & ({ id: string } | { name: string });\n\nexport type CommandTriggerSetting<\n  Co extends DefaultCommandType = DefaultCommandType\n> = TriggerSetting<CommandItemProps, SuggestionCommand<Co>>;\n\nexport type EmojiTriggerSetting = TriggerSetting<EmoticonItemProps, EmojiData>;\n\nexport type UserTriggerSetting<Us extends DefaultUserType<Us> = DefaultUserType> = TriggerSetting<\n  UserItemProps,\n  SuggestionUser<Us>\n>;\n\nexport type TriggerSetting<T extends UnknownType = UnknownType, U = UnknownType> = {\n  component: string | React.ComponentType<T>;\n  dataProvider: (\n    query: string,\n    text: string,\n    onReady: (data: (U & AutocompleteMinimalData)[], token: string) => void,\n  ) => U[] | Promise<void> | void;\n  output: (\n    entity: U,\n  ) =>\n    | {\n        caretPosition: 'start' | 'end' | 'next' | number;\n        text: string;\n        key?: string;\n      }\n    | string\n    | null;\n  callback?: (item: U) => void;\n};\n\nexport type TriggerSettings<\n  Co extends DefaultCommandType = DefaultCommandType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n> =\n  | {\n      [key in keyof V]: TriggerSetting<V[key]['componentProps'], V[key]['data']>;\n    }\n  | {\n      '/': CommandTriggerSetting<Co>;\n      ':': EmojiTriggerSetting;\n      '@': UserTriggerSetting<Us>;\n    };\n\nexport const DefaultTriggerProvider = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>({\n  children,\n}: PropsWithChildren<Record<string, unknown>>) => {\n  const currentValue = useMessageInputContext<At, Ch, Co, Ev, Me, Re, Us, V>(\n    'DefaultTriggerProvider',\n  );\n\n  const defaultAutocompleteTriggers: TriggerSettings<Co, Us> = {\n    '/': useCommandTrigger<At, Ch, Co>(),\n    ':': useEmojiTrigger(currentValue.emojiIndex),\n    '@': useUserTrigger<At, Ch, Co, Ev, Me, Re, Us>({\n      disableMentions: currentValue.disableMentions,\n      mentionAllAppUsers: currentValue.mentionAllAppUsers,\n      mentionQueryParams: currentValue.mentionQueryParams,\n      onSelectUser: currentValue.onSelectUser,\n      useMentionsTransliteration: currentValue.useMentionsTransliteration,\n    }),\n  };\n\n  const newValue = {\n    ...currentValue,\n    autocompleteTriggers: defaultAutocompleteTriggers,\n  };\n\n  return <MessageInputContextProvider value={newValue}>{children}</MessageInputContextProvider>;\n};\n","import React, { PropsWithChildren, useContext } from 'react';\n//@ts-expect-error\nimport DefaultEmojiIndex from 'emoji-mart/dist/utils/emoji-index/nimble-emoji-index.js';\n\nimport type {\n  Data as EmojiMartData,\n  EmojiSheetSize,\n  NimbleEmojiIndex,\n  NimbleEmojiProps,\n  NimblePickerProps,\n} from 'emoji-mart';\n\nimport type { UnknownType } from '../types/types';\n\nexport type CommonEmoji = {\n  custom: boolean;\n  emoticons: string[] | [];\n  short_names: string[] | [];\n};\n\nexport type EmojiSetDef = {\n  imageUrl: string;\n  sheetColumns: number;\n  sheetRows: number;\n  sheetSize: EmojiSheetSize;\n  spriteUrl: string;\n};\n\nexport type MinimalEmoji = CommonEmoji &\n  EmojiSetDef & {\n    colons: string;\n    id: string;\n    name: string;\n    sheet_x: number;\n    sheet_y: number;\n  };\n\nexport type EmojiConfig = {\n  commonEmoji: CommonEmoji;\n  defaultMinimalEmojis: MinimalEmoji[];\n  emojiData: EmojiMartData;\n  emojiSetDef: EmojiSetDef;\n};\n\nexport type EmojiContextValue = {\n  emojiConfig: EmojiConfig;\n  Emoji?: React.ComponentType<NimbleEmojiProps>;\n  EmojiIndex?: NimbleEmojiIndex;\n  EmojiPicker?: React.ComponentType<NimblePickerProps>;\n};\n\nconst DefaultEmoji = React.lazy(async () => {\n  //@ts-expect-error\n  const emoji = await import('emoji-mart/dist/components/emoji/nimble-emoji.js');\n  return { default: emoji.default };\n});\n\nconst DefaultEmojiPicker = React.lazy(async () => {\n  // @ts-expect-error\n  const emojiPicker = await import('emoji-mart/dist/components/picker/nimble-picker.js');\n  return { default: emojiPicker.default };\n});\n\nexport const EmojiContext = React.createContext<EmojiContextValue | undefined>(undefined);\n\nexport const EmojiProvider = ({\n  children,\n  value,\n}: PropsWithChildren<{\n  value: EmojiContextValue;\n}>) => {\n  const {\n    Emoji = DefaultEmoji,\n    emojiConfig,\n    EmojiIndex = DefaultEmojiIndex,\n    EmojiPicker = DefaultEmojiPicker,\n  } = value;\n\n  const emojiContextValue: Required<EmojiContextValue> = {\n    Emoji,\n    emojiConfig,\n    EmojiIndex,\n    EmojiPicker,\n  };\n\n  return <EmojiContext.Provider value={emojiContextValue}>{children}</EmojiContext.Provider>;\n};\n\nexport const useEmojiContext = (componentName?: string) => {\n  const contextValue = useContext(EmojiContext);\n\n  if (!contextValue) {\n    console.warn(\n      `The useEmojiContext hook was called outside of the EmojiContext provider. Make sure this hook is called within a child of the Channel component. The errored call is located in the ${componentName} component.`,\n    );\n\n    return {} as Required<EmojiContextValue>;\n  }\n\n  return contextValue as Required<EmojiContextValue>;\n};\n\n/**\n * Typescript currently does not support partial inference, so if EmojiContext\n * typing is desired while using the HOC withEmojiContext, the Props for the\n * wrapped component must be provided as the first generic.\n */\nexport const withEmojiContext = <P extends UnknownType>(\n  Component: React.ComponentType<P>,\n): React.FC<Omit<P, keyof EmojiContextValue>> => {\n  const WithEmojiContextComponent = (props: Omit<P, keyof EmojiContextValue>) => {\n    const componentContext = useEmojiContext();\n\n    return <Component {...(props as P)} {...componentContext} />;\n  };\n\n  WithEmojiContextComponent.displayName = (\n    Component.displayName ||\n    Component.name ||\n    'Component'\n  ).replace('Base', '');\n\n  return WithEmojiContextComponent;\n};\n","import React, { Suspense } from 'react';\n\nimport { useEmojiContext } from '../../context/EmojiContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\n\nimport type { EmojiData } from 'emoji-mart';\n\nimport { useMessageInputContext } from '../../context/MessageInputContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nconst filterEmoji = (emoji: EmojiData) => {\n  if (emoji.name === 'White Smiling Face' || emoji.name === 'White Frowning Face') {\n    return false;\n  }\n  return true;\n};\n\nexport type MessageInputEmojiPickerProps = {\n  small?: boolean;\n};\n\nexport const EmojiPicker = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: MessageInputEmojiPickerProps,\n) => {\n  const { small } = props;\n\n  const { emojiConfig, EmojiPicker: EmojiPickerComponent } = useEmojiContext('EmojiPicker');\n  const { t } = useTranslationContext('EmojiPicker');\n\n  const messageInput = useMessageInputContext<At, Ch, Co, Ev, Me, Re, Us>('EmojiPicker');\n\n  const { emojiData } = emojiConfig || {};\n\n  if (messageInput.emojiPickerIsOpen && emojiData) {\n    const className = small\n      ? 'str-chat__small-message-input-emojipicker'\n      : 'str-chat__input--emojipicker';\n\n    return (\n      <div className={className} ref={messageInput.emojiPickerRef}>\n        <Suspense fallback={null}>\n          <EmojiPickerComponent\n            color='#006CFF'\n            data={emojiData}\n            emoji='point_up'\n            emojisToShowFilter={filterEmoji}\n            native\n            onSelect={messageInput.onSelectEmoji}\n            set='facebook'\n            showPreview={false}\n            showSkinTones={false}\n            title={t('Pick your emoji')}\n            useButton\n          />\n        </Suspense>\n      </div>\n    );\n  }\n  return null;\n};\n","import React from 'react';\n\nimport { useTranslationContext } from '../../context/TranslationContext';\n\nimport type { Message } from 'stream-chat';\n\nimport type { DefaultAttachmentType, DefaultMessageType, DefaultUserType } from '../../types/types';\n\nexport const EmojiIconLarge: React.FC = () => {\n  const { t } = useTranslationContext('EmojiIconLarge');\n\n  return (\n    <svg height='28' width='28' xmlns='http://www.w3.org/2000/svg'>\n      <title>{t('Open emoji picker')}</title>\n      <g clipRule='evenodd' fillRule='evenodd'>\n        <path d='M14 4.4C8.6 4.4 4.4 8.6 4.4 14c0 5.4 4.2 9.6 9.6 9.6c5.4 0 9.6-4.2 9.6-9.6c0-5.4-4.2-9.6-9.6-9.6zM2 14c0-6.6 5.4-12 12-12s12 5.4 12 12s-5.4 12-12 12s-12-5.4-12-12zM12.8 11c0 1-.8 1.8-1.8 1.8s-1.8-.8-1.8-1.8s.8-1.8 1.8-1.8s1.8.8 1.8 1.8zM18.8 11c0 1-.8 1.8-1.8 1.8s-1.8-.8-1.8-1.8s.8-1.8 1.8-1.8s1.8.8 1.8 1.8zM8.6 15.4c.6-.4 1.2-.2 1.6.2c.6.8 1.6 1.8 3 2c1.2.4 2.8.2 4.8-2c.4-.4 1.2-.6 1.6 0c.4.4.6 1.2 0 1.6c-2.2 2.6-4.8 3.4-7 3c-2-.4-3.6-1.8-4.4-3c-.4-.6-.2-1.2.4-1.8z'></path>\n      </g>\n    </svg>\n  );\n};\n\nexport const EmojiIconSmall: React.FC = () => {\n  const { t } = useTranslationContext('EmojiIconSmall');\n\n  return (\n    <svg height='14' width='14' xmlns='http://www.w3.org/2000/svg'>\n      <title>{t('Open emoji picker')}</title>\n      <g clipRule='evenodd' fillRule='evenodd'>\n        <path d='M6.7 1.42C3.73 1.42 1.42 3.73 1.42 6.7c0 2.97 2.31 5.28 5.28 5.28c2.97 0 5.28-2.31 5.28-5.28c0-2.97-2.31-5.28-5.28-5.28zM.1 6.7c0-3.63 2.97-6.6 6.6-6.6s6.6 2.97 6.6 6.6s-2.97 6.6-6.6 6.6s-6.6-2.97-6.6-6.6zM6.04 5.05c0 .55-.44.99-.99.99s-.99-.44-.99-.99s.44-.99.99-.99s.99.44.99.99zM9.34 5.05c0 .55-.44.99-.99.99s-.99-.44-.99-.99s.44-.99.99-.99s.99.44.99.99zM3.73 7.47c.33-.22.66-.11.88.11c.33.44.88.99 1.65 1.1c.66.22 1.54.11 2.64-1.1c.22-.22.66-.33.88 0c.22.22.33.66 0 .88c-1.21 1.43-2.64 1.87-3.85 1.65c-1.1-.22-1.98-.99-2.42-1.65c-.22-.33-.11-.66.22-.99z'></path>\n      </g>\n    </svg>\n  );\n};\n\nexport const FileUploadIcon: React.FC = () => {\n  const { t } = useTranslationContext('FileUploadIcon');\n\n  return (\n    <svg height='14' width='14' xmlns='http://www.w3.org/2000/svg'>\n      <title>{t('Attach files')}</title>\n      <path\n        d='M7 .5c3.59 0 6.5 2.91 6.5 6.5s-2.91 6.5-6.5 6.5S.5 10.59.5 7 3.41.5 7 .5zm0 12c3.031 0 5.5-2.469 5.5-5.5S10.031 1.5 7 1.5A5.506 5.506 0 0 0 1.5 7c0 3.034 2.469 5.5 5.5 5.5zM7.506 3v3.494H11v1.05H7.506V11h-1.05V7.544H3v-1.05h3.456V3h1.05z'\n        fillRule='nonzero'\n      />\n    </svg>\n  );\n};\n\nexport const FileUploadIconFlat: React.FC = () => {\n  const { t } = useTranslationContext('FileUploadIconFlat');\n\n  return (\n    <svg height='14' width='14' xmlns='http://www.w3.org/2000/svg'>\n      <title>{t('Attach files')}</title>\n      <path\n        d='M1.667.333h10.666c.737 0 1.334.597 1.334 1.334v10.666c0 .737-.597 1.334-1.334 1.334H1.667a1.333 1.333 0 0 1-1.334-1.334V1.667C.333.93.93.333 1.667.333zm2 1.334a1.667 1.667 0 1 0 0 3.333 1.667 1.667 0 0 0 0-3.333zm-2 9.333v1.333h10.666v-4l-2-2-4 4-2-2L1.667 11z'\n        fillRule='nonzero'\n      />\n    </svg>\n  );\n};\n\nexport type SendButtonProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  sendMessage: (\n    event: React.BaseSyntheticEvent,\n    customMessageData?: Partial<Message<At, Me, Us>>,\n  ) => void;\n};\n\nexport const SendButton = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>({\n  sendMessage,\n}: SendButtonProps<At, Me, Us>) => {\n  const { t } = useTranslationContext('SendButton');\n\n  return (\n    <button aria-label='Send' className='str-chat__send-button' onClick={sendMessage}>\n      <svg height='17' viewBox='0 0 18 17' width='18' xmlns='http://www.w3.org/2000/svg'>\n        <title>{t('Send')}</title>\n        <path\n          d='M0 17.015l17.333-8.508L0 0v6.617l12.417 1.89L0 10.397z'\n          fill='#006cff'\n          fillRule='evenodd'\n        />\n      </svg>\n    </button>\n  );\n};\n","import React, { useEffect } from 'react';\nimport { FilePreviewer, ImagePreviewer } from 'react-file-utils';\n\nimport { useBreakpoint } from '../Message/hooks';\n\nimport { useChannelStateContext } from '../../context/ChannelStateContext';\nimport { useMessageInputContext } from '../../context/MessageInputContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport const UploadsPreview = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>() => {\n  const { maxNumberOfFiles, multipleUploads } = useChannelStateContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'UploadsPreview',\n  );\n  const messageInput = useMessageInputContext<At, Ch, Co, Ev, Me, Re, Us>('UploadsPreview');\n  const {\n    fileOrder,\n    fileUploads,\n    imageOrder,\n    imageUploads,\n    numberOfUploads,\n    removeFile,\n    removeImage,\n    text,\n    uploadFile,\n    uploadImage,\n    uploadNewFiles,\n  } = messageInput;\n\n  const imagesToPreview = imageOrder.map((id) => imageUploads[id]);\n  const filesToPreview = fileOrder.map((id) => fileUploads[id]);\n\n  const { device } = useBreakpoint();\n\n  useEffect(() => {\n    const elements = document.getElementsByClassName('str-chat__send-button');\n    const sendButton = elements.item(0);\n\n    if (sendButton instanceof HTMLButtonElement) {\n      if ((numberOfUploads && !text) || device !== 'full') {\n        sendButton.style.display = 'block';\n      } else {\n        sendButton.style.display = 'none';\n      }\n    }\n  }, [device, numberOfUploads, text]);\n\n  return (\n    <>\n      {imageOrder.length > 0 && (\n        <ImagePreviewer\n          disabled={\n            !multipleUploads ||\n            (maxNumberOfFiles !== undefined && numberOfUploads >= maxNumberOfFiles)\n          }\n          handleFiles={uploadNewFiles}\n          handleRemove={removeImage}\n          handleRetry={uploadImage}\n          imageUploads={imagesToPreview}\n          multiple={multipleUploads}\n        />\n      )}\n      {fileOrder.length > 0 && (\n        <FilePreviewer\n          handleFiles={uploadNewFiles}\n          handleRemove={removeFile}\n          handleRetry={uploadFile}\n          uploads={filesToPreview}\n        />\n      )}\n    </>\n  );\n};\n","import React, { useCallback } from 'react';\n\nimport { AutoCompleteTextarea } from '../AutoCompleteTextarea';\nimport { LoadingIndicator } from '../Loading/LoadingIndicator';\n\nimport { useMessageInputContext } from '../../context/MessageInputContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\nimport { useComponentContext } from '../../context/ComponentContext';\n\nimport type { EmojiData, NimbleEmojiIndex } from 'emoji-mart';\nimport type { CommandResponse, UserResponse } from 'stream-chat';\n\nimport type { TriggerSettings } from '../MessageInput/DefaultTriggerProvider';\n\nimport type {\n  CustomTrigger,\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\ntype ObjectUnion<T> = T[keyof T];\n\nexport type SuggestionCommand<\n  Co extends DefaultCommandType = DefaultCommandType\n> = CommandResponse<Co>;\n\nexport type SuggestionUser<Us extends DefaultUserType<Us> = DefaultUserType> = UserResponse<Us>;\n\nexport type SuggestionItemProps<\n  Co extends DefaultCommandType = DefaultCommandType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  className: string;\n  component: JSX.Element;\n  item: EmojiData | SuggestionUser<Us> | SuggestionCommand<Co>;\n  key: React.Key;\n  onClickHandler: (event: React.BaseSyntheticEvent) => void;\n  onSelectHandler: (item: EmojiData | SuggestionUser<Us> | SuggestionCommand<Co>) => void;\n  selected: boolean;\n  style: React.CSSProperties;\n  value: string;\n};\n\nexport type SuggestionListProps<\n  Co extends DefaultCommandType = DefaultCommandType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n> = ObjectUnion<\n  {\n    [key in keyof TriggerSettings<Co, Us, V>]: {\n      component: TriggerSettings<Co, Us, V>[key]['component'];\n      dropdownScroll: (element: HTMLDivElement) => void;\n      getSelectedItem:\n        | ((item: Parameters<TriggerSettings<Co, Us, V>[key]['output']>[0]) => void)\n        | null;\n      getTextToReplace: (\n        item: Parameters<TriggerSettings<Co, Us, V>[key]['output']>[0],\n      ) => {\n        caretPosition: 'start' | 'end' | 'next' | number;\n        text: string;\n        key?: string;\n      };\n      onSelect: (newToken: {\n        caretPosition: 'start' | 'end' | 'next' | number;\n        text: string;\n      }) => void;\n      values: Parameters<Parameters<TriggerSettings<Co, Us, V>[key]['dataProvider']>[2]>[0];\n      className?: string;\n      itemClassName?: string;\n      itemStyle?: React.CSSProperties;\n      style?: React.CSSProperties;\n      value?: string;\n    };\n  }\n>;\n\nexport type ChatAutoCompleteProps = {\n  /** Function to override the default submit handler on the underlying `textarea` component */\n  handleSubmit?: (event: React.BaseSyntheticEvent) => void;\n  /** Function to override the default onChange behavior on the underlying `textarea` component */\n  onChange?: React.ChangeEventHandler<HTMLTextAreaElement>;\n  /** Function to run on focus of the underlying `textarea` component */\n  onFocus?: React.FocusEventHandler<HTMLTextAreaElement>;\n  /** Function to override the default onPaste behavior on the underlying `textarea` component */\n  onPaste?: (event: React.ClipboardEvent<HTMLTextAreaElement>) => void;\n  /** Placeholder for the the underlying `textarea` component */\n  placeholder?: string;\n  /** The initial number of rows for the underlying `textarea` component */\n  rows?: number;\n  /** The text value of the underlying `textarea` component */\n  value?: string;\n  /** Function to override the default emojiReplace behavior on the `wordReplace` prop of the `textarea` component */\n  wordReplace?: (word: string, emojiIndex?: NimbleEmojiIndex) => string;\n};\n\nconst UnMemoizedChatAutoComplete = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>(\n  props: ChatAutoCompleteProps,\n) => {\n  const {\n    AutocompleteSuggestionItem: SuggestionItem,\n    AutocompleteSuggestionList: SuggestionList,\n  } = useComponentContext<At, Ch, Co, Ev, Me, Re, Us, V>('ChatAutoComplete');\n  const { t } = useTranslationContext('ChatAutoComplete');\n\n  const messageInput = useMessageInputContext<At, Ch, Co, Ev, Me, Re, Us, V>('ChatAutoComplete');\n  const { cooldownRemaining, disabled, emojiIndex, textareaRef: innerRef } = messageInput;\n\n  const placeholder = props.placeholder || t('Type your message');\n\n  const emojiReplace = props.wordReplace\n    ? (word: string) => props.wordReplace?.(word, emojiIndex)\n    : (word: string) => {\n        const found = emojiIndex?.search(word) || [];\n        const emoji = found\n          .filter(Boolean)\n          .slice(0, 10)\n          .find(({ emoticons }: EmojiData) => !!emoticons?.includes(word));\n        if (!emoji || !('native' in emoji)) return null;\n        return emoji.native;\n      };\n\n  const updateInnerRef = useCallback(\n    (ref) => {\n      if (innerRef) {\n        innerRef.current = ref;\n      }\n    },\n    [innerRef],\n  );\n\n  return (\n    <AutoCompleteTextarea\n      additionalTextareaProps={messageInput.additionalTextareaProps}\n      aria-label={cooldownRemaining ? t('Slow Mode ON') : placeholder}\n      className='str-chat__textarea__textarea'\n      closeCommandsList={messageInput.closeCommandsList}\n      closeMentionsList={messageInput.closeMentionsList}\n      containerClassName='str-chat__textarea'\n      disabled={disabled || !!cooldownRemaining}\n      disableMentions={messageInput.disableMentions}\n      dropdownClassName='str-chat__emojisearch'\n      grow={messageInput.grow}\n      handleSubmit={props.handleSubmit || messageInput.handleSubmit}\n      innerRef={updateInnerRef}\n      itemClassName='str-chat__emojisearch__item'\n      keycodeSubmitKeys={messageInput.keycodeSubmitKeys}\n      listClassName='str-chat__emojisearch__list'\n      loadingComponent={LoadingIndicator}\n      maxRows={messageInput.maxRows}\n      minChar={0}\n      onChange={props.onChange || messageInput.handleChange}\n      onFocus={props.onFocus}\n      onPaste={props.onPaste || messageInput.onPaste}\n      placeholder={cooldownRemaining ? t('Slow Mode ON') : placeholder}\n      replaceWord={emojiReplace}\n      rows={props.rows || 1}\n      showCommandsList={messageInput.showCommandsList}\n      showMentionsList={messageInput.showMentionsList}\n      SuggestionItem={SuggestionItem}\n      SuggestionList={SuggestionList}\n      trigger={messageInput.autocompleteTriggers || {}}\n      value={props.value || messageInput.text}\n    />\n  );\n};\n\nexport const ChatAutoComplete = React.memo(\n  UnMemoizedChatAutoComplete,\n) as typeof UnMemoizedChatAutoComplete;\n","import React, { useEffect } from 'react';\nimport { FileUploadButton, ImageDropzone } from 'react-file-utils';\n\nimport { EmojiPicker } from './EmojiPicker';\nimport {\n  EmojiIconSmall as DefaultEmojiIcon,\n  FileUploadIcon as DefaultFileUploadIcon,\n} from './icons';\nimport { UploadsPreview } from './UploadsPreview';\n\nimport { KEY_CODES } from '../AutoCompleteTextarea/listener';\nimport { ChatAutoComplete } from '../ChatAutoComplete/ChatAutoComplete';\nimport { Tooltip } from '../Tooltip/Tooltip';\n\nimport { useChannelStateContext } from '../../context/ChannelStateContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\nimport { useMessageInputContext } from '../../context/MessageInputContext';\nimport { useComponentContext } from '../../context/ComponentContext';\n\nimport type {\n  CustomTrigger,\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport const EditMessageForm = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>() => {\n  const { acceptedFiles, multipleUploads } = useChannelStateContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'EditMessageForm',\n  );\n  const { t } = useTranslationContext('EditMessageForm');\n\n  const {\n    clearEditingState,\n    closeEmojiPicker,\n    emojiPickerIsOpen,\n    handleSubmit,\n    isUploadEnabled,\n    maxFilesLeft,\n    openEmojiPicker,\n    uploadNewFiles,\n  } = useMessageInputContext<At, Ch, Co, Ev, Me, Re, Us, V>('EditMessageForm');\n\n  const {\n    EmojiIcon = DefaultEmojiIcon,\n    FileUploadIcon = DefaultFileUploadIcon,\n  } = useComponentContext<At, Ch, Co, Ev, Me, Re, Us>('EditMessageForm');\n\n  useEffect(() => {\n    const onKeyDown = (event: KeyboardEvent) => {\n      if (event.keyCode === KEY_CODES.ESC && clearEditingState) clearEditingState();\n    };\n\n    document.addEventListener('keydown', onKeyDown);\n    return () => document.removeEventListener('keydown', onKeyDown);\n  }, [clearEditingState]);\n\n  return (\n    <div className='str-chat__edit-message-form'>\n      <ImageDropzone\n        accept={acceptedFiles}\n        disabled={!isUploadEnabled || maxFilesLeft === 0}\n        handleFiles={uploadNewFiles}\n        maxNumberOfFiles={maxFilesLeft}\n        multiple={multipleUploads}\n      >\n        <form onSubmit={handleSubmit}>\n          {isUploadEnabled && <UploadsPreview />}\n          <EmojiPicker small />\n          <ChatAutoComplete />\n          <div className='str-chat__message-team-form-footer'>\n            <div className='str-chat__edit-message-form-options'>\n              <button\n                aria-label='Open Emoji Picker'\n                className='str-chat__input-emojiselect'\n                onClick={emojiPickerIsOpen ? closeEmojiPicker : openEmojiPicker}\n              >\n                <EmojiIcon />\n              </button>\n              {isUploadEnabled && (\n                <div className='str-chat__fileupload-wrapper' data-testid='fileinput'>\n                  <Tooltip>\n                    {maxFilesLeft\n                      ? t('Attach files')\n                      : t(\"You've reached the maximum number of files\")}\n                  </Tooltip>\n                  <FileUploadButton\n                    accepts={acceptedFiles}\n                    disabled={maxFilesLeft === 0}\n                    handleFiles={uploadNewFiles}\n                    multiple={multipleUploads}\n                  >\n                    <span className='str-chat__input-fileupload'>\n                      <FileUploadIcon />\n                    </span>\n                  </FileUploadButton>\n                </div>\n              )}\n            </div>\n            <div>\n              <button\n                onClick={() => {\n                  if (clearEditingState) {\n                    clearEditingState();\n                  }\n                }}\n              >\n                {t('Cancel')}\n              </button>\n              <button type='submit'>{t('Send')}</button>\n            </div>\n          </div>\n        </form>\n      </ImageDropzone>\n    </div>\n  );\n};\n","import React, { useEffect, useState } from 'react';\n\nimport { useChatContext } from '../../../context/ChatContext';\nimport { useChannelStateContext } from '../../../context/ChannelStateContext';\n\nimport type { ChannelResponse, Event } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport type CooldownTimerProps = {\n  cooldownInterval: number;\n  setCooldownRemaining: React.Dispatch<React.SetStateAction<number | undefined>>;\n};\n\nexport const CooldownTimer: React.FC<CooldownTimerProps> = (props) => {\n  const { cooldownInterval, setCooldownRemaining } = props;\n\n  const [seconds, setSeconds] = useState(cooldownInterval);\n\n  useEffect(() => {\n    const countdownInterval = setInterval(() => {\n      if (seconds > 0) {\n        setSeconds(seconds - 1);\n      } else {\n        setCooldownRemaining(0);\n      }\n    }, 1000);\n\n    return () => clearInterval(countdownInterval);\n  });\n\n  return <div>{seconds === 0 ? null : seconds}</div>;\n};\n\nconst rolesToSkip: Record<string, boolean> = {\n  admin: true,\n  channel_moderator: true,\n  moderator: true,\n};\n\nconst checkUserRoles = (globalRole: string, channelRole: string) => {\n  const skipGlobal = !!rolesToSkip[globalRole];\n  const skipChannel = !!rolesToSkip[channelRole];\n  return skipGlobal || skipChannel;\n};\n\nexport type CooldownTimerState = {\n  cooldownInterval: number;\n  setCooldownRemaining: React.Dispatch<React.SetStateAction<number | undefined>>;\n  cooldownRemaining?: number;\n};\n\nexport const useCooldownTimer = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(): CooldownTimerState => {\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('useCooldownTimer');\n  const { channel } = useChannelStateContext<At, Ch, Co, Ev, Me, Re, Us>('useCooldownTimer');\n\n  const { cooldown: cooldownInterval } = (channel.data || {}) as ChannelResponse<Ch, Co, Us>;\n\n  const [cooldownRemaining, setCooldownRemaining] = useState<number>();\n\n  const globalRole = client.user?.role || '';\n  const channelRole = channel.state.members[client.userID || '']?.role || '';\n\n  const skipCooldown = checkUserRoles(globalRole, channelRole);\n\n  useEffect(() => {\n    const handleEvent = (event: Event<At, Ch, Co, Ev, Me, Re, Us>) => {\n      if (!skipCooldown && event.user?.id === client.userID) {\n        setCooldownRemaining(cooldownInterval);\n      }\n    };\n\n    if (cooldownInterval) channel.on('message.new', handleEvent);\n    return () => channel.off('message.new', handleEvent);\n  }, [channel.id, cooldownInterval]);\n\n  return { cooldownInterval: cooldownInterval || 0, cooldownRemaining, setCooldownRemaining };\n};\n","import { useMemo } from 'react';\nimport type { NimbleEmojiIndex } from 'emoji-mart';\n\nimport { useEmojiContext } from '../../../context/EmojiContext';\n\nexport const useEmojiIndex = () => {\n  const { emojiConfig, EmojiIndex } = useEmojiContext('useEmojiIndex');\n\n  const { emojiData } = emojiConfig || {};\n\n  const emojiIndex: NimbleEmojiIndex | undefined = useMemo(() => {\n    if (EmojiIndex) {\n      // @ts-expect-error type here isn't registering the constructor type\n      return new EmojiIndex(emojiData);\n    }\n  }, [emojiData, EmojiIndex]);\n\n  return emojiIndex;\n};\n","import React, { useCallback, useEffect } from 'react';\n\nimport { checkUploadPermissions } from './utils';\n\nimport { useChannelActionContext } from '../../../context/ChannelActionContext';\nimport { useChannelStateContext } from '../../../context/ChannelStateContext';\nimport { useChatContext } from '../../../context/ChatContext';\nimport { useTranslationContext } from '../../../context/TranslationContext';\n\nimport type { SendFileAPIResponse } from 'stream-chat';\nimport type { MessageInputReducerAction, MessageInputState } from './useMessageInputState';\nimport type { MessageInputProps } from '../MessageInput';\n\nimport type {\n  CustomTrigger,\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useImageUploads = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>(\n  props: MessageInputProps<At, Ch, Co, Ev, Me, Re, Us, V>,\n  state: MessageInputState<At, Us>,\n  dispatch: React.Dispatch<MessageInputReducerAction<Us>>,\n) => {\n  const { doImageUploadRequest, errorHandler } = props;\n  const { imageUploads } = state;\n\n  const { channel } = useChannelStateContext<At, Ch, Co, Ev, Me, Re, Us>('useImageUploads');\n  const { getAppSettings } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('useImageUploads');\n  const { addNotification } = useChannelActionContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'useImageUploads',\n  );\n  const { t } = useTranslationContext('useImageUploads');\n\n  const removeImage = useCallback((id) => {\n    dispatch({ id, type: 'removeImageUpload' });\n    // TODO: cancel upload if still uploading\n  }, []);\n\n  const uploadImage = useCallback(\n    async (id) => {\n      const img = imageUploads[id];\n      if (!img) return;\n\n      const { file } = img;\n\n      if (img.state !== 'uploading') {\n        dispatch({ id, state: 'uploading', type: 'setImageUpload' });\n      }\n\n      const canUpload = await checkUploadPermissions({\n        addNotification,\n        file,\n        getAppSettings,\n        t,\n        uploadType: 'image',\n      });\n\n      if (!canUpload) return removeImage(id);\n\n      let response: SendFileAPIResponse;\n\n      try {\n        if (doImageUploadRequest) {\n          response = await doImageUploadRequest(file, channel);\n        } else {\n          response = await channel.sendImage(file as File);\n        }\n      } catch (error) {\n        const errorMessage: string =\n          typeof (error as Error).message === 'string'\n            ? (error as Error).message\n            : t('Error uploading image');\n\n        addNotification(errorMessage, 'error');\n\n        let alreadyRemoved = false;\n\n        if (!imageUploads[id]) {\n          alreadyRemoved = true;\n        } else {\n          dispatch({ id, state: 'failed', type: 'setImageUpload' });\n        }\n\n        if (!alreadyRemoved && errorHandler) {\n          // TODO: verify if the parameters passed to the error handler actually make sense\n          errorHandler(error as Error, 'upload-image', {\n            ...file,\n            id,\n          });\n        }\n\n        return;\n      }\n\n      // If doImageUploadRequest returns any falsy value, then don't create the upload preview.\n      // This is for the case if someone wants to handle failure on app level.\n      if (!response) {\n        removeImage(id);\n        return;\n      }\n\n      dispatch({\n        id,\n        state: 'finished',\n        type: 'setImageUpload',\n        url: response.file,\n      });\n    },\n    [imageUploads, channel, doImageUploadRequest, errorHandler, removeImage],\n  );\n\n  useEffect(() => {\n    if (FileReader) {\n      const upload = Object.values(imageUploads).find(\n        (imageUpload) =>\n          imageUpload.state === 'uploading' && !!imageUpload.file && !imageUpload.previewUri,\n      );\n      if (upload) {\n        const { file, id } = upload;\n        // TODO: Possibly use URL.createObjectURL instead. However, then we need\n        // to release the previews when not used anymore though.\n        const reader = new FileReader();\n        reader.onload = (event) => {\n          if (typeof event.target?.result !== 'string') return;\n          dispatch({\n            id,\n            previewUri: event.target.result,\n            type: 'setImageUpload',\n          });\n        };\n        reader.readAsDataURL((file as unknown) as Blob);\n        uploadImage(id);\n        return () => {\n          reader.onload = null;\n        };\n      }\n    }\n    return;\n  }, [imageUploads, uploadImage]);\n\n  return {\n    removeImage,\n    uploadImage,\n  };\n};\n","import { useCallback, useEffect } from 'react';\n\nimport { checkUploadPermissions } from './utils';\n\nimport { useChannelActionContext } from '../../../context/ChannelActionContext';\nimport { useChannelStateContext } from '../../../context/ChannelStateContext';\nimport { useChatContext } from '../../../context/ChatContext';\nimport { useTranslationContext } from '../../../context/TranslationContext';\n\nimport type { SendFileAPIResponse } from 'stream-chat';\nimport type { MessageInputReducerAction, MessageInputState } from './useMessageInputState';\nimport type { MessageInputProps } from '../MessageInput';\n\nimport type {\n  CustomTrigger,\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useFileUploads = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>(\n  props: MessageInputProps<At, Ch, Co, Ev, Me, Re, Us, V>,\n  state: MessageInputState<At, Us>,\n  dispatch: React.Dispatch<MessageInputReducerAction<Us>>,\n) => {\n  const { doFileUploadRequest, errorHandler } = props;\n  const { fileUploads } = state;\n\n  const { channel } = useChannelStateContext<At, Ch, Co, Ev, Me, Re, Us>('useFileUploads');\n  const { addNotification } = useChannelActionContext<At, Ch, Co, Ev, Me, Re, Us>('useFileUploads');\n  const { getAppSettings } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('useFileUploads');\n  const { t } = useTranslationContext('useFileUploads');\n\n  const uploadFile = useCallback((id) => {\n    dispatch({ id, state: 'uploading', type: 'setFileUpload' });\n  }, []);\n\n  const removeFile = useCallback((id) => {\n    // TODO: cancel upload if still uploading\n    dispatch({ id, type: 'removeFileUpload' });\n  }, []);\n\n  useEffect(() => {\n    (async () => {\n      const upload = Object.values(fileUploads).find(\n        (fileUpload) => fileUpload.state === 'uploading' && fileUpload.file,\n      );\n\n      if (!upload) return;\n\n      const { file, id } = upload;\n\n      const canUpload = await checkUploadPermissions({\n        addNotification,\n        file,\n        getAppSettings,\n        t,\n        uploadType: 'file',\n      });\n\n      if (!canUpload) return removeFile(id);\n\n      let response: SendFileAPIResponse;\n\n      try {\n        if (doFileUploadRequest) {\n          response = await doFileUploadRequest(file, channel);\n        } else {\n          response = await channel.sendFile(file as File);\n        }\n      } catch (error) {\n        const errorMessage: string =\n          typeof (error as Error).message === 'string'\n            ? (error as Error).message\n            : t('Error uploading file');\n\n        addNotification(errorMessage, 'error');\n\n        let alreadyRemoved = false;\n\n        if (!fileUploads[id]) {\n          alreadyRemoved = true;\n        } else {\n          dispatch({ id, state: 'failed', type: 'setFileUpload' });\n        }\n\n        if (!alreadyRemoved && errorHandler) {\n          // TODO: verify if the parameters passed to the error handler actually make sense\n          errorHandler(error as Error, 'upload-file', file);\n        }\n\n        return;\n      }\n\n      // If doImageUploadRequest returns any falsy value, then don't create the upload preview.\n      // This is for the case if someone wants to handle failure on app level.\n      if (!response) {\n        removeFile(id);\n        return;\n      }\n\n      dispatch({\n        id,\n        state: 'finished',\n        type: 'setFileUpload',\n        url: response.file,\n      });\n    })();\n  }, [fileUploads, channel, doFileUploadRequest, errorHandler, removeFile]);\n\n  return {\n    removeFile,\n    uploadFile,\n  };\n};\n","import { useCallback } from 'react';\n\nimport { useImageUploads } from './useImageUploads';\nimport { useFileUploads } from './useFileUploads';\n\nimport { useChannelStateContext } from '../../../context/ChannelStateContext';\nimport { generateRandomId } from '../../../utils';\n\nimport type { FileLike } from 'react-file-utils';\n\nimport type { MessageInputProps } from '../MessageInput';\nimport type { MessageInputReducerAction, MessageInputState } from './useMessageInputState';\n\nimport type {\n  CustomTrigger,\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nconst apiMaxNumberOfFiles = 10;\n\nexport const useAttachments = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>(\n  props: MessageInputProps<At, Ch, Co, Ev, Me, Re, Us, V>,\n  state: MessageInputState<At, Us>,\n  dispatch: React.Dispatch<MessageInputReducerAction<Us>>,\n  textareaRef: React.MutableRefObject<HTMLTextAreaElement | undefined>,\n) => {\n  const { noFiles } = props;\n  const { fileUploads, imageUploads } = state;\n\n  const { maxNumberOfFiles, multipleUploads } = useChannelStateContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'useAttachments',\n  );\n\n  const { removeFile, uploadFile } = useFileUploads<At, Ch, Co, Ev, Me, Re, Us, V>(\n    props,\n    state,\n    dispatch,\n  );\n\n  const { removeImage, uploadImage } = useImageUploads<At, Ch, Co, Ev, Me, Re, Us, V>(\n    props,\n    state,\n    dispatch,\n  );\n\n  // Number of files that the user can still add. Should never be more than the amount allowed by the API.\n  // If multipleUploads is false, we only want to allow a single upload.\n  const maxFilesAllowed = !multipleUploads ? 1 : maxNumberOfFiles || apiMaxNumberOfFiles;\n\n  const numberOfImages = Object.values(imageUploads).filter(({ state }) => state !== 'failed')\n    .length;\n  const numberOfFiles = Object.values(fileUploads).filter(({ state }) => state !== 'failed').length;\n  const numberOfUploads = numberOfImages + numberOfFiles;\n\n  const maxFilesLeft = maxFilesAllowed - numberOfUploads;\n\n  const uploadNewFiles = useCallback(\n    (files: FileList | File[] | FileLike[]) => {\n      Array.from(files)\n        .slice(0, maxFilesLeft)\n        .forEach((file) => {\n          const id = generateRandomId();\n\n          if (\n            file.type.startsWith('image/') &&\n            !file.type.endsWith('.photoshop') // photoshop files begin with 'image/'\n          ) {\n            dispatch({ file, id, state: 'uploading', type: 'setImageUpload' });\n          } else if (file instanceof File && !noFiles) {\n            dispatch({ file, id, state: 'uploading', type: 'setFileUpload' });\n          }\n        });\n\n      textareaRef?.current?.focus();\n    },\n    [maxFilesLeft, noFiles],\n  );\n\n  return {\n    maxFilesLeft,\n    numberOfUploads,\n    removeFile,\n    removeImage,\n    uploadFile,\n    uploadImage,\n    uploadNewFiles,\n  };\n};\n","import { useCallback, useEffect, useRef } from 'react';\nimport { logChatPromiseExecution } from 'stream-chat';\nimport type { MessageInputReducerAction, MessageInputState } from './useMessageInputState';\nimport type { MessageInputProps } from '../MessageInput';\nimport { useChannelStateContext } from '../../../context/ChannelStateContext';\n\nimport type {\n  CustomTrigger,\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useMessageInputText = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>(\n  props: MessageInputProps<At, Ch, Co, Ev, Me, Re, Us, V>,\n  state: MessageInputState<At, Us>,\n  dispatch: React.Dispatch<MessageInputReducerAction<Us>>,\n) => {\n  const { channel } = useChannelStateContext<At, Ch, Co, Ev, Me, Re, Us>('useMessageInputText');\n  const { additionalTextareaProps, focus, parent, publishTypingEvent = true } = props;\n  const { text } = state;\n\n  const textareaRef = useRef<HTMLTextAreaElement>();\n\n  // Focus\n  useEffect(() => {\n    if (focus && textareaRef.current) {\n      textareaRef.current.focus();\n    }\n  }, [focus]);\n\n  // Text + cursor position\n  const newCursorPosition = useRef<number>();\n\n  const insertText = useCallback(\n    (textToInsert: string) => {\n      const { maxLength } = additionalTextareaProps || {};\n\n      if (!textareaRef.current) {\n        dispatch({\n          getNewText: (text) => {\n            const updatedText = text + textToInsert;\n            if (maxLength && updatedText.length > maxLength) {\n              return updatedText.slice(0, maxLength);\n            }\n            return updatedText;\n          },\n          type: 'setText',\n        });\n        return;\n      }\n\n      const { selectionEnd, selectionStart } = textareaRef.current;\n      newCursorPosition.current = selectionStart + textToInsert.length;\n\n      dispatch({\n        getNewText: (prevText) => {\n          const updatedText =\n            prevText.slice(0, selectionStart) + textToInsert + prevText.slice(selectionEnd);\n\n          if (maxLength && updatedText.length > maxLength) {\n            return updatedText.slice(0, maxLength);\n          }\n\n          return updatedText;\n        },\n        type: 'setText',\n      });\n    },\n    [additionalTextareaProps, newCursorPosition, textareaRef],\n  );\n\n  useEffect(() => {\n    const textareaElement = textareaRef.current;\n    if (textareaElement && newCursorPosition.current !== undefined) {\n      textareaElement.selectionStart = newCursorPosition.current;\n      textareaElement.selectionEnd = newCursorPosition.current;\n      newCursorPosition.current = undefined;\n    }\n  }, [text, newCursorPosition]);\n\n  const handleChange: React.ChangeEventHandler<HTMLTextAreaElement> = useCallback(\n    (event) => {\n      event.preventDefault();\n      if (!event || !event.target) {\n        return;\n      }\n\n      const newText = event.target.value;\n      dispatch({\n        getNewText: () => newText,\n        type: 'setText',\n      });\n      if (publishTypingEvent && newText && channel) {\n        logChatPromiseExecution(channel.keystroke(parent?.id), 'start typing event');\n      }\n    },\n    [channel, parent, publishTypingEvent],\n  );\n\n  return {\n    handleChange,\n    insertText,\n    textareaRef,\n  };\n};\n","import { useCallback, useEffect, useRef } from 'react';\n\nimport type { MessageInputReducerAction, MessageInputState } from './useMessageInputState';\nimport type { BaseEmoji, EmojiData } from 'emoji-mart';\n\nimport type { DefaultAttachmentType, DefaultUserType } from '../../../types/types';\n\nexport const useEmojiPicker = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  state: MessageInputState<At, Us>,\n  dispatch: React.Dispatch<MessageInputReducerAction<Us>>,\n  insertText: (textToInsert: string) => void,\n  textareaRef: React.MutableRefObject<HTMLTextAreaElement | undefined>,\n  closeEmojiPickerOnClick?: boolean,\n) => {\n  const emojiPickerRef = useRef<HTMLDivElement>(null);\n\n  const closeEmojiPicker = useCallback(\n    (event: MouseEvent) => {\n      event.preventDefault();\n\n      if (emojiPickerRef.current && !emojiPickerRef.current.contains(event.target as Node)) {\n        dispatch({\n          type: 'setEmojiPickerIsOpen',\n          value: false,\n        });\n      }\n    },\n    [emojiPickerRef],\n  );\n\n  const openEmojiPicker: React.MouseEventHandler<HTMLButtonElement> = useCallback((event) => {\n    event.preventDefault();\n\n    dispatch({\n      type: 'setEmojiPickerIsOpen',\n      value: true,\n    });\n\n    // Prevent event from bubbling to document, so the close handler is never called for this event\n    event.stopPropagation();\n  }, []);\n\n  const handleEmojiKeyDown: React.KeyboardEventHandler<HTMLButtonElement> = (event) => {\n    if (event.key === ' ' || event.key === 'Enter' || event.key === 'Spacebar') {\n      event.preventDefault();\n      /**\n       * TODO: fix the below at some point because this type casting is wrong\n       * and just forced to not have warnings currently with the unknown casting\n       */\n      openEmojiPicker((event as unknown) as React.MouseEvent<HTMLButtonElement, MouseEvent>);\n    }\n  };\n\n  const handleEmojiEscape = (event: KeyboardEvent) => {\n    if (event.key === 'Escape') {\n      dispatch({\n        type: 'setEmojiPickerIsOpen',\n        value: false,\n      });\n    }\n  };\n\n  useEffect(() => {\n    if (state.emojiPickerIsOpen) {\n      document.addEventListener('click', closeEmojiPicker, false);\n      document.addEventListener('keydown', handleEmojiEscape);\n    }\n    return () => {\n      document.removeEventListener('click', closeEmojiPicker, false);\n      document.removeEventListener('keydown', handleEmojiEscape);\n    };\n  }, [closeEmojiPicker, state.emojiPickerIsOpen]);\n\n  const onSelectEmoji = useCallback(\n    (emoji: EmojiData) => {\n      insertText((emoji as BaseEmoji).native);\n      if (closeEmojiPickerOnClick) {\n        dispatch({\n          type: 'setEmojiPickerIsOpen',\n          value: false,\n        });\n      }\n\n      textareaRef?.current?.focus();\n    },\n    [insertText],\n  );\n\n  return {\n    closeEmojiPicker,\n    emojiPickerRef,\n    handleEmojiKeyDown,\n    onSelectEmoji,\n    openEmojiPicker,\n  };\n};\n","import { useChannelActionContext } from '../../../context/ChannelActionContext';\nimport { useChannelStateContext } from '../../../context/ChannelStateContext';\nimport { useTranslationContext } from '../../../context/TranslationContext';\n\nimport type { Attachment, Message, UpdatedMessage } from 'stream-chat';\n\nimport type { MessageInputReducerAction, MessageInputState } from './useMessageInputState';\nimport type { MessageInputProps } from '../MessageInput';\n\nimport type {\n  CustomTrigger,\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nconst getAttachmentTypeFromMime = (mime: string) => {\n  if (mime.includes('video/')) return 'video';\n  if (mime.includes('audio/')) return 'audio';\n  return 'file';\n};\n\nexport const useSubmitHandler = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>(\n  props: MessageInputProps<At, Ch, Co, Ev, Me, Re, Us, V>,\n  state: MessageInputState<At, Us>,\n  dispatch: React.Dispatch<MessageInputReducerAction<Us>>,\n  numberOfUploads: number,\n) => {\n  const { clearEditingState, message, overrideSubmitHandler, parent, publishTypingEvent } = props;\n\n  const {\n    attachments,\n    fileOrder,\n    fileUploads,\n    imageOrder,\n    imageUploads,\n    mentioned_users,\n    text,\n  } = state;\n\n  const { channel } = useChannelStateContext<At, Ch, Co, Ev, Me, Re, Us>('useSubmitHandler');\n  const { addNotification, editMessage, sendMessage } = useChannelActionContext<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us\n  >('useSubmitHandler');\n  const { t } = useTranslationContext('useSubmitHandler');\n\n  const getAttachmentsFromUploads = () => {\n    const imageAttachments = imageOrder\n      .map((id) => imageUploads[id])\n      .filter((upload) => upload.state !== 'failed')\n      .filter((\n        { id, url },\n        _,\n        self, // filter out duplicates based on url\n      ) => self.every((upload) => upload.id === id || upload.url !== url))\n      .map(\n        (upload) =>\n          ({\n            fallback: upload.file.name,\n            image_url: upload.url,\n            type: 'image',\n          } as Attachment<At>),\n      );\n\n    const fileAttachments = fileOrder\n      .map((id) => fileUploads[id])\n      .filter((upload) => upload.state !== 'failed')\n      .map(\n        (upload) =>\n          ({\n            asset_url: upload.url,\n            file_size: upload.file.size,\n            mime_type: upload.file.type,\n            title: upload.file.name,\n            type: getAttachmentTypeFromMime(upload.file.type || ''),\n          } as Attachment<At>),\n      );\n\n    return [\n      ...attachments, // from state\n      ...imageAttachments,\n      ...fileAttachments,\n    ];\n  };\n\n  const handleSubmit = async (\n    event: React.BaseSyntheticEvent,\n    customMessageData?: Partial<Message<At, Me, Us>>,\n  ) => {\n    event.preventDefault();\n\n    const trimmedMessage = text.trim();\n    const isEmptyMessage =\n      trimmedMessage === '' ||\n      trimmedMessage === '>' ||\n      trimmedMessage === '``````' ||\n      trimmedMessage === '``' ||\n      trimmedMessage === '**' ||\n      trimmedMessage === '____' ||\n      trimmedMessage === '__' ||\n      trimmedMessage === '****';\n\n    if (isEmptyMessage && numberOfUploads === 0) return;\n\n    // the channel component handles the actual sending of the message\n    const someAttachmentsUploading =\n      Object.values(imageUploads).some((upload) => upload.state === 'uploading') ||\n      Object.values(fileUploads).some((upload) => upload.state === 'uploading');\n\n    if (someAttachmentsUploading) {\n      return addNotification(t('Wait until all attachments have uploaded'), 'error');\n    }\n\n    const newAttachments = getAttachmentsFromUploads();\n\n    // Instead of checking if a user is still mentioned every time the text changes,\n    // just filter out non-mentioned users before submit, which is cheaper\n    // and allows users to easily undo any accidental deletion\n    const actualMentionedUsers = Array.from(\n      new Set(\n        mentioned_users.filter(\n          ({ id, name }) => text.includes(`@${id}`) || text.includes(`@${name}`),\n        ),\n      ),\n    );\n\n    const updatedMessage = {\n      attachments: newAttachments,\n      mentioned_users: actualMentionedUsers,\n      text,\n    };\n\n    if (message) {\n      delete message.i18n;\n\n      try {\n        await editMessage(({\n          ...message,\n          ...updatedMessage,\n        } as unknown) as UpdatedMessage<At, Ch, Co, Me, Re, Us>);\n\n        if (clearEditingState) clearEditingState();\n        dispatch({ type: 'clear' });\n      } catch (err) {\n        addNotification(t('Edit message request failed'), 'error');\n      }\n    } else {\n      try {\n        dispatch({ type: 'clear' });\n\n        if (overrideSubmitHandler) {\n          overrideSubmitHandler(\n            {\n              ...updatedMessage,\n              parent,\n            },\n            channel.cid,\n          );\n        } else {\n          await sendMessage(\n            {\n              ...updatedMessage,\n              parent,\n            },\n            customMessageData,\n          );\n        }\n\n        if (publishTypingEvent) await channel.stopTyping();\n      } catch (err) {\n        dispatch({\n          getNewText: () => text,\n          type: 'setText',\n        });\n\n        if (actualMentionedUsers.length) {\n          actualMentionedUsers.forEach((user) => {\n            dispatch({ type: 'addMentionedUser', user });\n          });\n        }\n\n        addNotification(t('Send message request failed'), 'error');\n      }\n    }\n  };\n\n  return { handleSubmit };\n};\n","import { useCallback } from 'react';\nimport { dataTransferItemsHaveFiles, dataTransferItemsToFiles, FileLike } from 'react-file-utils';\n\nexport const usePasteHandler = (\n  uploadNewFiles: (files: FileList | FileLike[] | File[]) => void,\n  insertText: (textToInsert: string) => void,\n) => {\n  const onPaste = useCallback(\n    (clipboardEvent: React.ClipboardEvent<HTMLTextAreaElement>) => {\n      (async (event) => {\n        // TODO: Move this handler to package with ImageDropzone\n        const { items } = event.clipboardData;\n        if (!dataTransferItemsHaveFiles(Array.from(items))) return;\n\n        event.preventDefault();\n        // Get a promise for the plain text in case no files are\n        // found. This needs to be done here because chrome cleans\n        // up the DataTransferItems after resolving of a promise.\n        let plainTextPromise: Promise<string> | undefined = undefined;\n        for (let i = 0; i < items.length; i++) {\n          const item = items[i];\n          if (item.kind === 'string' && item.type === 'text/plain') {\n            plainTextPromise = new Promise((resolve) => {\n              item.getAsString((string) => {\n                resolve(string);\n              });\n            });\n            break;\n          }\n        }\n\n        const fileLikes = await dataTransferItemsToFiles(Array.from(items));\n        if (fileLikes.length) {\n          uploadNewFiles(fileLikes);\n          return;\n        }\n\n        // fallback to regular text paste\n        if (plainTextPromise) {\n          const pastedText = await plainTextPromise;\n          insertText(pastedText);\n        }\n      })(clipboardEvent);\n    },\n    [insertText, uploadNewFiles],\n  );\n\n  return { onPaste };\n};\n","import React, { Reducer, useCallback, useReducer, useState } from 'react';\n\nimport { StreamMessage, useChannelStateContext } from '../../../context/ChannelStateContext';\nimport { generateRandomId } from '../../../utils';\n\nimport { useEmojiIndex } from './useEmojiIndex';\nimport { useAttachments } from './useAttachments';\nimport { useMessageInputText } from './useMessageInputText';\nimport { useEmojiPicker } from './useEmojiPicker';\nimport { useSubmitHandler } from './useSubmitHandler';\nimport { usePasteHandler } from './usePasteHandler';\n\nimport type { EmojiData, NimbleEmojiIndex } from 'emoji-mart';\nimport type { FileLike } from 'react-file-utils';\nimport type { Attachment, Message, UserResponse } from 'stream-chat';\n\nimport type { MessageInputProps } from '../MessageInput';\n\nimport type {\n  CustomTrigger,\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport type FileUpload = {\n  file: {\n    name: string;\n    lastModified?: number;\n    lastModifiedDate?: Date;\n    size?: number;\n    type?: string;\n    uri?: string;\n  };\n  id: string;\n  state: 'finished' | 'failed' | 'uploading';\n  url?: string;\n};\n\nexport type ImageUpload = {\n  file: {\n    name: string;\n    height?: number;\n    lastModified?: number;\n    lastModifiedDate?: Date;\n    size?: number;\n    type?: string;\n    uri?: string;\n    width?: number;\n  };\n  id: string;\n  state: 'finished' | 'failed' | 'uploading';\n  previewUri?: string;\n  url?: string;\n};\n\nexport type MessageInputState<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  attachments: Attachment<At>[];\n  emojiPickerIsOpen: boolean;\n  fileOrder: string[];\n  fileUploads: { [id: string]: FileUpload };\n  imageOrder: string[];\n  imageUploads: { [id: string]: ImageUpload };\n  mentioned_users: UserResponse<Us>[];\n  setText: (text: string) => void;\n  text: string;\n};\n\ntype SetEmojiPickerIsOpenAction = {\n  type: 'setEmojiPickerIsOpen';\n  value: boolean;\n};\n\ntype SetTextAction = {\n  getNewText: (currentStateText: string) => string;\n  type: 'setText';\n};\n\ntype ClearAction = {\n  type: 'clear';\n};\n\ntype SetImageUploadAction = {\n  id: string;\n  type: 'setImageUpload';\n  file?: File | FileLike;\n  previewUri?: string;\n  state?: string;\n  url?: string;\n};\n\ntype SetFileUploadAction = {\n  id: string;\n  type: 'setFileUpload';\n  file?: File;\n  state?: string;\n  url?: string;\n};\n\ntype RemoveImageUploadAction = {\n  id: string;\n  type: 'removeImageUpload';\n};\n\ntype RemoveFileUploadAction = {\n  id: string;\n  type: 'removeFileUpload';\n};\n\ntype AddMentionedUserAction<Us extends DefaultUserType<Us> = DefaultUserType> = {\n  type: 'addMentionedUser';\n  user: UserResponse<Us>;\n};\n\nexport type MessageInputReducerAction<Us extends DefaultUserType<Us> = DefaultUserType> =\n  | SetEmojiPickerIsOpenAction\n  | SetTextAction\n  | ClearAction\n  | SetImageUploadAction\n  | SetFileUploadAction\n  | RemoveImageUploadAction\n  | RemoveFileUploadAction\n  | AddMentionedUserAction<Us>;\n\nexport type MessageInputHookProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  closeEmojiPicker: React.MouseEventHandler<HTMLElement>;\n  emojiPickerRef: React.MutableRefObject<HTMLDivElement | null>;\n  handleChange: React.ChangeEventHandler<HTMLTextAreaElement>;\n  handleEmojiKeyDown: React.KeyboardEventHandler<HTMLSpanElement>;\n  handleSubmit: (\n    event: React.BaseSyntheticEvent,\n    customMessageData?: Partial<Message<At, Me, Us>>,\n  ) => void;\n  insertText: (textToInsert: string) => void;\n  isUploadEnabled: boolean;\n  maxFilesLeft: number;\n  numberOfUploads: number;\n  onPaste: (event: React.ClipboardEvent<HTMLTextAreaElement>) => void;\n  onSelectEmoji: (emoji: EmojiData) => void;\n  onSelectUser: (item: UserResponse<Us>) => void;\n  openEmojiPicker: React.MouseEventHandler<HTMLSpanElement>;\n  removeFile: (id: string) => void;\n  removeImage: (id: string) => void;\n  textareaRef: React.MutableRefObject<HTMLTextAreaElement | undefined>;\n  uploadFile: (id: string) => void;\n  uploadImage: (id: string) => void;\n  uploadNewFiles: (files: FileList | File[]) => void;\n  emojiIndex?: NimbleEmojiIndex;\n};\nconst emptyFileUploads: Record<string, FileUpload> = {};\nconst emptyImageUploads: Record<string, ImageUpload> = {};\n\n/**\n * Initializes the state. Empty if the message prop is falsy.\n */\nconst initState = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  message?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n): MessageInputState<At, Us> => {\n  if (!message) {\n    return {\n      attachments: [],\n      emojiPickerIsOpen: false,\n      fileOrder: [],\n      fileUploads: { ...emptyFileUploads },\n      imageOrder: [],\n      imageUploads: { ...emptyImageUploads },\n      mentioned_users: [],\n      setText: () => null,\n      text: '',\n    };\n  }\n\n  // if message prop is defined, get image uploads, file uploads, text, etc.\n  const imageUploads =\n    message.attachments\n      ?.filter(({ type }) => type === 'image')\n      .reduce((acc, attachment) => {\n        const id = generateRandomId();\n        acc[id] = {\n          file: {\n            name: attachment.fallback || '',\n          },\n          id,\n          state: 'finished',\n          url: attachment.image_url,\n        };\n        return acc;\n      }, {} as Record<string, ImageUpload>) || {};\n\n  const imageOrder = Object.keys(imageUploads);\n\n  const fileUploads =\n    message.attachments\n      ?.filter(({ type }) => type === 'file')\n      .reduce((acc, attachment) => {\n        const id = generateRandomId();\n        acc[id] = {\n          file: {\n            name: attachment.title || '',\n            size: attachment.file_size,\n            type: attachment.mime_type,\n          },\n          id,\n          state: 'finished',\n          url: attachment.asset_url,\n        };\n        return acc;\n      }, {} as Record<string, FileUpload>) || {};\n\n  const fileOrder = Object.keys(fileUploads);\n\n  const attachments =\n    message.attachments?.filter(({ type }) => type !== 'file' && type !== 'image') || [];\n\n  const mentioned_users = message.mentioned_users || [];\n\n  return {\n    attachments,\n    emojiPickerIsOpen: false,\n    fileOrder,\n    fileUploads,\n    imageOrder,\n    imageUploads,\n    mentioned_users,\n    setText: () => null,\n    text: message.text || '',\n  };\n};\n\n/**\n * MessageInput state reducer\n */\nconst messageInputReducer = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  state: MessageInputState<At, Us>,\n  action: MessageInputReducerAction<Us>,\n) => {\n  switch (action.type) {\n    case 'setEmojiPickerIsOpen':\n      return { ...state, emojiPickerIsOpen: action.value };\n\n    case 'setText':\n      return { ...state, text: action.getNewText(state.text) };\n\n    case 'clear':\n      return {\n        attachments: [],\n        emojiPickerIsOpen: false,\n        fileOrder: [],\n        fileUploads: { ...emptyFileUploads },\n        imageOrder: [],\n        imageUploads: { ...emptyImageUploads },\n        mentioned_users: [],\n        text: '',\n      };\n\n    case 'setImageUpload': {\n      const imageAlreadyExists = state.imageUploads[action.id];\n      if (!imageAlreadyExists && !action.file) return state;\n      const imageOrder = imageAlreadyExists ? state.imageOrder : state.imageOrder.concat(action.id);\n      const newUploadFields = { ...action } as Partial<SetImageUploadAction>;\n      delete newUploadFields.type;\n      return {\n        ...state,\n        imageOrder,\n        imageUploads: {\n          ...state.imageUploads,\n          [action.id]: { ...state.imageUploads[action.id], ...newUploadFields },\n        },\n      };\n    }\n\n    case 'setFileUpload': {\n      const fileAlreadyExists = state.fileUploads[action.id];\n      if (!fileAlreadyExists && !action.file) return state;\n      const fileOrder = fileAlreadyExists ? state.fileOrder : state.fileOrder.concat(action.id);\n      const newUploadFields = { ...action } as Partial<SetFileUploadAction>;\n      delete newUploadFields.type;\n      return {\n        ...state,\n        fileOrder,\n        fileUploads: {\n          ...state.fileUploads,\n          [action.id]: { ...state.fileUploads[action.id], ...newUploadFields },\n        },\n      };\n    }\n\n    case 'removeImageUpload': {\n      if (!state.imageUploads[action.id]) return state; // cannot remove anything\n      const newImageUploads = { ...state.imageUploads };\n      delete newImageUploads[action.id];\n      return {\n        ...state,\n        imageOrder: state.imageOrder.filter((_id) => _id !== action.id),\n        imageUploads: newImageUploads,\n      };\n    }\n\n    case 'removeFileUpload': {\n      if (!state.fileUploads[action.id]) return state; // cannot remove anything\n      const newFileUploads = { ...state.fileUploads };\n      delete newFileUploads[action.id];\n      return {\n        ...state,\n        fileOrder: state.fileOrder.filter((_id) => _id !== action.id),\n        fileUploads: newFileUploads,\n      };\n    }\n\n    case 'addMentionedUser':\n      return {\n        ...state,\n        mentioned_users: state.mentioned_users.concat(action.user),\n      };\n\n    default:\n      return state;\n  }\n};\n\nexport type CommandsListState = {\n  closeCommandsList: () => void;\n  openCommandsList: () => void;\n  showCommandsList: boolean;\n};\n\nexport type MentionsListState = {\n  closeMentionsList: () => void;\n  openMentionsList: () => void;\n  showMentionsList: boolean;\n};\n\n/**\n * hook for MessageInput state\n */\nexport const useMessageInputState = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>(\n  props: MessageInputProps<At, Ch, Co, Ev, Me, Re, Us, V>,\n): MessageInputState<At, Us> &\n  MessageInputHookProps<At, Me, Us> &\n  CommandsListState &\n  MentionsListState => {\n  const { closeEmojiPickerOnClick, message } = props;\n\n  const { channelCapabilities = {}, channelConfig } = useChannelStateContext<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us\n  >('useMessageInputState');\n\n  const [state, dispatch] = useReducer(\n    messageInputReducer as Reducer<MessageInputState<At, Us>, MessageInputReducerAction<Us>>,\n    message,\n    initState,\n  );\n\n  const { handleChange, insertText, textareaRef } = useMessageInputText<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us,\n    V\n  >(props, state, dispatch);\n\n  const [showCommandsList, setShowCommandsList] = useState(false);\n  const [showMentionsList, setShowMentionsList] = useState(false);\n\n  const openCommandsList = () => {\n    dispatch({\n      getNewText: () => '/',\n      type: 'setText',\n    });\n    setShowCommandsList(true);\n  };\n\n  const closeCommandsList = () => setShowCommandsList(false);\n\n  const openMentionsList = () => {\n    dispatch({\n      getNewText: (currentText) => currentText + '@',\n      type: 'setText',\n    });\n    setShowMentionsList(true);\n  };\n\n  const closeMentionsList = () => setShowMentionsList(false);\n\n  const {\n    closeEmojiPicker,\n    emojiPickerRef,\n    handleEmojiKeyDown,\n    onSelectEmoji,\n    openEmojiPicker,\n  } = useEmojiPicker<At, Us>(state, dispatch, insertText, textareaRef, closeEmojiPickerOnClick);\n\n  const {\n    maxFilesLeft,\n    numberOfUploads,\n    removeFile,\n    removeImage,\n    uploadFile,\n    uploadImage,\n    uploadNewFiles,\n  } = useAttachments<At, Ch, Co, Ev, Me, Re, Us, V>(props, state, dispatch, textareaRef);\n\n  const { handleSubmit } = useSubmitHandler<At, Ch, Co, Ev, Me, Re, Us, V>(\n    props,\n    state,\n    dispatch,\n    numberOfUploads,\n  );\n\n  const { onPaste } = usePasteHandler(uploadNewFiles, insertText);\n\n  const isUploadEnabled =\n    channelConfig?.uploads !== false && channelCapabilities['upload-file'] !== false;\n\n  const onSelectUser = useCallback((item: UserResponse<Us>) => {\n    dispatch({ type: 'addMentionedUser', user: item });\n  }, []);\n\n  const setText = useCallback((text: string) => {\n    dispatch({ getNewText: () => text, type: 'setText' });\n  }, []);\n\n  return {\n    ...state,\n    closeCommandsList,\n    /**\n     * TODO: fix the below at some point because this type casting is wrong\n     * and just forced to not have warnings currently with the unknown casting\n     */\n    closeEmojiPicker: (closeEmojiPicker as unknown) as React.MouseEventHandler<HTMLSpanElement>,\n    closeMentionsList,\n    emojiIndex: useEmojiIndex(),\n    emojiPickerRef,\n    handleChange,\n    handleEmojiKeyDown,\n    handleSubmit,\n    insertText,\n    isUploadEnabled,\n    maxFilesLeft,\n    numberOfUploads,\n    onPaste,\n    onSelectEmoji,\n    onSelectUser,\n    openCommandsList,\n    openEmojiPicker,\n    openMentionsList,\n    removeFile,\n    removeImage,\n    setText,\n    showCommandsList,\n    showMentionsList,\n    textareaRef,\n    uploadFile,\n    uploadImage,\n    uploadNewFiles,\n  };\n};\n","import React from 'react';\n\nimport { Avatar as DefaultAvatar } from '../Avatar';\n\nimport { useChannelActionContext } from '../../context/ChannelActionContext';\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\n\nimport type { TranslationLanguages } from 'stream-chat';\n\nimport type { StreamMessage } from '../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nconst QuotedMessagePreviewHeader = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>() => {\n  const { setQuotedMessage } = useChannelActionContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'QuotedMessagePreview',\n  );\n  const { t } = useTranslationContext('QuotedMessagePreview');\n\n  return (\n    <div className='quoted-message-preview-header'>\n      <div>{t('Reply to Message')}</div>\n      <button\n        aria-label='Cancel Reply'\n        className='str-chat__square-button'\n        onClick={() => setQuotedMessage(undefined)}\n      >\n        <svg height='10' width='10' xmlns='http://www.w3.org/2000/svg'>\n          <path\n            d='M9.916 1.027L8.973.084 5 4.058 1.027.084l-.943.943L4.058 5 .084 8.973l.943.943L5 5.942l3.973 3.974.943-.943L5.942 5z'\n            fillRule='evenodd'\n          />\n        </svg>\n      </button>\n    </div>\n  );\n};\n\nexport type QuotedMessagePreviewProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  quotedMessage: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>;\n};\n\nexport const QuotedMessagePreview = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: QuotedMessagePreviewProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const { quotedMessage } = props;\n\n  const { Attachment, Avatar: ContextAvatar } = useComponentContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'QuotedMessagePreview',\n  );\n  const { userLanguage } = useTranslationContext('QuotedMessagePreview');\n\n  const Avatar = ContextAvatar || DefaultAvatar;\n\n  const quotedMessageText =\n    quotedMessage.i18n?.[`${userLanguage}_text` as `${TranslationLanguages}_text`] ||\n    quotedMessage.text;\n\n  // @ts-expect-error\n  const quotedMessageAttachment = quotedMessage.attachments.length\n    ? // @ts-expect-error\n      quotedMessage.attachments[0]\n    : null;\n\n  if (!quotedMessageText && !quotedMessageAttachment) return null;\n\n  return (\n    <div className='quoted-message-preview'>\n      <QuotedMessagePreviewHeader />\n      <div className='quoted-message-preview-content'>\n        {quotedMessage.user && (\n          <Avatar\n            image={quotedMessage.user.image}\n            name={quotedMessage.user.name || quotedMessage.user.id}\n            size={20}\n            user={quotedMessage.user}\n          />\n        )}\n        <div className='quoted-message-preview-content-inner'>\n          {quotedMessageAttachment && <Attachment attachments={[quotedMessageAttachment]} />}\n          <div>{quotedMessageText}</div>\n        </div>\n      </div>\n    </div>\n  );\n};\n","import React from 'react';\nimport { FileUploadButton, ImageDropzone } from 'react-file-utils';\n\nimport { EmojiPicker } from './EmojiPicker';\nimport { CooldownTimer as DefaultCooldownTimer } from './hooks/useCooldownTimer';\nimport {\n  EmojiIconLarge as DefaultEmojiIcon,\n  FileUploadIconFlat as DefaultFileUploadIcon,\n  SendButton as DefaultSendButton,\n} from './icons';\nimport { QuotedMessagePreview as DefaultQuotedMessagePreview } from './QuotedMessagePreview';\nimport { UploadsPreview } from './UploadsPreview';\n\nimport { ChatAutoComplete } from '../ChatAutoComplete/ChatAutoComplete';\nimport { Tooltip } from '../Tooltip/Tooltip';\n\nimport { useChannelStateContext } from '../../context/ChannelStateContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\nimport { useMessageInputContext } from '../../context/MessageInputContext';\nimport { useComponentContext } from '../../context/ComponentContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport const MessageInputFlat = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>() => {\n  const { acceptedFiles, multipleUploads, quotedMessage } = useChannelStateContext<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us\n  >('MessageInputFlat');\n  const { t } = useTranslationContext('MessageInputFlat');\n\n  const {\n    closeEmojiPicker,\n    cooldownInterval,\n    cooldownRemaining,\n    emojiPickerIsOpen,\n    handleSubmit,\n    isUploadEnabled,\n    maxFilesLeft,\n    openEmojiPicker,\n    setCooldownRemaining,\n    uploadNewFiles,\n  } = useMessageInputContext<At, Ch, Co, Ev, Me, Re, Us>('MessageInputFlat');\n\n  const {\n    CooldownTimer = DefaultCooldownTimer,\n    EmojiIcon = DefaultEmojiIcon,\n    FileUploadIcon = DefaultFileUploadIcon,\n    QuotedMessagePreview = DefaultQuotedMessagePreview,\n    SendButton = DefaultSendButton,\n  } = useComponentContext<At, Ch, Co, Ev, Me, Re, Us>('MessageInputFlat');\n\n  return (\n    <div\n      className={`str-chat__input-flat ${\n        SendButton ? 'str-chat__input-flat--send-button-active' : null\n      } ${quotedMessage && !quotedMessage.parent_id ? 'str-chat__input-flat-quoted' : null}`}\n    >\n      <ImageDropzone\n        accept={acceptedFiles}\n        disabled={!isUploadEnabled || maxFilesLeft === 0 || !!cooldownRemaining}\n        handleFiles={uploadNewFiles}\n        maxNumberOfFiles={maxFilesLeft}\n        multiple={multipleUploads}\n      >\n        {quotedMessage && !quotedMessage.parent_id && (\n          <QuotedMessagePreview quotedMessage={quotedMessage} />\n        )}\n        <div className='str-chat__input-flat-wrapper'>\n          <div className='str-chat__input-flat--textarea-wrapper'>\n            {isUploadEnabled && <UploadsPreview />}\n            <div className='str-chat__emojiselect-wrapper'>\n              <Tooltip>\n                {emojiPickerIsOpen ? t('Close emoji picker') : t('Open emoji picker')}\n              </Tooltip>\n              <button\n                aria-label='Emoji picker'\n                className='str-chat__input-flat-emojiselect'\n                onClick={emojiPickerIsOpen ? closeEmojiPicker : openEmojiPicker}\n              >\n                {cooldownRemaining ? (\n                  <div className='str-chat__input-flat-cooldown'>\n                    <CooldownTimer\n                      cooldownInterval={cooldownInterval}\n                      setCooldownRemaining={setCooldownRemaining}\n                    />\n                  </div>\n                ) : (\n                  <EmojiIcon />\n                )}\n              </button>\n            </div>\n            <EmojiPicker />\n            <ChatAutoComplete />\n            {isUploadEnabled && !cooldownRemaining && (\n              <div className='str-chat__fileupload-wrapper' data-testid='fileinput'>\n                <Tooltip>\n                  {maxFilesLeft\n                    ? t('Attach files')\n                    : t(\"You've reached the maximum number of files\")}\n                </Tooltip>\n                <FileUploadButton\n                  accepts={acceptedFiles}\n                  disabled={maxFilesLeft === 0}\n                  handleFiles={uploadNewFiles}\n                  multiple={multipleUploads}\n                >\n                  <span className='str-chat__input-flat-fileupload'>\n                    <FileUploadIcon />\n                  </span>\n                </FileUploadButton>\n              </div>\n            )}\n          </div>\n          {!cooldownRemaining && <SendButton sendMessage={handleSubmit} />}\n        </div>\n      </ImageDropzone>\n    </div>\n  );\n};\n","import { useMemo } from 'react';\n\nimport type { MessageInputContextValue } from '../../../context/MessageInputContext';\nimport type {\n  CustomTrigger,\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useCreateMessageInputContext = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>(\n  value: MessageInputContextValue<At, Ch, Co, Ev, Me, Re, Us, V>,\n) => {\n  const {\n    additionalTextareaProps,\n    attachments,\n    autocompleteTriggers,\n    clearEditingState,\n    closeCommandsList,\n    closeEmojiPicker,\n    closeMentionsList,\n    cooldownInterval,\n    cooldownRemaining,\n    disabled,\n    disableMentions,\n    doFileUploadRequest,\n    doImageUploadRequest,\n    emojiIndex,\n    emojiPickerIsOpen,\n    emojiPickerRef,\n    errorHandler,\n    fileOrder,\n    fileUploads,\n    focus,\n    grow,\n    handleChange,\n    handleEmojiKeyDown,\n    handleSubmit,\n    imageOrder,\n    imageUploads,\n    insertText,\n    isUploadEnabled,\n    keycodeSubmitKeys,\n    maxFilesLeft,\n    maxRows,\n    mentionAllAppUsers,\n    mentioned_users,\n    mentionQueryParams,\n    message,\n    noFiles,\n    numberOfUploads,\n    onPaste,\n    onSelectEmoji,\n    onSelectUser,\n    openCommandsList,\n    openEmojiPicker,\n    openMentionsList,\n    overrideSubmitHandler,\n    parent,\n    publishTypingEvent,\n    removeFile,\n    removeImage,\n    setCooldownRemaining,\n    setText,\n    showCommandsList,\n    showMentionsList,\n    text,\n    textareaRef,\n    uploadFile,\n    uploadImage,\n    uploadNewFiles,\n    useMentionsTransliteration,\n  } = value;\n\n  const editing = message?.editing;\n  const fileUploadsValue = Object.entries(fileUploads)\n    // eslint-disable-next-line\n    .map(([_, value]) => value.state)\n    .join();\n  const imageUploadsValue = Object.entries(imageUploads)\n    // eslint-disable-next-line\n    .map(([_, value]) => value.state)\n    .join();\n  const mentionedUsersLength = mentioned_users.length;\n  const parentId = parent?.id;\n\n  const messageInputContext: MessageInputContextValue<At, Ch, Co, Ev, Me, Re, Us, V> = useMemo(\n    () => ({\n      additionalTextareaProps,\n      attachments,\n      autocompleteTriggers,\n      clearEditingState,\n      closeCommandsList,\n      closeEmojiPicker,\n      closeMentionsList,\n      cooldownInterval,\n      cooldownRemaining,\n      disabled,\n      disableMentions,\n      doFileUploadRequest,\n      doImageUploadRequest,\n      emojiIndex,\n      emojiPickerIsOpen,\n      emojiPickerRef,\n      errorHandler,\n      fileOrder,\n      fileUploads,\n      focus,\n      grow,\n      handleChange,\n      handleEmojiKeyDown,\n      handleSubmit,\n      imageOrder,\n      imageUploads,\n      insertText,\n      isUploadEnabled,\n      keycodeSubmitKeys,\n      maxFilesLeft,\n      maxRows,\n      mentionAllAppUsers,\n      mentioned_users,\n      mentionQueryParams,\n      message,\n      noFiles,\n      numberOfUploads,\n      onPaste,\n      onSelectEmoji,\n      onSelectUser,\n      openCommandsList,\n      openEmojiPicker,\n      openMentionsList,\n      overrideSubmitHandler,\n      parent,\n      publishTypingEvent,\n      removeFile,\n      removeImage,\n      setCooldownRemaining,\n      setText,\n      showCommandsList,\n      showMentionsList,\n      text,\n      textareaRef,\n      uploadFile,\n      uploadImage,\n      uploadNewFiles,\n      useMentionsTransliteration,\n    }),\n    [\n      cooldownInterval,\n      cooldownRemaining,\n      editing,\n      emojiPickerIsOpen,\n      fileUploadsValue,\n      imageUploadsValue,\n      isUploadEnabled,\n      mentionedUsersLength,\n      parentId,\n      publishTypingEvent,\n      showCommandsList,\n      showMentionsList,\n      text,\n    ],\n  );\n\n  return messageInputContext;\n};\n","import React, { PropsWithChildren, useMemo } from 'react';\n\nimport { DefaultTriggerProvider } from './DefaultTriggerProvider';\nimport { MessageInputFlat } from './MessageInputFlat';\n\nimport { useCooldownTimer } from './hooks/useCooldownTimer';\nimport { useCreateMessageInputContext } from './hooks/useCreateMessageInputContext';\nimport { FileUpload, ImageUpload, useMessageInputState } from './hooks/useMessageInputState';\n\nimport { StreamMessage, useChannelStateContext } from '../../context/ChannelStateContext';\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { MessageInputContextProvider } from '../../context/MessageInputContext';\n\nimport type { Channel, SendFileAPIResponse } from 'stream-chat';\n\nimport type { SearchQueryParams } from '../ChannelSearch/ChannelSearch';\nimport type { MessageToSend } from '../../context/ChannelActionContext';\n\nimport type {\n  CustomTrigger,\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type MessageInputProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n> = {\n  /** Additional props to be passed to the underlying `AutoCompleteTextarea` component, [available props](https://www.npmjs.com/package/react-textarea-autosize) */\n  additionalTextareaProps?: React.TextareaHTMLAttributes<HTMLTextAreaElement>;\n  /** Function to clear the editing state while editing a message */\n  clearEditingState?: () => void;\n  /** If true, picking an emoji from the `EmojiPicker` component will close the picker */\n  closeEmojiPickerOnClick?: boolean;\n  /** If true, disables the text input */\n  disabled?: boolean;\n  /** If true, the suggestion list will not display and autocomplete @mentions. Default: false. */\n  disableMentions?: boolean;\n  /** Function to override the default file upload request */\n  doFileUploadRequest?: (\n    file: FileUpload['file'],\n    channel: Channel<At, Ch, Co, Ev, Me, Re, Us>,\n  ) => Promise<SendFileAPIResponse>;\n  /** Function to override the default image upload request */\n  doImageUploadRequest?: (\n    file: ImageUpload['file'],\n    channel: Channel<At, Ch, Co, Ev, Me, Re, Us>,\n  ) => Promise<SendFileAPIResponse>;\n  /** Custom error handler function to be called with a file/image upload fails */\n  errorHandler?: (\n    error: Error,\n    type: string,\n    file: (FileUpload | ImageUpload)['file'] & { id?: string },\n  ) => void;\n  /** If true, focuses the text input on component mount */\n  focus?: boolean;\n  /** If true, expands the text input vertically for new lines */\n  grow?: boolean;\n  /** Custom UI component handling how the message input is rendered, defaults to and accepts the same props as [MessageInputFlat](https://github.com/GetStream/stream-chat-react/blob/master/src/components/MessageInput/MessageInputFlat.tsx) */\n  Input?: React.ComponentType<MessageInputProps<At, Ch, Co, Ev, Me, Re, Us, V>>;\n  /**\n   * Currently, Enter is the default submission key and Shift+Enter is the default for new line.\n   * If provided, this array of keycode numbers will override the default Enter for submission, and Enter will then only create a new line.\n   * Shift + Enter will still always create a new line, unless Shift+Enter [16, 13] is included in the override.\n   * e.g.: [[16,13], [57], [48]] - submission keys would then be Shift+Enter, 9, and 0.\n   * */\n  keycodeSubmitKeys?: Array<number[]>;\n  /** Max number of rows the underlying `textarea` component is allowed to grow */\n  maxRows?: number;\n  /** If true, the suggestion list will search all app users for an @mention, not just current channel members/watchers. Default: false. */\n  mentionAllAppUsers?: boolean;\n  /** Object containing filters/sort/options overrides for an @mention user query */\n  mentionQueryParams?: SearchQueryParams<Us>['userFilters'];\n  /** If provided, the existing message will be edited on submit */\n  message?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>;\n  /** If true, disables file uploads for all attachments except for those with type 'image'. Default: false */\n  noFiles?: boolean;\n  /** Function to override the default submit handler */\n  overrideSubmitHandler?: (\n    message: MessageToSend<At, Ch, Co, Ev, Me, Re, Us>,\n    channelCid: string,\n  ) => void;\n  /** When replying in a thread, the parent message object */\n  parent?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>;\n  /** If true, triggers typing events on text input keystroke */\n  publishTypingEvent?: boolean;\n  /** If true, will use an optional dependency to support transliteration in the input for mentions, default is false. See: https://github.com/getstream/transliterate */\n  useMentionsTransliteration?: boolean;\n};\n\nconst MessageInputProvider = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>(\n  props: PropsWithChildren<MessageInputProps<At, Ch, Co, Ev, Me, Re, Us, V>>,\n) => {\n  const cooldownTimerState = useCooldownTimer<At, Ch, Co, Ev, Me, Re, Us>();\n  const messageInputState = useMessageInputState<At, Ch, Co, Ev, Me, Re, Us, V>(props);\n\n  const messageInputContextValue = useCreateMessageInputContext<At, Ch, Co, Ev, Me, Re, Us, V>({\n    ...cooldownTimerState,\n    ...messageInputState,\n    ...props,\n  });\n\n  return (\n    <MessageInputContextProvider<At, Ch, Co, Ev, Me, Re, Us, V> value={messageInputContextValue}>\n      {props.children}\n    </MessageInputContextProvider>\n  );\n};\n\nconst UnMemoizedMessageInput = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>(\n  props: MessageInputProps<At, Ch, Co, Ev, Me, Re, Us, V>,\n) => {\n  const { Input: PropInput } = props;\n\n  const { dragAndDropWindow } = useChannelStateContext<At, Ch, Co, Ev, Me, Re, Us>();\n  const { Input: ContextInput, TriggerProvider = DefaultTriggerProvider } = useComponentContext<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us,\n    V\n  >('MessageInput');\n\n  const Input = PropInput || ContextInput || MessageInputFlat;\n  const NullProvider: React.FC = ({ children }) => <>{children}</>;\n\n  const OptionalMessageInputProvider = useMemo(\n    () => (dragAndDropWindow ? NullProvider : MessageInputProvider),\n    [dragAndDropWindow],\n  );\n\n  return (\n    <OptionalMessageInputProvider {...props}>\n      <TriggerProvider>\n        <Input />\n      </TriggerProvider>\n    </OptionalMessageInputProvider>\n  );\n};\n\n/**\n * A high level component that has provides all functionality to the Input it renders.\n */\nexport const MessageInput = React.memo(UnMemoizedMessageInput) as typeof UnMemoizedMessageInput;\n","import React from 'react';\nimport { FileUploadButton, ImageDropzone } from 'react-file-utils';\n\nimport { EmojiPicker } from './EmojiPicker';\nimport { CooldownTimer as DefaultCooldownTimer } from './hooks/useCooldownTimer';\nimport {\n  EmojiIconSmall as DefaultEmojiIcon,\n  FileUploadIconFlat as DefaultFileUploadIcon,\n  SendButton as DefaultSendButton,\n} from './icons';\nimport { UploadsPreview } from './UploadsPreview';\n\nimport { ChatAutoComplete } from '../ChatAutoComplete/ChatAutoComplete';\nimport { Tooltip } from '../Tooltip/Tooltip';\n\nimport { useChannelStateContext } from '../../context/ChannelStateContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\nimport { useMessageInputContext } from '../../context/MessageInputContext';\nimport { useComponentContext } from '../../context/ComponentContext';\n\nimport { QuotedMessagePreview as DefaultQuotedMessagePreview } from './QuotedMessagePreview';\n\nimport type {\n  CustomTrigger,\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport const MessageInputSmall = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>() => {\n  const { acceptedFiles, multipleUploads, quotedMessage } = useChannelStateContext<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us\n  >('MessageInputSmall');\n  const { t } = useTranslationContext('MessageInputSmall');\n\n  const {\n    closeEmojiPicker,\n    cooldownInterval,\n    cooldownRemaining,\n    emojiPickerIsOpen,\n    handleSubmit,\n    isUploadEnabled,\n    maxFilesLeft,\n    openEmojiPicker,\n    setCooldownRemaining,\n    uploadNewFiles,\n  } = useMessageInputContext<At, Ch, Co, Ev, Me, Re, Us, V>('MessageInputSmall');\n\n  const {\n    CooldownTimer = DefaultCooldownTimer,\n    EmojiIcon = DefaultEmojiIcon,\n    FileUploadIcon = DefaultFileUploadIcon,\n    SendButton = DefaultSendButton,\n    QuotedMessagePreview = DefaultQuotedMessagePreview,\n  } = useComponentContext<At, Ch, Co, Ev, Me, Re, Us>('MessageInputSmall');\n\n  return (\n    <div className='str-chat__small-message-input__wrapper'>\n      <ImageDropzone\n        accept={acceptedFiles}\n        disabled={!isUploadEnabled || maxFilesLeft === 0 || !!cooldownRemaining}\n        handleFiles={uploadNewFiles}\n        maxNumberOfFiles={maxFilesLeft}\n        multiple={multipleUploads}\n      >\n        <div\n          className={`str-chat__small-message-input ${\n            SendButton ? 'str-chat__small-message-input--send-button-active' : null\n          } ${quotedMessage && quotedMessage.parent_id ? 'str-chat__input-flat-quoted' : null}`}\n        >\n          {quotedMessage && quotedMessage.parent_id && (\n            <QuotedMessagePreview quotedMessage={quotedMessage} />\n          )}\n          <div className='str-chat__small-message-input--textarea-wrapper'>\n            {isUploadEnabled && <UploadsPreview />}\n            <ChatAutoComplete />\n            {cooldownRemaining ? (\n              <div className='str-chat__input-small-cooldown'>\n                <CooldownTimer\n                  cooldownInterval={cooldownInterval}\n                  setCooldownRemaining={setCooldownRemaining}\n                />\n              </div>\n            ) : (\n              <>\n                {isUploadEnabled && (\n                  <div className='str-chat__fileupload-wrapper' data-testid='fileinput'>\n                    <Tooltip>\n                      {maxFilesLeft\n                        ? t('Attach files')\n                        : t(\"You've reached the maximum number of files\")}\n                    </Tooltip>\n                    <FileUploadButton\n                      accepts={acceptedFiles}\n                      disabled={maxFilesLeft === 0}\n                      handleFiles={uploadNewFiles}\n                      multiple={multipleUploads}\n                    >\n                      <span className='str-chat__small-message-input-fileupload'>\n                        <FileUploadIcon />\n                      </span>\n                    </FileUploadButton>\n                  </div>\n                )}\n                <div className='str-chat__emojiselect-wrapper'>\n                  <Tooltip>\n                    {emojiPickerIsOpen ? t('Close emoji picker') : t('Open emoji picker')}\n                  </Tooltip>\n                  <button\n                    aria-label='Emoji picker'\n                    className='str-chat__small-message-input-emojiselect'\n                    onClick={emojiPickerIsOpen ? closeEmojiPicker : openEmojiPicker}\n                  >\n                    <EmojiIcon />\n                  </button>\n                </div>\n              </>\n            )}\n            <EmojiPicker small />\n          </div>\n          {!cooldownRemaining && <SendButton sendMessage={handleSubmit} />}\n        </div>\n      </ImageDropzone>\n    </div>\n  );\n};\n","import React, { Suspense } from 'react';\n\nimport { useChatContext } from '../../context/ChatContext';\n\nimport type { ActionHandlerReturnType } from '../Message/hooks/useActionHandler';\n\nconst MMLReact = React.lazy(async () => {\n  const mml = await import('mml-react');\n  return { default: mml.MML };\n});\n\nexport type MMLProps = {\n  /** MML source string */\n  source: string;\n  /** Submit handler for mml actions */\n  actionHandler?: ActionHandlerReturnType;\n  /** Align MML components to left/right, defaults to right */\n  align?: 'left' | 'right';\n};\n\n/**\n * A wrapper component around MML-React library\n */\nexport const MML: React.FC<MMLProps> = (props) => {\n  const { actionHandler, align = 'right', source } = props;\n\n  const { theme } = useChatContext('MML');\n\n  return (\n    <Suspense fallback={null}>\n      <MMLReact\n        className={`mml-align-${align}`}\n        Loading={null}\n        onSubmit={actionHandler}\n        source={source}\n        Success={null}\n        theme={(theme || '').replace(' ', '-')}\n      />\n    </Suspense>\n  );\n};\n","export const isMutableRef = <T>(\n  ref: React.ForwardedRef<T> | null,\n): ref is React.MutableRefObject<T> => {\n  if (ref) {\n    return (ref as React.MutableRefObject<T>).current !== undefined;\n  }\n  return false;\n};\n","import React, { Suspense, useCallback, useEffect, useMemo, useRef, useState } from 'react';\n\nimport { isMutableRef } from './utils/utils';\n\nimport { AvatarProps, Avatar as DefaultAvatar } from '../Avatar';\nimport { getStrippedEmojiData, ReactionEmoji } from '../Channel/emojiData';\n\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { useEmojiContext } from '../../context/EmojiContext';\nimport { useMessageContext } from '../../context/MessageContext';\n\nimport type { NimbleEmojiProps } from 'emoji-mart';\nimport type { ReactionResponse } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type ReactionSelectorProps<\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  /** Additional props to be passed to the [NimbleEmoji](https://github.com/missive/emoji-mart/blob/master/src/components/emoji/nimble-emoji.js) component from `emoji-mart` */\n  additionalEmojiProps?: Partial<NimbleEmojiProps>;\n  /** Custom UI component to display user avatar, defaults to and accepts same props as: [Avatar](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Avatar/Avatar.tsx) */\n  Avatar?: React.ElementType<AvatarProps>;\n  /** If true, shows the user's avatar with the reaction */\n  detailedView?: boolean;\n  /** Function that adds/removes a reaction on a message (overrides the function stored in `MessageContext`) */\n  handleReaction?: (reactionType: string, event: React.BaseSyntheticEvent) => Promise<void>;\n  /** An array of the reaction objects to display in the list */\n  latest_reactions?: ReactionResponse<Re, Us>[];\n  /** An object that keeps track of the count of each type of reaction on a message */\n  reaction_counts?: { [key: string]: number };\n  /** A list of the currently supported reactions on a message */\n  reactionOptions?: ReactionEmoji[];\n  /** If true, adds a CSS class that reverses the horizontal positioning of the selector */\n  reverse?: boolean;\n};\n\nconst UnMemoizedReactionSelector = React.forwardRef(\n  <\n    At extends DefaultAttachmentType = DefaultAttachmentType,\n    Ch extends DefaultChannelType = DefaultChannelType,\n    Co extends DefaultCommandType = DefaultCommandType,\n    Ev extends DefaultEventType = DefaultEventType,\n    Me extends DefaultMessageType = DefaultMessageType,\n    Re extends DefaultReactionType = DefaultReactionType,\n    Us extends DefaultUserType<Us> = DefaultUserType\n  >(\n    props: ReactionSelectorProps<Re, Us>,\n    ref: React.ForwardedRef<HTMLDivElement | null>,\n  ) => {\n    const {\n      additionalEmojiProps = {},\n      Avatar: propAvatar,\n      detailedView = true,\n      handleReaction: propHandleReaction,\n      latest_reactions: propLatestReactions,\n      reaction_counts: propReactionCounts,\n      reactionOptions: propReactionOptions,\n      reverse = false,\n    } = props;\n\n    const { Avatar: contextAvatar } = useComponentContext<At, Ch, Co, Ev, Me, Re, Us>(\n      'ReactionSelector',\n    );\n    const { Emoji, emojiConfig } = useEmojiContext('ReactionSelector');\n    const { handleReaction: contextHandleReaction, message } = useMessageContext<\n      At,\n      Ch,\n      Co,\n      Ev,\n      Me,\n      Re,\n      Us\n    >('ReactionSelector');\n\n    const { defaultMinimalEmojis, emojiData: fullEmojiData, emojiSetDef } = emojiConfig || {};\n\n    const Avatar = propAvatar || contextAvatar || DefaultAvatar;\n    const handleReaction = propHandleReaction || contextHandleReaction;\n    const latestReactions = propLatestReactions || message?.latest_reactions || [];\n    const reactionCounts = propReactionCounts || message?.reaction_counts || {};\n    const reactionOptions = propReactionOptions || defaultMinimalEmojis;\n    const reactionsAreCustom = !!propReactionOptions?.length;\n\n    const emojiData = useMemo(\n      () => (reactionsAreCustom ? fullEmojiData : getStrippedEmojiData(fullEmojiData)),\n      [fullEmojiData, reactionsAreCustom],\n    );\n\n    const [tooltipReactionType, setTooltipReactionType] = useState<string | null>(null);\n    const [tooltipPositions, setTooltipPositions] = useState<{\n      arrow: number;\n      tooltip: number;\n    } | null>(null);\n\n    const targetRef = useRef<HTMLDivElement | null>(null);\n    const tooltipRef = useRef<HTMLDivElement | null>(null);\n\n    const showTooltip = useCallback((event, reactionType: string) => {\n      targetRef.current = event.target;\n      setTooltipReactionType(reactionType);\n    }, []);\n\n    const hideTooltip = useCallback(() => {\n      setTooltipReactionType(null);\n      setTooltipPositions(null);\n    }, []);\n\n    useEffect(() => {\n      if (tooltipReactionType) {\n        const tooltip = tooltipRef.current?.getBoundingClientRect();\n        const target = targetRef.current?.getBoundingClientRect();\n\n        const container = isMutableRef(ref) ? ref.current?.getBoundingClientRect() : null;\n\n        if (!tooltip || !target || !container) return;\n\n        const tooltipPosition =\n          tooltip.width === container.width || tooltip.x < container.x\n            ? 0\n            : target.left + target.width / 2 - container.left - tooltip.width / 2;\n\n        const arrowPosition = target.x - tooltip.x + target.width / 2 - tooltipPosition;\n\n        setTooltipPositions({\n          arrow: arrowPosition,\n          tooltip: tooltipPosition,\n        });\n      }\n    }, [tooltipReactionType, ref]);\n\n    const getUsersPerReactionType = (type: string | null) =>\n      latestReactions\n        .map((reaction) => {\n          if (reaction.type === type) {\n            return reaction.user?.name || reaction.user?.id;\n          }\n          return null;\n        })\n        .filter(Boolean);\n\n    const getLatestUserForReactionType = (type: string | null) =>\n      latestReactions.find((reaction) => reaction.type === type && !!reaction.user)?.user ||\n      undefined;\n\n    return (\n      <div\n        className={`str-chat__reaction-selector ${\n          reverse ? 'str-chat__reaction-selector--reverse' : ''\n        }`}\n        data-testid='reaction-selector'\n        ref={ref}\n      >\n        {!!tooltipReactionType && detailedView && (\n          <div\n            className='str-chat__reaction-selector-tooltip'\n            ref={tooltipRef}\n            style={{\n              left: tooltipPositions?.tooltip,\n              visibility: tooltipPositions ? 'visible' : 'hidden',\n            }}\n          >\n            <div className='arrow' style={{ left: tooltipPositions?.arrow }} />\n            {getUsersPerReactionType(tooltipReactionType)?.map((user, i, users) => (\n              <span className='latest-user-username' key={`key-${i}-${user}`}>\n                {`${user}${i < users.length - 1 ? ', ' : ''}`}\n              </span>\n            ))}\n          </div>\n        )}\n        <ul className='str-chat__message-reactions-list'>\n          {reactionOptions.map((reactionOption: ReactionEmoji) => {\n            const latestUser = getLatestUserForReactionType(reactionOption.id);\n            const count = reactionCounts && reactionCounts[reactionOption.id];\n\n            return (\n              <li key={`item-${reactionOption.id}`}>\n                <button\n                  aria-label={`Select Reaction: ${reactionOption.name}`}\n                  className='str-chat__message-reactions-list-item'\n                  data-text={reactionOption.id}\n                  onClick={(event) => handleReaction(reactionOption.id, event)}\n                >\n                  {!!count && detailedView && (\n                    <>\n                      <div\n                        className='latest-user'\n                        onClick={hideTooltip}\n                        onMouseEnter={(e) => showTooltip(e, reactionOption.id)}\n                        onMouseLeave={hideTooltip}\n                      >\n                        {latestUser ? (\n                          <Avatar\n                            image={latestUser.image}\n                            name={latestUser.name}\n                            size={20}\n                            user={latestUser}\n                          />\n                        ) : (\n                          <div className='latest-user-not-found' />\n                        )}\n                      </div>\n                    </>\n                  )}\n                  {\n                    <Suspense fallback={null}>\n                      <Emoji\n                        data={emojiData}\n                        emoji={reactionOption}\n                        size={20}\n                        {...(reactionsAreCustom ? additionalEmojiProps : emojiSetDef)}\n                      />\n                    </Suspense>\n                  }\n                  {Boolean(count) && detailedView && (\n                    <span className='str-chat__message-reactions-list-item__count'>\n                      {count || ''}\n                    </span>\n                  )}\n                </button>\n              </li>\n            );\n          })}\n        </ul>\n      </div>\n    );\n  },\n);\n\n/**\n * Component that allows a user to select a reaction.\n */\nexport const ReactionSelector = React.memo(\n  UnMemoizedReactionSelector,\n) as typeof UnMemoizedReactionSelector;\n","import React, { Suspense, useMemo } from 'react';\n\nimport { getStrippedEmojiData, ReactionEmoji } from '../Channel/emojiData';\n\nimport { useEmojiContext } from '../../context/EmojiContext';\nimport { useMessageContext } from '../../context/MessageContext';\n\nimport type { NimbleEmojiProps } from 'emoji-mart';\nimport type { ReactionResponse } from 'stream-chat';\n\nimport type { ReactEventHandler } from '../Message/types';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type ReactionsListProps<\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  /** Additional props to be passed to the [NimbleEmoji](https://github.com/missive/emoji-mart/blob/master/src/components/emoji/nimble-emoji.js) component from `emoji-mart` */\n  additionalEmojiProps?: Partial<NimbleEmojiProps>;\n  /** Custom on click handler for an individual reaction, defaults to `onReactionListClick` from the `MessageContext` */\n  onClick?: ReactEventHandler;\n  /** An object that keeps track of the count of each type of reaction on a message */\n  reaction_counts?: { [key: string]: number };\n  /** A list of the currently supported reactions on a message */\n  reactionOptions?: ReactionEmoji[];\n  /** An array of the reaction objects to display in the list */\n  reactions?: ReactionResponse<Re, Us>[];\n  /** Display the reactions in the list in reverse order, defaults to false */\n  reverse?: boolean;\n};\n\nconst UnMemoizedReactionsList = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: ReactionsListProps<Re, Us>,\n) => {\n  const {\n    additionalEmojiProps,\n    onClick,\n    reaction_counts: propReactionCounts,\n    reactionOptions: propReactionOptions,\n    reactions: propReactions,\n    reverse = false,\n  } = props;\n\n  const { Emoji, emojiConfig } = useEmojiContext('ReactionsList');\n  const { message, onReactionListClick } = useMessageContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'ReactionsList',\n  );\n\n  const { defaultMinimalEmojis, emojiData: fullEmojiData, emojiSetDef } = emojiConfig || {};\n\n  const reactions = propReactions || message.latest_reactions || [];\n  const reactionCounts = propReactionCounts || message.reaction_counts || {};\n  const reactionOptions = propReactionOptions || defaultMinimalEmojis;\n  const reactionsAreCustom = !!propReactionOptions?.length;\n\n  const emojiData = useMemo(\n    () => (reactionsAreCustom ? fullEmojiData : getStrippedEmojiData(fullEmojiData)),\n    [fullEmojiData, reactionsAreCustom],\n  );\n\n  if (!reactions.length) return null;\n\n  const getTotalReactionCount = () =>\n    Object.values(reactionCounts).reduce((total, count) => total + count, 0);\n\n  const getCurrentMessageReactionTypes = () => {\n    const reactionTypes: string[] = [];\n    reactions.forEach(({ type }) => {\n      if (reactionTypes.indexOf(type) === -1) {\n        reactionTypes.push(type);\n      }\n    });\n    return reactionTypes;\n  };\n\n  const getEmojiByReactionType = (type: string): ReactionEmoji | undefined => {\n    const reactionEmoji = reactionOptions.find((option: ReactionEmoji) => option.id === type);\n    return reactionEmoji;\n  };\n\n  const getSupportedReactionMap = () => {\n    const reactionMap: Record<string, boolean> = {};\n    reactionOptions.forEach(({ id }) => (reactionMap[id] = true));\n    return reactionMap;\n  };\n\n  const messageReactionTypes = getCurrentMessageReactionTypes();\n  const supportedReactionMap = getSupportedReactionMap();\n\n  const supportedReactionsArePresent = messageReactionTypes.some(\n    (type) => supportedReactionMap[type],\n  );\n\n  if (!supportedReactionsArePresent) return null;\n\n  return (\n    <div\n      aria-label='Reaction list'\n      className={`str-chat__reaction-list ${reverse ? 'str-chat__reaction-list--reverse' : ''}`}\n      data-testid='reaction-list'\n      onClick={onClick || onReactionListClick}\n      onKeyPress={onClick || onReactionListClick}\n      role='figure'\n    >\n      <ul>\n        {messageReactionTypes.map((reactionType) => {\n          const emojiObject = getEmojiByReactionType(reactionType);\n\n          return emojiObject ? (\n            <li key={emojiObject.id}>\n              <button aria-label={`Reactions: ${reactionType}`}>\n                {\n                  <Suspense fallback={null}>\n                    <Emoji\n                      data={emojiData}\n                      emoji={emojiObject}\n                      size={16}\n                      {...(reactionsAreCustom ? additionalEmojiProps : emojiSetDef)}\n                    />\n                  </Suspense>\n                }\n                &nbsp;\n              </button>\n            </li>\n          ) : null;\n        })}\n        <li>\n          <span className='str-chat__reaction-list--counter'>{getTotalReactionCount()}</span>\n        </li>\n      </ul>\n    </div>\n  );\n};\n\n/**\n * Component that displays a list of reactions on a message.\n */\nexport const ReactionsList = React.memo(UnMemoizedReactionsList) as typeof UnMemoizedReactionsList;\n","import React, { Suspense, useMemo, useState } from 'react';\n\nimport { getStrippedEmojiData, ReactionEmoji } from '../Channel/emojiData';\n\nimport { useEmojiContext } from '../../context/EmojiContext';\nimport { useMessageContext } from '../../context/MessageContext';\n\nimport type { NimbleEmojiProps } from 'emoji-mart';\nimport type { ReactionResponse } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type SimpleReactionsListProps<\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  /** Additional props to be passed to the [NimbleEmoji](https://github.com/missive/emoji-mart/blob/master/src/components/emoji/nimble-emoji.js) component from `emoji-mart` */\n  additionalEmojiProps?: Partial<NimbleEmojiProps>;\n  /** Function that adds/removes a reaction on a message (overrides the function stored in `MessageContext`) */\n  handleReaction?: (reactionType: string, event: React.BaseSyntheticEvent) => Promise<void>;\n  /** An object that keeps track of the count of each type of reaction on a message */\n  reaction_counts?: { [key: string]: number };\n  /** A list of the currently supported reactions on a message */\n  reactionOptions?: ReactionEmoji[];\n  /** An array of the reaction objects to display in the list */\n  reactions?: ReactionResponse<Re, Us>[];\n};\n\nconst UnMemoizedSimpleReactionsList = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: SimpleReactionsListProps<Re, Us>,\n) => {\n  const {\n    additionalEmojiProps = {},\n    handleReaction: propHandleReaction,\n    reaction_counts: propReactionCounts,\n    reactionOptions: propReactionOptions,\n    reactions: propReactions,\n  } = props;\n\n  const { Emoji, emojiConfig } = useEmojiContext('SimpleReactionsList');\n  const { handleReaction: contextHandleReaction, message } = useMessageContext<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us\n  >('SimpleReactionsList');\n\n  const { defaultMinimalEmojis, emojiData: fullEmojiData, emojiSetDef } = emojiConfig || {};\n\n  const [tooltipReactionType, setTooltipReactionType] = useState<string | undefined>(undefined);\n\n  const handleReaction = propHandleReaction || contextHandleReaction;\n  const reactions = propReactions || message.latest_reactions || [];\n  const reactionCounts = propReactionCounts || message.reaction_counts || {};\n  const reactionOptions = propReactionOptions || defaultMinimalEmojis;\n  const reactionsAreCustom = !!propReactionOptions?.length;\n\n  const emojiData = useMemo(\n    () => (reactionsAreCustom ? fullEmojiData : getStrippedEmojiData(fullEmojiData)),\n    [fullEmojiData, reactionsAreCustom],\n  );\n\n  if (!reactions.length) return null;\n\n  const getUsersPerReactionType = (type: string) =>\n    reactions\n      .map((reaction) => {\n        if (reaction.type === type) {\n          return reaction.user?.name || reaction.user?.id;\n        }\n        return null;\n      })\n      .filter(Boolean);\n\n  const getTotalReactionCount = () =>\n    Object.values(reactionCounts).reduce((total, count) => total + count, 0);\n\n  const getCurrentMessageReactionTypes = () => {\n    const reactionTypes: string[] = [];\n    reactions.forEach(({ type }) => {\n      if (reactionTypes.indexOf(type) === -1) {\n        reactionTypes.push(type);\n      }\n    });\n    return reactionTypes;\n  };\n\n  const getEmojiByReactionType = (type: string): ReactionEmoji | undefined => {\n    const reactionEmoji = reactionOptions.find((option: ReactionEmoji) => option.id === type);\n    return reactionEmoji;\n  };\n\n  const getSupportedReactionMap = () => {\n    const reactionMap: Record<string, boolean> = {};\n    reactionOptions.forEach(({ id }) => (reactionMap[id] = true));\n    return reactionMap;\n  };\n\n  const messageReactionTypes = getCurrentMessageReactionTypes();\n  const supportedReactionMap = getSupportedReactionMap();\n\n  const supportedReactionsArePresent = messageReactionTypes.some(\n    (type) => supportedReactionMap[type],\n  );\n\n  if (!supportedReactionsArePresent) return null;\n\n  return (\n    <ul\n      className='str-chat__simple-reactions-list'\n      data-testid='simple-reaction-list'\n      onMouseLeave={() => setTooltipReactionType(undefined)}\n    >\n      {messageReactionTypes.map((reactionType, i) => {\n        const emojiObject = getEmojiByReactionType(reactionType);\n\n        return emojiObject ? (\n          <li\n            className='str-chat__simple-reactions-list-item'\n            key={`${emojiObject.id}-${i}`}\n            onClick={(event) => handleReaction(reactionType, event)}\n            onKeyPress={(event) => handleReaction(reactionType, event)}\n          >\n            <span onMouseEnter={() => setTooltipReactionType(reactionType)}>\n              {\n                <Suspense fallback={null}>\n                  <Emoji\n                    data={emojiData}\n                    emoji={emojiObject}\n                    size={13}\n                    {...(reactionsAreCustom ? additionalEmojiProps : emojiSetDef)}\n                  />\n                </Suspense>\n              }\n              &nbsp;\n            </span>\n            {tooltipReactionType === emojiObject.id && (\n              <div className='str-chat__simple-reactions-list-tooltip'>\n                <div className='arrow' />\n                {getUsersPerReactionType(tooltipReactionType)?.join(', ')}\n              </div>\n            )}\n          </li>\n        ) : null;\n      })}\n      {\n        <li className='str-chat__simple-reactions-list-item--last-number'>\n          {getTotalReactionCount()}\n        </li>\n      }\n    </ul>\n  );\n};\n\nexport const SimpleReactionsList = React.memo(\n  UnMemoizedSimpleReactionsList,\n) as typeof UnMemoizedSimpleReactionsList;\n","import React, { useRef } from 'react';\n\nimport { MessageDeleted as DefaultMessageDeleted } from './MessageDeleted';\nimport { MessageOptions as DefaultMessageOptions } from './MessageOptions';\nimport { MessageRepliesCountButton as DefaultMessageRepliesCountButton } from './MessageRepliesCountButton';\nimport { MessageStatus as DefaultMessageStatus } from './MessageStatus';\nimport { MessageText } from './MessageText';\nimport { MessageTimestamp as DefaultMessageTimestamp } from './MessageTimestamp';\nimport { areMessageUIPropsEqual, messageHasAttachments, messageHasReactions } from './utils';\n\nimport { Avatar as DefaultAvatar } from '../Avatar';\nimport { EditMessageForm as DefaultEditMessageForm, MessageInput } from '../MessageInput';\nimport { MML } from '../MML';\nimport { Modal } from '../Modal';\nimport {\n  ReactionsList as DefaultReactionList,\n  ReactionSelector as DefaultReactionSelector,\n} from '../Reactions';\n\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { MessageContextValue, useMessageContext } from '../../context/MessageContext';\n\nimport type { MessageUIComponentProps } from './types';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\ntype MessageSimpleWithContextProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = MessageContextValue<At, Ch, Co, Ev, Me, Re, Us>;\n\nconst MessageSimpleWithContext = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: MessageSimpleWithContextProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const {\n    additionalMessageInputProps,\n    clearEditingState,\n    editing,\n    endOfGroup,\n    firstOfGroup,\n    groupedByUser,\n    handleAction,\n    handleOpenThread,\n    handleRetry,\n    isMyMessage,\n    isReactionEnabled,\n    message,\n    onUserClick,\n    onUserHover,\n    reactionSelectorRef,\n    showDetailedReactions,\n    threadList,\n  } = props;\n\n  const {\n    Attachment,\n    Avatar = DefaultAvatar,\n    EditMessageInput = DefaultEditMessageForm,\n    MessageDeleted = DefaultMessageDeleted,\n    MessageOptions = DefaultMessageOptions,\n    MessageRepliesCountButton = DefaultMessageRepliesCountButton,\n    MessageStatus = DefaultMessageStatus,\n    MessageTimestamp = DefaultMessageTimestamp,\n    ReactionSelector = DefaultReactionSelector,\n    ReactionsList = DefaultReactionList,\n  } = useComponentContext<At, Ch, Co, Ev, Me, Re, Us>('MessageSimple');\n\n  const messageWrapperRef = useRef<HTMLDivElement | null>(null);\n\n  const hasAttachment = messageHasAttachments(message);\n  const hasReactions = messageHasReactions(message);\n\n  const messageClasses = isMyMessage()\n    ? 'str-chat__message str-chat__message--me str-chat__message-simple str-chat__message-simple--me'\n    : 'str-chat__message str-chat__message-simple';\n\n  if (message.customType === 'message.date') {\n    return null;\n  }\n\n  if (message.deleted_at || message.type === 'deleted') {\n    return <MessageDeleted message={message} />;\n  }\n\n  return (\n    <>\n      {editing && (\n        <Modal onClose={clearEditingState} open={editing}>\n          <MessageInput\n            clearEditingState={clearEditingState}\n            Input={EditMessageInput}\n            message={message}\n            {...additionalMessageInputProps}\n          />\n        </Modal>\n      )}\n      {\n        <div\n          className={`\n\t\t\t\t\t\t${messageClasses}\n\t\t\t\t\t\tstr-chat__message--${message.type}\n\t\t\t\t\t\tstr-chat__message--${message.status}\n\t\t\t\t\t\t${message.text ? 'str-chat__message--has-text' : 'has-no-text'}\n\t\t\t\t\t\t${hasAttachment ? 'str-chat__message--has-attachment' : ''}\n            ${hasReactions && isReactionEnabled ? 'str-chat__message--with-reactions' : ''}\n            ${message.pinned ? 'pinned-message' : ''}\n            ${groupedByUser ? 'str-chat__virtual-message__wrapper--group' : ''}\n            ${firstOfGroup ? 'str-chat__virtual-message__wrapper--first' : ''}\n            ${endOfGroup ? 'str-chat__virtual-message__wrapper--end' : ''}\n\t\t\t\t\t`.trim()}\n          key={message.id}\n          ref={messageWrapperRef}\n        >\n          <MessageStatus />\n          {message.user && (\n            <Avatar\n              image={message.user.image}\n              name={message.user.name || message.user.id}\n              onClick={onUserClick}\n              onMouseOver={onUserHover}\n              user={message.user}\n            />\n          )}\n          <div\n            className='str-chat__message-inner'\n            data-testid='message-inner'\n            onClick={\n              message.status === 'failed' && message.errorStatusCode !== 403\n                ? () => handleRetry(message)\n                : undefined\n            }\n            onKeyPress={\n              message.status === 'failed' && message.errorStatusCode !== 403\n                ? () => handleRetry(message)\n                : undefined\n            }\n          >\n            <>\n              <MessageOptions messageWrapperRef={messageWrapperRef} />\n              {hasReactions && !showDetailedReactions && isReactionEnabled && (\n                <ReactionsList reverse />\n              )}\n              {showDetailedReactions && isReactionEnabled && (\n                <ReactionSelector ref={reactionSelectorRef} />\n              )}\n            </>\n            {message.attachments?.length && !message.quoted_message ? (\n              <Attachment actionHandler={handleAction} attachments={message.attachments} />\n            ) : null}\n            <MessageText message={message} />\n            {message.mml && (\n              <MML\n                actionHandler={handleAction}\n                align={isMyMessage() ? 'right' : 'left'}\n                source={message.mml}\n              />\n            )}\n            {!threadList && !!message.reply_count && (\n              <div className='str-chat__message-simple-reply-button'>\n                <MessageRepliesCountButton\n                  onClick={handleOpenThread}\n                  reply_count={message.reply_count}\n                />\n              </div>\n            )}\n            {(!groupedByUser || endOfGroup) && (\n              <div className={`str-chat__message-data str-chat__message-simple-data`}>\n                {!isMyMessage() && message.user ? (\n                  <span className='str-chat__message-simple-name'>\n                    {message.user.name || message.user.id}\n                  </span>\n                ) : null}\n                <MessageTimestamp calendar customClass='str-chat__message-simple-timestamp' />\n              </div>\n            )}\n          </div>\n        </div>\n      }\n    </>\n  );\n};\n\nconst MemoizedMessageSimple = React.memo(\n  MessageSimpleWithContext,\n  areMessageUIPropsEqual,\n) as typeof MessageSimpleWithContext;\n\n/**\n * The default UI component that renders a message and receives functionality and logic from the MessageContext.\n */\nexport const MessageSimple = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: MessageUIComponentProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const messageContext = useMessageContext<At, Ch, Co, Ev, Me, Re, Us>('MessageSimple');\n\n  return <MemoizedMessageSimple {...messageContext} {...props} />;\n};\n","import React, { PropsWithChildren } from 'react';\nimport { ImageDropzone } from 'react-file-utils';\n\nimport { useCooldownTimer } from './hooks/useCooldownTimer';\nimport { useCreateMessageInputContext } from './hooks/useCreateMessageInputContext';\nimport { useMessageInputState } from './hooks/useMessageInputState';\n\nimport { useChannelStateContext } from '../../context/ChannelStateContext';\nimport {\n  MessageInputContextProvider,\n  useMessageInputContext,\n} from '../../context/MessageInputContext';\n\nimport type { MessageInputProps } from './MessageInput';\n\nimport type {\n  CustomTrigger,\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n  UnknownType,\n} from '../../types/types';\n\nconst DropzoneInner = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>({\n  children,\n}: PropsWithChildren<UnknownType>) => {\n  const { acceptedFiles, multipleUploads } = useChannelStateContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'DropzoneProvider',\n  );\n\n  const {\n    cooldownRemaining,\n    isUploadEnabled,\n    maxFilesLeft,\n    uploadNewFiles,\n  } = useMessageInputContext<At, Ch, Co, Ev, Me, Re, Us, V>('DropzoneProvider');\n\n  return (\n    <ImageDropzone\n      accept={acceptedFiles}\n      disabled={!isUploadEnabled || maxFilesLeft === 0 || !!cooldownRemaining}\n      handleFiles={uploadNewFiles}\n      maxNumberOfFiles={maxFilesLeft}\n      multiple={multipleUploads}\n    >\n      {children}\n    </ImageDropzone>\n  );\n};\n\nexport const DropzoneProvider = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>(\n  props: PropsWithChildren<MessageInputProps<At, Ch, Co, Ev, Me, Re, Us, V>>,\n) => {\n  const cooldownTimerState = useCooldownTimer<At, Ch, Co, Ev, Me, Re, Us>();\n  const messageInputState = useMessageInputState<At, Ch, Co, Ev, Me, Re, Us, V>(props);\n\n  const messageInputContextValue = useCreateMessageInputContext<At, Ch, Co, Ev, Me, Re, Us, V>({\n    ...cooldownTimerState,\n    ...messageInputState,\n    ...props,\n  });\n\n  return (\n    <MessageInputContextProvider value={messageInputContextValue}>\n      <DropzoneInner>{props.children}</DropzoneInner>\n    </MessageInputContextProvider>\n  );\n};\n","import React, { PropsWithChildren, useContext } from 'react';\n\nimport type { ChannelState as StreamChannelState } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n  UnknownType,\n} from '../types/types';\n\nexport type TypingContextValue<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  typing?: StreamChannelState<At, Ch, Co, Ev, Me, Re, Us>['typing'];\n};\n\nexport const TypingContext = React.createContext<TypingContextValue | undefined>(undefined);\n\nexport const TypingProvider = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>({\n  children,\n  value,\n}: PropsWithChildren<{\n  value: TypingContextValue<At, Ch, Co, Ev, Me, Re, Us>;\n}>) => (\n  <TypingContext.Provider value={(value as unknown) as TypingContextValue}>\n    {children}\n  </TypingContext.Provider>\n);\n\nexport const useTypingContext = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  componentName?: string,\n) => {\n  const contextValue = useContext(TypingContext);\n\n  if (!contextValue) {\n    console.warn(\n      `The useTypingContext hook was called outside of the TypingContext provider. Make sure this hook is called within a child of the Channel component. The errored call is located in the ${componentName} component.`,\n    );\n\n    return {} as TypingContextValue<At, Ch, Co, Ev, Me, Re, Us>;\n  }\n\n  return contextValue as TypingContextValue<At, Ch, Co, Ev, Me, Re, Us>;\n};\n\n/**\n * Typescript currently does not support partial inference, so if TypingContext\n * typing is desired while using the HOC withTypingContext, the Props for the\n * wrapped component must be provided as the first generic.\n */\nexport const withTypingContext = <\n  P extends UnknownType,\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  Component: React.ComponentType<P>,\n): React.FC<Omit<P, keyof TypingContextValue<At, Ch, Co, Ev, Me, Re, Us>>> => {\n  const WithTypingContextComponent = (\n    props: Omit<P, keyof TypingContextValue<At, Ch, Co, Ev, Me, Re, Us>>,\n  ) => {\n    const typingContext = useTypingContext<At, Ch, Co, Ev, Me, Re, Us>();\n\n    return <Component {...(props as P)} {...typingContext} />;\n  };\n\n  WithTypingContextComponent.displayName = (\n    Component.displayName ||\n    Component.name ||\n    'Component'\n  ).replace('Base', '');\n\n  return WithTypingContextComponent;\n};\n","import React, {\n  PropsWithChildren,\n  useEffect,\n  useLayoutEffect,\n  useMemo,\n  useReducer,\n  useRef,\n  useState,\n} from 'react';\n\nimport debounce from 'lodash.debounce';\nimport throttle from 'lodash.throttle';\nimport {\n  ChannelAPIResponse,\n  ChannelState,\n  Event,\n  logChatPromiseExecution,\n  Message,\n  MessageResponse,\n  SendMessageAPIResponse,\n  Channel as StreamChannel,\n  StreamChat,\n  UpdatedMessage,\n  UserResponse,\n} from 'stream-chat';\nimport { v4 as uuidv4 } from 'uuid';\n\nimport { channelReducer, ChannelStateReducer, initialState } from './channelState';\nimport { commonEmoji, defaultMinimalEmojis, emojiSetDef } from './emojiData';\nimport { useCreateChannelStateContext } from './hooks/useCreateChannelStateContext';\nimport { useCreateTypingContext } from './hooks/useCreateTypingContext';\nimport { useEditMessageHandler } from './hooks/useEditMessageHandler';\nimport { useIsMounted } from './hooks/useIsMounted';\nimport { OnMentionAction, useMentionsHandlers } from './hooks/useMentionsHandlers';\n\nimport { Attachment as DefaultAttachment } from '../Attachment/Attachment';\nimport {\n  LoadingErrorIndicator as DefaultLoadingErrorIndicator,\n  LoadingIndicator as DefaultLoadingIndicator,\n  LoadingErrorIndicatorProps,\n} from '../Loading';\nimport { MessageSimple } from '../Message/MessageSimple';\nimport { DropzoneProvider } from '../MessageInput/DropzoneProvider';\n\nimport {\n  ChannelActionContextValue,\n  ChannelActionProvider,\n  MessageAttachments,\n  MessageToSend,\n} from '../../context/ChannelActionContext';\nimport {\n  ChannelNotifications,\n  ChannelStateProvider,\n  StreamMessage,\n} from '../../context/ChannelStateContext';\nimport { ComponentContextValue, ComponentProvider } from '../../context/ComponentContext';\nimport { useChatContext } from '../../context/ChatContext';\nimport { EmojiConfig, EmojiContextValue, EmojiProvider } from '../../context/EmojiContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\nimport { TypingProvider } from '../../context/TypingContext';\nimport defaultEmojiData from '../../stream-emoji.json';\n\nimport type { Data as EmojiMartData } from 'emoji-mart';\n\nimport type { MessageInputProps } from '../MessageInput/MessageInput';\n\nimport type {\n  CustomTrigger,\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type ChannelProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n> = {\n  /** List of accepted file types */\n  acceptedFiles?: string[];\n  /** Custom handler function that runs when the active channel has unread messages (i.e., when chat is running on a separate browser tab) */\n  activeUnreadHandler?: (unread: number, documentTitle: string) => void;\n  /** Custom UI component to display a message attachment, defaults to and accepts same props as: [Attachment](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Attachment/Attachment.tsx) */\n  Attachment?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['Attachment'];\n  /** Optional UI component to override the default suggestion Header component, defaults to and accepts same props as: [Header](https://github.com/GetStream/stream-chat-react/blob/master/src/components/AutoCompleteTextarea/Header.tsx) */\n  AutocompleteSuggestionHeader?: ComponentContextValue<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us\n  >['AutocompleteSuggestionHeader'];\n  /** Optional UI component to override the default suggestion Item component, defaults to and accepts same props as: [Item](https://github.com/GetStream/stream-chat-react/blob/master/src/components/AutoCompleteTextarea/Item.js) */\n  AutocompleteSuggestionItem?: ComponentContextValue<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us\n  >['AutocompleteSuggestionItem'];\n  /** Optional UI component to override the default List component that displays suggestions, defaults to and accepts same props as: [List](https://github.com/GetStream/stream-chat-react/blob/master/src/components/AutoCompleteTextarea/List.js) */\n  AutocompleteSuggestionList?: ComponentContextValue<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us\n  >['AutocompleteSuggestionList'];\n  /** UI component to display a user's avatar, defaults to and accepts same props as: [Avatar](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Avatar/Avatar.tsx) */\n  Avatar?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['Avatar'];\n  /** The connected and active channel */\n  channel?: StreamChannel<At, Ch, Co, Ev, Me, Re, Us>;\n  /** Custom UI component to display the slow mode cooldown timer, defaults to and accepts same props as: [CooldownTimer](https://github.com/GetStream/stream-chat-react/blob/master/src/components/MessageInput/hooks/useCooldownTimer.tsx) */\n  CooldownTimer?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['CooldownTimer'];\n  /** Custom UI component for date separators, defaults to and accepts same props as: [DateSeparator](https://github.com/GetStream/stream-chat-react/blob/master/src/components/DateSeparator.tsx) */\n  DateSeparator?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['DateSeparator'];\n  /** Custom action handler to override the default `channel.markRead` request function (advanced usage only) */\n  doMarkReadRequest?: (\n    channel: StreamChannel<At, Ch, Co, Ev, Me, Re, Us>,\n  ) => Promise<MessageResponse<At, Ch, Co, Me, Re, Us>> | void;\n  /** Custom action handler to override the default `channel.sendMessage` request function (advanced usage only) */\n  doSendMessageRequest?: (\n    channelId: string,\n    message: Message<At, Me, Us>,\n  ) => ReturnType<StreamChannel<At, Ch, Co, Ev, Me, Re, Us>['sendMessage']> | void;\n  /** Custom action handler to override the default `client.updateMessage` request function (advanced usage only) */\n  doUpdateMessageRequest?: (\n    cid: string,\n    updatedMessage: UpdatedMessage<At, Ch, Co, Me, Re, Us>,\n  ) => ReturnType<StreamChat<At, Ch, Co, Ev, Me, Re, Us>['updateMessage']>;\n  /** If true, chat users will be able to drag and drop file uploads to the entire channel window */\n  dragAndDropWindow?: boolean;\n  /** Custom UI component to override default edit message input, defaults to and accepts same props as: [EditMessageForm](https://github.com/GetStream/stream-chat-react/blob/master/src/components/MessageInput/EditMessageForm.tsx) */\n  EditMessageInput?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['EditMessageInput'];\n  /** Custom UI component to override default `NimbleEmoji` from `emoji-mart` */\n  Emoji?: EmojiContextValue['Emoji'];\n  /** Custom prop to override default `facebook.json` emoji data set from `emoji-mart` */\n  emojiData?: EmojiMartData;\n  /** Custom UI component for emoji button in input, defaults to and accepts same props as: [EmojiIconSmall](https://github.com/GetStream/stream-chat-react/blob/master/src/components/MessageInput/icons.tsx) */\n  EmojiIcon?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['EmojiIcon'];\n  /** Custom UI component to override default `NimbleEmojiIndex` from `emoji-mart` */\n  EmojiIndex?: EmojiContextValue['EmojiIndex'];\n  /** Custom UI component to override default `NimblePicker` from `emoji-mart` */\n  EmojiPicker?: EmojiContextValue['EmojiPicker'];\n  /** Custom UI component to be shown if no active channel is set, defaults to null and skips rendering the Channel component */\n  EmptyPlaceholder?: React.ReactElement;\n  /** Custom UI component to be displayed when the `MessageList` is empty, , defaults to and accepts same props as: [EmptyStateIndicator](https://github.com/GetStream/stream-chat-react/blob/master/src/components/EmptyStateIndicator/EmptyStateIndicator.tsx)  */\n  EmptyStateIndicator?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['EmptyStateIndicator'];\n  /** Custom UI component for file upload icon, defaults to and accepts same props as: [FileUploadIcon](https://github.com/GetStream/stream-chat-react/blob/master/src/components/MessageInput/icons.tsx) */\n  FileUploadIcon?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['FileUploadIcon'];\n  /** Custom UI component to render a Giphy preview in the `VirtualizedMessageList` */\n  GiphyPreviewMessage?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['GiphyPreviewMessage'];\n  /** Custom UI component to render at the top of the `MessageList` */\n  HeaderComponent?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['HeaderComponent'];\n  /** Custom UI component handling how the message input is rendered, defaults to and accepts the same props as [MessageInputFlat](https://github.com/GetStream/stream-chat-react/blob/master/src/components/MessageInput/MessageInputFlat.tsx) */\n  Input?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['Input'];\n  /** Custom UI component to be shown if the channel query fails, defaults to and accepts same props as: [LoadingErrorIndicator](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Loading/LoadingErrorIndicator.tsx) */\n  LoadingErrorIndicator?: React.ComponentType<LoadingErrorIndicatorProps>;\n  /** Custom UI component to render while the `MessageList` is loading new messages, defaults to and accepts same props as: [LoadingIndicator](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Loading/LoadingIndicator.tsx) */\n  LoadingIndicator?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['LoadingIndicator'];\n  /** Maximum number of attachments allowed per message */\n  maxNumberOfFiles?: number;\n  /** Custom UI component to display a message in the standard `MessageList`, defaults to and accepts the same props as: [MessageSimple](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Message/MessageSimple.tsx) */\n  Message?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['Message'];\n  /** Custom UI component for a deleted message, defaults to and accepts same props as: [MessageDeleted](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Message/MessageDeleted.tsx) */\n  MessageDeleted?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['MessageDeleted'];\n  /** Custom UI component that displays message and connection status notifications in the `MessageList`, defaults to and accepts same props as [DefaultMessageListNotifications](https://github.com/GetStream/stream-chat-react/blob/master/src/components/MessageList/MessageList.tsx) */\n  MessageListNotifications?: ComponentContextValue<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us\n  >['MessageListNotifications'];\n  /** Custom UI component to display a notification when scrolled up the list and new messages arrive, defaults to and accepts same props as [MessageNotification](https://github.com/GetStream/stream-chat-react/blob/master/src/components/MessageList/MessageNotification.tsx) */\n  MessageNotification?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['MessageNotification'];\n  /** Custom UI component for message options popup, defaults to and accepts same props as: [MessageOptions](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Message/MessageOptions.tsx) */\n  MessageOptions?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['MessageOptions'];\n  /** Custom UI component to display message replies, defaults to and accepts same props as: [MessageRepliesCountButton](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Message/MessageRepliesCountButton.tsx) */\n  MessageRepliesCountButton?: ComponentContextValue<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us\n  >['MessageRepliesCountButton'];\n  /** Custom UI component to display message delivery status, defaults to and accepts same props as: [MessageStatus](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Message/MessageStatus.tsx) */\n  MessageStatus?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['MessageStatus'];\n  /** Custom UI component to display system messages, defaults to and accepts same props as: [EventComponent](https://github.com/GetStream/stream-chat-react/blob/master/src/components/EventComponent/EventComponent.tsx) */\n  MessageSystem?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['MessageSystem'];\n  /** Custom UI component to display a timestamp on a message, defaults to and accepts same props as: [MessageTimestamp](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Message/MessageTimestamp.tsx) */\n  MessageTimestamp?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['MessageTimestamp'];\n  /** Whether to allow multiple attachment uploads */\n  multipleUploads?: boolean;\n  /** Custom action handler function to run on click of an @mention in a message */\n  onMentionsClick?: OnMentionAction<Us>;\n  /** Custom action handler function to run on hover of an @mention in a message */\n  onMentionsHover?: OnMentionAction<Us>;\n  /** If `dragAndDropWindow` prop is true, the props to pass to the MessageInput component (overrides props placed directly on MessageInput) */\n  optionalMessageInputProps?: MessageInputProps<At, Ch, Co, Ev, Me, Re, Us, V>;\n  /** Custom UI component to override default pinned message indicator, defaults to and accepts same props as: [PinIndicator](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Message/icons.tsx) */\n  PinIndicator?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['PinIndicator'];\n  /** Custom UI component to override quoted message UI on a sent message, defaults to and accepts same props as: [QuotedMessage](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Message/QuotedMessage.tsx) */\n  QuotedMessage?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['QuotedMessage'];\n  /** Custom UI component to override the message input's quoted message preview, defaults to and accepts same props as: [QuotedMessagePreview](https://github.com/GetStream/stream-chat-react/blob/master/src/components/MessageInput/QuotedMessagePreview.tsx) */\n  QuotedMessagePreview?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['QuotedMessagePreview'];\n  /** Custom UI component to display the reaction selector, defaults to and accepts same props as: [ReactionSelector](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Reactions/ReactionSelector.tsx) */\n  ReactionSelector?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['ReactionSelector'];\n  /** Custom UI component to display the list of reactions on a message, defaults to and accepts same props as: [ReactionsList](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Reactions/ReactionsList.tsx) */\n  ReactionsList?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['ReactionsList'];\n  /** Custom UI component for send button, defaults to and accepts same props as: [SendButton](https://github.com/GetStream/stream-chat-react/blob/master/src/components/MessageInput/icons.tsx) */\n  SendButton?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['SendButton'];\n  /** If true, skips the message data string comparison used to memoize the current channel messages (helpful for channels with 1000s of messages) */\n  skipMessageDataMemoization?: boolean;\n  /** Custom UI component to display the header of a `Thread`, defaults to and accepts same props as: [DefaultThreadHeader](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Thread/Thread.tsx) */\n  ThreadHeader?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['ThreadHeader'];\n  /** Custom UI component to display the start of a threaded `MessageList`, defaults to and accepts same props as: [DefaultThreadStart](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Thread/Thread.tsx) */\n  ThreadStart?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['ThreadStart'];\n  /** Optional context provider that lets you override the default autocomplete triggers, defaults to: [DefaultTriggerProvider](https://github.com/GetStream/stream-chat-react/blob/master/src/components/MessageInput/DefaultTriggerProvider.tsx) */\n  TriggerProvider?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['TriggerProvider'];\n  /** Custom UI component for the typing indicator, defaults to and accepts same props as: [TypingIndicator](https://github.com/GetStream/stream-chat-react/blob/master/src/components/TypingIndicator/TypingIndicator.tsx) */\n  TypingIndicator?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['TypingIndicator'];\n  /** Custom UI component to display a message in the `VirtualizedMessageList`, defaults to and accepts same props as: [FixedHeightMessage](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Message/FixedHeightMessage.tsx) */\n  VirtualMessage?: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us>['VirtualMessage'];\n};\n\nconst UnMemoizedChannel = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>(\n  props: PropsWithChildren<ChannelProps<At, Ch, Co, Ev, Me, Re, Us, V>>,\n) => {\n  const { channel: propsChannel, EmptyPlaceholder = null } = props;\n\n  const { channel: contextChannel } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('Channel');\n\n  const channel = propsChannel || contextChannel;\n\n  if (!channel?.cid) return EmptyPlaceholder;\n\n  return <ChannelInner {...props} channel={channel} key={channel.cid} />;\n};\n\nconst ChannelInner = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>(\n  props: PropsWithChildren<\n    ChannelProps<At, Ch, Co, Ev, Me, Re, Us, V> & {\n      channel: StreamChannel<At, Ch, Co, Ev, Me, Re, Us>;\n      key: string;\n    }\n  >,\n) => {\n  const {\n    acceptedFiles,\n    activeUnreadHandler,\n    channel,\n    children,\n    doMarkReadRequest,\n    doSendMessageRequest,\n    doUpdateMessageRequest,\n    dragAndDropWindow = false,\n    emojiData = defaultEmojiData,\n    LoadingErrorIndicator = DefaultLoadingErrorIndicator,\n    LoadingIndicator = DefaultLoadingIndicator,\n    maxNumberOfFiles,\n    multipleUploads = true,\n    onMentionsClick,\n    onMentionsHover,\n    optionalMessageInputProps = {},\n    skipMessageDataMemoization,\n  } = props;\n\n  const { client, customClasses, mutes, theme, useImageFlagEmojisOnWindows } = useChatContext<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us\n  >('Channel');\n  const { t } = useTranslationContext('Channel');\n\n  const [channelConfig, setChannelConfig] = useState(channel.getConfig());\n  const [notifications, setNotifications] = useState<ChannelNotifications>([]);\n  const [quotedMessage, setQuotedMessage] = useState<StreamMessage<At, Ch, Co, Ev, Me, Re, Us>>();\n\n  const notificationTimeouts: Array<NodeJS.Timeout> = [];\n\n  const [state, dispatch] = useReducer<ChannelStateReducer<At, Ch, Co, Ev, Me, Re, Us>>(\n    channelReducer,\n    initialState,\n  );\n\n  const isMounted = useIsMounted();\n\n  const originalTitle = useRef('');\n  const lastRead = useRef(new Date());\n  const online = useRef(true);\n\n  const channelCapabilitiesArray = channel.data?.own_capabilities as string[];\n\n  const emojiConfig: EmojiConfig = {\n    commonEmoji,\n    defaultMinimalEmojis,\n    emojiData,\n    emojiSetDef,\n  };\n\n  const throttledCopyStateFromChannel = throttle(\n    () => dispatch({ channel, type: 'copyStateFromChannelOnEvent' }),\n    500,\n    {\n      leading: true,\n      trailing: true,\n    },\n  );\n\n  const markRead = () => {\n    if (channel.disconnected || !channelConfig?.read_events) {\n      return;\n    }\n\n    lastRead.current = new Date();\n\n    if (doMarkReadRequest) {\n      doMarkReadRequest(channel);\n    } else {\n      logChatPromiseExecution(channel.markRead(), 'mark read');\n    }\n\n    if (activeUnreadHandler) {\n      activeUnreadHandler(0, originalTitle.current);\n    } else if (originalTitle.current) {\n      document.title = originalTitle.current;\n    }\n  };\n\n  const markReadThrottled = throttle(markRead, 500, { leading: true, trailing: true });\n\n  const handleEvent = (event: Event<At, Ch, Co, Ev, Me, Re, Us>) => {\n    if (event.message) {\n      dispatch({\n        channel,\n        message: event.message,\n        type: 'updateThreadOnEvent',\n      });\n    }\n\n    if (event.type === 'user.watching.start' || event.type === 'user.watching.stop') return;\n\n    if (event.type === 'typing.start' || event.type === 'typing.stop') {\n      return dispatch({ channel, type: 'setTyping' });\n    }\n\n    if (event.type === 'connection.changed' && typeof event.online === 'boolean') {\n      online.current = event.online;\n    }\n\n    if (event.type === 'message.new') {\n      let mainChannelUpdated = true;\n\n      if (event.message?.parent_id && !event.message?.show_in_channel) {\n        mainChannelUpdated = false;\n      }\n\n      if (mainChannelUpdated && event.message?.user?.id !== client.userID) {\n        if (!document.hidden) {\n          markReadThrottled();\n        } else if (channelConfig?.read_events && !channel.muteStatus().muted) {\n          const unread = channel.countUnread(lastRead.current);\n\n          if (activeUnreadHandler) {\n            activeUnreadHandler(unread, originalTitle.current);\n          } else {\n            document.title = `(${unread}) ${originalTitle.current}`;\n          }\n        }\n      }\n    }\n\n    throttledCopyStateFromChannel();\n  };\n\n  // useLayoutEffect here to prevent spinner. Use Suspense when it is available in stable release\n  useLayoutEffect(() => {\n    let errored = false;\n    let done = false;\n\n    const onVisibilityChange = () => {\n      if (!document.hidden) markRead();\n    };\n\n    (async () => {\n      if (!channel.initialized) {\n        try {\n          await channel.watch();\n          const config = channel.getConfig();\n          setChannelConfig(config);\n        } catch (e) {\n          dispatch({ error: e as Error, type: 'setError' });\n          errored = true;\n        }\n      }\n\n      done = true;\n      originalTitle.current = document.title;\n\n      if (!errored) {\n        dispatch({ channel, type: 'initStateFromChannel' });\n        if (channel.countUnread() > 0) markRead();\n        // The more complex sync logic is done in Chat\n        document.addEventListener('visibilitychange', onVisibilityChange);\n        client.on('connection.changed', handleEvent);\n        client.on('connection.recovered', handleEvent);\n        client.on('user.updated', handleEvent);\n        client.on('user.deleted', handleEvent);\n        channel.on(handleEvent);\n      }\n    })();\n\n    return () => {\n      if (errored || !done) return;\n      document.removeEventListener('visibilitychange', onVisibilityChange);\n      channel?.off(handleEvent);\n      client.off('connection.changed', handleEvent);\n      client.off('connection.recovered', handleEvent);\n      client.off('user.updated', handleEvent);\n      client.off('user.deleted', handleEvent);\n      notificationTimeouts.forEach(clearTimeout);\n    };\n  }, [channel.cid]);\n\n  useEffect(() => {\n    if (state.thread && state.messages?.length) {\n      for (let i = state.messages.length - 1; i >= 0; i -= 1) {\n        if (state.messages[i].id === state.thread.id) {\n          dispatch({ message: state.messages[i], type: 'setThread' });\n          break;\n        }\n      }\n    }\n  }, [state.messages, state.thread]);\n\n  /** MESSAGE */\n\n  // Adds a temporary notification to message list, will be removed after 5 seconds\n  const addNotification = (text: string, type: 'success' | 'error') => {\n    if (typeof text !== 'string' || (type !== 'success' && type !== 'error')) {\n      return;\n    }\n\n    const id = uuidv4();\n\n    setNotifications((prevNotifications) => [...prevNotifications, { id, text, type }]);\n\n    const timeout = setTimeout(\n      () =>\n        setNotifications((prevNotifications) =>\n          prevNotifications.filter((notification) => notification.id !== id),\n        ),\n      5000,\n    );\n\n    notificationTimeouts.push(timeout);\n  };\n\n  const loadMoreFinished = debounce(\n    (hasMore: boolean, messages: ChannelState<At, Ch, Co, Ev, Me, Re, Us>['messages']) => {\n      if (!isMounted.current) return;\n      dispatch({ hasMore, messages, type: 'loadMoreFinished' });\n    },\n    2000,\n    {\n      leading: true,\n      trailing: true,\n    },\n  );\n\n  const loadMore = async (limit = 100) => {\n    if (!online.current || !window.navigator.onLine) return 0;\n\n    // prevent duplicate loading events...\n    const oldestMessage = state?.messages?.[0];\n\n    if (state.loadingMore || oldestMessage?.status !== 'received') return 0;\n\n    // initial state loads with up to 25 messages, so if less than 25 no need for additional query\n    if (channel.state.messages.length < 25) {\n      loadMoreFinished(false, channel.state.messages);\n      return channel.state.messages.length;\n    }\n\n    dispatch({ loadingMore: true, type: 'setLoadingMore' });\n\n    const oldestID = oldestMessage?.id;\n    const perPage = limit;\n    let queryResponse: ChannelAPIResponse<At, Ch, Co, Me, Re, Us>;\n\n    try {\n      queryResponse = await channel.query({\n        messages: { id_lt: oldestID, limit: perPage },\n        watchers: { limit: perPage },\n      });\n    } catch (e) {\n      console.warn('message pagination request failed with error', e);\n      dispatch({ loadingMore: false, type: 'setLoadingMore' });\n      return 0;\n    }\n\n    const hasMoreMessages = queryResponse.messages.length === perPage;\n    loadMoreFinished(hasMoreMessages, channel.state.messages);\n\n    return queryResponse.messages.length;\n  };\n\n  const updateMessage = (\n    updatedMessage:\n      | MessageToSend<At, Ch, Co, Ev, Me, Re, Us>\n      | StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n  ) => {\n    // add the message to the local channel state\n    channel.state.addMessageSorted(updatedMessage as MessageResponse<At, Ch, Co, Me, Re, Us>, true);\n\n    dispatch({\n      channel,\n      parentId: state.thread && updatedMessage.parent_id,\n      type: 'copyMessagesFromChannel',\n    });\n  };\n\n  const isUserResponseArray = (\n    output: string[] | UserResponse<Us>[],\n  ): output is UserResponse<Us>[] => (output as UserResponse<Us>[])[0]?.id != null;\n\n  const doSendMessage = async (\n    message: MessageToSend<At, Ch, Co, Ev, Me, Re, Us> | StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n    customMessageData?: Partial<Message<At, Me, Us>>,\n  ) => {\n    const { attachments, id, mentioned_users = [], parent_id, text } = message;\n\n    // channel.sendMessage expects an array of user id strings\n    const mentions = isUserResponseArray(mentioned_users)\n      ? mentioned_users.map(({ id }) => id)\n      : mentioned_users;\n\n    const messageData = {\n      attachments,\n      id,\n      mentioned_users: mentions,\n      parent_id,\n      quoted_message_id: parent_id === quotedMessage?.parent_id ? quotedMessage?.id : undefined,\n      text,\n      ...customMessageData,\n    } as Message<At, Me, Us>;\n\n    try {\n      let messageResponse: void | SendMessageAPIResponse<At, Ch, Co, Me, Re, Us>;\n\n      if (doSendMessageRequest) {\n        messageResponse = await doSendMessageRequest(channel.cid, messageData);\n      } else {\n        messageResponse = await channel.sendMessage(messageData);\n      }\n\n      // replace it after send is completed\n      if (messageResponse?.message) {\n        updateMessage({\n          ...messageResponse.message,\n          status: 'received',\n        });\n      }\n\n      if (quotedMessage && parent_id === quotedMessage?.parent_id) setQuotedMessage(undefined);\n    } catch (error) {\n      // error response isn't usable so needs to be stringified then parsed\n      const stringError = JSON.stringify(error);\n      const parsedError = stringError ? JSON.parse(stringError) : {};\n\n      updateMessage({\n        ...message,\n        errorStatusCode: (parsedError.status as number) || undefined,\n        status: 'failed',\n      });\n    }\n  };\n\n  const createMessagePreview = (\n    text: string,\n    attachments: MessageAttachments<At>,\n    parent: StreamMessage<At, Ch, Co, Ev, Me, Re, Us> | undefined,\n    mentioned_users: UserResponse<Us>[],\n  ) => {\n    const clientSideID = `${client.userID}-${uuidv4()}`;\n\n    return ({\n      __html: text,\n      attachments,\n      created_at: new Date(),\n      html: text,\n      id: clientSideID,\n      mentioned_users,\n      reactions: [],\n      status: 'sending',\n      text,\n      type: 'regular',\n      user: client.user,\n      ...(parent?.id ? { parent_id: parent.id } : null),\n    } as unknown) as MessageResponse<At, Ch, Co, Me, Re, Us>;\n  };\n\n  const sendMessage = async (\n    {\n      attachments = [],\n      mentioned_users = [],\n      parent = undefined,\n      text = '',\n    }: MessageToSend<At, Ch, Co, Ev, Me, Re, Us>,\n    customMessageData?: Partial<Message<At, Me, Us>>,\n  ) => {\n    channel.state.filterErrorMessages();\n\n    const messagePreview = createMessagePreview(text, attachments, parent, mentioned_users);\n\n    updateMessage(messagePreview);\n\n    await doSendMessage(messagePreview, customMessageData);\n  };\n\n  const retrySendMessage = async (message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>) => {\n    updateMessage({\n      ...message,\n      errorStatusCode: undefined,\n      status: 'sending',\n    });\n\n    await doSendMessage(message);\n  };\n\n  const removeMessage = (message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>) => {\n    channel.state.removeMessage(message);\n\n    dispatch({\n      channel,\n      parentId: state.thread && message.parent_id,\n      type: 'copyMessagesFromChannel',\n    });\n  };\n\n  /** THREAD */\n\n  const openThread = (\n    message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n    event: React.BaseSyntheticEvent,\n  ) => {\n    event.preventDefault();\n    setQuotedMessage((current) => {\n      if (current?.parent_id !== message?.parent_id) {\n        return undefined;\n      } else {\n        return current;\n      }\n    });\n    dispatch({ channel, message, type: 'openThread' });\n  };\n\n  const closeThread = (event: React.BaseSyntheticEvent) => {\n    event.preventDefault();\n    dispatch({ type: 'closeThread' });\n  };\n\n  const loadMoreThreadFinished = debounce(\n    (\n      threadHasMore: boolean,\n      threadMessages: Array<ReturnType<ChannelState<At, Ch, Co, Ev, Me, Re, Us>['formatMessage']>>,\n    ) => {\n      dispatch({\n        threadHasMore,\n        threadMessages,\n        type: 'loadMoreThreadFinished',\n      });\n    },\n    2000,\n    { leading: true, trailing: true },\n  );\n\n  const loadMoreThread = async () => {\n    if (state.threadLoadingMore || !state.thread) return;\n\n    dispatch({ type: 'startLoadingThread' });\n    const parentID = state.thread.id;\n\n    if (!parentID) {\n      return dispatch({ type: 'closeThread' });\n    }\n\n    const oldMessages = channel.state.threads[parentID] || [];\n    const oldestMessageID = oldMessages[0]?.id;\n    const limit = 50;\n\n    try {\n      const queryResponse = await channel.getReplies(parentID, {\n        id_lt: oldestMessageID,\n        limit,\n      });\n\n      const threadHasMoreMessages = queryResponse.messages.length === limit;\n      const newThreadMessages = channel.state.threads[parentID] || [];\n\n      // next set loadingMore to false so we can start asking for more data\n      loadMoreThreadFinished(threadHasMoreMessages, newThreadMessages);\n    } catch (e) {\n      loadMoreThreadFinished(false, oldMessages);\n    }\n  };\n\n  const onMentionsHoverOrClick = useMentionsHandlers(onMentionsHover, onMentionsClick);\n\n  const editMessage = useEditMessageHandler(doUpdateMessageRequest);\n\n  const { typing, ...restState } = state;\n\n  const channelStateContextValue = useCreateChannelStateContext({\n    ...restState,\n    acceptedFiles,\n    channel,\n    channelCapabilitiesArray,\n    channelConfig,\n    dragAndDropWindow,\n    maxNumberOfFiles,\n    multipleUploads,\n    mutes,\n    notifications,\n    quotedMessage,\n    watcher_count: state.watcherCount,\n  });\n\n  const channelActionContextValue: ChannelActionContextValue<At, Ch, Co, Ev, Me, Re, Us> = useMemo(\n    () => ({\n      addNotification,\n      closeThread,\n      dispatch,\n      editMessage,\n      loadMore,\n      loadMoreThread,\n      onMentionsClick: onMentionsHoverOrClick,\n      onMentionsHover: onMentionsHoverOrClick,\n      openThread,\n      removeMessage,\n      retrySendMessage,\n      sendMessage,\n      setQuotedMessage,\n      skipMessageDataMemoization,\n      updateMessage,\n    }),\n    [channel.cid, loadMore, quotedMessage],\n  );\n\n  const componentContextValue: ComponentContextValue<At, Ch, Co, Ev, Me, Re, Us> = useMemo(\n    () => ({\n      Attachment: props.Attachment || DefaultAttachment,\n      AutocompleteSuggestionHeader: props.AutocompleteSuggestionHeader,\n      AutocompleteSuggestionItem: props.AutocompleteSuggestionItem,\n      AutocompleteSuggestionList: props.AutocompleteSuggestionList,\n      Avatar: props.Avatar,\n      CooldownTimer: props.CooldownTimer,\n      DateSeparator: props.DateSeparator,\n      EditMessageInput: props.EditMessageInput,\n      EmojiIcon: props.EmojiIcon,\n      EmptyStateIndicator: props.EmptyStateIndicator,\n      FileUploadIcon: props.FileUploadIcon,\n      GiphyPreviewMessage: props.GiphyPreviewMessage,\n      HeaderComponent: props.HeaderComponent,\n      Input: props.Input,\n      LoadingIndicator: props.LoadingIndicator,\n      Message: props.Message || MessageSimple,\n      MessageDeleted: props.MessageDeleted,\n      MessageListNotifications: props.MessageListNotifications,\n      MessageNotification: props.MessageNotification,\n      MessageOptions: props.MessageOptions,\n      MessageRepliesCountButton: props.MessageRepliesCountButton,\n      MessageStatus: props.MessageStatus,\n      MessageSystem: props.MessageSystem,\n      MessageTimestamp: props.MessageTimestamp,\n      PinIndicator: props.PinIndicator,\n      QuotedMessage: props.QuotedMessage,\n      QuotedMessagePreview: props.QuotedMessagePreview,\n      ReactionSelector: props.ReactionSelector,\n      ReactionsList: props.ReactionsList,\n      SendButton: props.SendButton,\n      ThreadHeader: props.ThreadHeader,\n      ThreadStart: props.ThreadStart,\n      TriggerProvider: props.TriggerProvider,\n      TypingIndicator: props.TypingIndicator,\n      VirtualMessage: props.VirtualMessage,\n    }),\n    [],\n  );\n\n  const emojiContextValue: EmojiContextValue = useMemo(\n    () => ({\n      Emoji: props.Emoji,\n      emojiConfig,\n      EmojiIndex: props.EmojiIndex,\n      EmojiPicker: props.EmojiPicker,\n    }),\n    [],\n  );\n\n  const typingContextValue = useCreateTypingContext({\n    typing,\n  });\n\n  const chatClass = customClasses?.chat || 'str-chat';\n  const chatContainerClass = customClasses?.chatContainer || 'str-chat__container';\n  const channelClass = customClasses?.channel || 'str-chat-channel';\n  const windowsEmojiClass =\n    useImageFlagEmojisOnWindows && navigator.userAgent.match(/Win/)\n      ? 'str-chat--windows-flags'\n      : '';\n\n  const NullProvider: React.FC = ({ children }) => <>{children}</>;\n\n  const OptionalMessageInputProvider = useMemo(\n    () => (dragAndDropWindow ? DropzoneProvider : NullProvider),\n    [dragAndDropWindow],\n  );\n\n  if (state.error) {\n    return (\n      <div className={`${chatClass} ${channelClass} ${theme}`}>\n        <LoadingErrorIndicator error={state.error} />\n      </div>\n    );\n  }\n\n  if (state.loading) {\n    return (\n      <div className={`${chatClass} ${channelClass} ${theme}`}>\n        <LoadingIndicator size={25} />\n      </div>\n    );\n  }\n\n  if (!channel.watch) {\n    return (\n      <div className={`${chatClass} ${channelClass} ${theme}`}>\n        <div>{t('Channel Missing')}</div>\n      </div>\n    );\n  }\n\n  return (\n    <div className={`${chatClass} ${channelClass} ${theme} ${windowsEmojiClass}`}>\n      <ChannelStateProvider value={channelStateContextValue}>\n        <ChannelActionProvider value={channelActionContextValue}>\n          <ComponentProvider value={componentContextValue}>\n            <EmojiProvider value={emojiContextValue}>\n              <TypingProvider value={typingContextValue}>\n                <div className={`${chatContainerClass}`}>\n                  <OptionalMessageInputProvider {...optionalMessageInputProps}>\n                    {children}\n                  </OptionalMessageInputProvider>\n                </div>\n              </TypingProvider>\n            </EmojiProvider>\n          </ComponentProvider>\n        </ChannelActionProvider>\n      </ChannelStateProvider>\n    </div>\n  );\n};\n\n/**\n * A wrapper component that provides channel data and renders children.\n * The Channel component provides the following contexts:\n * - [ChannelStateContext](https://getstream.io/chat/docs/sdk/react/contexts/channel_state_context/)\n * - [ChannelActionContext](https://getstream.io/chat/docs/sdk/react/contexts/channel_action_context/)\n * - [ComponentContext](https://getstream.io/chat/docs/sdk/react/contexts/component_context/)\n * - [EmojiContext](https://getstream.io/chat/docs/sdk/react/contexts/emoji_context/)\n * - [TypingContext](https://getstream.io/chat/docs/sdk/react/contexts/typing_context/)\n */\nexport const Channel = React.memo(UnMemoizedChannel) as typeof UnMemoizedChannel;\n","import React from 'react';\n\nimport { AvatarProps, Avatar as DefaultAvatar } from '../Avatar';\n\nimport { useChannelStateContext } from '../../context/ChannelStateContext';\nimport { useChatContext } from '../../context/ChatContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type ChannelHeaderProps = {\n  /** UI component to display a user's avatar, defaults to and accepts same props as: [Avatar](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Avatar/Avatar.tsx) */\n  Avatar?: React.ComponentType<AvatarProps>;\n  /** Manually set the image to render, defaults to the Channel image */\n  image?: string;\n  /** Show a little indicator that the Channel is live right now */\n  live?: boolean;\n  /** Set title manually */\n  title?: string;\n};\n\nconst UnMemoizedChannelHeader = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: ChannelHeaderProps,\n) => {\n  const { Avatar = DefaultAvatar, image: propImage, live, title } = props;\n\n  const { channel, watcher_count } = useChannelStateContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'ChannelHeader',\n  );\n  const { openMobileNav } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('ChannelHeader');\n  const { t } = useTranslationContext('ChannelHeader');\n\n  const { image: channelImage, member_count, name, subtitle } = channel?.data || {};\n\n  const image = propImage || channelImage;\n\n  return (\n    <div className='str-chat__header-livestream'>\n      <button aria-label='Menu' className='str-chat__header-hamburger' onClick={openMobileNav}>\n        <span className='str-chat__header-hamburger--line'></span>\n        <span className='str-chat__header-hamburger--line'></span>\n        <span className='str-chat__header-hamburger--line'></span>\n      </button>\n      {image && (\n        <Avatar image={image} shape='rounded' size={channel?.type === 'commerce' ? 60 : 40} />\n      )}\n      <div className='str-chat__header-livestream-left'>\n        <p className='str-chat__header-livestream-left--title'>\n          {title || name}{' '}\n          {live && <span className='str-chat__header-livestream-left--livelabel'>{t('live')}</span>}\n        </p>\n        {subtitle && <p className='str-chat__header-livestream-left--subtitle'>{subtitle}</p>}\n        <p className='str-chat__header-livestream-left--members'>\n          {!live && !!member_count && member_count > 0 && (\n            <>\n              {t('{{ memberCount }} members', {\n                memberCount: member_count,\n              })}\n              ,{' '}\n            </>\n          )}\n          {t('{{ watcherCount }} online', { watcherCount: watcher_count })}\n        </p>\n      </div>\n    </div>\n  );\n};\n\n/**\n * The ChannelHeader component renders some basic information about a Channel.\n */\nexport const ChannelHeader = React.memo(UnMemoizedChannelHeader) as typeof UnMemoizedChannelHeader;\n","var img = \"data:image/svg+xml,%3c%3fxml version='1.0' encoding='UTF-8'%3f%3e%3csvg width='78px' height='78px' viewBox='0 0 78 78' version='1.1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink'%3e %3c!-- Generator: Sketch 52.6 (67491) - http://www.bohemiancoding.com/sketch --%3e %3ctitle%3eCombined Shape%3c/title%3e %3cdesc%3eCreated with Sketch.%3c/desc%3e %3cg id='Interactions' stroke='none' stroke-width='1' fill='none' fill-rule='evenodd'%3e %3cg id='Connection-Error-_-Connectivity' transform='translate(-270.000000%2c -30.000000)' fill='%23CF1F25'%3e %3cg id='109-network-connection' transform='translate(270.000000%2c 30.000000)'%3e %3cpath d='M66.4609744%2c11.414231 C81.6225232%2c26.5757798 81.6225232%2c51.157545 66.4609744%2c66.3188467 C51.2994256%2c81.4803954 26.7176604%2c81.4803954 11.5563587%2c66.3188467 C-3.60519004%2c51.1572979 -3.60519004%2c26.5755327 11.5563587%2c11.414231 C26.7179075%2c-3.74731776 51.2996727%2c-3.74731776 66.4609744%2c11.414231 Z M54.7853215%2c45.8823776 L54.7853215%2c40.5882574 C54.7853215%2c39.613638 53.9952341%2c38.8235506 53.0206147%2c38.8235506 L44.9576695%2c38.8235506 L41.428256%2c42.3529641 L51.255555%2c42.3529641 L51.255555%2c45.8823776 L54.7853215%2c45.8823776 Z M40.6659027%2c43.1153174 L37.8988425%2c45.8823776 L40.6659027%2c45.8823776 L40.6659027%2c43.1153174 Z M51.1764962%2c56.4702653 L58.2353232%2c56.4702653 C59.2099355%2c56.4702653 60.00003%2c55.6801708 60.00003%2c54.7055585 L60.00003%2c51.176145 C60.00003%2c50.2015327 59.2099355%2c49.4114382 58.2353232%2c49.4114382 L51.1764962%2c49.4114382 C50.2018839%2c49.4114382 49.4117894%2c50.2015327 49.4117894%2c51.176145 L49.4117894%2c54.7055585 C49.4117894%2c55.6801708 50.2018839%2c56.4702653 51.1764962%2c56.4702653 Z M35.2941353%2c56.4702653 L42.3529624%2c56.4702653 C43.3275746%2c56.4702653 44.1176691%2c55.6801708 44.1176691%2c54.7055585 L44.1176691%2c51.176145 C44.1176691%2c50.2015327 43.3275746%2c49.4114382 42.3529624%2c49.4114382 L35.2941353%2c49.4114382 C34.319523%2c49.4114382 33.5294285%2c50.2015327 33.5294285%2c51.176145 L33.5294285%2c54.7055585 C33.5294285%2c55.6801708 34.319523%2c56.4702653 35.2941353%2c56.4702653 Z M56.6964989%2c19.0874231 C56.007381%2c18.3985134 54.8903216%2c18.3985134 54.2012036%2c19.087423 L45.882376%2c27.4062507 L45.882376%2c19.4117761 C45.882376%2c18.4371568 45.0922885%2c17.6470693 44.1176692%2c17.6470693 L33.5294286%2c17.6470693 C32.5548092%2c17.6470694 31.7647218%2c18.4371568 31.7647218%2c19.4117761 L31.7647218%2c30.0000167 C31.7647219%2c30.9746363 32.5548092%2c31.7647237 33.5294285%2c31.7647237 L41.5239031%2c31.7647237 L34.4650761%2c38.8235508 L24.7058947%2c38.8235508 C23.7312753%2c38.8235508 22.9411879%2c39.6136382 22.9411879%2c40.5882575 L22.9411879%2c45.8823778 L26.4706014%2c45.8823778 L26.4706014%2c42.3529643 L30.9356624%2c42.3529643 L23.8768354%2c49.4117914 L19.4117743%2c49.4117914 C18.4371549%2c49.4117914 17.6470675%2c50.2018788 17.6470675%2c51.1764981 L17.6470675%2c54.7059117 C17.6504049%2c54.9674302 17.7129076%2c55.2248042 17.8298886%2c55.4587302 L16.4456526%2c56.8429662 C15.7446193%2c57.5200453 15.7252005%2c58.6372282 16.4022825%2c59.3382615 C17.0793616%2c60.0392948 18.1965445%2c60.0587136 18.8975778%2c59.3816316 C18.9122847%2c59.3674273 18.9267436%2c59.3529684 18.940948%2c59.3382615 L56.6964963%2c21.5830662 C57.3856425%2c20.8939094 57.3856425%2c19.7765747 56.6964963%2c19.0874179 Z' id='Combined-Shape'%3e%3c/path%3e %3c/g%3e %3c/g%3e %3c/g%3e%3c/svg%3e\";\n  export default img;","import React from 'react';\n\nimport { LoadingChannels } from '../Loading/LoadingChannels';\n\nimport placeholder from '../../assets/str-chat__connection-error.svg';\nimport { useTranslationContext } from '../../context/TranslationContext';\n\nexport type ChatDownProps = {\n  /** The type of error */\n  type: string;\n  /** The image url for this error */\n  image?: string;\n  /** The error message to show */\n  text?: string;\n};\n\nconst UnMemoizedChatDown: React.FC<ChatDownProps> = (props) => {\n  const { image, text, type = 'Error' } = props;\n\n  const { t } = useTranslationContext('ChatDown');\n\n  return (\n    <div className='str-chat__down'>\n      <LoadingChannels />\n      <div className='str-chat__down-main'>\n        <img alt='Connection error' data-testid='chatdown-img' src={image || placeholder} />\n        <h1>{type}</h1>\n        <h3 aria-live='assertive'>\n          {text || t('Error connecting to chat, refresh the page to try again.')}\n        </h3>\n      </div>\n    </div>\n  );\n};\n\n/**\n * A simple indicator that chat functionality isn't available, triggered when the Chat API is unavailable or your network isn't working.\n */\nexport const ChatDown = React.memo(UnMemoizedChatDown) as typeof UnMemoizedChatDown;\n","import React, { PropsWithChildren } from 'react';\n\nimport { ChatDown, ChatDownProps } from '../ChatDown/ChatDown';\nimport { LoadingChannels } from '../Loading/LoadingChannels';\n\nimport type { Channel } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type ChannelListMessengerProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  /** Whether or not the channel query request returned an errored response */\n  error?: boolean;\n  /** The channels currently loaded in the list, only defined if `sendChannelsToList` on `ChannelList` is true */\n  loadedChannels?: Channel<At, Ch, Co, Ev, Me, Re, Us>[];\n  /** Whether or not channels are currently loading */\n  loading?: boolean;\n  /** Custom UI component to display a loading error, defaults to and accepts same props as: [ChatDown](https://github.com/GetStream/stream-chat-react/blob/master/src/components/ChatDown/ChatDown.tsx) */\n  LoadingErrorIndicator?: React.ComponentType<ChatDownProps>;\n  /** Custom UI component to display a loading indicator, defaults to and accepts same props as: [LoadingChannels](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Loading/LoadingChannels.tsx) */\n  LoadingIndicator?: React.ComponentType;\n  /** Local state hook that resets the currently loaded channels */\n  setChannels?: React.Dispatch<React.SetStateAction<Channel<At, Ch, Co, Ev, Me, Re, Us>[]>>;\n};\n\n/**\n * A preview list of channels, allowing you to select the channel you want to open\n */\nexport const ChannelListMessenger = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: PropsWithChildren<ChannelListMessengerProps<At, Ch, Co, Ev, Me, Re, Us>>,\n) => {\n  const {\n    children,\n    error = false,\n    loading,\n    LoadingErrorIndicator = ChatDown,\n    LoadingIndicator = LoadingChannels,\n  } = props;\n\n  if (error) {\n    return <LoadingErrorIndicator type='Connection Error' />;\n  }\n\n  if (loading) {\n    return <LoadingIndicator />;\n  }\n\n  return (\n    <div className='str-chat__channel-list-messenger'>\n      <div\n        aria-label='Channel list'\n        className='str-chat__channel-list-messenger__main'\n        role='listbox'\n      >\n        {children}\n      </div>\n    </div>\n  );\n};\n","import { useEffect } from 'react';\n\nimport { useChatContext } from '../../../context/ChatContext';\n\nimport type { Channel, Event } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useChannelDeletedListener = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n  customHandler?: (\n    setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n    event: Event<At, Ch, Co, Ev, Me, Re, Us>,\n  ) => void,\n) => {\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('useChannelDeletedListener');\n\n  useEffect(() => {\n    const handleEvent = (event: Event<At, Ch, Co, Ev, Me, Re, Us>) => {\n      if (customHandler && typeof customHandler === 'function') {\n        customHandler(setChannels, event);\n      } else {\n        setChannels((channels) => {\n          const channelIndex = channels.findIndex((channel) => channel.cid === event.cid);\n\n          if (channelIndex < 0) return [...channels];\n\n          // Remove the deleted channel from the list.s\n          channels.splice(channelIndex, 1);\n\n          return [...channels];\n        });\n      }\n    };\n\n    client.on('channel.deleted', handleEvent);\n\n    return () => {\n      client.off('channel.deleted', handleEvent);\n    };\n  }, [customHandler]);\n};\n","import { useEffect } from 'react';\n\nimport { useChatContext } from '../../../context/ChatContext';\n\nimport type { Channel, Event } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useChannelHiddenListener = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n  customHandler?: (\n    setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n    event: Event<At, Ch, Co, Ev, Me, Re, Us>,\n  ) => void,\n) => {\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('useChannelHiddenListener');\n\n  useEffect(() => {\n    const handleEvent = (event: Event<At, Ch, Co, Ev, Me, Re, Us>) => {\n      if (customHandler && typeof customHandler === 'function') {\n        customHandler(setChannels, event);\n      } else {\n        setChannels((channels) => {\n          const channelIndex = channels.findIndex((channel) => channel.cid === event.cid);\n          if (channelIndex < 0) return [...channels];\n\n          // Remove the hidden channel from the list.s\n          channels.splice(channelIndex, 1);\n\n          return [...channels];\n        });\n      }\n    };\n\n    client.on('channel.hidden', handleEvent);\n\n    return () => {\n      client.off('channel.hidden', handleEvent);\n    };\n  }, [customHandler]);\n};\n","import { useEffect } from 'react';\n\nimport { useChatContext } from '../../../context/ChatContext';\n\nimport type { Channel, Event } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useChannelTruncatedListener = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n  customHandler?: (\n    setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n    event: Event<At, Ch, Co, Ev, Me, Re, Us>,\n  ) => void,\n  forceUpdate?: () => void,\n) => {\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('useChannelTruncatedListener');\n\n  useEffect(() => {\n    const handleEvent = (event: Event<At, Ch, Co, Ev, Me, Re, Us>) => {\n      setChannels((channels) => [...channels]);\n\n      if (customHandler && typeof customHandler === 'function') {\n        customHandler(setChannels, event);\n      }\n      if (forceUpdate) {\n        forceUpdate();\n      }\n    };\n\n    client.on('channel.truncated', handleEvent);\n\n    return () => {\n      client.off('channel.truncated', handleEvent);\n    };\n  }, [customHandler]);\n};\n","import { useEffect } from 'react';\n\nimport { useChatContext } from '../../../context/ChatContext';\n\nimport type { Channel, Event } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useChannelUpdatedListener = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n  customHandler?: (\n    setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n    event: Event<At, Ch, Co, Ev, Me, Re, Us>,\n  ) => void,\n  forceUpdate?: () => void,\n) => {\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('useChannelUpdatedListener');\n\n  useEffect(() => {\n    const handleEvent = (event: Event<At, Ch, Co, Ev, Me, Re, Us>) => {\n      setChannels((channels) => {\n        const channelIndex = channels.findIndex((channel) => channel.cid === event.channel?.cid);\n\n        if (channelIndex > -1 && event.channel) {\n          const newChannels = channels;\n          newChannels[channelIndex].data = {\n            ...event.channel,\n            hidden: event.channel?.hidden ?? newChannels[channelIndex].data?.hidden,\n            own_capabilities:\n              event.channel?.own_capabilities ?? newChannels[channelIndex].data?.own_capabilities,\n          };\n\n          return [...newChannels];\n        }\n\n        return channels;\n      });\n      if (forceUpdate) {\n        forceUpdate();\n      }\n      if (customHandler && typeof customHandler === 'function') {\n        customHandler(setChannels, event);\n      }\n    };\n\n    client.on('channel.updated', handleEvent);\n\n    return () => {\n      client.off('channel.updated', handleEvent);\n    };\n  }, [customHandler]);\n};\n","import type { Channel, StreamChat } from 'stream-chat';\nimport uniqBy from 'lodash.uniqby';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport const getChannel = async <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  client: StreamChat<At, Ch, Co, Ev, Me, Re, Us>,\n  type: string,\n  id: string,\n) => {\n  const channel = client.channel(type, id);\n  await channel.watch();\n  return channel;\n};\n\nexport const MAX_QUERY_CHANNELS_LIMIT = 30;\n\ntype MoveChannelUpParams<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  channels: Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>;\n  cid: string;\n  activeChannel?: Channel<At, Ch, Co, Ev, Me, Re, Us>;\n};\n\nexport const moveChannelUp = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>({\n  activeChannel,\n  channels,\n  cid,\n}: MoveChannelUpParams<At, Ch, Co, Ev, Me, Re, Us>) => {\n  // get index of channel to move up\n  const channelIndex = channels.findIndex((channel) => channel.cid === cid);\n\n  if (!activeChannel && channelIndex <= 0) return channels;\n\n  // get channel to move up\n  const channel = activeChannel || channels[channelIndex];\n\n  return uniqBy([channel, ...channels], 'cid');\n};\n","import { useEffect } from 'react';\nimport uniqBy from 'lodash.uniqby';\n\nimport { getChannel } from '../utils';\n\nimport { useChatContext } from '../../../context/ChatContext';\n\nimport type { Channel, Event } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useChannelVisibleListener = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n  customHandler?: (\n    setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n    event: Event<At, Ch, Co, Ev, Me, Re, Us>,\n  ) => void,\n) => {\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('useChannelVisibleListener');\n\n  useEffect(() => {\n    const handleEvent = async (event: Event<At, Ch, Co, Ev, Me, Re, Us>) => {\n      if (customHandler && typeof customHandler === 'function') {\n        customHandler(setChannels, event);\n      } else if (event.type && event.channel_type && event.channel_id) {\n        const channel = await getChannel(client, event.channel_type, event.channel_id);\n        setChannels((channels) => uniqBy([channel, ...channels], 'cid'));\n      }\n    };\n\n    client.on('channel.visible', handleEvent);\n\n    return () => {\n      client.off('channel.visible', handleEvent);\n    };\n  }, [customHandler]);\n};\n","import { useEffect } from 'react';\n\nimport { useChatContext } from '../../../context/ChatContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useConnectionRecoveredListener = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  forceUpdate?: () => void,\n) => {\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('useConnectionRecoveredListener');\n\n  useEffect(() => {\n    const handleEvent = () => {\n      if (forceUpdate) {\n        forceUpdate();\n      }\n    };\n\n    client.on('connection.recovered', handleEvent);\n\n    return () => {\n      client.off('connection.recovered', handleEvent);\n    };\n  }, []);\n};\n","import { useEffect } from 'react';\nimport uniqBy from 'lodash.uniqby';\n\nimport { moveChannelUp } from '../utils';\n\nimport { useChatContext } from '../../../context/ChatContext';\n\nimport type { Channel, Event } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useMessageNewListener = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n  lockChannelOrder = false,\n  allowNewMessagesFromUnfilteredChannels = true,\n) => {\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('useMessageNewListener');\n\n  useEffect(() => {\n    const handleEvent = (event: Event<At, Ch, Co, Ev, Me, Re, Us>) => {\n      setChannels((channels) => {\n        const channelInList = channels.filter((channel) => channel.cid === event.cid).length > 0;\n\n        if (!channelInList && allowNewMessagesFromUnfilteredChannels && event.channel_type) {\n          const channel = client.channel(event.channel_type, event.channel_id);\n          return uniqBy([channel, ...channels], 'cid');\n        }\n\n        if (!lockChannelOrder) return moveChannelUp({ channels, cid: event.cid || '' });\n\n        return channels;\n      });\n    };\n\n    client.on('message.new', handleEvent);\n\n    return () => {\n      client.off('message.new', handleEvent);\n    };\n  }, [lockChannelOrder]);\n};\n","import { useEffect } from 'react';\n\nexport const useMobileNavigation = (\n  channelListRef: React.RefObject<HTMLDivElement>,\n  navOpen: boolean,\n  closeMobileNav?: () => void,\n) => {\n  useEffect(() => {\n    const handleClickOutside = (event: MouseEvent) => {\n      if (\n        closeMobileNav &&\n        channelListRef.current &&\n        !channelListRef.current.contains(event.target as Node) &&\n        navOpen\n      ) {\n        closeMobileNav();\n      }\n    };\n\n    document.addEventListener('click', handleClickOutside);\n\n    return () => {\n      document.removeEventListener('click', handleClickOutside);\n    };\n  }, [channelListRef, closeMobileNav, navOpen]);\n};\n","import { useEffect } from 'react';\nimport uniqBy from 'lodash.uniqby';\n\nimport { getChannel } from '../utils';\n\nimport { useChatContext } from '../../../context/ChatContext';\n\nimport type { Channel, Event } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useNotificationAddedToChannelListener = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n  customHandler?: (\n    setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n    event: Event<At, Ch, Co, Ev, Me, Re, Us>,\n  ) => void,\n  allowNewMessagesFromUnfilteredChannels = true,\n) => {\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'useNotificationAddedToChannelListener',\n  );\n\n  useEffect(() => {\n    const handleEvent = async (event: Event<At, Ch, Co, Ev, Me, Re, Us>) => {\n      if (customHandler && typeof customHandler === 'function') {\n        customHandler(setChannels, event);\n      } else if (allowNewMessagesFromUnfilteredChannels && event.channel?.type) {\n        const channel = await getChannel(client, event.channel.type, event.channel.id);\n        setChannels((channels) => uniqBy([channel, ...channels], 'cid'));\n      }\n    };\n\n    client.on('notification.added_to_channel', handleEvent);\n\n    return () => {\n      client.off('notification.added_to_channel', handleEvent);\n    };\n  }, [customHandler]);\n};\n","import { useEffect } from 'react';\nimport uniqBy from 'lodash.uniqby';\n\nimport { getChannel } from '../utils';\n\nimport { useChatContext } from '../../../context/ChatContext';\n\nimport type { Channel, Event } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useNotificationMessageNewListener = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n  customHandler?: (\n    setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n    event: Event<At, Ch, Co, Ev, Me, Re, Us>,\n  ) => void,\n  allowNewMessagesFromUnfilteredChannels = true,\n) => {\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'useNotificationMessageNewListener',\n  );\n\n  useEffect(() => {\n    const handleEvent = async (event: Event<At, Ch, Co, Ev, Me, Re, Us>) => {\n      if (customHandler && typeof customHandler === 'function') {\n        customHandler(setChannels, event);\n      } else if (allowNewMessagesFromUnfilteredChannels && event.channel?.type) {\n        const channel = await getChannel(client, event.channel.type, event.channel.id);\n        setChannels((channels) => uniqBy([channel, ...channels], 'cid'));\n      }\n    };\n\n    client.on('notification.message_new', handleEvent);\n\n    return () => {\n      client.off('notification.message_new', handleEvent);\n    };\n  }, [customHandler]);\n};\n","import { useEffect } from 'react';\n\nimport { useChatContext } from '../../../context/ChatContext';\n\nimport type { Channel, Event } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useNotificationRemovedFromChannelListener = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n  customHandler?: (\n    setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n    event: Event<At, Ch, Co, Ev, Me, Re, Us>,\n  ) => void,\n) => {\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'useNotificationRemovedFromChannelListener',\n  );\n\n  useEffect(() => {\n    const handleEvent = (event: Event<At, Ch, Co, Ev, Me, Re, Us>) => {\n      if (customHandler && typeof customHandler === 'function') {\n        customHandler(setChannels, event);\n      } else {\n        setChannels((channels) => channels.filter((channel) => channel.cid !== event.channel?.cid));\n      }\n    };\n\n    client.on('notification.removed_from_channel', handleEvent);\n\n    return () => {\n      client.off('notification.removed_from_channel', handleEvent);\n    };\n  }, [customHandler]);\n};\n","import { useEffect, useMemo, useState } from 'react';\n\nimport { MAX_QUERY_CHANNELS_LIMIT } from '../utils';\n\nimport type { Channel, ChannelFilters, ChannelOptions, ChannelSort, StreamChat } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const usePaginatedChannels = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  client: StreamChat<At, Ch, Co, Ev, Me, Re, Us>,\n  filters: ChannelFilters<Ch, Co, Us>,\n  sort: ChannelSort<Ch>,\n  options: ChannelOptions,\n  activeChannelHandler: (\n    channels: Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>,\n    setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n  ) => void,\n) => {\n  const [channels, setChannels] = useState<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>([]);\n  const [error, setError] = useState(false);\n  const [hasNextPage, setHasNextPage] = useState(true);\n  const [loadingChannels, setLoadingChannels] = useState(true);\n  const [refreshing, setRefreshing] = useState(true);\n\n  const filterString = useMemo(() => JSON.stringify(filters), [filters]);\n  const sortString = useMemo(() => JSON.stringify(sort), [sort]);\n\n  const queryChannels = async (queryType?: string) => {\n    setError(false);\n\n    if (queryType === 'reload') {\n      setChannels([]);\n      setLoadingChannels(true);\n    }\n\n    setRefreshing(true);\n\n    const offset = queryType === 'reload' ? 0 : channels.length;\n\n    const newOptions = {\n      limit: options?.limit ?? MAX_QUERY_CHANNELS_LIMIT,\n      offset,\n      ...options,\n    };\n\n    try {\n      const channelQueryResponse = await client.queryChannels(filters, sort || {}, newOptions);\n\n      const newChannels =\n        queryType === 'reload' ? channelQueryResponse : [...channels, ...channelQueryResponse];\n\n      setChannels(newChannels);\n      setHasNextPage(channelQueryResponse.length >= newOptions.limit);\n\n      // Set active channel only on load of first page\n      if (!offset && activeChannelHandler) {\n        activeChannelHandler(newChannels, setChannels);\n      }\n    } catch (err) {\n      console.warn(err);\n      setError(true);\n    }\n\n    setLoadingChannels(false);\n    setRefreshing(false);\n  };\n\n  const loadNextPage = () => {\n    queryChannels();\n  };\n\n  useEffect(() => {\n    queryChannels('reload');\n  }, [filterString, sortString]);\n\n  return {\n    channels,\n    hasNextPage,\n    loadNextPage,\n    setChannels,\n    status: {\n      error,\n      loadingChannels,\n      refreshing,\n    },\n  };\n};\n","import { useEffect } from 'react';\n\nimport { useChatContext } from '../../../context/ChatContext';\n\nimport type { Channel, Event } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useUserPresenceChangedListener = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n) => {\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('useUserPresenceChangedListener');\n\n  useEffect(() => {\n    const handleEvent = (event: Event<At, Ch, Co, Ev, Me, Re, Us>) => {\n      setChannels((channels) => {\n        const newChannels = channels.map((channel) => {\n          if (!event.user?.id || !channel.state.members[event.user.id]) {\n            return channel;\n          }\n\n          const newChannel = channel; // dumb workaround for linter\n          newChannel.state.members[event.user.id].user = event.user;\n\n          return newChannel;\n        });\n\n        return [...newChannels];\n      });\n    };\n\n    client.on('user.presence.changed', handleEvent);\n\n    return () => {\n      client.off('user.presence.changed', handleEvent);\n    };\n  }, []);\n};\n","import React, { useRef } from 'react';\n\nimport { Avatar as DefaultAvatar } from '../Avatar';\n\nimport type { ChannelPreviewUIComponentProps } from './ChannelPreview';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nconst UnMemoizedChannelPreviewMessenger = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: ChannelPreviewUIComponentProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const {\n    active,\n    Avatar = DefaultAvatar,\n    channel,\n    displayImage,\n    displayTitle,\n    latestMessage,\n    setActiveChannel,\n    unread,\n    watchers,\n  } = props;\n\n  const channelPreviewButton = useRef<HTMLButtonElement | null>(null);\n\n  const activeClass = active ? 'str-chat__channel-preview-messenger--active' : '';\n  const unreadClass = unread && unread >= 1 ? 'str-chat__channel-preview-messenger--unread' : '';\n\n  const avatarName =\n    displayTitle || channel.state.messages[channel.state.messages.length - 1]?.user?.id;\n\n  const onSelectChannel = () => {\n    if (setActiveChannel) {\n      setActiveChannel(channel, watchers);\n    }\n    if (channelPreviewButton?.current) {\n      channelPreviewButton.current.blur();\n    }\n  };\n\n  return (\n    <button\n      aria-label={`Select Channel: ${displayTitle || ''}`}\n      aria-selected={active}\n      className={`str-chat__channel-preview-messenger ${unreadClass} ${activeClass}`}\n      data-testid='channel-preview-button'\n      onClick={onSelectChannel}\n      ref={channelPreviewButton}\n      role='option'\n    >\n      <div className='str-chat__channel-preview-messenger--left'>\n        <Avatar image={displayImage} name={avatarName} size={40} />\n      </div>\n      <div className='str-chat__channel-preview-messenger--right'>\n        <div className='str-chat__channel-preview-messenger--name'>\n          <span>{displayTitle}</span>\n        </div>\n        <div className='str-chat__channel-preview-messenger--last-message'>{latestMessage}</div>\n      </div>\n    </button>\n  );\n};\n\n/**\n * Used as preview component for channel item in [ChannelList](#channellist) component.\n * Its best suited for messenger type chat.\n */\nexport const ChannelPreviewMessenger = React.memo(\n  UnMemoizedChannelPreviewMessenger,\n) as typeof UnMemoizedChannelPreviewMessenger;\n","import { useEffect, useState } from 'react';\n\nimport { useChatContext } from '../../../context/ChatContext';\n\nimport type { Channel } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useIsChannelMuted = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  channel: Channel<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('useIsChannelMuted');\n\n  const [muted, setMuted] = useState(channel.muteStatus());\n\n  useEffect(() => {\n    const handleEvent = () => setMuted(channel.muteStatus());\n\n    client.on('notification.channel_mutes_updated', handleEvent);\n    return () => client.off('notification.channel_mutes_updated', handleEvent);\n  }, [muted]);\n\n  return muted;\n};\n","import React from 'react';\n\nimport ReactMarkdown from 'react-markdown/with-html';\n\nimport type { Channel, TranslationLanguages, UserResponse } from 'stream-chat';\n\nimport type { TranslationContextValue } from '../../context/TranslationContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport const renderPreviewText = (text: string) => <ReactMarkdown source={text} />;\n\nexport const getLatestMessagePreview = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  channel: Channel<At, Ch, Co, Ev, Me, Re, Us>,\n  t: TranslationContextValue['t'],\n  userLanguage: TranslationContextValue['userLanguage'] = 'en',\n): string | JSX.Element => {\n  const latestMessage = channel.state.messages[channel.state.messages.length - 1];\n\n  const previewTextToRender =\n    latestMessage?.i18n?.[`${userLanguage}_text` as `${TranslationLanguages}_text`] ||\n    latestMessage?.text;\n\n  if (!latestMessage) {\n    return t('Nothing yet...');\n  }\n\n  if (latestMessage.deleted_at) {\n    return t('Message deleted');\n  }\n\n  if (previewTextToRender) {\n    const renderedText = renderPreviewText(previewTextToRender);\n    return renderedText;\n  }\n\n  if (latestMessage.command) {\n    return `/${latestMessage.command}`;\n  }\n\n  if (latestMessage.attachments?.length) {\n    return t(' Attachment...');\n  }\n\n  return t('Empty message...');\n};\n\nexport const getDisplayTitle = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  channel: Channel<At, Ch, Co, Ev, Me, Re, Us>,\n  currentUser?: UserResponse<Us>,\n) => {\n  let title = channel.data?.name;\n  const members = Object.values(channel.state.members);\n\n  if (!title && members.length === 2) {\n    const otherMember = members.find((member) => member.user?.id !== currentUser?.id);\n    if (otherMember?.user?.name) {\n      title = otherMember.user.name;\n    }\n  }\n\n  return title;\n};\n\nexport const getDisplayImage = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType = DefaultUserType\n>(\n  channel: Channel<At, Ch, Co, Ev, Me, Re, Us>,\n  currentUser?: UserResponse<Us>,\n) => {\n  let image = channel.data?.image;\n  const members = Object.values(channel.state.members);\n\n  if (!image && members.length === 2) {\n    const otherMember = members.find((member) => member.user?.id !== currentUser?.id);\n    if (otherMember?.user?.image) {\n      image = otherMember.user.image;\n    }\n  }\n\n  return image;\n};\n","import React, { useEffect, useState } from 'react';\n\nimport { ChannelPreviewMessenger } from './ChannelPreviewMessenger';\nimport { useIsChannelMuted } from './hooks/useIsChannelMuted';\nimport { getDisplayImage, getDisplayTitle, getLatestMessagePreview } from './utils';\n\nimport { ChatContextValue, useChatContext } from '../../context/ChatContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\n\nimport type { Channel, Event } from 'stream-chat';\n\nimport type { AvatarProps } from '../Avatar/Avatar';\n\nimport type { StreamMessage } from '../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type ChannelPreviewUIComponentProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = ChannelPreviewProps<At, Ch, Co, Ev, Me, Re, Us> & {\n  /** If the component's channel is the active (selected) Channel */\n  active?: boolean;\n  /** Image of Channel to display */\n  displayImage?: string;\n  /** Title of Channel to display */\n  displayTitle?: string;\n  /** The last message received in a channel */\n  lastMessage?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>;\n  /** Latest message preview to display, will be a string or JSX element supporting markdown. */\n  latestMessage?: string | JSX.Element;\n  /** Number of unread Messages */\n  unread?: number;\n};\n\nexport type ChannelPreviewProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  /** Comes from either the `channelRenderFilterFn` or `usePaginatedChannels` call from [ChannelList](https://github.com/GetStream/stream-chat-react/blob/master/src/components/ChannelList/ChannelList.tsx) */\n  channel: Channel<At, Ch, Co, Ev, Me, Re, Us>;\n  /** Current selected channel object */\n  activeChannel?: Channel<At, Ch, Co, Ev, Me, Re, Us>;\n  /** Custom UI component to display user avatar, defaults to and accepts same props as: [Avatar](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Avatar/Avatar.tsx) */\n  Avatar?: React.ComponentType<AvatarProps>;\n  /** Forces the update of preview component on channel update */\n  channelUpdateCount?: number;\n  key?: string;\n  /** Custom UI component to display the channel preview in the list, defaults to and accepts same props as: [ChannelPreviewMessenger](https://github.com/GetStream/stream-chat-react/blob/master/src/components/ChannelPreview/ChannelPreviewMessenger.tsx) */\n  Preview?: React.ComponentType<ChannelPreviewUIComponentProps<At, Ch, Co, Ev, Me, Re, Us>>;\n  /** Setter for selected Channel */\n  setActiveChannel?: ChatContextValue<At, Ch, Co, Ev, Me, Re, Us>['setActiveChannel'];\n  /** Object containing watcher parameters */\n  watchers?: { limit?: number; offset?: number };\n};\n\nexport const ChannelPreview = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: ChannelPreviewProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const { channel, Preview = ChannelPreviewMessenger } = props;\n\n  const { channel: activeChannel, client, setActiveChannel } = useChatContext<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us\n  >('ChannelPreview');\n  const { t, userLanguage } = useTranslationContext('ChannelPreview');\n\n  const [lastMessage, setLastMessage] = useState<StreamMessage<At, Ch, Co, Ev, Me, Re, Us>>(\n    channel.state.messages[channel.state.messages.length - 1],\n  );\n  const [unread, setUnread] = useState(0);\n\n  const isActive = activeChannel?.cid === channel.cid;\n  const { muted } = useIsChannelMuted(channel);\n\n  useEffect(() => {\n    const handleEvent = (event: Event) => {\n      if (!event.cid) return setUnread(0);\n      if (channel.cid === event.cid) setUnread(0);\n    };\n\n    client.on('notification.mark_read', handleEvent);\n    return () => client.off('notification.mark_read', handleEvent);\n  }, []);\n\n  useEffect(() => {\n    if (isActive || muted) {\n      setUnread(0);\n    } else {\n      setUnread(channel.countUnread());\n    }\n  }, [channel, isActive, muted]);\n\n  useEffect(() => {\n    const handleEvent = (event: Event<At, Ch, Co, Ev, Me, Re, Us>) => {\n      if (event.message) setLastMessage(event.message);\n\n      if (!isActive && !muted) {\n        setUnread(channel.countUnread());\n      } else {\n        setUnread(0);\n      }\n    };\n\n    channel.on('message.new', handleEvent);\n    channel.on('message.updated', handleEvent);\n    channel.on('message.deleted', handleEvent);\n\n    return () => {\n      channel.off('message.new', handleEvent);\n      channel.off('message.updated', handleEvent);\n      channel.off('message.deleted', handleEvent);\n    };\n  }, [channel, isActive, muted]);\n\n  if (!Preview) return null;\n\n  const displayImage = getDisplayImage(channel, client.user);\n  const displayTitle = getDisplayTitle(channel, client.user);\n  const latestMessage = getLatestMessagePreview(channel, t, userLanguage);\n\n  return (\n    <Preview\n      {...props}\n      active={isActive}\n      displayImage={displayImage}\n      displayTitle={displayTitle}\n      lastMessage={lastMessage}\n      latestMessage={latestMessage}\n      setActiveChannel={setActiveChannel}\n      unread={unread}\n    />\n  );\n};\n","import React from 'react';\n\nimport { useTranslationContext } from '../../context/TranslationContext';\n\nimport type { ChannelOrUserResponse } from './utils';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type ChannelSearchFunctionParams<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  setQuery: React.Dispatch<React.SetStateAction<string>>;\n  setResults: React.Dispatch<\n    React.SetStateAction<Array<ChannelOrUserResponse<At, Ch, Co, Ev, Me, Re, Us>>>\n  >;\n  setResultsOpen: React.Dispatch<React.SetStateAction<boolean>>;\n  setSearching: React.Dispatch<React.SetStateAction<boolean>>;\n};\n\nexport type SearchInputProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  channelSearchParams: {\n    setQuery: React.Dispatch<React.SetStateAction<string>>;\n    setResults: React.Dispatch<\n      React.SetStateAction<ChannelOrUserResponse<At, Ch, Co, Ev, Me, Re, Us>[]>\n    >;\n    setResultsOpen: React.Dispatch<React.SetStateAction<boolean>>;\n    setSearching: React.Dispatch<React.SetStateAction<boolean>>;\n  };\n  inputRef: React.RefObject<HTMLInputElement>;\n  onSearch: (event: React.BaseSyntheticEvent) => void;\n  query: string;\n  searchFunction?: (\n    params: ChannelSearchFunctionParams<At, Ch, Co, Ev, Me, Re, Us>,\n    event: React.BaseSyntheticEvent,\n  ) => Promise<void> | void;\n};\n\nexport const SearchInput = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: SearchInputProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const { channelSearchParams, inputRef, onSearch, query, searchFunction } = props;\n\n  const { t } = useTranslationContext('SearchInput');\n\n  return (\n    <input\n      className='str-chat__channel-search-input'\n      onChange={(event: React.BaseSyntheticEvent) =>\n        searchFunction ? searchFunction(channelSearchParams, event) : onSearch(event)\n      }\n      placeholder={t('Search')}\n      ref={inputRef}\n      type='text'\n      value={query}\n    />\n  );\n};\n","import type { Channel, UserResponse } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type ChannelOrUserResponse<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = Channel<At, Ch, Co, Ev, Me, Re, Us> | UserResponse<Us>;\n\nexport const isChannel = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  output: ChannelOrUserResponse<At, Ch, Co, Ev, Me, Re, Us>,\n): output is Channel<At, Ch, Co, Ev, Me, Re, Us> =>\n  (output as Channel<At, Ch, Co, Ev, Me, Re, Us>).cid != null;\n","import React, { useCallback, useEffect, useState } from 'react';\n\nimport { ChannelOrUserResponse, isChannel } from './utils';\n\nimport { Avatar } from '../Avatar/Avatar';\nimport { useBreakpoint } from '../Message/hooks/useBreakpoint';\n\nimport { useTranslationContext } from '../../context/TranslationContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type DropdownContainerProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  results: ChannelOrUserResponse<At, Ch, Co, Ev, Me, Re, Us>[];\n  SearchResultItem: React.ComponentType<SearchResultItemProps<At, Ch, Co, Ev, Me, Re, Us>>;\n  selectResult: (result: ChannelOrUserResponse<At, Ch, Co, Ev, Me, Re, Us>) => Promise<void> | void;\n  focusedUser?: number;\n};\n\nconst DefaultDropdownContainer = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: DropdownContainerProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const { focusedUser, results, SearchResultItem = DefaultSearchResultItem, selectResult } = props;\n\n  return (\n    <>\n      {results.map((result, index) => (\n        <SearchResultItem\n          focusedUser={focusedUser}\n          index={index}\n          key={index}\n          result={result}\n          selectResult={selectResult}\n        />\n      ))}\n    </>\n  );\n};\n\nexport type SearchResultItemProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  index: number;\n  result: ChannelOrUserResponse<At, Ch, Co, Ev, Me, Re, Us>;\n  selectResult: (result: ChannelOrUserResponse<At, Ch, Co, Ev, Me, Re, Us>) => Promise<void> | void;\n  focusedUser?: number;\n};\n\nconst DefaultSearchResultItem = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: SearchResultItemProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const { focusedUser, index, result, selectResult } = props;\n\n  const focused = focusedUser === index;\n\n  if (isChannel(result)) {\n    const channel = result;\n\n    return (\n      <button\n        aria-label={`Select Channel: ${channel.data?.name || ''}`}\n        className={`str-chat__channel-search-result ${focused ? 'focused' : ''}`}\n        onClick={() => selectResult(channel)}\n      >\n        <div className='result-hashtag'>#</div>\n        <p className='channel-search__result-text'>{channel.data?.name}</p>\n      </button>\n    );\n  } else {\n    return (\n      <button\n        aria-label={`Select User Channel: ${result.name || ''}`}\n        className={`str-chat__channel-search-result ${focused ? 'focused' : ''}`}\n        onClick={() => selectResult(result)}\n      >\n        <Avatar image={result.image} user={result} />\n        {result.name || result.id}\n      </button>\n    );\n  }\n};\n\nexport type SearchResultsProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  results: Array<ChannelOrUserResponse<At, Ch, Co, Ev, Me, Re, Us>> | [];\n  searching: boolean;\n  selectResult: (result: ChannelOrUserResponse<At, Ch, Co, Ev, Me, Re, Us>) => Promise<void> | void;\n  DropdownContainer?: React.ComponentType<DropdownContainerProps<At, Ch, Co, Ev, Me, Re, Us>>;\n  popupResults?: boolean;\n  SearchEmpty?: React.ComponentType;\n  SearchLoading?: React.ComponentType;\n  SearchResultItem?: React.ComponentType<SearchResultItemProps<At, Ch, Co, Ev, Me, Re, Us>>;\n  SearchResultsHeader?: React.ComponentType;\n};\n\nexport const SearchResults = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: SearchResultsProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const {\n    DropdownContainer = DefaultDropdownContainer,\n    popupResults,\n    results,\n    searching,\n    SearchEmpty,\n    SearchResultsHeader,\n    SearchLoading,\n    SearchResultItem = DefaultSearchResultItem,\n    selectResult,\n  } = props;\n\n  const { t } = useTranslationContext('SearchResults');\n\n  const [focusedUser, setFocusedUser] = useState<number>();\n\n  const { device } = useBreakpoint();\n\n  const containerStyle = popupResults && device === 'full' ? 'popup' : 'inline';\n\n  const ResultsContainer: React.FC = ({ children }) => (\n    <div className={`str-chat__channel-search-container ${containerStyle}`}>{children}</div>\n  );\n\n  const handleKeyDown = useCallback(\n    (event: KeyboardEvent) => {\n      if (event.key === 'ArrowUp') {\n        setFocusedUser((prevFocused) => {\n          if (prevFocused === undefined) return 0;\n          return prevFocused === 0 ? results.length - 1 : prevFocused - 1;\n        });\n      }\n\n      if (event.key === 'ArrowDown') {\n        setFocusedUser((prevFocused) => {\n          if (prevFocused === undefined) return 0;\n          return prevFocused === results.length - 1 ? 0 : prevFocused + 1;\n        });\n      }\n\n      if (event.key === 'Enter') {\n        event.preventDefault();\n        if (focusedUser !== undefined) {\n          selectResult(results[focusedUser]);\n          return setFocusedUser(undefined);\n        }\n      }\n    },\n    [focusedUser],\n  );\n\n  useEffect(() => {\n    document.addEventListener('keydown', handleKeyDown, false);\n    return () => document.removeEventListener('keydown', handleKeyDown);\n  }, [handleKeyDown]);\n\n  if (searching) {\n    return (\n      <ResultsContainer>\n        {SearchLoading ? (\n          <SearchLoading />\n        ) : (\n          <div className='str-chat__channel-search-container-searching'>{t('Searching...')}</div>\n        )}\n      </ResultsContainer>\n    );\n  }\n\n  if (!results.length) {\n    return (\n      <ResultsContainer>\n        {SearchEmpty ? (\n          <SearchEmpty />\n        ) : (\n          <div aria-live='polite' className='str-chat__channel-search-container-empty'>\n            {t('No results found')}\n          </div>\n        )}\n      </ResultsContainer>\n    );\n  }\n\n  return (\n    <ResultsContainer>\n      {SearchResultsHeader && <SearchResultsHeader />}\n      <DropdownContainer\n        focusedUser={focusedUser}\n        results={results}\n        SearchResultItem={SearchResultItem}\n        selectResult={selectResult}\n      />\n    </ResultsContainer>\n  );\n};\n","import React, { useEffect, useRef, useState } from 'react';\nimport throttle from 'lodash.throttle';\n\nimport {\n  ChannelSearchFunctionParams,\n  SearchInput as DefaultSearchInput,\n  SearchInputProps,\n} from './SearchInput';\nimport { DropdownContainerProps, SearchResultItemProps, SearchResults } from './SearchResults';\n\nimport { ChannelOrUserResponse, isChannel } from './utils';\n\nimport { useChatContext } from '../../context/ChatContext';\n\nimport type {\n  ChannelFilters,\n  ChannelOptions,\n  ChannelSort,\n  UserFilters,\n  UserOptions,\n  UserSort,\n} from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type SearchQueryParams<\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  channelFilters?: {\n    filters?: ChannelFilters<Ch, Co, Us>;\n    options?: ChannelOptions;\n    sort?: ChannelSort<Ch>;\n  };\n  userFilters?: {\n    filters?: UserFilters<Us>;\n    options?: UserOptions;\n    sort?: UserSort<Us>;\n  };\n};\n\nexport type ChannelSearchProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  /** The type of channel to create on user result select, defaults to `messaging` */\n  channelType?: string;\n  /** Custom UI component to display all of the search results, defaults to accepts same props as: [DefaultDropdownContainer](https://github.com/GetStream/stream-chat-react/blob/master/src/components/ChannelSearch/SearchResults.tsx)  */\n  DropdownContainer?: React.ComponentType<DropdownContainerProps<At, Ch, Co, Ev, Me, Re, Us>>;\n  /** Custom handler function to run on search result item selection */\n  onSelectResult?: (\n    result: ChannelOrUserResponse<At, Ch, Co, Ev, Me, Re, Us>,\n  ) => Promise<void> | void;\n  /** Display search results as an absolutely positioned popup, defaults to false and shows inline */\n  popupResults?: boolean;\n  /** Custom UI component to display empty search results */\n  SearchEmpty?: React.ComponentType;\n  /** Boolean to search for channels as well as users in the server query, default is false and just searches for users */\n  searchForChannels?: boolean;\n  /** Custom search function to override default */\n  searchFunction?: (\n    params: ChannelSearchFunctionParams<At, Ch, Co, Ev, Me, Re, Us>,\n    event: React.BaseSyntheticEvent,\n  ) => Promise<void> | void;\n  /** Custom UI component to display the search text input */\n  SearchInput?: React.ComponentType<SearchInputProps<At, Ch, Co, Ev, Me, Re, Us>>;\n  /** Custom UI component to display the search loading state */\n  SearchLoading?: React.ComponentType;\n  /** Object containing filters/sort/options overrides for user search */\n  searchQueryParams?: SearchQueryParams<Ch, Co, Us>;\n  /** Custom UI component to display a search result list item, defaults to and accepts same props as: [DefaultSearchResultItem](https://github.com/GetStream/stream-chat-react/blob/master/src/components/ChannelSearch/SearchResults.tsx) */\n  SearchResultItem?: React.ComponentType<SearchResultItemProps<At, Ch, Co, Ev, Me, Re, Us>>;\n  /** Custom UI component to display the search results header */\n  SearchResultsHeader?: React.ComponentType;\n};\n\nconst UnMemoizedChannelSearch = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: ChannelSearchProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const {\n    channelType = 'messaging',\n    DropdownContainer,\n    onSelectResult,\n    popupResults = false,\n    SearchEmpty,\n    searchForChannels = false,\n    searchFunction,\n    SearchInput = DefaultSearchInput,\n    SearchLoading,\n    searchQueryParams,\n    SearchResultItem,\n    SearchResultsHeader,\n  } = props;\n\n  const { client, setActiveChannel } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('ChannelSearch');\n\n  const [query, setQuery] = useState('');\n  const [results, setResults] = useState<Array<ChannelOrUserResponse<At, Ch, Co, Ev, Me, Re, Us>>>(\n    [],\n  );\n  const [resultsOpen, setResultsOpen] = useState(false);\n  const [searching, setSearching] = useState(false);\n\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  const clearState = () => {\n    setQuery('');\n    setResults([]);\n    setResultsOpen(false);\n    setSearching(false);\n  };\n\n  useEffect(() => {\n    const clickListener = (event: MouseEvent) => {\n      if (resultsOpen && event.target instanceof HTMLElement) {\n        const isInputClick = inputRef.current?.contains(event.target);\n        if (!isInputClick) {\n          clearState();\n        }\n      }\n    };\n\n    document.addEventListener('click', clickListener);\n    return () => document.removeEventListener('click', clickListener);\n  }, [resultsOpen]);\n\n  const selectResult = async (result: ChannelOrUserResponse<At, Ch, Co, Ev, Me, Re, Us>) => {\n    if (!client.userID) return;\n\n    if (isChannel(result)) {\n      setActiveChannel(result);\n    } else {\n      // @ts-expect-error\n      const newChannel = client.channel(channelType, { members: [client.userID, result.id] });\n      await newChannel.watch();\n\n      setActiveChannel(newChannel);\n    }\n    clearState();\n  };\n\n  const getChannels = async (text: string) => {\n    if (!text || searching) return;\n    setSearching(true);\n\n    try {\n      const userResponse = await client.queryUsers(\n        // @ts-expect-error\n        {\n          $or: [{ id: { $autocomplete: text } }, { name: { $autocomplete: text } }],\n          id: { $ne: client.userID },\n          ...searchQueryParams?.userFilters?.filters,\n        },\n        { id: 1, ...searchQueryParams?.userFilters?.sort },\n        { limit: 8, ...searchQueryParams?.userFilters?.options },\n      );\n\n      if (searchForChannels) {\n        const channelResponse = client.queryChannels(\n          // @ts-expect-error\n          {\n            name: { $autocomplete: text },\n            ...searchQueryParams?.channelFilters?.filters,\n          },\n          searchQueryParams?.channelFilters?.sort || {},\n          { limit: 5, ...searchQueryParams?.channelFilters?.options },\n        );\n\n        const [channels, { users }] = await Promise.all([channelResponse, userResponse]);\n\n        setResults([...channels, ...users]);\n        setResultsOpen(true);\n        setSearching(false);\n        return;\n      }\n\n      const { users } = await Promise.resolve(userResponse);\n\n      setResults(users);\n      setResultsOpen(true);\n    } catch (error) {\n      clearState();\n      console.error(error);\n    }\n\n    setSearching(false);\n  };\n\n  const getChannelsThrottled = throttle(getChannels, 200);\n\n  const onSearch = (event: React.BaseSyntheticEvent) => {\n    event.preventDefault();\n    setQuery(event.target.value);\n    getChannelsThrottled(event.target.value);\n  };\n\n  const channelSearchParams = {\n    setQuery,\n    setResults,\n    setResultsOpen,\n    setSearching,\n  };\n\n  return (\n    <div className='str-chat__channel-search'>\n      <SearchInput\n        channelSearchParams={channelSearchParams}\n        inputRef={inputRef}\n        onSearch={onSearch}\n        query={query}\n        searchFunction={searchFunction}\n      />\n      {query && (\n        <SearchResults\n          DropdownContainer={DropdownContainer}\n          popupResults={popupResults}\n          results={results}\n          SearchEmpty={SearchEmpty}\n          searching={searching}\n          SearchLoading={SearchLoading}\n          SearchResultItem={SearchResultItem}\n          SearchResultsHeader={SearchResultsHeader}\n          selectResult={onSelectResult || selectResult}\n        />\n      )}\n    </div>\n  );\n};\n\n/**\n * The ChannelSearch component makes a query users call and displays the results in a list.\n * Clicking on a list item will navigate you into a channel with the selected user. It can be used\n * on its own or added to the ChannelList component by setting the `showChannelSearch` prop to true.\n */\nexport const ChannelSearch = React.memo(UnMemoizedChannelSearch) as typeof UnMemoizedChannelSearch;\n","import React from 'react';\n\nimport { useTranslationContext } from '../../context/TranslationContext';\n\nexport type EmptyStateIndicatorProps = {\n  /** List Type: channel | message */\n  listType: 'channel' | 'message';\n};\n\nconst UnMemoizedEmptyStateIndicator: React.FC<EmptyStateIndicatorProps> = (props) => {\n  const { listType } = props;\n\n  const { t } = useTranslationContext('EmptyStateIndicator');\n\n  if (listType === 'channel') return <p role='listitem'>{t('You have no channels currently')}</p>;\n\n  if (listType === 'message') return null;\n\n  return <p>No items exist</p>;\n};\n\nexport const EmptyStateIndicator = React.memo(\n  UnMemoizedEmptyStateIndicator,\n) as typeof UnMemoizedEmptyStateIndicator;\n","import React from 'react';\nimport { LoadingIndicator } from 'react-file-utils';\n\nexport type LoadMoreButtonProps = {\n  /** onClick handler load more button. Pagination logic should be executed in this handler. */\n  onClick: React.MouseEventHandler<HTMLButtonElement>;\n  /** If true, LoadingIndicator is displayed instead of button */\n  refreshing?: boolean;\n};\n\nconst UnMemoizedLoadMoreButton: React.FC<LoadMoreButtonProps> = (props) => {\n  const { children = 'Load more', onClick, refreshing } = props;\n\n  return (\n    <div className='str-chat__load-more-button'>\n      <button\n        aria-label='Load More Channels'\n        className='str-chat__load-more-button__button'\n        data-testid='load-more-button'\n        disabled={refreshing}\n        onClick={onClick}\n      >\n        {refreshing ? <LoadingIndicator /> : children}\n      </button>\n    </div>\n  );\n};\n\nexport const LoadMoreButton = React.memo(\n  UnMemoizedLoadMoreButton,\n) as typeof UnMemoizedLoadMoreButton;\n","import React from 'react';\n\nimport { LoadMoreButton as DefaultLoadMoreButton, LoadMoreButtonProps } from './LoadMoreButton';\n\nexport type LoadMorePaginatorProps = {\n  /** callback to load the next page */\n  loadNextPage: () => void;\n  hasNextPage?: boolean;\n  LoadMoreButton?: React.ComponentType<LoadMoreButtonProps>;\n  /** indicates if there there's currently any refreshing taking place */\n  refreshing?: boolean;\n  reverse?: boolean;\n};\n\nexport const UnMemoizedLoadMorePaginator: React.FC<LoadMorePaginatorProps> = (props) => {\n  const {\n    children,\n    hasNextPage,\n    LoadMoreButton = DefaultLoadMoreButton,\n    loadNextPage,\n    refreshing,\n    reverse,\n  } = props;\n\n  return (\n    <>\n      {!reverse && children}\n      {hasNextPage && <LoadMoreButton onClick={loadNextPage} refreshing={refreshing} />}\n      {reverse && children}\n    </>\n  );\n};\n\nexport const LoadMorePaginator = React.memo(\n  UnMemoizedLoadMorePaginator,\n) as typeof UnMemoizedLoadMorePaginator;\n","import React, { useEffect, useRef, useState } from 'react';\n\nimport { ChannelListMessenger, ChannelListMessengerProps } from './ChannelListMessenger';\nimport { useChannelDeletedListener } from './hooks/useChannelDeletedListener';\nimport { useChannelHiddenListener } from './hooks/useChannelHiddenListener';\nimport { useChannelTruncatedListener } from './hooks/useChannelTruncatedListener';\nimport { useChannelUpdatedListener } from './hooks/useChannelUpdatedListener';\nimport { useChannelVisibleListener } from './hooks/useChannelVisibleListener';\nimport { useConnectionRecoveredListener } from './hooks/useConnectionRecoveredListener';\nimport { useMessageNewListener } from './hooks/useMessageNewListener';\nimport { useMobileNavigation } from './hooks/useMobileNavigation';\nimport { useNotificationAddedToChannelListener } from './hooks/useNotificationAddedToChannelListener';\nimport { useNotificationMessageNewListener } from './hooks/useNotificationMessageNewListener';\nimport { useNotificationRemovedFromChannelListener } from './hooks/useNotificationRemovedFromChannelListener';\nimport { usePaginatedChannels } from './hooks/usePaginatedChannels';\nimport { useUserPresenceChangedListener } from './hooks/useUserPresenceChangedListener';\nimport { MAX_QUERY_CHANNELS_LIMIT, moveChannelUp } from './utils';\n\nimport { AvatarProps, Avatar as DefaultAvatar } from '../Avatar/Avatar';\nimport { ChannelPreview, ChannelPreviewUIComponentProps } from '../ChannelPreview/ChannelPreview';\nimport {\n  ChannelSearchProps,\n  ChannelSearch as DefaultChannelSearch,\n} from '../ChannelSearch/ChannelSearch';\nimport { ChatDown, ChatDownProps } from '../ChatDown/ChatDown';\nimport {\n  EmptyStateIndicator as DefaultEmptyStateIndicator,\n  EmptyStateIndicatorProps,\n} from '../EmptyStateIndicator';\nimport { LoadingChannels } from '../Loading/LoadingChannels';\nimport { LoadMorePaginator, LoadMorePaginatorProps } from '../LoadMore/LoadMorePaginator';\n\nimport { useChatContext } from '../../context/ChatContext';\n\nimport type { Channel, ChannelFilters, ChannelOptions, ChannelSort, Event } from 'stream-chat';\n\nimport type { InfiniteScrollPaginatorProps } from '../InfiniteScrollPaginator/InfiniteScrollPaginator';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nconst DEFAULT_FILTERS = {};\nconst DEFAULT_OPTIONS = {};\nconst DEFAULT_SORT = {};\n\nexport type ChannelListProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  /** Additional props for underlying ChannelSearch component, [available props](https://getstream.io/chat/docs/sdk/react/utility-components/channel_search/#props) */\n  additionalChannelSearchProps?: ChannelSearchProps<At, Ch, Co, Ev, Me, Re, Us>;\n  /**\n   * When the client receives `message.new`, `notification.message_new`, and `notification.added_to_channel` events, we automatically\n   * push that channel to the top of the list. If the channel doesn't currently exist in the list, we grab the channel from\n   * `client.activeChannels` and push it to the top of the list. You can disable this behavior by setting this prop\n   * to false, which will prevent channels not in the list from incrementing the list. The default is true.\n   */\n  allowNewMessagesFromUnfilteredChannels?: boolean;\n  /** Custom UI component to display user avatar, defaults to and accepts same props as: [Avatar](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Avatar/Avatar.tsx) */\n  Avatar?: React.ComponentType<AvatarProps>;\n  /** Optional function to filter channels prior to loading in the DOM. Do not use any complex or async logic that would delay the loading of the ChannelList. We recommend using a pure function with array methods like filter/sort/reduce. */\n  channelRenderFilterFn?: (\n    channels: Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>,\n  ) => Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>;\n  /** Custom UI component to display search results, defaults to and accepts same props as: [ChannelSearch](https://github.com/GetStream/stream-chat-react/blob/master/src/components/ChannelSearch/ChannelSearch.tsx) */\n  ChannelSearch?: React.ComponentType<ChannelSearchProps<At, Ch, Co, Ev, Me, Re, Us>>;\n  /** Set a channel (with this ID) to active and manually move it to the top of the list */\n  customActiveChannel?: string;\n  /** Custom UI component for rendering an empty list, defaults to and accepts same props as: [EmptyStateIndicator](https://github.com/GetStream/stream-chat-react/blob/master/src/components/EmptyStateIndicator/EmptyStateIndicator.tsx) */\n  EmptyStateIndicator?: React.ComponentType<EmptyStateIndicatorProps>;\n  /** An object containing channel query filters */\n  filters?: ChannelFilters<Ch, Co, Us>;\n  /** Custom UI component to display the container for the queried channels, defaults to and accepts same props as: [ChannelListMessenger](https://github.com/GetStream/stream-chat-react/blob/master/src/components/ChannelList/ChannelListMessenger.tsx) */\n  List?: React.ComponentType<ChannelListMessengerProps<At, Ch, Co, Ev, Me, Re, Us>>;\n  /** Custom UI component to display the loading error indicator, defaults to and accepts same props as: [ChatDown](https://github.com/GetStream/stream-chat-react/blob/master/src/components/ChatDown/ChatDown.tsx) */\n  LoadingErrorIndicator?: React.ComponentType<ChatDownProps>;\n  /** Custom UI component to display the loading state, defaults to and accepts same props as: [LoadingChannels](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Loading/LoadingChannels.tsx) */\n  LoadingIndicator?: React.ComponentType;\n  /** When true, channels won't dynamically sort by most recent message */\n  lockChannelOrder?: boolean;\n  /** Function to override the default behavior when a user is added to a channel, corresponds to [notification.added\\_to\\_channel](https://getstream.io/chat/docs/javascript/event_object/?language=javascript) event */\n  onAddedToChannel?: (\n    setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n    event: Event<At, Ch, Co, Ev, Me, Re, Us>,\n  ) => void;\n  /** Function to override the default behavior when a channel is deleted, corresponds to [channel.deleted](https://getstream.io/chat/docs/javascript/event_object/?language=javascript) event */\n  onChannelDeleted?: (\n    setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n    event: Event<At, Ch, Co, Ev, Me, Re, Us>,\n  ) => void;\n  /** Function to override the default behavior when a channel is hidden, corresponds to [channel.hidden](https://getstream.io/chat/docs/javascript/event_object/?language=javascript) event */\n  onChannelHidden?: (\n    setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n    event: Event<At, Ch, Co, Ev, Me, Re, Us>,\n  ) => void;\n  /** Function to override the default behavior when a channel is truncated, corresponds to [channel.truncated](https://getstream.io/chat/docs/javascript/event_object/?language=javascript) event */\n  onChannelTruncated?: (\n    setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n    event: Event<At, Ch, Co, Ev, Me, Re, Us>,\n  ) => void;\n  /** Function to override the default behavior when a channel is updated, corresponds to [channel.updated](https://getstream.io/chat/docs/javascript/event_object/?language=javascript) event */\n  onChannelUpdated?: (\n    setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n    event: Event<At, Ch, Co, Ev, Me, Re, Us>,\n  ) => void;\n  /** Function to override the default channel visible behavior, corresponds to [channel.visible](https://getstream.io/chat/docs/javascript/event_object/?language=javascript) event */\n  onChannelVisible?: (\n    setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n    event: Event<At, Ch, Co, Ev, Me, Re, Us>,\n  ) => void;\n  /** Function to override the default behavior when a message is received on a channel not being watched, corresponds to [notification.message\\_new](https://getstream.io/chat/docs/javascript/event_object/?language=javascript) event */\n  onMessageNew?: (\n    setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n    event: Event<At, Ch, Co, Ev, Me, Re, Us>,\n  ) => void;\n  /** Function to override the default behavior when a user gets removed from a channel, corresponds to [notification.removed\\_from\\_channel](https://getstream.io/chat/docs/javascript/event_object/?language=javascript) event */\n  onRemovedFromChannel?: (\n    setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n    event: Event<At, Ch, Co, Ev, Me, Re, Us>,\n  ) => void;\n  /** An object containing channel query options */\n  options?: ChannelOptions;\n  /** Custom UI component to handle channel pagination logic, defaults to and accepts same props as: [LoadMorePaginator](https://github.com/GetStream/stream-chat-react/blob/master/src/components/LoadMore/LoadMorePaginator.tsx) */\n  Paginator?: React.ComponentType<InfiniteScrollPaginatorProps | LoadMorePaginatorProps>;\n  /** Custom UI component to display the channel preview in the list, defaults to and accepts same props as: [ChannelPreviewMessenger](https://github.com/GetStream/stream-chat-react/blob/master/src/components/ChannelPreview/ChannelPreviewMessenger.tsx) */\n  Preview?: React.ComponentType<ChannelPreviewUIComponentProps<At, Ch, Co, Ev, Me, Re, Us>>;\n  /** If true, sends the list's currently loaded channels to the `List` component as the `loadedChannels` prop */\n  sendChannelsToList?: boolean;\n  /** Last channel will be set as active channel if true, defaults to true */\n  setActiveChannelOnMount?: boolean;\n  /** Whether or not to load the list with a search component, defaults to false */\n  showChannelSearch?: boolean;\n  /** An object containing channel query sort parameters */\n  sort?: ChannelSort<Ch>;\n  /** An object containing query parameters for fetching channel watchers */\n  watchers?: { limit?: number; offset?: number };\n};\n\nconst UnMemoizedChannelList = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: ChannelListProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const {\n    additionalChannelSearchProps,\n    Avatar = DefaultAvatar,\n    allowNewMessagesFromUnfilteredChannels,\n    channelRenderFilterFn,\n    ChannelSearch = DefaultChannelSearch,\n    customActiveChannel,\n    EmptyStateIndicator = DefaultEmptyStateIndicator,\n    filters,\n    LoadingErrorIndicator = ChatDown,\n    LoadingIndicator = LoadingChannels,\n    List = ChannelListMessenger,\n    lockChannelOrder,\n    onAddedToChannel,\n    onChannelDeleted,\n    onChannelHidden,\n    onChannelTruncated,\n    onChannelUpdated,\n    onChannelVisible,\n    onMessageNew,\n    onRemovedFromChannel,\n    options,\n    Paginator = LoadMorePaginator,\n    Preview,\n    sendChannelsToList = false,\n    setActiveChannelOnMount = true,\n    showChannelSearch = false,\n    sort = DEFAULT_SORT,\n    watchers = {},\n  } = props;\n\n  const {\n    channel,\n    client,\n    closeMobileNav,\n    customClasses,\n    navOpen = false,\n    setActiveChannel,\n    theme,\n    useImageFlagEmojisOnWindows,\n  } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('ChannelList');\n\n  const channelListRef = useRef<HTMLDivElement>(null);\n  const [channelUpdateCount, setChannelUpdateCount] = useState(0);\n\n  /**\n   * Set a channel with id {customActiveChannel} as active and move it to the top of the list.\n   * If customActiveChannel prop is absent, then set the first channel in list as active channel.\n   */\n  const activeChannelHandler = async (\n    channels: Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>,\n    setChannels: React.Dispatch<React.SetStateAction<Array<Channel<At, Ch, Co, Ev, Me, Re, Us>>>>,\n  ) => {\n    if (!channels.length || channels.length > (options?.limit || MAX_QUERY_CHANNELS_LIMIT)) {\n      return;\n    }\n\n    if (customActiveChannel) {\n      let customActiveChannelObject = channels.find((chan) => chan.id === customActiveChannel);\n\n      if (!customActiveChannelObject) {\n        //@ts-expect-error\n        [customActiveChannelObject] = await client.queryChannels({ id: customActiveChannel });\n      }\n\n      if (customActiveChannelObject) {\n        setActiveChannel(customActiveChannelObject, watchers);\n\n        const newChannels = moveChannelUp({\n          activeChannel: customActiveChannelObject,\n          channels,\n          cid: customActiveChannelObject.cid,\n        });\n\n        setChannels(newChannels);\n      }\n\n      return;\n    }\n\n    if (setActiveChannelOnMount) {\n      setActiveChannel(channels[0], watchers);\n    }\n  };\n\n  /**\n   * For some events, inner properties on the channel will update but the shallow comparison will not\n   * force a re-render. Incrementing this dummy variable ensures the channel previews update.\n   */\n  const forceUpdate = () => setChannelUpdateCount((count) => count + 1);\n\n  const { channels, hasNextPage, loadNextPage, setChannels, status } = usePaginatedChannels(\n    client,\n    filters || DEFAULT_FILTERS,\n    sort || DEFAULT_SORT,\n    options || DEFAULT_OPTIONS,\n    activeChannelHandler,\n  );\n\n  const loadedChannels = channelRenderFilterFn ? channelRenderFilterFn(channels) : channels;\n\n  useMobileNavigation(channelListRef, navOpen, closeMobileNav);\n\n  useMessageNewListener(setChannels, lockChannelOrder, allowNewMessagesFromUnfilteredChannels);\n  useNotificationMessageNewListener(\n    setChannels,\n    onMessageNew,\n    allowNewMessagesFromUnfilteredChannels,\n  );\n  useNotificationAddedToChannelListener(\n    setChannels,\n    onAddedToChannel,\n    allowNewMessagesFromUnfilteredChannels,\n  );\n  useNotificationRemovedFromChannelListener(setChannels, onRemovedFromChannel);\n  useChannelDeletedListener(setChannels, onChannelDeleted);\n  useChannelHiddenListener(setChannels, onChannelHidden);\n  useChannelVisibleListener(setChannels, onChannelVisible);\n  useChannelTruncatedListener(setChannels, onChannelTruncated, forceUpdate);\n  useChannelUpdatedListener(setChannels, onChannelUpdated, forceUpdate);\n  useConnectionRecoveredListener(forceUpdate);\n  useUserPresenceChangedListener(setChannels);\n\n  useEffect(() => {\n    const handleEvent = (event: Event<At, Ch, Co, Ev, Me, Re, Us>) => {\n      if (event.cid === channel?.cid) {\n        setActiveChannel();\n      }\n    };\n\n    client.on('channel.deleted', handleEvent);\n    client.on('channel.hidden', handleEvent);\n\n    return () => {\n      client.off('channel.deleted', handleEvent);\n      client.off('channel.hidden', handleEvent);\n    };\n  }, [channel?.cid]);\n\n  const renderChannel = (item: Channel<At, Ch, Co, Ev, Me, Re, Us>) => {\n    const previewProps = {\n      activeChannel: channel,\n      Avatar,\n      channel: item,\n      channelUpdateCount, // forces the update of preview component on channel update\n      key: item.id,\n      Preview,\n      setActiveChannel,\n      watchers,\n    };\n\n    return <ChannelPreview {...previewProps} />;\n  };\n\n  const chatClass = customClasses?.chat || 'str-chat';\n  const channelListClass = customClasses?.channelList || 'str-chat-channel-list';\n  const navigationClass = navOpen ? 'str-chat-channel-list--open' : '';\n  const windowsEmojiClass =\n    useImageFlagEmojisOnWindows && navigator.userAgent.match(/Win/)\n      ? 'str-chat--windows-flags'\n      : '';\n\n  return (\n    <>\n      <div\n        className={`${chatClass} ${channelListClass} ${theme} ${navigationClass} ${windowsEmojiClass}`}\n        ref={channelListRef}\n      >\n        {showChannelSearch && <ChannelSearch {...additionalChannelSearchProps} />}\n        <List\n          error={status.error}\n          loadedChannels={sendChannelsToList ? loadedChannels : undefined}\n          loading={status.loadingChannels}\n          LoadingErrorIndicator={LoadingErrorIndicator}\n          LoadingIndicator={LoadingIndicator}\n          setChannels={setChannels}\n        >\n          {!loadedChannels?.length ? (\n            <EmptyStateIndicator listType='channel' />\n          ) : (\n            <Paginator\n              hasNextPage={hasNextPage}\n              loadNextPage={loadNextPage}\n              refreshing={status.refreshing}\n            >\n              {loadedChannels.map(renderChannel)}\n            </Paginator>\n          )}\n        </List>\n      </div>\n    </>\n  );\n};\n\n/**\n * Renders a preview list of Channels, allowing you to select the Channel you want to open\n */\nexport const ChannelList = React.memo(UnMemoizedChannelList) as typeof UnMemoizedChannelList;\n","import i18n, { TFunction } from 'i18next';\nimport Dayjs from 'dayjs';\nimport calendar from 'dayjs/plugin/calendar';\nimport updateLocale from 'dayjs/plugin/updateLocale';\nimport LocalizedFormat from 'dayjs/plugin/localizedFormat';\nimport localeData from 'dayjs/plugin/localeData';\nimport relativeTime from 'dayjs/plugin/relativeTime';\n\nimport type moment from 'moment';\nimport type { TranslationLanguages } from 'stream-chat';\n\nimport type { TDateTimeParser } from '../context/TranslationContext';\n\nimport type { UnknownType } from '../types/types';\n\nimport {\n  deTranslations,\n  enTranslations,\n  esTranslations,\n  frTranslations,\n  hiTranslations,\n  itTranslations,\n  jaTranslations,\n  koTranslations,\n  nlTranslations,\n  ptTranslations,\n  ruTranslations,\n  trTranslations,\n} from './translations';\n\nconst defaultNS = 'translation';\nconst defaultLng = 'en';\n\nimport 'dayjs/locale/de';\nimport 'dayjs/locale/es';\nimport 'dayjs/locale/fr';\nimport 'dayjs/locale/hi';\nimport 'dayjs/locale/it';\nimport 'dayjs/locale/ja';\nimport 'dayjs/locale/ko';\nimport 'dayjs/locale/nl';\nimport 'dayjs/locale/pt';\nimport 'dayjs/locale/ru';\nimport 'dayjs/locale/tr';\n// These locale imports also set these locale globally.\n// So As a last step I am going to import english locale\n// to make sure I don't mess up language at other places in app.\nimport 'dayjs/locale/en';\n\nDayjs.extend(updateLocale);\n\nDayjs.updateLocale('de', {\n  calendar: {\n    lastDay: '[gestern um] LT',\n    lastWeek: '[letzten] dddd [bei] LT',\n    nextDay: '[morgen zu] LT',\n    nextWeek: 'dddd [bei] LT',\n    sameDay: '[heute um] LT',\n    sameElse: 'L',\n  },\n});\n\nDayjs.updateLocale('es', {\n  calendar: {\n    lastDay: '[ayer a las] LT',\n    lastWeek: '[pasado] dddd [a] LT',\n    nextDay: '[maana a] LT',\n    nextWeek: 'dddd [a] LT',\n    sameDay: '[hoy a las] LT',\n    sameElse: 'L',\n  },\n});\n\nDayjs.updateLocale('fr', {\n  calendar: {\n    lastDay: '[Hier ] LT',\n    lastWeek: 'dddd [dernier ] LT',\n    nextDay: '[Demain ] LT',\n    nextWeek: 'dddd [] LT',\n    sameDay: '[Aujourdhui ] LT',\n    sameElse: 'L',\n  },\n});\n\nDayjs.updateLocale('hi', {\n  calendar: {\n    lastDay: '[] LT',\n    lastWeek: '[] dddd, LT',\n    nextDay: '[] LT',\n    nextWeek: 'dddd, LT',\n    sameDay: '[] LT',\n    sameElse: 'L',\n  },\n  // Hindi notation for meridiems are quite fuzzy in practice. While there exists\n  // a rigid notion of a 'Pahar' it is not used as rigidly in modern Hindi.\n  meridiem(hour: number) {\n    if (hour < 4) {\n      return '';\n    } else if (hour < 10) {\n      return '';\n    } else if (hour < 17) {\n      return '';\n    } else if (hour < 20) {\n      return '';\n    } else {\n      return '';\n    }\n  },\n  meridiemHour(hour: number, meridiem: string) {\n    if (hour === 12) {\n      hour = 0;\n    }\n    if (meridiem === '') {\n      return hour < 4 ? hour : hour + 12;\n    } else if (meridiem === '') {\n      return hour;\n    } else if (meridiem === '') {\n      return hour >= 10 ? hour : hour + 12;\n    } else if (meridiem === '') {\n      return hour + 12;\n    }\n    return hour;\n  },\n  meridiemParse: /|||/,\n});\n\nDayjs.updateLocale('it', {\n  calendar: {\n    lastDay: '[Ieri alle] LT',\n    lastWeek: '[lo scorso] dddd [alle] LT',\n    nextDay: '[Domani alle] LT',\n    nextWeek: 'dddd [alle] LT',\n    sameDay: '[Oggi alle] LT',\n    sameElse: 'L',\n  },\n});\n\nDayjs.updateLocale('ja', {\n  calendar: {\n    lastDay: '[] LT',\n    lastWeek: 'dddd LT',\n    nextDay: '[] LT',\n    nextWeek: '[] dddd LT',\n    sameDay: '[] LT',\n    sameElse: 'L',\n  },\n});\n\nDayjs.updateLocale('ko', {\n  calendar: {\n    lastDay: '[] LT',\n    lastWeek: '[] dddd LT',\n    nextDay: '[] LT',\n    nextWeek: 'dddd LT',\n    sameDay: '[] LT',\n    sameElse: 'L',\n  },\n});\n\nDayjs.updateLocale('nl', {\n  calendar: {\n    lastDay: '[gisteren om] LT',\n    lastWeek: '[afgelopen] dddd [om] LT',\n    nextDay: '[morgen om] LT',\n    nextWeek: 'dddd [om] LT',\n    sameDay: '[vandaag om] LT',\n    sameElse: 'L',\n  },\n});\n\nDayjs.updateLocale('pt', {\n  calendar: {\n    lastDay: '[ontem s] LT',\n    lastWeek: '[passado] dddd [para] LT',\n    nextDay: '[amanh s] LT',\n    nextWeek: 'dddd [para] LT',\n    sameDay: '[hoje s] LT',\n    sameElse: 'L',\n  },\n});\n\nDayjs.updateLocale('ru', {\n  calendar: {\n    lastDay: '[, ] LT',\n    nextDay: '[, ] LT',\n    sameDay: '[, ] LT',\n  },\n});\n\nDayjs.updateLocale('tr', {\n  calendar: {\n    lastDay: '[dn] LT',\n    lastWeek: '[geen] dddd [saat] LT',\n    nextDay: '[yarn saat] LT',\n    nextWeek: '[gelecek] dddd [saat] LT',\n    sameDay: '[bugn saat] LT',\n    sameElse: 'L',\n  },\n});\n\nconst en_locale = {\n  formats: {},\n  months: [\n    'January',\n    'February',\n    'March',\n    'April',\n    'May',\n    'June',\n    'July',\n    'August',\n    'September',\n    'October',\n    'November',\n    'December',\n  ],\n  relativeTime: {},\n  weekdays: ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'],\n};\n\n// Type guards to check DayJs\nconst isDayJs = (dateTimeParser: typeof Dayjs | typeof moment): dateTimeParser is typeof Dayjs =>\n  (dateTimeParser as typeof Dayjs).extend !== undefined;\n\ntype Options = {\n  DateTimeParser?: typeof Dayjs | typeof moment;\n  dayjsLocaleConfigForLanguage?: Partial<ILocale>;\n  debug?: boolean;\n  disableDateTimeTranslations?: boolean;\n  language?: TranslationLanguages;\n  logger?: (message?: string) => void;\n  translationsForLanguage?: Partial<typeof enTranslations>;\n};\n\n/**\n * Wrapper around [i18next](https://www.i18next.com/) class for Stream related translations.\n * Instance of this class should be provided to Chat component to handle translations.\n * Stream provides following list of in-built translations:\n * 1. English (en)\n * 2. Dutch (nl)\n * 3. Russian (ru)\n * 4. Turkish (tr)\n * 5. French (fr)\n * 6. Italian (it)\n * 7. Hindi (hi)\n * 8. Spanish (es)\n * 9. Portuguese (pt)\n * 10. German (de)\n * 11. Japanese (ja)\n * 12. Korean (ko)\n *\n * Simplest way to start using chat components in one of the in-built languages would be following:\n *\n * ```\n * const i18n = new Streami18n({ language 'nl' });\n * <Chat client={chatClient} i18nInstance={i18n}>\n *  ...\n * </Chat>\n * ```\n *\n * If you would like to override certain keys in in-built translation.\n * UI will be automatically updated in this case.\n *\n * ```\n * const i18n = new Streami18n({\n *  language: 'nl',\n *  translationsForLanguage: {\n *    'Nothing yet...': 'Nog Niet ...',\n *    '{{ firstUser }} and {{ secondUser }} are typing...': '{{ firstUser }} en {{ secondUser }} zijn aan het typen...',\n *  }\n * });\n *\n * If you would like to register additional languages, use registerTranslation. You can add as many languages as you want:\n *\n * i18n.registerTranslation('zh', {\n *  'Nothing yet...': 'Nog Niet ...',\n *  '{{ firstUser }} and {{ secondUser }} are typing...': '{{ firstUser }} en {{ secondUser }} zijn aan het typen...',\n * });\n *\n * <Chat client={chatClient} i18nInstance={i18n}>\n *  ...\n * </Chat>\n * ```\n *\n * You can use the same function to add whole new language as well.\n *\n * ```\n * const i18n = new Streami18n();\n *\n * i18n.registerTranslation('mr', {\n *  'Nothing yet...': '   ...',\n *  '{{ firstUser }} and {{ secondUser }} are typing...': '{{ firstUser }}  {{ secondUser }}    ',\n * });\n *\n * // Make sure to call setLanguage to reflect new language in UI.\n * i18n.setLanguage('it');\n * <Chat client={chatClient} i18nInstance={i18n}>\n *  ...\n * </Chat>\n * ```\n *\n * ## Datetime translations\n *\n * Stream react chat components uses [dayjs](https://day.js.org/en/) internally by default to format datetime stamp.\n * e.g., in ChannelPreview, MessageContent components.\n * Dayjs has locale support as well - https://day.js.org/docs/en/i18n/i18n\n * Dayjs is a lightweight alternative to Momentjs with the same modern API.\n *\n * Dayjs provides locale config for plenty of languages, you can check the whole list of locale configs at following url\n * https://github.com/iamkun/dayjs/tree/dev/src/locale\n *\n * You can either provide the dayjs locale config while registering\n * language with Streami18n (either via constructor or registerTranslation()) or you can provide your own Dayjs or Moment instance\n * to Streami18n constructor, which will be then used internally (using the language locale) in components.\n *\n * 1. Via language registration\n *\n * e.g.,\n * ```\n * const i18n = new Streami18n({\n *  language: 'nl',\n *  dayjsLocaleConfigForLanguage: {\n *    months: [...],\n *    monthsShort: [...],\n *    calendar: {\n *      sameDay: ...'\n *    }\n *  }\n * });\n * ```\n *\n * Similarly, you can add locale config for moment while registering translation via `registerTranslation` function.\n *\n * e.g.,\n * ```\n * const i18n = new Streami18n();\n *\n * i18n.registerTranslation(\n *  'mr',\n *  {\n *    'Nothing yet...': '   ...',\n *    '{{ firstUser }} and {{ secondUser }} are typing...': '{{ firstUser }}  {{ secondUser }}    ',\n *  },\n *  {\n *    months: [...],\n *    monthsShort: [...],\n *    calendar: {\n *      sameDay: ...'\n *    }\n *  }\n * );\n *```\n * 2. Provide your own Moment object\n *\n * ```js\n * import 'moment/locale/nl';\n * import 'moment/locale/it';\n * // or if you want to include all locales\n * import 'moment/min/locales';\n *\n * import Moment from moment\n *\n * const i18n = new Streami18n({\n *  language: 'nl',\n *  DateTimeParser: Moment\n * })\n * ```\n *\n * 3. Provide your own Dayjs object\n *\n * ```js\n * import Dayjs from 'dayjs'\n *\n * import 'dayjs/locale/nl';\n * import 'dayjs/locale/it';\n * // or if you want to include all locales\n * import 'dayjs/min/locales';\n *\n * const i18n = new Streami18n({\n *  language: 'nl',\n *  DateTimeParser: Dayjs\n * })\n * ```\n * If you would like to stick with english language for datetimes in Stream compoments, you can set `disableDateTimeTranslations` to true.\n *\n */\nconst defaultStreami18nOptions = {\n  DateTimeParser: Dayjs,\n  dayjsLocaleConfigForLanguage: null,\n  debug: false,\n  disableDateTimeTranslations: false,\n  language: 'en' as TranslationLanguages,\n  logger: (message?: string) => console.warn(message),\n};\n\nexport class Streami18n {\n  i18nInstance = i18n.createInstance();\n  Dayjs = null;\n  setLanguageCallback: (t: TFunction) => void = () => null;\n  initialized = false;\n\n  t: TFunction = (key: string) => key;\n  tDateTimeParser: TDateTimeParser;\n\n  translations: {\n    [key: string]: {\n      [key: string]: typeof enTranslations | UnknownType;\n    };\n  } = {\n    de: { [defaultNS]: deTranslations },\n    en: { [defaultNS]: enTranslations },\n    es: { [defaultNS]: esTranslations },\n    fr: { [defaultNS]: frTranslations },\n    hi: { [defaultNS]: hiTranslations },\n    it: { [defaultNS]: itTranslations },\n    ja: { [defaultNS]: jaTranslations },\n    ko: { [defaultNS]: koTranslations },\n    nl: { [defaultNS]: nlTranslations },\n    pt: { [defaultNS]: ptTranslations },\n    ru: { [defaultNS]: ruTranslations },\n    tr: { [defaultNS]: trTranslations },\n  };\n\n  /**\n   * dayjs.defineLanguage('nl') also changes the global locale. We don't want to do that\n   * when user calls registerTranslation() function. So instead we will store the locale configs\n   * given to registerTranslation() function in `dayjsLocales` object, and register the required locale\n   * with moment, when setLanguage is called.\n   * */\n  dayjsLocales: { [key: string]: Partial<ILocale> } = {};\n  // dayjsLocales = {};\n\n  /**\n   * Initialize properties used in constructor\n   */\n  logger: (msg?: string) => void;\n  currentLanguage: TranslationLanguages;\n  DateTimeParser: typeof Dayjs | typeof moment;\n  isCustomDateTimeParser: boolean;\n  i18nextConfig: {\n    debug: boolean;\n    fallbackLng: false;\n    interpolation: { escapeValue: boolean };\n    keySeparator: false;\n    lng: string;\n    nsSeparator: false;\n    parseMissingKeyHandler: (key: string) => string;\n  };\n  /**\n   * Constructor accepts following options:\n   *  - language (String) default: 'en'\n   *    Language code e.g., en, tr\n   *\n   *  - translationsForLanguage (object)\n   *    Translations object. Please check src/i18n/en.json for example.\n   *\n   *  - disableDateTimeTranslations (boolean) default: false\n   *    Disable translations for date-times\n   *\n   *  - debug (boolean) default: false\n   *    Enable debug mode in internal i18n class\n   *\n   *  - logger (function) default: () => {}\n   *    Logger function to log warnings/errors from this class\n   *\n   *  - dayjsLocaleConfigForLanguage (object) default: 'enConfig'\n   *    [Config object](https://momentjs.com/docs/#/i18n/changing-locale/) for internal moment object,\n   *    corresponding to language (param)\n   *\n   *  - DateTimeParser (function) Moment or Dayjs instance/function.\n   *    Make sure to load all the required locales in this Moment or Dayjs instance that you will be provide to Streami18n\n   *\n   * @param {*} options\n   */\n  constructor(options: Options = {}) {\n    const finalOptions = {\n      ...defaultStreami18nOptions,\n      ...options,\n    };\n    // Prepare the i18next configuration.\n    this.logger = finalOptions.logger;\n    this.currentLanguage = finalOptions.language;\n    this.DateTimeParser = finalOptions.DateTimeParser;\n\n    try {\n      if (this.DateTimeParser && isDayJs(this.DateTimeParser)) {\n        this.DateTimeParser.extend(LocalizedFormat);\n        this.DateTimeParser.extend(calendar);\n        this.DateTimeParser.extend(localeData);\n        this.DateTimeParser.extend(relativeTime);\n      }\n    } catch (error) {\n      throw Error(\n        `Streami18n: Looks like you wanted to provide Dayjs instance, but something went wrong while adding plugins ${error}`,\n      );\n    }\n\n    this.isCustomDateTimeParser = !!options.DateTimeParser;\n    const translationsForLanguage = finalOptions.translationsForLanguage;\n\n    if (translationsForLanguage) {\n      this.translations[this.currentLanguage] = {\n        [defaultNS]:\n          this.translations[this.currentLanguage] &&\n          this.translations[this.currentLanguage][defaultNS]\n            ? {\n                ...this.translations[this.currentLanguage][defaultNS],\n                ...translationsForLanguage,\n              }\n            : translationsForLanguage,\n      };\n    }\n\n    // If translations don't exist for given language, then set it as empty object.\n    if (!this.translations[this.currentLanguage]) {\n      this.translations[this.currentLanguage] = {\n        [defaultNS]: {},\n      };\n    }\n\n    this.i18nextConfig = {\n      debug: finalOptions.debug,\n      fallbackLng: false,\n      interpolation: { escapeValue: false },\n      keySeparator: false,\n      lng: this.currentLanguage,\n      nsSeparator: false,\n\n      parseMissingKeyHandler: (key) => {\n        this.logger(`Streami18n: Missing translation for key: ${key}`);\n\n        return key;\n      },\n    };\n\n    this.validateCurrentLanguage();\n\n    const dayjsLocaleConfigForLanguage = finalOptions.dayjsLocaleConfigForLanguage;\n\n    if (dayjsLocaleConfigForLanguage) {\n      this.addOrUpdateLocale(this.currentLanguage, {\n        ...dayjsLocaleConfigForLanguage,\n      });\n    } else if (!this.localeExists(this.currentLanguage)) {\n      this.logger(\n        `Streami18n: Streami18n(...) - Locale config for ${this.currentLanguage} does not exist in momentjs.` +\n          `Please import the locale file using \"import 'moment/locale/${this.currentLanguage}';\" in your app or ` +\n          `register the locale config with Streami18n using registerTranslation(language, translation, customDayjsLocale)`,\n      );\n    }\n\n    this.tDateTimeParser = (timestamp) => {\n      if (finalOptions.disableDateTimeTranslations || !this.localeExists(this.currentLanguage)) {\n        /**\n         * TS needs to know which is being called to accept the chain call\n         */\n        if (isDayJs(this.DateTimeParser)) {\n          return this.DateTimeParser(timestamp).locale(defaultLng);\n        }\n        return this.DateTimeParser(timestamp).locale(defaultLng);\n      }\n\n      if (isDayJs(this.DateTimeParser)) {\n        return this.DateTimeParser(timestamp).locale(this.currentLanguage);\n      }\n\n      return this.DateTimeParser(timestamp).locale(this.currentLanguage);\n    };\n  }\n\n  /**\n   * Initializes the i18next instance with configuration (which enables natural language as default keys)\n   */\n  async init() {\n    this.validateCurrentLanguage();\n\n    try {\n      this.t = await this.i18nInstance.init({\n        ...this.i18nextConfig,\n        lng: this.currentLanguage,\n        resources: this.translations,\n      });\n      this.initialized = true;\n    } catch (error) {\n      this.logger(`Something went wrong with init: ${JSON.stringify(error)}`);\n    }\n\n    return {\n      t: this.t,\n      tDateTimeParser: this.tDateTimeParser,\n    };\n  }\n\n  localeExists = (language: TranslationLanguages) => {\n    if (this.isCustomDateTimeParser) return true;\n\n    return Object.keys(Dayjs.Ls).indexOf(language) > -1;\n  };\n\n  validateCurrentLanguage = () => {\n    const availableLanguages = Object.keys(this.translations);\n    if (availableLanguages.indexOf(this.currentLanguage) === -1) {\n      this.logger(\n        `Streami18n: '${this.currentLanguage}' language is not registered.` +\n          ` Please make sure to call streami18n.registerTranslation('${this.currentLanguage}', {...}) or ` +\n          `use one the built-in supported languages - ${this.getAvailableLanguages()}`,\n      );\n\n      this.currentLanguage = defaultLng;\n    }\n  };\n\n  /** Returns an instance of i18next used within this class instance */\n  geti18Instance = () => this.i18nInstance;\n\n  /** Returns list of available languages. */\n  getAvailableLanguages = () => Object.keys(this.translations);\n\n  /** Returns all the translation dictionary for all inbuilt-languages */\n  getTranslations = () => this.translations;\n\n  /**\n   * Returns current version translator function.\n   */\n  async getTranslators() {\n    if (!this.initialized) {\n      if (this.dayjsLocales[this.currentLanguage]) {\n        this.addOrUpdateLocale(this.currentLanguage, this.dayjsLocales[this.currentLanguage]);\n      }\n\n      return await this.init();\n    } else {\n      return {\n        t: this.t,\n        tDateTimeParser: this.tDateTimeParser,\n      };\n    }\n  }\n\n  registerTranslation(\n    language: TranslationLanguages,\n    translation: typeof enTranslations,\n    customDayjsLocale?: Partial<ILocale>,\n  ) {\n    if (!translation) {\n      this.logger(\n        `Streami18n: registerTranslation(language, translation, customDayjsLocale) called without translation`,\n      );\n      return;\n    }\n\n    if (!this.translations[language]) {\n      this.translations[language] = { [defaultNS]: translation };\n    } else {\n      this.translations[language][defaultNS] = translation;\n    }\n\n    if (customDayjsLocale) {\n      this.dayjsLocales[language] = { ...customDayjsLocale };\n    } else if (!this.localeExists(language)) {\n      this.logger(\n        `Streami18n: registerTranslation(language, translation, customDayjsLocale) - ` +\n          `Locale config for ${language} does not exist in Dayjs.` +\n          `Please import the locale file using \"import 'dayjs/locale/${language}';\" in your app or ` +\n          `register the locale config with Streami18n using registerTranslation(language, translation, customDayjsLocale)`,\n      );\n    }\n\n    if (this.initialized) {\n      this.i18nInstance.addResources(language, defaultNS, translation);\n    }\n  }\n\n  addOrUpdateLocale(key: TranslationLanguages, config: Partial<ILocale>) {\n    if (this.localeExists(key)) {\n      Dayjs.updateLocale(key, { ...config });\n    } else {\n      // Merging the custom locale config with en config, so missing keys can default to english.\n      Dayjs.locale({ name: key, ...en_locale, ...config }, undefined, true);\n    }\n  }\n\n  async setLanguage(language: TranslationLanguages) {\n    this.currentLanguage = language;\n\n    if (!this.initialized) return;\n\n    try {\n      const t = await this.i18nInstance.changeLanguage(language);\n      if (this.dayjsLocales[language]) {\n        this.addOrUpdateLocale(this.currentLanguage, this.dayjsLocales[this.currentLanguage]);\n      }\n\n      this.setLanguageCallback(t);\n      return t;\n    } catch (error) {\n      this.logger(`Failed to set language: ${JSON.stringify(error)}`);\n      return this.t;\n    }\n  }\n\n  registerSetLanguageCallback(callback: (t: TFunction) => void) {\n    this.setLanguageCallback = callback;\n  }\n}\n","export const version = '7.0.0';\n","import { useCallback, useEffect, useRef, useState } from 'react';\nimport Dayjs from 'dayjs';\n\nimport {\n  isLanguageSupported,\n  SupportedTranslations,\n  TranslationContextValue,\n} from '../../../context/TranslationContext';\nimport { Streami18n } from '../../../i18n';\nimport { version } from '../../../version';\n\nimport type { AppSettingsAPIResponse, Channel, Event, Mute, StreamChat } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport type UseChatParams<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  client: StreamChat<At, Ch, Co, Ev, Me, Re, Us>;\n  defaultLanguage?: SupportedTranslations;\n  i18nInstance?: Streami18n;\n  initialNavOpen?: boolean;\n};\n\nexport const useChat = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>({\n  client,\n  defaultLanguage = 'en',\n  i18nInstance,\n  initialNavOpen,\n}: UseChatParams<At, Ch, Co, Ev, Me, Re, Us>) => {\n  const [translators, setTranslators] = useState<TranslationContextValue>({\n    t: (key: string) => key,\n    tDateTimeParser: (input) => Dayjs(input),\n    userLanguage: 'en',\n  });\n\n  const [channel, setChannel] = useState<Channel<At, Ch, Co, Ev, Me, Re, Us>>();\n  const [mutes, setMutes] = useState<Array<Mute<Us>>>([]);\n  const [navOpen, setNavOpen] = useState(initialNavOpen);\n\n  const clientMutes = client.user?.mutes;\n\n  const closeMobileNav = () => setNavOpen(false);\n  const openMobileNav = () => setTimeout(() => setNavOpen(true), 100);\n\n  const appSettings = useRef<Promise<AppSettingsAPIResponse<Co>> | null>(null);\n\n  const getAppSettings = () => {\n    if (appSettings.current) {\n      return appSettings.current;\n    }\n    appSettings.current = client.getAppSettings();\n    return appSettings.current;\n  };\n\n  useEffect(() => {\n    if (client) {\n      const userAgent = client.getUserAgent();\n      if (!userAgent.includes('stream-chat-react')) {\n        // result looks like: 'stream-chat-react-2.3.2-stream-chat-javascript-client-browser-2.2.2'\n        client.setUserAgent(`stream-chat-react-${version}-${userAgent}`);\n      }\n    }\n  }, [client]);\n\n  useEffect(() => {\n    setMutes(clientMutes || []);\n\n    const handleEvent = (event: Event<At, Ch, Co, Ev, Me, Re, Us>) => {\n      setMutes(event.me?.mutes || []);\n    };\n\n    client.on('notification.mutes_updated', handleEvent);\n    return () => client.off('notification.mutes_updated', handleEvent);\n  }, [clientMutes?.length]);\n\n  useEffect(() => {\n    let userLanguage = client.user?.language;\n\n    if (!userLanguage) {\n      const browserLanguage = window.navigator.language.slice(0, 2); // just get language code, not country-specific version\n      userLanguage = isLanguageSupported(browserLanguage) ? browserLanguage : defaultLanguage;\n    }\n\n    const streami18n = i18nInstance || new Streami18n({ language: userLanguage });\n\n    streami18n.registerSetLanguageCallback((t) =>\n      setTranslators((prevTranslator) => ({ ...prevTranslator, t })),\n    );\n\n    streami18n.getTranslators().then((translator) => {\n      setTranslators({\n        ...translator,\n        userLanguage: userLanguage || defaultLanguage,\n      });\n    });\n  }, [i18nInstance]);\n\n  const setActiveChannel = useCallback(\n    async (\n      activeChannel?: Channel<At, Ch, Co, Ev, Me, Re, Us>,\n      watchers: { limit?: number; offset?: number } = {},\n      event?: React.BaseSyntheticEvent,\n    ) => {\n      if (event && event.preventDefault) event.preventDefault();\n\n      if (activeChannel && Object.keys(watchers).length) {\n        await activeChannel.query({ watch: true, watchers });\n      }\n\n      setChannel(activeChannel);\n      closeMobileNav();\n    },\n    [],\n  );\n\n  return {\n    channel,\n    closeMobileNav,\n    getAppSettings,\n    mutes,\n    navOpen,\n    openMobileNav,\n    setActiveChannel,\n    translators,\n  };\n};\n","import { useMemo } from 'react';\n\nimport type { ChatContextValue } from '../../../context/ChatContext';\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useCreateChatContext = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  value: ChatContextValue<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const {\n    channel,\n    client,\n    closeMobileNav,\n    customClasses,\n    getAppSettings,\n    mutes,\n    navOpen,\n    openMobileNav,\n    setActiveChannel,\n    theme,\n    useImageFlagEmojisOnWindows,\n  } = value;\n\n  const channelCid = channel?.cid;\n  const clientValues = `${client.clientID}${Object.keys(client.activeChannels).length}${\n    Object.keys(client.listeners).length\n  }${client.mutedChannels.length}\n  ${client.user?.id}`;\n  const mutedUsersLength = mutes.length;\n\n  const chatContext: ChatContextValue<At, Ch, Co, Ev, Me, Re, Us> = useMemo(\n    () => ({\n      channel,\n      client,\n      closeMobileNav,\n      customClasses,\n      getAppSettings,\n      mutes,\n      navOpen,\n      openMobileNav,\n      setActiveChannel,\n      theme,\n      useImageFlagEmojisOnWindows,\n    }),\n    [channelCid, clientValues, getAppSettings, mutedUsersLength, navOpen],\n  );\n\n  return chatContext;\n};\n","export type CSSVariables =\n  | '--main-font'\n  | '--second-font'\n  | '--xs-font'\n  | '--sm-font'\n  | '--md-font'\n  | '--lg-font'\n  | '--xl-font'\n  | '--xxl-font'\n  | '--xxxl-font'\n  | '--font-weight-regular'\n  | '--font-weight-semi-bold'\n  | '--font-weight-bold'\n  | '--primary-color'\n  | '--primary-color-faded'\n  | '--magenta'\n  | '--red'\n  | '--faded-red'\n  | '--dt-bg-team'\n  | '--border-color'\n  | '--lighten-black'\n  | '--lighten-grey'\n  | '--light-grey'\n  | '--grey'\n  | '--dark-grey'\n  | '--green'\n  | '--faded-green'\n  | '--white'\n  | '--white5'\n  | '--white10'\n  | '--white20'\n  | '--white30'\n  | '--white40'\n  | '--white50'\n  | '--white60'\n  | '--white70'\n  | '--white80'\n  | '--white90'\n  | '--white95'\n  | '--black'\n  | '--black5'\n  | '--black10'\n  | '--black20'\n  | '--black30'\n  | '--black40'\n  | '--black50'\n  | '--black60'\n  | '--black70'\n  | '--black80'\n  | '--black90'\n  | '--black95'\n  | '--border-radius'\n  | '--border-radius-sm'\n  | '--border-radius-md'\n  | '--border-radius-round'\n  | '--spacing-unit'\n  | '--xxs-p'\n  | '--xs-p'\n  | '--sm-p'\n  | '--md-p'\n  | '--lg-p'\n  | '--xl-p'\n  | '--xxl-p'\n  | '--xxs-m'\n  | '--xs-m'\n  | '--sm-m'\n  | '--md-m'\n  | '--lg-m'\n  | '--xl-m'\n  | '--xxl-m'\n  | '--assetsPath'\n  | '--accent_blue'\n  | '--accent_green'\n  | '--accent_red'\n  | '--bg-gradient-end'\n  | '--bg-gradient-start'\n  | '--black'\n  | '--blue-alice'\n  | '--border'\n  | '--button-background'\n  | '--button-text'\n  | '--grey'\n  | '--grey-gainsboro'\n  | '--grey-whisper'\n  | '--highlight'\n  | '--modal-shadow'\n  | '--overlay'\n  | '--overlay-dark'\n  | '--shadow-icon'\n  | '--targetedMessageBackground'\n  | '--transparent'\n  | '--white'\n  | '--white-smoke'\n  | '--white-snow';\n\nexport const darkModeTheme: CustomStyles = {\n  '--bg-gradient-end': '#101214',\n  '--bg-gradient-start': '#070a0d',\n  '--black': '#ffffff',\n  '--blue-alice': '#00193d',\n  '--border': '#141924',\n  '--button-background': '#ffffff',\n  '--button-text': '#005fff',\n  '--grey': '#7a7a7a',\n  '--grey-gainsboro': '#2d2f2f',\n  '--grey-whisper': '#1c1e22',\n  '--modal-shadow': '#000000',\n  '--overlay': '#00000066', // 66 = 40% opacity\n  '--overlay-dark': '#ffffffcc', // CC = 80% opacity\n  '--shadow-icon': '#00000080', // 80 = 50% opacity\n  '--targetedMessageBackground': '#302d22',\n  '--transparent': 'transparent',\n  '--white': '#101418',\n  '--white-smoke': '#13151b',\n  '--white-snow': '#070a0d',\n};\n\nexport type CustomStyles = Partial<Record<CSSVariables, string>>;\n\nexport const useCustomStyles = (customStyles?: CustomStyles) => {\n  if (!customStyles) return;\n\n  for (const [key, value] of Object.entries(customStyles)) {\n    document.documentElement.style.setProperty(key, value);\n  }\n};\n","import React, { PropsWithChildren } from 'react';\n\nimport { useChat } from './hooks/useChat';\nimport { useCreateChatContext } from './hooks/useCreateChatContext';\nimport { CustomStyles, darkModeTheme, useCustomStyles } from './hooks/useCustomStyles';\n\nimport { ChatProvider, CustomClasses } from '../../context/ChatContext';\nimport { SupportedTranslations, TranslationProvider } from '../../context/TranslationContext';\n\nimport type { StreamChat } from 'stream-chat';\n\nimport type { Streami18n } from '../../i18n/Streami18n';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type Theme<T extends string = string> =\n  | 'commerce dark'\n  | 'commerce light'\n  | 'livestream dark'\n  | 'livestream light'\n  | 'messaging dark'\n  | 'messaging light'\n  | 'team dark'\n  | 'team light'\n  | T;\n\nexport type ChatProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  /** The StreamChat client object */\n  client: StreamChat<At, Ch, Co, Ev, Me, Re, Us>;\n  /** Object containing custom CSS classnames to override the library's default container CSS */\n  customClasses?: CustomClasses;\n  /** Object containing custom styles to override the default CSS variables */\n  customStyles?: CustomStyles;\n  /** If true, toggles the CSS variables to the default dark mode color palette */\n  darkMode?: boolean;\n  /** Sets the default fallback language for UI component translation, defaults to 'en' for English */\n  defaultLanguage?: SupportedTranslations;\n  /** Instance of Stream i18n */\n  i18nInstance?: Streami18n;\n  /** Initial status of mobile navigation */\n  initialNavOpen?: boolean;\n  /** @deprecated and to be removed in a future major release. Use the `customStyles` prop to adjust CSS variables and [customize the theme](https://getstream.io/chat/docs/sdk/react/customization/css_and_theming/#css-variables) of your app  */\n  theme?: Theme;\n  /** Windows 10 does not support country flag emojis out of the box. It chooses to render these emojis as characters instead. Stream\n   * Chat can override this behavior by loading a custom web font that will render images instead (PNGs or SVGs depending on the platform).\n   * Set this prop to true if you want to use these custom emojis for Windows users.\n   */\n  useImageFlagEmojisOnWindows?: boolean;\n};\n\n/**\n * Wrapper component for a StreamChat application. Chat needs to be placed around any other chat components\n * as it provides the ChatContext.\n */\nexport const Chat = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: PropsWithChildren<ChatProps<At, Ch, Co, Ev, Me, Re, Us>>,\n) => {\n  const {\n    children,\n    client,\n    customClasses,\n    customStyles,\n    darkMode = false,\n    defaultLanguage,\n    i18nInstance,\n    initialNavOpen = true,\n    theme = 'messaging light',\n    useImageFlagEmojisOnWindows = false,\n  } = props;\n\n  const {\n    channel,\n    closeMobileNav,\n    getAppSettings,\n    mutes,\n    navOpen,\n    openMobileNav,\n    setActiveChannel,\n    translators,\n  } = useChat({ client, defaultLanguage, i18nInstance, initialNavOpen });\n\n  useCustomStyles(darkMode ? darkModeTheme : customStyles);\n\n  const chatContextValue = useCreateChatContext({\n    channel,\n    client,\n    closeMobileNav,\n    customClasses,\n    getAppSettings,\n    mutes,\n    navOpen,\n    openMobileNav,\n    setActiveChannel,\n    theme,\n    useImageFlagEmojisOnWindows,\n  });\n\n  if (!translators.t) return null;\n\n  return (\n    <ChatProvider value={chatContextValue}>\n      <TranslationProvider value={translators}>{children}</TranslationProvider>\n    </ChatProvider>\n  );\n};\n","import React from 'react';\n\nimport { isDayOrMoment, useTranslationContext } from '../../context/TranslationContext';\n\nexport type DateSeparatorProps = {\n  /** The date to format */\n  date: Date;\n  /** Override the default formatting of the date. This is a function that has access to the original date object. */\n  formatDate?: (date: Date) => string;\n  /** Set the position of the date in the separator, options are 'left', 'center', 'right', @default right */\n  position?: 'left' | 'center' | 'right';\n  /** If following messages are not new */\n  unread?: boolean;\n};\n\nconst UnMemoizedDateSeparator = (props: DateSeparatorProps) => {\n  const { date, formatDate, position = 'right', unread } = props;\n\n  const { t, tDateTimeParser } = useTranslationContext('DateSeparator');\n\n  if (typeof date === 'string') return null;\n\n  const parsedDate = tDateTimeParser(date.toISOString());\n\n  const formattedDate = formatDate\n    ? formatDate(date)\n    : isDayOrMoment(parsedDate)\n    ? parsedDate.calendar()\n    : parsedDate;\n\n  return (\n    <div className='str-chat__date-separator'>\n      {(position === 'right' || position === 'center') && (\n        <hr className='str-chat__date-separator-line' />\n      )}\n      <div className='str-chat__date-separator-date'>\n        {unread ? `${t('New')} - ${formattedDate}` : formattedDate}\n      </div>\n      {(position === 'left' || position === 'center') && (\n        <hr className='str-chat__date-separator-line' />\n      )}\n    </div>\n  );\n};\n\n/**\n * A simple date separator between messages.\n */\nexport const DateSeparator = React.memo(UnMemoizedDateSeparator) as typeof UnMemoizedDateSeparator;\n","import React from 'react';\n\nimport { AvatarProps, Avatar as DefaultAvatar } from '../Avatar';\n\nimport { isDayOrMoment, useTranslationContext } from '../../context/TranslationContext';\n\nimport type { StreamMessage } from '../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type EventComponentProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  /** Message object */\n  message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>;\n  /** Custom UI component to display user avatar, defaults to and accepts same props as: [Avatar](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Avatar/Avatar.tsx) */\n  Avatar?: React.ComponentType<AvatarProps>;\n};\n\n/**\n * Component to display system and channel event messages\n */\nconst UnMemoizedEventComponent = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: EventComponentProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const { Avatar = DefaultAvatar, message } = props;\n\n  const { tDateTimeParser } = useTranslationContext('EventComponent');\n  const { created_at = '', event, text, type } = message;\n\n  const dateFormatter = (date: string | Date, format: string) => {\n    const parsedDate = tDateTimeParser(date);\n    const formattedDate = isDayOrMoment(parsedDate) ? parsedDate.format(format) : parsedDate;\n    return formattedDate;\n  };\n\n  if (type === 'system')\n    return (\n      <div className='str-chat__message--system'>\n        <div className='str-chat__message--system__text'>\n          <div className='str-chat__message--system__line' />\n          <p>{text}</p>\n          <div className='str-chat__message--system__line' />\n        </div>\n        <div className='str-chat__message--system__date'>\n          <strong>{dateFormatter(created_at, 'dddd')} </strong>\n          at {dateFormatter(created_at, 'hh:mm A')}\n        </div>\n      </div>\n    );\n\n  if (event?.type === 'member.removed' || event?.type === 'member.added') {\n    const name = event.user?.name || event.user?.id;\n    const sentence = `${name} ${\n      event.type === 'member.added' ? 'has joined the chat' : 'was removed from the chat'\n    }`;\n\n    return (\n      <div className='str-chat__event-component__channel-event'>\n        <Avatar image={event.user?.image} name={name} user={event.user} />\n        <div className='str-chat__event-component__channel-event__content'>\n          <em className='str-chat__event-component__channel-event__sentence'>{sentence}</em>\n          <div className='str-chat__event-component__channel-event__date'>\n            {dateFormatter(created_at, 'LT')}\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  return null;\n};\n\nexport const EventComponent = React.memo(\n  UnMemoizedEventComponent,\n) as typeof UnMemoizedEventComponent;\n","import React, { useCallback, useEffect, useRef } from 'react';\n\n/**\n * Prevents Chrome hangups\n * See: https://stackoverflow.com/questions/47524205/random-high-content-download-time-in-chrome/47684257#47684257\n */\nconst mousewheelListener = (event: Event) => {\n  if (event instanceof WheelEvent && event.deltaY === 1) {\n    event.preventDefault();\n  }\n};\n\nconst calculateTopPosition = (element: HTMLElement | Element | null): number => {\n  if (element instanceof HTMLElement) {\n    return element.offsetTop + calculateTopPosition(element.offsetParent);\n  }\n  return 0;\n};\n\n/**\n * Computes by recursively summing offsetTop until an element without offsetParent is reached\n */\nconst calculateOffset = (element: HTMLElement, scrollTop: number) => {\n  if (!element) {\n    return 0;\n  }\n\n  return calculateTopPosition(element) + (element.offsetHeight - scrollTop - window.innerHeight);\n};\n\nexport type InfiniteScrollProps = {\n  className?: string;\n  element?: React.ElementType;\n  hasMore?: boolean;\n  initialLoad?: boolean;\n  isLoading?: boolean;\n  isReverse?: boolean;\n  listenToScroll?: (offset: number, reverseOffset: number, threshold: number) => void;\n  loader?: React.ReactNode;\n  loading?: React.ReactNode;\n  loadMore?: () => void;\n  pageStart?: number;\n  threshold?: number;\n  useCapture?: boolean;\n  useWindow?: boolean;\n};\n\nexport const InfiniteScroll: React.FC<InfiniteScrollProps> = (props) => {\n  const {\n    children,\n    element = 'div',\n    hasMore = false,\n    initialLoad = true,\n    isLoading = false,\n    isReverse = false,\n    listenToScroll,\n    loader,\n    loadMore,\n    threshold = 250,\n    useCapture = false,\n    useWindow = true,\n    ...elementProps\n  } = props;\n\n  const scrollComponent = useRef<HTMLElement>();\n\n  const scrollListener = useCallback(() => {\n    const element = scrollComponent.current;\n    if (!element) return;\n    const { parentElement } = element;\n\n    let offset = 0;\n    let reverseOffset = 0;\n    if (useWindow) {\n      const doc = document.documentElement || document.body.parentNode || document.body;\n      const scrollTop = window.pageYOffset !== undefined ? window.pageYOffset : doc.scrollTop;\n      offset = calculateOffset(element, scrollTop);\n      reverseOffset = scrollTop;\n    } else if (parentElement) {\n      offset = element.scrollHeight - parentElement.scrollTop - parentElement.clientHeight;\n      reverseOffset = parentElement.scrollTop;\n    }\n    if (listenToScroll) {\n      listenToScroll(offset, reverseOffset, threshold);\n    }\n\n    // Here we make sure the element is visible as well as checking the offset\n    if (\n      (isReverse ? reverseOffset : offset) < Number(threshold) &&\n      element.offsetParent !== null &&\n      typeof loadMore === 'function' &&\n      hasMore\n    ) {\n      loadMore();\n    }\n  }, [hasMore, useWindow, isReverse, threshold, listenToScroll, loadMore]);\n\n  useEffect(() => {\n    const scrollElement = useWindow ? window : scrollComponent.current?.parentNode;\n    if (isLoading || !scrollElement) {\n      return () => undefined;\n    }\n\n    scrollElement.addEventListener('scroll', scrollListener, useCapture);\n    scrollElement.addEventListener('resize', scrollListener, useCapture);\n\n    if (initialLoad) {\n      scrollListener();\n    }\n\n    return () => {\n      scrollElement.removeEventListener('scroll', scrollListener, useCapture);\n      scrollElement.removeEventListener('resize', scrollListener, useCapture);\n    };\n  }, [initialLoad, isLoading, scrollListener, useCapture, useWindow]);\n\n  useEffect(() => {\n    const scrollElement = useWindow ? window : scrollComponent.current?.parentNode;\n    if (scrollElement) {\n      scrollElement.addEventListener('wheel', mousewheelListener, { passive: false });\n    }\n    return () => {\n      if (scrollElement) {\n        scrollElement.removeEventListener('wheel', mousewheelListener, useCapture);\n      }\n    };\n  }, [useCapture, useWindow]);\n\n  const attributes = {\n    ...elementProps,\n    ref: (element: HTMLElement) => {\n      scrollComponent.current = element;\n    },\n  };\n\n  const childrenArray = [children];\n  if (isLoading && loader) {\n    if (isReverse) {\n      childrenArray.unshift(loader);\n    } else {\n      childrenArray.push(loader);\n    }\n  }\n  return React.createElement(element, attributes, childrenArray);\n};\n","import React from 'react';\nimport { LoadingIndicator as DefaultLoadingIndicator } from 'react-file-utils';\n\nimport { InfiniteScroll } from './InfiniteScroll';\n\nimport type { LoadingIndicatorProps } from '../Loading/LoadingIndicator';\n\nexport type InfiniteScrollPaginatorProps = {\n  /** callback to load the next page */\n  loadNextPage: () => void;\n  /** indicates if there is a next page to load */\n  hasNextPage?: boolean;\n  /** The loading indicator to use */\n  LoadingIndicator?: React.ComponentType<LoadingIndicatorProps>;\n  /** indicates if there there's currently any refreshing taking place */\n  refreshing?: boolean;\n  /** display the items in opposite order */\n  reverse?: boolean;\n  /** Offset from when to start the loadNextPage call */\n  threshold?: number;\n};\n\nexport const InfiniteScrollPaginator: React.FC<InfiniteScrollPaginatorProps> = (props) => {\n  const {\n    children,\n    hasNextPage,\n    LoadingIndicator = DefaultLoadingIndicator,\n    loadNextPage,\n    refreshing,\n    reverse,\n    threshold,\n  } = props;\n\n  return (\n    <InfiniteScroll\n      hasMore={hasNextPage}\n      isLoading={refreshing}\n      isReverse={reverse}\n      loader={\n        <div className='str-chat__infinite-scroll-paginator' key='loadingindicator'>\n          <LoadingIndicator />\n        </div>\n      }\n      loadMore={loadNextPage}\n      threshold={threshold}\n      useWindow={false}\n    >\n      {children}\n    </InfiniteScroll>\n  );\n};\n","import React from 'react';\n\nimport { InfiniteScroll, InfiniteScrollProps } from './InfiniteScroll';\n\nexport const ReverseInfiniteScroll: React.FC<InfiniteScrollProps> = (props) => (\n  <InfiniteScroll {...props} isReverse />\n);\n","import React, { useCallback, useMemo } from 'react';\n\nimport { useActionHandler, useDeleteHandler, useUserRole } from './hooks';\nimport { MessageDeleted as DefaultMessageDeleted } from './MessageDeleted';\nimport { MessageTimestamp } from './MessageTimestamp';\nimport { getMessageActions } from './utils';\n\nimport { Avatar } from '../Avatar';\nimport { Gallery } from '../Gallery';\nimport { MessageActions } from '../MessageActions';\nimport { MML } from '../MML';\n\nimport { useChatContext } from '../../context/ChatContext';\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { useMessageContext } from '../../context/MessageContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\nimport { renderText } from '../../utils';\n\nimport type { TranslationLanguages } from 'stream-chat';\n\nimport type { StreamMessage } from '../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nconst selectColor = (number: number, dark: boolean) => {\n  const hue = number * 137.508; // use golden angle approximation\n  return `hsl(${hue},${dark ? '50%' : '85%'}, ${dark ? '75%' : '55%'})`;\n};\n\nconst hashUserId = (userId: string) => {\n  const hash = userId.split('').reduce((acc, c) => {\n    acc = (acc << 5) - acc + c.charCodeAt(0); // eslint-disable-line\n    return acc & acc; // eslint-disable-line no-bitwise\n  }, 0);\n  return Math.abs(hash) / 10 ** Math.ceil(Math.log10(Math.abs(hash) + 1));\n};\n\nconst getUserColor = (theme: string, userId: string) =>\n  selectColor(hashUserId(userId), theme.includes('dark'));\n\nexport type FixedHeightMessageProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  groupedByUser?: boolean;\n  message?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>;\n};\n\nconst UnMemoizedFixedHeightMessage = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: FixedHeightMessageProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const { groupedByUser: propGroupedByUser, message: propMessage } = props;\n\n  const { theme } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('FixedHeightMessage');\n\n  const { groupedByUser: contextGroupedByUser, message: contextMessage } = useMessageContext<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us\n  >('FixedHeightMessage');\n\n  const { MessageDeleted = DefaultMessageDeleted } = useComponentContext<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us\n  >('FixedHeightMessage');\n\n  const { userLanguage } = useTranslationContext('FixedHeightMessage');\n\n  const groupedByUser = propGroupedByUser !== undefined ? propGroupedByUser : contextGroupedByUser;\n  const message = propMessage || contextMessage;\n\n  const handleAction = useActionHandler(message);\n  const handleDelete = useDeleteHandler(message);\n  const role = useUserRole(message);\n\n  const messageTextToRender =\n    message?.i18n?.[`${userLanguage}_text` as `${TranslationLanguages}_text`] || message?.text;\n\n  const renderedText = useMemo(() => renderText(messageTextToRender, message.mentioned_users), [\n    message.mentioned_users,\n    messageTextToRender,\n  ]);\n\n  const userId = message.user?.id || '';\n  const userColor = useMemo(() => getUserColor(theme, userId), [userId, theme]);\n\n  const messageActionsHandler = useCallback(\n    () => getMessageActions(['delete'], { canDelete: role.canDelete }),\n    [role],\n  );\n\n  const images = message?.attachments?.filter(({ type }) => type === 'image');\n\n  return (\n    <div\n      className={`str-chat__virtual-message__wrapper ${\n        role.isMyMessage ? 'str-chat__virtual-message__wrapper--me' : ''\n      } ${groupedByUser ? 'str-chat__virtual-message__wrapper--group' : ''}`}\n      key={message.id}\n    >\n      {message.user && (\n        <Avatar\n          image={message.user.image}\n          name={message.user.name || message.user.id}\n          shape='rounded'\n          size={38}\n          user={message.user}\n        />\n      )}\n      <div className='str-chat__virtual-message__content'>\n        <div className='str-chat__virtual-message__meta'>\n          <div className='str-chat__virtual-message__author' style={{ color: userColor }}>\n            <strong>{message.user?.name || 'unknown'}</strong>\n          </div>\n        </div>\n        {message.deleted_at || message.type === 'deleted' ? (\n          <MessageDeleted message={message} />\n        ) : (\n          <>\n            {images && <Gallery images={images} />}\n            <div className='str-chat__virtual-message__text' data-testid='msg-text'>\n              {renderedText}\n              {message.mml && (\n                <MML actionHandler={handleAction} align='left' source={message.mml} />\n              )}\n              <div className='str-chat__virtual-message__data'>\n                <MessageActions\n                  customWrapperClass='str-chat__virtual-message__actions'\n                  getMessageActions={messageActionsHandler}\n                  handleDelete={handleDelete}\n                  message={message}\n                  mine={() => role.isMyMessage}\n                />\n                <span className='str-chat__virtual-message__date'>\n                  <MessageTimestamp\n                    customClass='str-chat__message-simple-timestamp'\n                    message={message}\n                  />\n                </span>\n              </div>\n            </div>\n          </>\n        )}\n      </div>\n    </div>\n  );\n};\n\n/**\n * @deprecated - This UI component will be removed in the next major release.\n *\n * FixedHeightMessage - This component renders a single message.\n * It uses fixed height elements to make sure it works well in VirtualizedMessageList\n */\nexport const FixedHeightMessage = React.memo(\n  UnMemoizedFixedHeightMessage,\n) as typeof UnMemoizedFixedHeightMessage;\n","import React, { useCallback, useRef } from 'react';\n\nimport {\n  useActionHandler,\n  useDeleteHandler,\n  useEditHandler,\n  useFlagHandler,\n  useMentionsHandler,\n  useMuteHandler,\n  useOpenThreadHandler,\n  usePinHandler,\n  useReactionClick,\n  useReactionHandler,\n  useRetryHandler,\n  useUserHandler,\n  useUserRole,\n} from './hooks';\nimport { areMessagePropsEqual, getMessageActions, MESSAGE_ACTIONS } from './utils';\n\nimport { useChannelActionContext } from '../../context/ChannelActionContext';\nimport { useChannelStateContext } from '../../context/ChannelStateContext';\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { MessageContextValue, MessageProvider } from '../../context/MessageContext';\n\nimport type { MessageProps } from './types';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\ntype MessagePropsToOmit = 'onMentionsClick' | 'onMentionsHover' | 'openThread' | 'retrySendMessage';\n\ntype MessageContextPropsToPick =\n  | 'handleAction'\n  | 'handleDelete'\n  | 'handleFlag'\n  | 'handleMute'\n  | 'handleOpenThread'\n  | 'handlePin'\n  | 'handleReaction'\n  | 'handleRetry'\n  | 'isReactionEnabled'\n  | 'mutes'\n  | 'onMentionsClickMessage'\n  | 'onMentionsHoverMessage'\n  | 'onReactionListClick'\n  | 'reactionSelectorRef'\n  | 'showDetailedReactions';\n\ntype MessageWithContextProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = Omit<MessageProps<At, Ch, Co, Ev, Me, Re, Us>, MessagePropsToOmit> &\n  Pick<MessageContextValue<At, Ch, Co, Ev, Me, Re, Us>, MessageContextPropsToPick> & {\n    canPin: boolean;\n    userRoles: ReturnType<typeof useUserRole>;\n  };\n\nconst MessageWithContext = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: MessageWithContextProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const {\n    canPin,\n    groupedByUser,\n    Message: propMessage,\n    message,\n    messageActions = Object.keys(MESSAGE_ACTIONS),\n    onUserClick: propOnUserClick,\n    onUserHover: propOnUserHover,\n    userRoles,\n  } = props;\n\n  const { Message: contextMessage } = useComponentContext<At, Ch, Co, Ev, Me, Re, Us>('Message');\n\n  const actionsEnabled = message.type === 'regular' && message.status === 'received';\n  const MessageUIComponent = propMessage || contextMessage;\n\n  const { clearEdit, editing, setEdit } = useEditHandler();\n\n  const { onUserClick, onUserHover } = useUserHandler(message, {\n    onUserClickHandler: propOnUserClick,\n    onUserHoverHandler: propOnUserHover,\n  });\n\n  const {\n    canDelete,\n    canEdit,\n    canFlag,\n    canMute,\n    canQuote,\n    canReact,\n    canReply,\n    isMyMessage,\n  } = userRoles;\n\n  const messageActionsHandler = useCallback(\n    () =>\n      getMessageActions(messageActions, {\n        canDelete,\n        canEdit,\n        canFlag,\n        canMute,\n        canPin,\n        canQuote,\n        canReact,\n        canReply,\n      }),\n    [canDelete, canEdit, canFlag, canMute, canPin, canQuote, canReact, canReply],\n  );\n\n  const {\n    canPin: canPinPropToNotPass, // eslint-disable-line @typescript-eslint/no-unused-vars\n    messageActions: messageActionsPropToNotPass, // eslint-disable-line @typescript-eslint/no-unused-vars\n    onlySenderCanEdit: onlySenderCanEditPropToNotPass, // eslint-disable-line @typescript-eslint/no-unused-vars\n    onUserClick: onUserClickPropToNotPass, // eslint-disable-line @typescript-eslint/no-unused-vars\n    onUserHover: onUserHoverPropToNotPass, // eslint-disable-line @typescript-eslint/no-unused-vars\n    userRoles: userRolesPropToNotPass, // eslint-disable-line @typescript-eslint/no-unused-vars\n    ...rest\n  } = props;\n\n  const messageContextValue: MessageContextValue<At, Ch, Co, Ev, Me, Re, Us> = {\n    ...rest,\n    actionsEnabled,\n    clearEditingState: clearEdit,\n    editing,\n    getMessageActions: messageActionsHandler,\n    handleEdit: setEdit,\n    isMyMessage: () => isMyMessage,\n    onUserClick,\n    onUserHover,\n    setEditingState: setEdit,\n  };\n\n  return (\n    <MessageProvider value={messageContextValue}>\n      <MessageUIComponent groupedByUser={groupedByUser} />\n      {/* TODO - remove prop in next major release, maintains VML backwards compatibility */}\n    </MessageProvider>\n  );\n};\n\nconst MemoizedMessage = React.memo(\n  MessageWithContext,\n  areMessagePropsEqual,\n) as typeof MessageWithContext;\n\n/**\n * The Message component is a context provider which implements all the logic required for rendering\n * an individual message. The actual UI of the message is delegated via the Message prop on Channel.\n */\nexport const Message = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: MessageProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const {\n    closeReactionSelectorOnClick,\n    disableQuotedMessages,\n    getDeleteMessageErrorNotification,\n    getFlagMessageErrorNotification,\n    getFlagMessageSuccessNotification,\n    getMuteUserErrorNotification,\n    getMuteUserSuccessNotification,\n    getPinMessageErrorNotification,\n    message,\n    onlySenderCanEdit = false,\n    onMentionsClick: propOnMentionsClick,\n    onMentionsHover: propOnMentionsHover,\n    openThread: propOpenThread,\n    pinPermissions,\n    retrySendMessage: propRetrySendMessage,\n  } = props;\n\n  const { addNotification } = useChannelActionContext<At, Ch, Co, Ev, Me, Re, Us>('Message');\n  const { mutes } = useChannelStateContext<At, Ch, Co, Ev, Me, Re, Us>('Message');\n\n  const reactionSelectorRef = useRef<HTMLDivElement | null>(null);\n\n  const handleAction = useActionHandler(message);\n  const handleOpenThread = useOpenThreadHandler(message, propOpenThread);\n  const handleReaction = useReactionHandler(message);\n  const handleRetry = useRetryHandler(propRetrySendMessage);\n  const userRoles = useUserRole(message, onlySenderCanEdit, disableQuotedMessages);\n\n  const handleDelete = useDeleteHandler(message, {\n    getErrorNotification: getDeleteMessageErrorNotification,\n    notify: addNotification,\n  });\n\n  const handleFlag = useFlagHandler(message, {\n    getErrorNotification: getFlagMessageErrorNotification,\n    getSuccessNotification: getFlagMessageSuccessNotification,\n    notify: addNotification,\n  });\n\n  const handleMute = useMuteHandler(message, {\n    getErrorNotification: getMuteUserErrorNotification,\n    getSuccessNotification: getMuteUserSuccessNotification,\n    notify: addNotification,\n  });\n\n  const { onMentionsClick, onMentionsHover } = useMentionsHandler(message, {\n    onMentionsClick: propOnMentionsClick,\n    onMentionsHover: propOnMentionsHover,\n  });\n\n  const { canPin, handlePin } = usePinHandler(message, pinPermissions, {\n    getErrorNotification: getPinMessageErrorNotification,\n    notify: addNotification,\n  });\n\n  const { isReactionEnabled, onReactionListClick, showDetailedReactions } = useReactionClick(\n    message,\n    reactionSelectorRef,\n    undefined,\n    closeReactionSelectorOnClick,\n  );\n\n  return (\n    <MemoizedMessage\n      additionalMessageInputProps={props.additionalMessageInputProps}\n      canPin={canPin}\n      customMessageActions={props.customMessageActions}\n      disableQuotedMessages={props.disableQuotedMessages}\n      endOfGroup={props.endOfGroup}\n      firstOfGroup={props.firstOfGroup}\n      formatDate={props.formatDate}\n      groupedByUser={props.groupedByUser}\n      groupStyles={props.groupStyles}\n      handleAction={handleAction}\n      handleDelete={handleDelete}\n      handleFlag={handleFlag}\n      handleMute={handleMute}\n      handleOpenThread={handleOpenThread}\n      handlePin={handlePin}\n      handleReaction={handleReaction}\n      handleRetry={handleRetry}\n      initialMessage={props.initialMessage}\n      isReactionEnabled={isReactionEnabled}\n      lastReceivedId={props.lastReceivedId}\n      message={message}\n      Message={props.Message}\n      messageActions={props.messageActions}\n      messageListRect={props.messageListRect}\n      mutes={mutes}\n      onMentionsClickMessage={onMentionsClick}\n      onMentionsHoverMessage={onMentionsHover}\n      onReactionListClick={onReactionListClick}\n      onUserClick={props.onUserClick}\n      onUserHover={props.onUserHover}\n      pinPermissions={props.pinPermissions}\n      reactionSelectorRef={reactionSelectorRef}\n      readBy={props.readBy}\n      renderText={props.renderText}\n      showDetailedReactions={showDetailedReactions}\n      threadList={props.threadList}\n      unsafeHTML={props.unsafeHTML}\n      userRoles={userRoles}\n    />\n  );\n};\n","import React from 'react';\n\nimport { MessageDeleted as DefaultMessageDeleted } from './MessageDeleted';\nimport { MessageOptions as DefaultMessageOptions } from './MessageOptions';\nimport { MessageRepliesCountButton as DefaultMessageRepliesCountButton } from './MessageRepliesCountButton';\nimport { MessageText } from './MessageText';\nimport { MessageTimestamp as DefaultMessageTimestamp } from './MessageTimestamp';\nimport { areMessageUIPropsEqual, messageHasAttachments, messageHasReactions } from './utils';\n\nimport { Avatar as DefaultAvatar } from '../Avatar';\nimport { MML } from '../MML';\nimport {\n  ReactionSelector as DefaultReactionSelector,\n  ReactionsList as DefaultReactionsList,\n} from '../Reactions';\n\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { MessageContextValue, useMessageContext } from '../../context/MessageContext';\n\nimport type { MessageUIComponentProps, ReactEventHandler } from './types';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\ntype MessageCommerceWithContextProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = MessageContextValue<At, Ch, Co, Ev, Me, Re, Us> & {\n  isReactionEnabled: boolean;\n  onReactionListClick: ReactEventHandler;\n  reactionSelectorRef: React.MutableRefObject<HTMLDivElement | null>;\n  showDetailedReactions: boolean;\n};\n\nconst MessageCommerceWithContext = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: MessageCommerceWithContextProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const {\n    groupStyles,\n    handleAction,\n    handleOpenThread,\n    isMyMessage,\n    isReactionEnabled,\n    message,\n    onUserClick,\n    onUserHover,\n    reactionSelectorRef,\n    showDetailedReactions,\n    threadList,\n  } = props;\n\n  const {\n    Attachment,\n    Avatar = DefaultAvatar,\n    MessageDeleted = DefaultMessageDeleted,\n    MessageRepliesCountButton = DefaultMessageRepliesCountButton,\n    MessageOptions = DefaultMessageOptions,\n    MessageTimestamp = DefaultMessageTimestamp,\n    ReactionSelector = DefaultReactionSelector,\n    ReactionsList = DefaultReactionsList,\n  } = useComponentContext<At, Ch, Co, Ev, Me, Re, Us>('MessageCommerce');\n\n  const hasAttachment = messageHasAttachments(message);\n  const hasReactions = messageHasReactions(message);\n\n  const firstGroupStyle = groupStyles ? groupStyles[0] : 'single';\n\n  const messageClasses = `str-chat__message-commerce str-chat__message-commerce--${\n    isMyMessage() ? 'right' : 'left'\n  }`;\n\n  if (message.deleted_at) {\n    return <MessageDeleted message={message} />;\n  }\n\n  if (message.customType === 'message.date') {\n    return null;\n  }\n\n  return (\n    <div\n      className={`\n\t\t\t\t\t\t${messageClasses}\n\t\t\t\t\t\tstr-chat__message-commerce--${message.type}\n\t\t\t\t\t\t${message.text ? 'str-chat__message-commerce--has-text' : 'str-chat__message-commerce--has-no-text'}\n\t\t\t\t\t\t${hasAttachment ? 'str-chat__message-commerce--has-attachment' : ''}\n            ${hasReactions && isReactionEnabled ? 'str-chat__message-commerce--with-reactions' : ''}\n            ${`str-chat__message-commerce--${firstGroupStyle}`}\n            ${message.pinned ? 'pinned-message' : ''}\n\t\t\t\t\t`.trim()}\n      data-testid='message-commerce-wrapper'\n      key={message.id}\n    >\n      {(firstGroupStyle === 'bottom' || firstGroupStyle === 'single') && (\n        <Avatar\n          image={message.user?.image}\n          name={message.user?.name || message.user?.id}\n          onClick={onUserClick}\n          onMouseOver={onUserHover}\n        />\n      )}\n      <div className='str-chat__message-commerce-inner'>\n        <>\n          {<MessageOptions displayLeft={false} displayReplies={false} theme='commerce' />}\n          {hasReactions && !showDetailedReactions && isReactionEnabled && <ReactionsList />}\n          {showDetailedReactions && isReactionEnabled && (\n            <ReactionSelector ref={reactionSelectorRef} />\n          )}\n        </>\n        {message.attachments?.length ? (\n          <Attachment actionHandler={handleAction} attachments={message.attachments} />\n        ) : null}\n        {message.mml && (\n          <MML\n            actionHandler={handleAction}\n            align={isMyMessage() ? 'right' : 'left'}\n            source={message.mml}\n          />\n        )}\n        {message.text && (\n          <MessageText\n            customInnerClass='str-chat__message-commerce-text-inner'\n            customWrapperClass='str-chat__message-commerce-text'\n            theme='commerce'\n          />\n        )}\n        {!threadList && (\n          <div className='str-chat__message-commerce-reply-button'>\n            <MessageRepliesCountButton\n              onClick={handleOpenThread}\n              reply_count={message.reply_count}\n            />\n          </div>\n        )}\n        <div className='str-chat__message-commerce-data'>\n          {!isMyMessage() ? (\n            <span className='str-chat__message-commerce-name'>\n              {message.user?.name || message.user?.id}\n            </span>\n          ) : null}\n          <MessageTimestamp customClass='str-chat__message-commerce-timestamp' format='LT' />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nconst MemoizedMessageCommerce = React.memo(\n  MessageCommerceWithContext,\n  areMessageUIPropsEqual,\n) as typeof MessageCommerceWithContext;\n\n/**\n * @deprecated - This UI component will be removed in the next major release.\n *\n * UI component that renders a message and receives functionality from the Message/MessageList components\n */\nexport const MessageCommerce = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: MessageUIComponentProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const messageContext = useMessageContext<At, Ch, Co, Ev, Me, Re, Us>('MessageCommerce');\n\n  return <MemoizedMessageCommerce {...messageContext} {...props} />;\n};\n","import React, { useCallback, useEffect, useMemo, useRef, useState } from 'react';\n\nimport { MessageDeleted as DefaultMessageDeleted } from './MessageDeleted';\nimport { MessageRepliesCountButton as DefaultMessageRepliesCountButton } from './MessageRepliesCountButton';\nimport { MessageTimestamp as DefaultTimestamp } from './MessageTimestamp';\nimport { useReactionClick } from './hooks';\nimport { PinIndicator as DefaultPinIndicator, ErrorIcon, ReactionIcon, ThreadIcon } from './icons';\nimport { QuotedMessage as DefaultQuotedMessage } from './QuotedMessage';\nimport { areMessageUIPropsEqual, MESSAGE_ACTIONS, showMessageActionsBox } from './utils';\n\nimport { Avatar as DefaultAvatar } from '../Avatar';\nimport { MessageActions } from '../MessageActions';\nimport { EditMessageForm as DefaultEditMessageForm, MessageInput } from '../MessageInput';\nimport {\n  ReactionSelector as DefaultReactionSelector,\n  SimpleReactionsList as DefaultReactionsList,\n} from '../Reactions';\n\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { MessageContextValue, useMessageContext } from '../../context/MessageContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\nimport { renderText as defaultRenderText, isOnlyEmojis } from '../../utils';\n\nimport type { TranslationLanguages } from 'stream-chat';\n\nimport type { MessageUIComponentProps, ReactEventHandler } from './types';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\ntype MessageLivestreamWithContextProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = MessageContextValue<At, Ch, Co, Ev, Me, Re, Us> & {\n  isReactionEnabled: boolean;\n  messageWrapperRef: React.MutableRefObject<HTMLDivElement | null>;\n  onReactionListClick: ReactEventHandler;\n  reactionSelectorRef: React.MutableRefObject<HTMLDivElement | null>;\n  showDetailedReactions: boolean;\n};\n\nconst MessageLivestreamWithContext = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: MessageLivestreamWithContextProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const {\n    clearEditingState,\n    editing,\n    groupStyles,\n    handleAction,\n    handleOpenThread,\n    handleRetry,\n    initialMessage,\n    isReactionEnabled,\n    message,\n    messageWrapperRef,\n    onMentionsClickMessage,\n    onMentionsHoverMessage,\n    onReactionListClick,\n    onUserClick,\n    onUserHover,\n    reactionSelectorRef,\n    renderText = defaultRenderText,\n    showDetailedReactions,\n    unsafeHTML,\n  } = props;\n\n  const {\n    Attachment,\n    Avatar = DefaultAvatar,\n    EditMessageInput = DefaultEditMessageForm,\n    MessageDeleted = DefaultMessageDeleted,\n    MessageRepliesCountButton = DefaultMessageRepliesCountButton,\n    PinIndicator = DefaultPinIndicator,\n    QuotedMessage = DefaultQuotedMessage,\n    ReactionsList = DefaultReactionsList,\n    ReactionSelector = DefaultReactionSelector,\n  } = useComponentContext<At, Ch, Co, Ev, Me, Re, Us>('MessageLivestream');\n  const { t, userLanguage } = useTranslationContext('MessageLivestream');\n\n  const messageTextToRender =\n    message.i18n?.[`${userLanguage}_text` as `${TranslationLanguages}_text`] || message.text;\n\n  const messageText = useMemo(() => renderText(messageTextToRender, message.mentioned_users), [\n    message.mentioned_users,\n    messageTextToRender,\n  ]);\n\n  const firstGroupStyle = groupStyles ? groupStyles[0] : 'single';\n\n  if (message.customType === 'message.date') {\n    return null;\n  }\n\n  if (message.deleted_at) {\n    return <MessageDeleted message={message} />;\n  }\n\n  if (editing) {\n    return (\n      <div\n        className={`str-chat__message-team str-chat__message-team--${firstGroupStyle} str-chat__message-team--editing`}\n        data-testid={'message-livestream-edit'}\n      >\n        {(firstGroupStyle === 'top' || firstGroupStyle === 'single') && (\n          <div className='str-chat__message-team-meta'>\n            <Avatar\n              image={message.user?.image}\n              name={message.user?.name || message.user?.id}\n              onClick={onUserClick}\n              onMouseOver={onUserHover}\n              size={40}\n            />\n          </div>\n        )}\n        <MessageInput\n          clearEditingState={clearEditingState}\n          Input={EditMessageInput}\n          message={message}\n        />\n      </div>\n    );\n  }\n\n  return (\n    <>\n      {message.pinned && (\n        <div className='str-chat__message-livestream-pin-indicator'>\n          <PinIndicator message={message} t={t} />\n        </div>\n      )}\n      <div\n        className={`str-chat__message-livestream str-chat__message-livestream--${firstGroupStyle} str-chat__message-livestream--${\n          message.type\n        } str-chat__message-livestream--${message.status} ${\n          initialMessage ? 'str-chat__message-livestream--initial-message' : ''\n        } ${message.pinned ? 'pinned-message' : ''}`}\n        data-testid='message-livestream'\n        ref={messageWrapperRef}\n      >\n        {showDetailedReactions && isReactionEnabled && (\n          <ReactionSelector ref={reactionSelectorRef} />\n        )}\n        <MessageLivestreamActions\n          messageWrapperRef={messageWrapperRef}\n          onReactionListClick={onReactionListClick}\n        />\n        <div className='str-chat__message-livestream-left'>\n          <Avatar\n            image={message.user?.image}\n            name={message.user?.name || message.user?.id}\n            onClick={onUserClick}\n            onMouseOver={onUserHover}\n            size={30}\n          />\n        </div>\n        <div className='str-chat__message-livestream-right'>\n          <div className='str-chat__message-livestream-content'>\n            <div className='str-chat__message-livestream-author'>\n              <strong>{message.user?.name || message.user?.id}</strong>\n              {message.type === 'error' && (\n                <div className='str-chat__message-team-error-header'>\n                  {t('Only visible to you')}\n                </div>\n              )}\n            </div>\n            <div\n              className={\n                isOnlyEmojis(message.text) ? 'str-chat__message-livestream-text--is-emoji' : ''\n              }\n              data-testid='message-livestream-text'\n              onClick={onMentionsClickMessage}\n              onMouseOver={onMentionsHoverMessage}\n            >\n              {message.quoted_message && (\n                <div className='livestream-quoted-message'>\n                  <QuotedMessage />\n                </div>\n              )}\n              {message.type !== 'error' &&\n                message.status !== 'failed' &&\n                !unsafeHTML &&\n                messageText}\n              {message.type !== 'error' &&\n                message.status !== 'failed' &&\n                unsafeHTML &&\n                !!message.html && <div dangerouslySetInnerHTML={{ __html: message.html }} />}\n              {message.type === 'error' && !message.command && (\n                <p data-testid='message-livestream-error'>\n                  <ErrorIcon />\n                  {message.text}\n                </p>\n              )}\n              {message.type === 'error' && message.command && (\n                <p data-testid='message-livestream-command-error'>\n                  <ErrorIcon />\n                  {/* TODO: Translate following sentence */}\n                  <strong>/{message.command}</strong> is not a valid command\n                </p>\n              )}\n              {message.status === 'failed' && (\n                <p\n                  onClick={message.errorStatusCode !== 403 ? () => handleRetry(message) : undefined}\n                >\n                  <ErrorIcon />\n                  {message.errorStatusCode !== 403\n                    ? t('Message Failed  Click to try again')\n                    : t('Message Failed  Unauthorized')}\n                </p>\n              )}\n            </div>\n            {message.attachments?.length ? (\n              <Attachment actionHandler={handleAction} attachments={message.attachments} />\n            ) : null}\n            {isReactionEnabled && <ReactionsList />}\n            {!initialMessage && (\n              <MessageRepliesCountButton\n                onClick={handleOpenThread}\n                reply_count={message.reply_count}\n              />\n            )}\n          </div>\n        </div>\n      </div>\n    </>\n  );\n};\n\nexport type MessageLivestreamActionsProps = {\n  messageWrapperRef: React.RefObject<HTMLDivElement>;\n  onReactionListClick: ReactEventHandler;\n};\n\nconst MessageLivestreamActions = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: MessageLivestreamActionsProps,\n) => {\n  const { messageWrapperRef, onReactionListClick } = props;\n\n  const { MessageTimestamp = DefaultTimestamp } = useComponentContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'MessageLivestream',\n  );\n\n  const {\n    getMessageActions,\n    handleOpenThread,\n    initialMessage,\n    message,\n    threadList,\n  } = useMessageContext<At, Ch, Co, Ev, Me, Re, Us>('MessageLivestream');\n\n  const [actionsBoxOpen, setActionsBoxOpen] = useState(false);\n\n  const hideOptions = useCallback(() => setActionsBoxOpen(false), []);\n  const messageDeletedAt = !!message.deleted_at;\n  const messageWrapper = messageWrapperRef?.current;\n\n  const messageActions = getMessageActions();\n  const showActionsBox = showMessageActionsBox(messageActions);\n\n  const shouldShowReactions = messageActions.indexOf(MESSAGE_ACTIONS.react) > -1;\n  const shouldShowReplies = messageActions.indexOf(MESSAGE_ACTIONS.reply) > -1 && !threadList;\n\n  useEffect(() => {\n    if (messageWrapper) {\n      messageWrapper.addEventListener('mouseleave', hideOptions);\n    }\n\n    return () => {\n      if (messageWrapper) {\n        messageWrapper.removeEventListener('mouseleave', hideOptions);\n      }\n    };\n  }, [messageWrapper, hideOptions]);\n\n  useEffect(() => {\n    if (messageDeletedAt) {\n      document.removeEventListener('click', hideOptions);\n    }\n  }, [messageDeletedAt, hideOptions]);\n\n  useEffect(() => {\n    if (actionsBoxOpen) {\n      document.addEventListener('click', hideOptions);\n    } else {\n      document.removeEventListener('click', hideOptions);\n    }\n    return () => {\n      document.removeEventListener('click', hideOptions);\n    };\n  }, [actionsBoxOpen, hideOptions]);\n\n  if (\n    initialMessage ||\n    !message ||\n    message.type === 'error' ||\n    message.type === 'system' ||\n    message.type === 'ephemeral' ||\n    message.status === 'failed' ||\n    message.status === 'sending'\n  ) {\n    return null;\n  }\n\n  return (\n    <div\n      className={`str-chat__message-livestream-actions`}\n      data-testid={'message-livestream-actions'}\n    >\n      <MessageTimestamp customClass='str-chat__message-livestream-time' />\n      {shouldShowReactions && (\n        <span data-testid='message-livestream-reactions-action' onClick={onReactionListClick}>\n          <span>\n            <ReactionIcon />\n          </span>\n        </span>\n      )}\n      {shouldShowReplies && (\n        <span data-testid='message-livestream-thread-action' onClick={handleOpenThread}>\n          <ThreadIcon />\n        </span>\n      )}\n      {showActionsBox && <MessageActions inline />}\n    </div>\n  );\n};\n\nconst MemoizedMessageLivestream = React.memo(\n  MessageLivestreamWithContext,\n  areMessageUIPropsEqual,\n) as typeof MessageLivestreamWithContext;\n\n/**\n * @deprecated - This UI component will be removed in the next major release.\n *\n * Handles the rendering of a message and depends on the Message component for all the logic.\n * Implements the look and feel for a livestream use case.\n */\nexport const MessageLivestream = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: MessageUIComponentProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const messageContext = useMessageContext<At, Ch, Co, Ev, Me, Re, Us>('MessageLivestream');\n\n  const messageWrapperRef = useRef<HTMLDivElement | null>(null);\n  const reactionSelectorRef = useRef<HTMLDivElement | null>(null);\n\n  const message = props.message || messageContext.message;\n\n  const { isReactionEnabled, onReactionListClick, showDetailedReactions } = useReactionClick(\n    message,\n    reactionSelectorRef,\n    messageWrapperRef,\n  );\n\n  return (\n    <MemoizedMessageLivestream\n      {...messageContext}\n      isReactionEnabled={isReactionEnabled}\n      messageWrapperRef={messageWrapperRef}\n      onReactionListClick={onReactionListClick}\n      reactionSelectorRef={reactionSelectorRef}\n      showDetailedReactions={showDetailedReactions}\n      {...props}\n    />\n  );\n};\n","import React, { useMemo, useRef } from 'react';\n\nimport { MessageDeleted as DefaultMessageDeleted } from './MessageDeleted';\nimport { MessageRepliesCountButton as DefaultMessageRepliesCountButton } from './MessageRepliesCountButton';\nimport { MessageStatus } from './MessageStatus';\nimport { MessageTimestamp as DefaultTimestamp } from './MessageTimestamp';\nimport { useReactionClick } from './hooks';\nimport { PinIndicator as DefaultPinIndicator, ErrorIcon, ReactionIcon, ThreadIcon } from './icons';\nimport { QuotedMessage as DefaultQuotedMessage } from './QuotedMessage';\nimport { areMessageUIPropsEqual, MESSAGE_ACTIONS, showMessageActionsBox } from './utils';\n\nimport { Avatar as DefaultAvatar } from '../Avatar';\nimport { MessageActions } from '../MessageActions';\nimport { EditMessageForm as DefaultEditMessageForm, MessageInput } from '../MessageInput';\nimport { MML } from '../MML';\nimport {\n  ReactionSelector as DefaultReactionSelector,\n  SimpleReactionsList as DefaultReactionsList,\n} from '../Reactions';\n\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { MessageContextValue, useMessageContext } from '../../context/MessageContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\nimport { renderText as defaultRenderText, isOnlyEmojis } from '../../utils';\n\nimport type { TranslationLanguages } from 'stream-chat';\n\nimport type { MessageUIComponentProps, ReactEventHandler } from './types';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\ntype MessageTeamWithContextProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = MessageContextValue<At, Ch, Co, Ev, Me, Re, Us> & {\n  isReactionEnabled: boolean;\n  messageWrapperRef: React.MutableRefObject<HTMLDivElement | null>;\n  onReactionListClick: ReactEventHandler;\n  reactionSelectorRef: React.MutableRefObject<HTMLDivElement | null>;\n  showDetailedReactions: boolean;\n};\n\nconst MessageTeamWithContext = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: MessageTeamWithContextProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const {\n    clearEditingState,\n    editing,\n    getMessageActions,\n    groupStyles,\n    handleAction,\n    handleOpenThread,\n    handleRetry,\n    initialMessage,\n    isReactionEnabled,\n    message,\n    messageWrapperRef,\n    onMentionsClickMessage,\n    onMentionsHoverMessage,\n    onReactionListClick,\n    onUserClick,\n    onUserHover,\n    reactionSelectorRef,\n    renderText = defaultRenderText,\n    showDetailedReactions,\n    threadList,\n    unsafeHTML,\n  } = props;\n\n  const {\n    Attachment,\n    Avatar = DefaultAvatar,\n    EditMessageInput = DefaultEditMessageForm,\n    MessageDeleted = DefaultMessageDeleted,\n    MessageRepliesCountButton = DefaultMessageRepliesCountButton,\n    MessageTimestamp = DefaultTimestamp,\n    PinIndicator = DefaultPinIndicator,\n    QuotedMessage = DefaultQuotedMessage,\n    ReactionsList = DefaultReactionsList,\n    ReactionSelector = DefaultReactionSelector,\n  } = useComponentContext<At, Ch, Co, Ev, Me, Re, Us>('MessageTeam');\n\n  const { t, userLanguage } = useTranslationContext('MessageTeam');\n\n  const messageActions = getMessageActions();\n  const showActionsBox = showMessageActionsBox(messageActions);\n\n  const shouldShowReplies = messageActions.indexOf(MESSAGE_ACTIONS.reply) > -1 && !threadList;\n\n  const messageTextToRender =\n    message.i18n?.[`${userLanguage}_text` as `${TranslationLanguages}_text`] || message.text;\n\n  const messageMentionedUsersItem = message.mentioned_users;\n\n  const messageText = useMemo(() => renderText(messageTextToRender, messageMentionedUsersItem), [\n    messageMentionedUsersItem,\n    messageTextToRender,\n  ]);\n\n  const firstGroupStyle = groupStyles ? groupStyles[0] : 'single';\n\n  if (message.deleted_at) {\n    return <MessageDeleted message={message} />;\n  }\n\n  if (editing) {\n    return (\n      <div\n        className={`str-chat__message-team str-chat__message-team--${firstGroupStyle} str-chat__message-team--editing`}\n        data-testid='message-team-edit'\n      >\n        {(firstGroupStyle === 'top' || firstGroupStyle === 'single') && (\n          <div className='str-chat__message-team-meta'>\n            <Avatar\n              image={message.user?.image}\n              name={message.user?.name || message.user?.id}\n              onClick={onUserClick}\n              onMouseOver={onUserHover}\n              size={40}\n            />\n          </div>\n        )}\n        <MessageInput\n          clearEditingState={clearEditingState}\n          Input={EditMessageInput}\n          message={message}\n        />\n      </div>\n    );\n  }\n\n  return (\n    <>\n      {message.pinned && (\n        <div className='str-chat__message-team-pin-indicator'>\n          <PinIndicator message={message} t={t} />\n        </div>\n      )}\n      <div\n        className={`str-chat__message-team str-chat__message-team--${firstGroupStyle} str-chat__message-team--${\n          message.type\n        } ${threadList ? 'thread-list' : ''} str-chat__message-team--${message.status} ${\n          message.pinned ? 'pinned-message' : ''\n        }`}\n        data-testid='message-team'\n        ref={messageWrapperRef}\n      >\n        <div className='str-chat__message-team-meta'>\n          {firstGroupStyle === 'top' || firstGroupStyle === 'single' || initialMessage ? (\n            <Avatar\n              image={message.user?.image}\n              name={message.user?.name || message.user?.id}\n              onClick={onUserClick}\n              onMouseOver={onUserHover}\n              size={40}\n            />\n          ) : (\n            <div data-testid='team-meta-spacer' style={{ marginRight: 0, width: 40 }} />\n          )}\n          <MessageTimestamp />\n        </div>\n        <div className='str-chat__message-team-group'>\n          {(firstGroupStyle === 'top' || firstGroupStyle === 'single' || initialMessage) && (\n            <div\n              className='str-chat__message-team-author'\n              data-testid='message-team-author'\n              onClick={onUserClick}\n            >\n              <strong>{message.user?.name || message.user?.id}</strong>\n              {message.type === 'error' && (\n                <div className='str-chat__message-team-error-header'>\n                  {t('Only visible to you')}\n                </div>\n              )}\n            </div>\n          )}\n          <div\n            className={`str-chat__message-team-content str-chat__message-team-content--${firstGroupStyle} str-chat__message-team-content--${\n              message.text === '' ? 'image' : 'text'\n            }`}\n            data-testid='message-team-content'\n          >\n            {message.quoted_message && <QuotedMessage />}\n            {!initialMessage &&\n              message.status !== 'sending' &&\n              message.status !== 'failed' &&\n              message.type !== 'system' &&\n              message.type !== 'ephemeral' &&\n              message.type !== 'error' && (\n                <div\n                  className={`str-chat__message-team-actions`}\n                  data-testid='message-team-actions'\n                >\n                  {showDetailedReactions && <ReactionSelector ref={reactionSelectorRef} />}\n                  {isReactionEnabled && (\n                    <span\n                      data-testid='message-team-reaction-icon'\n                      onClick={onReactionListClick}\n                      title='Reactions'\n                    >\n                      <ReactionIcon />\n                    </span>\n                  )}\n                  {shouldShowReplies && (\n                    <span\n                      data-testid='message-team-thread-icon'\n                      onClick={handleOpenThread}\n                      title='Start a thread'\n                    >\n                      <ThreadIcon />\n                    </span>\n                  )}\n                  {showActionsBox && (\n                    <MessageActions inline messageWrapperRef={messageWrapperRef} />\n                  )}\n                </div>\n              )}\n            {\n              <span\n                className={\n                  isOnlyEmojis(message.text) ? 'str-chat__message-team-text--is-emoji' : ''\n                }\n                data-testid='message-team-message'\n                onClick={onMentionsClickMessage}\n                onMouseOver={onMentionsHoverMessage}\n              >\n                {unsafeHTML && message.html ? (\n                  <div dangerouslySetInnerHTML={{ __html: message.html }} />\n                ) : (\n                  messageText\n                )}\n              </span>\n            }\n            {message.mml && <MML actionHandler={handleAction} align='left' source={message.mml} />}\n            {!message.text && message.attachments?.length ? (\n              <Attachment actionHandler={handleAction} attachments={message.attachments} />\n            ) : null}\n            {message.latest_reactions?.length !== 0 && message.text !== '' && isReactionEnabled && (\n              <ReactionsList />\n            )}\n            {message.status === 'failed' && (\n              <button\n                className='str-chat__message-team-failed'\n                data-testid='message-team-failed'\n                onClick={message.errorStatusCode !== 403 ? () => handleRetry(message) : undefined}\n              >\n                <ErrorIcon />\n                {message.errorStatusCode !== 403\n                  ? t('Message Failed  Click to try again')\n                  : t('Message Failed  Unauthorized')}\n              </button>\n            )}\n          </div>\n          <MessageStatus messageType='team' />\n          {message.text && message.attachments?.length ? (\n            <Attachment actionHandler={handleAction} attachments={message.attachments} />\n          ) : null}\n          {message.latest_reactions &&\n            message.latest_reactions.length !== 0 &&\n            message.text === '' &&\n            isReactionEnabled && <ReactionsList />}\n          {!threadList && (\n            <MessageRepliesCountButton\n              onClick={handleOpenThread}\n              reply_count={message.reply_count}\n            />\n          )}\n        </div>\n      </div>\n    </>\n  );\n};\n\nconst MemoizedMessageTeam = React.memo(\n  MessageTeamWithContext,\n  areMessageUIPropsEqual,\n) as typeof MessageTeamWithContext;\n\n/**\n * @deprecated - This UI component will be removed in the next major release.\n *\n * Handles the rendering of a Message and depends on the Message component for all the logic.\n * Implements the look and feel for a team style collaboration environment.\n */\nexport const MessageTeam = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: MessageUIComponentProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const messageContext = useMessageContext<At, Ch, Co, Ev, Me, Re, Us>('MessageTeam');\n\n  const reactionSelectorRef = useRef<HTMLDivElement | null>(null);\n  const messageWrapperRef = useRef<HTMLDivElement | null>(null);\n\n  const message = props.message || messageContext.message;\n\n  const { isReactionEnabled, onReactionListClick, showDetailedReactions } = useReactionClick(\n    message,\n    reactionSelectorRef,\n    messageWrapperRef,\n  );\n\n  return (\n    <MemoizedMessageTeam\n      {...messageContext}\n      isReactionEnabled={isReactionEnabled}\n      messageWrapperRef={messageWrapperRef}\n      onReactionListClick={onReactionListClick}\n      reactionSelectorRef={reactionSelectorRef}\n      showDetailedReactions={showDetailedReactions}\n      {...props}\n    />\n  );\n};\n","import React from 'react';\n\nexport type CustomNotificationProps = {\n  type: string;\n  active?: boolean;\n};\n\nconst UnMemoizedCustomNotification: React.FC<CustomNotificationProps> = (props) => {\n  const { active, children, type } = props;\n\n  if (!active) return null;\n\n  return (\n    <div\n      aria-live='polite'\n      className={`str-chat__custom-notification notification-${type}`}\n      data-testid='custom-notification'\n    >\n      {children}\n    </div>\n  );\n};\n\nexport const CustomNotification = React.memo(\n  UnMemoizedCustomNotification,\n) as typeof UnMemoizedCustomNotification;\n","import React, { useEffect, useState } from 'react';\n\nimport type { Event } from 'stream-chat';\n\nimport { CustomNotification } from './CustomNotification';\nimport { useChatContext, useTranslationContext } from '../../context';\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nconst UnMemoizedConnectionStatus: React.FC = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>() => {\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('ConnectionStatus');\n  const { t } = useTranslationContext('ConnectionStatus');\n\n  const [online, setOnline] = useState(true);\n\n  useEffect(() => {\n    const connectionChanged = ({\n      online: onlineStatus = false,\n    }: Event<At, Ch, Co, Ev, Me, Re, Us>) => {\n      if (online !== onlineStatus) {\n        setOnline(onlineStatus);\n      }\n    };\n\n    client.on('connection.changed', connectionChanged);\n    return () => client.off('connection.changed', connectionChanged);\n  }, [client, online]);\n\n  return (\n    <CustomNotification active={!online} type='error'>\n      {t('Connection failure, reconnecting now...')}\n    </CustomNotification>\n  );\n};\n\nexport const ConnectionStatus = React.memo(\n  UnMemoizedConnectionStatus,\n) as typeof UnMemoizedConnectionStatus;\n","import React from 'react';\n\nimport { Message } from '../Message/Message';\n\nimport type { StreamMessage } from '../../context/ChannelStateContext';\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type GiphyPreviewMessageProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>;\n};\n\nexport const GiphyPreviewMessage = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: GiphyPreviewMessageProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const { message } = props;\n\n  return (\n    <div className='giphy-preview-message'>\n      <Message message={message} />\n    </div>\n  );\n};\n","import { useCallback } from 'react';\n\nimport type { MessageListProps } from '../MessageList';\n\nexport const useCallLoadMore = (loadMore: MessageListProps['loadMore'], limit: number) =>\n  useCallback(() => {\n    if (loadMore) {\n      loadMore(limit);\n    }\n  }, [limit, loadMore]);\n","/* eslint-disable no-continue */\nimport { isDate } from '../../context/TranslationContext';\n\nimport type { UserResponse } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nimport type { StreamMessage } from '../../context/ChannelStateContext';\n\ntype ProcessMessagesParams<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  disableDateSeparator: boolean;\n  hideDeletedMessages: boolean;\n  hideNewMessageSeparator: boolean;\n  messages: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>[];\n  userId: string;\n  lastRead?: Date | null;\n  separateGiphyPreview?: boolean;\n  setGiphyPreviewMessage?: React.Dispatch<\n    React.SetStateAction<StreamMessage<At, Ch, Co, Ev, Me, Re, Us> | undefined>\n  >;\n  threadList?: boolean;\n};\n\nexport const processMessages = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  params: ProcessMessagesParams<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const {\n    disableDateSeparator,\n    hideDeletedMessages,\n    hideNewMessageSeparator,\n    lastRead,\n    messages,\n    separateGiphyPreview,\n    setGiphyPreviewMessage,\n    threadList,\n    userId,\n  } = params;\n\n  let unread = false;\n  let ephemeralMessagePresent = false;\n  let lastDateSeparator;\n  const newMessages: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>[] = [];\n\n  for (let i = 0; i < messages.length; i += 1) {\n    const message = messages[i];\n\n    if (hideDeletedMessages && message.type === 'deleted') {\n      continue;\n    }\n\n    if (\n      separateGiphyPreview &&\n      setGiphyPreviewMessage &&\n      message.type === 'ephemeral' &&\n      message.command === 'giphy'\n    ) {\n      ephemeralMessagePresent = true;\n      setGiphyPreviewMessage(message);\n      continue;\n    }\n\n    const messageDate =\n      (message.created_at && isDate(message.created_at) && message.created_at.toDateString()) || '';\n    let prevMessageDate = messageDate;\n    const previousMessage = messages[i - 1];\n\n    if (\n      i > 0 &&\n      !disableDateSeparator &&\n      !threadList &&\n      previousMessage.created_at &&\n      isDate(previousMessage.created_at)\n    ) {\n      prevMessageDate = previousMessage.created_at.toDateString();\n    }\n\n    if (!unread && !hideNewMessageSeparator && !threadList) {\n      unread = (lastRead && message.created_at && new Date(lastRead) < message.created_at) || false;\n\n      // do not show date separator for current user's messages\n      if (!disableDateSeparator && unread && message.user?.id !== userId) {\n        newMessages.push({\n          customType: 'message.date',\n          date: message.created_at,\n          id: message.id,\n          unread,\n        } as StreamMessage<At, Ch, Co, Ev, Me, Re, Us>);\n      }\n    }\n\n    if (\n      !disableDateSeparator &&\n      !threadList &&\n      (i === 0 ||\n        messageDate !== prevMessageDate ||\n        (hideDeletedMessages &&\n          messages[i - 1]?.type === 'deleted' &&\n          lastDateSeparator !== messageDate)) &&\n      newMessages?.[newMessages.length - 1]?.customType !== 'message.date' // do not show two date separators in a row\n    ) {\n      lastDateSeparator = messageDate;\n\n      newMessages.push(\n        {\n          customType: 'message.date',\n          date: message.created_at,\n          id: message.id,\n        } as StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n        message,\n      );\n    } else {\n      newMessages.push(message);\n    }\n  }\n\n  // clean up the giphy preview component state after a Cancel action\n  if (separateGiphyPreview && !ephemeralMessagePresent) {\n    setGiphyPreviewMessage?.(undefined);\n  }\n\n  return newMessages;\n};\n\n// fast since it usually iterates just the last few messages\nexport const getLastReceived = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  messages: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>[],\n) => {\n  for (let i = messages.length - 1; i > 0; i -= 1) {\n    if (messages[i].status === 'received') {\n      return messages[i].id;\n    }\n  }\n\n  return null;\n};\n\nexport const getReadStates = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  messages: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>[],\n  read: Record<string, { last_read: Date; user: UserResponse<Us> }> = {},\n  returnAllReadData: boolean,\n) => {\n  // create object with empty array for each message id\n  const readData: Record<string, Array<UserResponse<Us>>> = {};\n\n  Object.values(read).forEach((readState) => {\n    if (!readState.last_read) return;\n\n    let userLastReadMsgId: string | undefined;\n\n    // loop messages sent by current user and add read data for other users in channel\n    messages.forEach((msg) => {\n      if (msg.updated_at && msg.updated_at < readState.last_read) {\n        userLastReadMsgId = msg.id;\n\n        // if true, save other user's read data for all messages they've read\n        if (returnAllReadData) {\n          if (!readData[userLastReadMsgId]) {\n            readData[userLastReadMsgId] = [];\n          }\n\n          readData[userLastReadMsgId].push(readState.user);\n        }\n      }\n    });\n\n    // if true, only save read data for other user's last read message\n    if (userLastReadMsgId && !returnAllReadData) {\n      if (!readData[userLastReadMsgId]) {\n        readData[userLastReadMsgId] = [];\n      }\n\n      readData[userLastReadMsgId].push(readState.user);\n    }\n  });\n\n  return readData;\n};\n\nexport const insertIntro = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  messages: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>[],\n  headerPosition?: number,\n) => {\n  const newMessages = messages;\n  const intro = ({ customType: 'channel.intro' } as unknown) as StreamMessage<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us\n  >;\n\n  // if no headerPosition is set, HeaderComponent will go at the top\n  if (!headerPosition) {\n    newMessages.unshift(intro);\n    return newMessages;\n  }\n\n  // if no messages, intro gets inserted\n  if (!newMessages.length) {\n    newMessages.unshift(intro);\n    return newMessages;\n  }\n\n  // else loop over the messages\n  for (let i = 0; i < messages.length; i += 1) {\n    const message = messages[i];\n    const messageTime =\n      message.created_at && isDate(message.created_at) ? message.created_at.getTime() : null;\n\n    const nextMessage = messages[i + 1];\n    const nextMessageTime =\n      nextMessage.created_at && isDate(nextMessage.created_at)\n        ? nextMessage.created_at.getTime()\n        : null;\n\n    // header position is smaller than message time so comes after;\n    if (messageTime && messageTime < headerPosition) {\n      // if header position is also smaller than message time continue;\n      if (nextMessageTime && nextMessageTime < headerPosition) {\n        if (messages[i + 1] && messages[i + 1].customType === 'message.date') continue;\n        if (!nextMessageTime) {\n          newMessages.push(intro);\n          return newMessages;\n        }\n        continue;\n      } else {\n        newMessages.splice(i + 1, 0, intro);\n        return newMessages;\n      }\n    }\n  }\n\n  return newMessages;\n};\n\nexport type GroupStyle = '' | 'middle' | 'top' | 'bottom' | 'single';\n\nexport const getGroupStyles = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n  previousMessage: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n  nextMessage: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n  noGroupByUser: boolean,\n): GroupStyle => {\n  if (message.customType === 'message.date') return '';\n  if (message.customType === 'channel.intro') return '';\n\n  if (noGroupByUser || message.attachments?.length !== 0) return 'single';\n\n  const isTopMessage =\n    !previousMessage ||\n    previousMessage.customType === 'channel.intro' ||\n    previousMessage.customType === 'message.date' ||\n    previousMessage.type === 'system' ||\n    previousMessage.attachments?.length !== 0 ||\n    message.user?.id !== previousMessage.user?.id ||\n    previousMessage.type === 'error' ||\n    previousMessage.deleted_at;\n\n  const isBottomMessage =\n    !nextMessage ||\n    nextMessage.customType === 'message.date' ||\n    nextMessage.type === 'system' ||\n    nextMessage.customType === 'channel.intro' ||\n    nextMessage.attachments?.length !== 0 ||\n    message.user?.id !== nextMessage.user?.id ||\n    nextMessage.type === 'error' ||\n    nextMessage.deleted_at;\n\n  if (!isTopMessage && !isBottomMessage) {\n    if (message.deleted_at || message.type === 'error') return 'single';\n    return 'middle';\n  }\n\n  if (isBottomMessage) {\n    if (isTopMessage || message.deleted_at || message.type === 'error') return 'single';\n    return 'bottom';\n  }\n\n  if (isTopMessage) return 'top';\n\n  return '';\n};\n","import { useMemo } from 'react';\n\nimport { getGroupStyles, GroupStyle, insertIntro, processMessages } from '../utils';\n\nimport { useChatContext } from '../../../context/ChatContext';\nimport { useComponentContext } from '../../../context/ComponentContext';\n\nimport type { Channel } from 'stream-chat';\n\nimport type { StreamMessage } from '../../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useEnrichedMessages = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(args: {\n  channel: Channel<At, Ch, Co, Ev, Me, Re, Us>;\n  disableDateSeparator: boolean;\n  hideDeletedMessages: boolean;\n  hideNewMessageSeparator: boolean;\n  messages: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>[];\n  noGroupByUser: boolean;\n  threadList: boolean;\n  groupStyles?: (\n    message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n    previousMessage: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n    nextMessage: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n    noGroupByUser: boolean,\n  ) => GroupStyle;\n  headerPosition?: number;\n}) => {\n  const {\n    channel,\n    disableDateSeparator,\n    groupStyles,\n    headerPosition,\n    hideDeletedMessages,\n    hideNewMessageSeparator,\n    messages,\n    noGroupByUser,\n    threadList,\n  } = args;\n\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('useEnrichedMessages');\n  const { HeaderComponent } = useComponentContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'useEnrichedMessages',\n  );\n\n  const lastRead = useMemo(() => channel.lastRead?.(), [channel]);\n\n  let messagesWithDates =\n    disableDateSeparator && !hideDeletedMessages && hideNewMessageSeparator\n      ? messages\n      : processMessages({\n          disableDateSeparator,\n          hideDeletedMessages,\n          hideNewMessageSeparator,\n          lastRead,\n          messages,\n          threadList,\n          userId: client.userID || '',\n        });\n\n  if (HeaderComponent) {\n    messagesWithDates = insertIntro(messagesWithDates, headerPosition);\n  }\n\n  const groupStylesFn = groupStyles || getGroupStyles;\n  const messageGroupStyles = useMemo(\n    () =>\n      messagesWithDates.reduce((acc, message, i) => {\n        const style = groupStylesFn(\n          message,\n          messagesWithDates[i - 1],\n          messagesWithDates[i + 1],\n          noGroupByUser,\n        );\n        if (style) acc[message.id] = style;\n        return acc;\n      }, {} as Record<string, GroupStyle>),\n    [messagesWithDates, noGroupByUser],\n  );\n\n  return { messageGroupStyles, messages: messagesWithDates };\n};\n","import { useMemo } from 'react';\n\nimport { getReadStates } from '../utils';\n\nimport type { UserResponse } from 'stream-chat';\n\nimport type { StreamMessage } from '../../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\ntype UseLastReadDataParams<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  messages: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>[];\n  returnAllReadData: boolean;\n  userID: string | undefined;\n  read?: Record<string, { last_read: Date; user: UserResponse<Us> }>;\n};\n\nexport const useLastReadData = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: UseLastReadDataParams<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const { messages, read, returnAllReadData, userID } = props;\n\n  return useMemo(\n    () =>\n      getReadStates(\n        messages.filter(({ user }) => user?.id === userID),\n        read,\n        returnAllReadData,\n      ),\n    [messages, read, returnAllReadData, userID],\n  );\n};\n","/* eslint-disable no-continue */\nimport React, { useMemo } from 'react';\n\nimport { useLastReadData } from './useLastReadData';\nimport { getLastReceived, GroupStyle } from '../utils';\n\nimport { DateSeparator as DefaultDateSeparator } from '../../DateSeparator/DateSeparator';\nimport { EventComponent } from '../../EventComponent/EventComponent';\nimport { Message } from '../../Message';\n\nimport { useChatContext } from '../../../context/ChatContext';\nimport { useComponentContext } from '../../../context/ComponentContext';\nimport { isDate } from '../../../context/TranslationContext';\n\nimport type { UserResponse } from 'stream-chat';\n\nimport type { MessageProps } from '../../Message/types';\n\nimport type { StreamMessage } from '../../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\ntype MessagePropsToOmit =\n  | 'channel'\n  | 'groupStyles'\n  | 'initialMessage'\n  | 'lastReceivedId'\n  | 'message'\n  | 'readBy'\n  | 'threadList';\n\ntype UseMessageListElementsProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  enrichedMessages: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>[];\n  internalMessageProps: Omit<MessageProps<At, Ch, Co, Ev, Me, Re, Us>, MessagePropsToOmit>;\n  messageGroupStyles: Record<string, GroupStyle>;\n  onMessageLoadCaptured: (event: React.SyntheticEvent<HTMLLIElement, Event>) => void;\n  returnAllReadData: boolean;\n  threadList: boolean;\n  read?: Record<string, { last_read: Date; user: UserResponse<Us> }>;\n};\n\nexport const useMessageListElements = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: UseMessageListElementsProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const {\n    enrichedMessages,\n    internalMessageProps,\n    messageGroupStyles,\n    onMessageLoadCaptured,\n    read,\n    returnAllReadData,\n    threadList,\n  } = props;\n\n  const { client, customClasses } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'useMessageListElements',\n  );\n  const {\n    DateSeparator = DefaultDateSeparator,\n    HeaderComponent,\n    MessageSystem = EventComponent,\n  } = useComponentContext<At, Ch, Co, Ev, Me, Re, Us>('useMessageListElements');\n\n  // get the readData, but only for messages submitted by the user themselves\n  const readData = useLastReadData({\n    messages: enrichedMessages,\n    read,\n    returnAllReadData,\n    userID: client.userID,\n  });\n\n  const lastReceivedId = useMemo(() => getLastReceived(enrichedMessages), [enrichedMessages]);\n\n  return useMemo(\n    () =>\n      enrichedMessages.map((message) => {\n        if (message.customType === 'message.date' && message.date && isDate(message.date)) {\n          return (\n            <li key={`${message.date.toISOString()}-i`}>\n              <DateSeparator\n                date={message.date}\n                formatDate={internalMessageProps.formatDate}\n                unread={message.unread}\n              />\n            </li>\n          );\n        }\n\n        if (message.customType === 'channel.intro' && HeaderComponent) {\n          return (\n            <li key='intro'>\n              <HeaderComponent />\n            </li>\n          );\n        }\n\n        if (message.type === 'system') {\n          return (\n            <li\n              key={\n                (message.event as { created_at: string })?.created_at ||\n                (message.created_at as string) ||\n                ''\n              }\n            >\n              <MessageSystem message={message} />\n            </li>\n          );\n        }\n\n        const groupStyles: GroupStyle = messageGroupStyles[message.id] || '';\n        const messageClass = customClasses?.message || `str-chat__li str-chat__li--${groupStyles}`;\n\n        return (\n          <li\n            className={messageClass}\n            data-testid={messageClass}\n            key={message.id || (message.created_at as string)}\n            onLoadCapture={onMessageLoadCaptured}\n          >\n            <Message\n              groupStyles={[groupStyles]} /* TODO: convert to simple string */\n              lastReceivedId={lastReceivedId}\n              message={message}\n              readBy={readData[message.id] || []}\n              threadList={threadList}\n              {...internalMessageProps}\n            />\n          </li>\n        );\n      }),\n    [\n      enrichedMessages,\n      internalMessageProps,\n      lastReceivedId,\n      messageGroupStyles,\n      onMessageLoadCaptured,\n      readData,\n      threadList,\n    ],\n  );\n};\n","import { useEffect, useRef } from 'react';\n\nimport { useChatContext } from '../../../context/ChatContext';\n\nimport type { StreamMessage } from '../../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport type ContainerMeasures = {\n  offsetHeight: number;\n  scrollHeight: number;\n};\n\nexport type UseMessageListScrollManagerParams<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  messages: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>[];\n  onScrollBy: (scrollBy: number) => void;\n  scrollContainerMeasures: () => ContainerMeasures;\n  scrolledUpThreshold: number;\n  scrollToBottom: () => void;\n  showNewMessages: () => void;\n};\n\nexport function useMessageListScrollManager<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(params: UseMessageListScrollManagerParams<At, Ch, Co, Ev, Me, Re, Us>) {\n  const {\n    onScrollBy,\n    scrollContainerMeasures,\n    scrolledUpThreshold,\n    scrollToBottom,\n    showNewMessages,\n  } = params;\n\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('useMessageListScrollManager');\n\n  const measures = useRef<ContainerMeasures>({\n    offsetHeight: 0,\n    scrollHeight: 0,\n  });\n  const messages = useRef<StreamMessage<At, Ch, Co, Ev, Me, Re, Us>[]>();\n  const scrollTop = useRef(0);\n\n  useEffect(() => {\n    scrollToBottom();\n  }, []);\n\n  useEffect(() => {\n    const prevMeasures = measures.current;\n    const prevMessages = messages.current;\n    const newMessages = params.messages;\n    const lastNewMessage = newMessages[newMessages.length - 1] || {};\n    const lastPrevMessage = prevMessages?.[prevMessages.length - 1];\n    const newMeasures = scrollContainerMeasures();\n\n    const wasAtBottom =\n      prevMeasures.scrollHeight - prevMeasures.offsetHeight - scrollTop.current <\n      scrolledUpThreshold;\n\n    if (typeof prevMessages !== 'undefined') {\n      if (prevMessages.length < newMessages.length) {\n        // messages added to the top\n        if (lastPrevMessage?.id === lastNewMessage.id) {\n          const listHeightDelta = newMeasures.scrollHeight - prevMeasures.scrollHeight;\n\n          onScrollBy(listHeightDelta);\n        }\n        // messages added to the bottom\n        else {\n          const lastMessageIsFromCurrentUser = lastNewMessage.user?.id === client.userID;\n\n          if (lastMessageIsFromCurrentUser || wasAtBottom) {\n            scrollToBottom();\n          } else {\n            showNewMessages();\n          }\n        }\n      }\n      // message list length didn't change, but check if last message had reaction/reply update\n      else {\n        const hasNewReactions =\n          lastPrevMessage?.latest_reactions?.length !== lastNewMessage.latest_reactions?.length;\n        const hasNewReplies = lastPrevMessage?.reply_count !== lastNewMessage.reply_count;\n\n        if ((hasNewReactions || hasNewReplies) && wasAtBottom) {\n          scrollToBottom();\n        }\n      }\n    }\n\n    messages.current = newMessages;\n    measures.current = newMeasures;\n  }, [measures, messages, params.messages]);\n\n  return (scrollTopValue: number) => {\n    scrollTop.current = scrollTopValue;\n  };\n}\n","import React, { useCallback, useLayoutEffect, useRef, useState } from 'react';\n\nimport { useMessageListScrollManager } from './useMessageListScrollManager';\n\nimport type { StreamMessage } from '../../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport type UseScrollLocationLogicParams<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  currentUserId?: string;\n  messages?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>[];\n  scrolledUpThreshold?: number;\n};\n\nexport const useScrollLocationLogic = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  params: UseScrollLocationLogicParams<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const { messages = [], scrolledUpThreshold = 200 } = params;\n\n  const [hasNewMessages, setHasNewMessages] = useState(false);\n  const [wrapperRect, setWrapperRect] = useState<DOMRect>();\n\n  const closeToBottom = useRef(false);\n  const closeToTop = useRef(false);\n  const listRef = useRef<HTMLDivElement>(null);\n\n  const scrollToBottom = useCallback(() => {\n    if (!listRef.current?.scrollTo) return;\n\n    listRef.current?.scrollTo({\n      top: listRef.current.scrollHeight,\n    });\n    setHasNewMessages(false);\n\n    // this is hacky and unreliable, but that was the current implementation so not breaking it\n    setTimeout(() => {\n      listRef.current?.scrollTo({\n        top: listRef.current.scrollHeight,\n      });\n    }, 200);\n  }, [listRef]);\n\n  useLayoutEffect(() => {\n    if (listRef?.current) {\n      setWrapperRect(listRef.current.getBoundingClientRect());\n      scrollToBottom();\n    }\n  }, [listRef]);\n\n  const updateScrollTop = useMessageListScrollManager({\n    messages,\n    onScrollBy: (scrollBy) => listRef.current?.scrollBy({ top: scrollBy }),\n    scrollContainerMeasures: () => ({\n      offsetHeight: listRef.current?.offsetHeight || 0,\n      scrollHeight: listRef.current?.scrollHeight || 0,\n    }),\n    scrolledUpThreshold,\n    scrollToBottom,\n    showNewMessages: () => setHasNewMessages(true),\n  });\n\n  const onScroll = useCallback(\n    (event: React.UIEvent<HTMLDivElement>) => {\n      const element = event.target as HTMLDivElement;\n      const scrollTop = element.scrollTop;\n\n      updateScrollTop(scrollTop);\n\n      const offsetHeight = element.offsetHeight;\n      const scrollHeight = element.scrollHeight;\n\n      closeToBottom.current = scrollHeight - (scrollTop + offsetHeight) < scrolledUpThreshold;\n      closeToTop.current = scrollTop < scrolledUpThreshold;\n\n      if (closeToBottom.current) {\n        setHasNewMessages(false);\n      }\n    },\n    [updateScrollTop, closeToTop, closeToBottom, scrolledUpThreshold],\n  );\n\n  const onMessageLoadCaptured = useCallback(() => {\n    /**\n     * A load event (emitted by e.g. an <img>) was captured on a message.\n     * In some cases, the loaded asset is larger than the placeholder, which means we have to scroll down.\n     */\n    if (closeToBottom.current && !closeToTop.current) {\n      scrollToBottom();\n    }\n  }, [closeToTop, closeToBottom, scrollToBottom]);\n\n  return {\n    hasNewMessages,\n    listRef,\n    onMessageLoadCaptured,\n    onScroll,\n    scrollToBottom,\n    wrapperRect,\n  };\n};\n","import React from 'react';\n\nconst UnMemoizedCenter: React.FC<{ key: string }> = ({ children }) => (\n  <div className='str-chat__list__center'>{children}</div>\n);\n\nexport const Center = React.memo(UnMemoizedCenter) as typeof UnMemoizedCenter;\n","import React from 'react';\n\nexport type MessageNotificationProps = {\n  /** button click event handler */\n  onClick: React.MouseEventHandler;\n  /** Whether or not to show notification */\n  showNotification: boolean;\n};\n\nconst UnMemoizedMessageNotification: React.FC<MessageNotificationProps> = (props) => {\n  const { children, onClick, showNotification = true } = props;\n\n  if (!showNotification) return null;\n\n  return (\n    <button\n      aria-live='polite'\n      className='str-chat__message-notification'\n      data-testid='message-notification'\n      onClick={onClick}\n    >\n      {children}\n    </button>\n  );\n};\n\nexport const MessageNotification = React.memo(\n  UnMemoizedMessageNotification,\n) as typeof UnMemoizedMessageNotification;\n","import React from 'react';\n\nimport { ConnectionStatus } from './ConnectionStatus';\nimport { CustomNotification } from './CustomNotification';\n\nimport { useTranslationContext } from '../../context/TranslationContext';\n\nimport type { MessageNotificationProps } from './MessageNotification';\n\nimport type { ChannelNotifications } from '../../context/ChannelStateContext';\n\nexport type MessageListNotificationsProps = {\n  hasNewMessages: boolean;\n  MessageNotification: React.ComponentType<MessageNotificationProps>;\n  notifications: ChannelNotifications;\n  scrollToBottom: () => void;\n};\n\nexport const MessageListNotifications = (props: MessageListNotificationsProps) => {\n  const { hasNewMessages, MessageNotification, notifications, scrollToBottom } = props;\n\n  const { t } = useTranslationContext('MessageListNotifications');\n\n  return (\n    <div className='str-chat__list-notifications'>\n      {notifications.map((notification) => (\n        <CustomNotification active={true} key={notification.id} type={notification.type}>\n          {notification.text}\n        </CustomNotification>\n      ))}\n      <ConnectionStatus />\n      <MessageNotification onClick={scrollToBottom} showNotification={hasNewMessages}>\n        {t('New Messages!')}\n      </MessageNotification>\n    </div>\n  );\n};\n","import React from 'react';\n\nimport { AvatarProps, Avatar as DefaultAvatar } from '../Avatar';\n\nimport { useChannelStateContext } from '../../context/ChannelStateContext';\nimport { useChatContext } from '../../context/ChatContext';\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { useTypingContext } from '../../context/TypingContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type TypingIndicatorProps<Us extends DefaultUserType<Us> = DefaultUserType> = {\n  /** Custom UI component to display user avatar, defaults to and accepts same props as: [Avatar](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Avatar/Avatar.tsx) */\n  Avatar?: React.ComponentType<AvatarProps<Us>>;\n  /** Avatar size in pixels, @default 32px */\n  avatarSize?: number;\n  /** Whether or not the typing indicator is in a thread */\n  threadList?: boolean;\n};\n\n/**\n * TypingIndicator lists users currently typing, it needs to be a child of Channel component\n */\nconst UnMemoizedTypingIndicator = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: TypingIndicatorProps<Us>,\n) => {\n  const { Avatar: PropAvatar, avatarSize = 32, threadList } = props;\n\n  const { channelConfig, thread } = useChannelStateContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'TypingIndicator',\n  );\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('TypingIndicator');\n  const { Avatar: ContextAvatar } = useComponentContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'TypingIndicator',\n  );\n  const { typing = {} } = useTypingContext<At, Ch, Co, Ev, Me, Re, Us>('TypingIndicator');\n\n  const Avatar = PropAvatar || ContextAvatar || DefaultAvatar;\n\n  if (channelConfig?.typing_events === false) {\n    return null;\n  }\n\n  const typingInChannel = !threadList\n    ? Object.values(typing).filter(\n        ({ parent_id, user }) => user?.id !== client.user?.id && !parent_id,\n      )\n    : [];\n\n  const typingInThread = threadList\n    ? Object.values(typing).filter(\n        ({ parent_id, user }) => user?.id !== client.user?.id && parent_id === thread?.id,\n      )\n    : [];\n\n  return (\n    <div\n      className={`str-chat__typing-indicator ${\n        (threadList && typingInThread.length) || (!threadList && typingInChannel.length)\n          ? 'str-chat__typing-indicator--typing'\n          : ''\n      }`}\n    >\n      <div className='str-chat__typing-indicator__avatars'>\n        {(threadList ? typingInThread : typingInChannel).map(({ user }, i) => (\n          <Avatar\n            image={user?.image}\n            key={`${user?.id}-${i}`}\n            name={user?.name || user?.id}\n            size={avatarSize}\n            user={user}\n          />\n        ))}\n      </div>\n      <div className='str-chat__typing-indicator__dots'>\n        <span className='str-chat__typing-indicator__dot' />\n        <span className='str-chat__typing-indicator__dot' />\n        <span className='str-chat__typing-indicator__dot' />\n      </div>\n    </div>\n  );\n};\n\nexport const TypingIndicator = React.memo(\n  UnMemoizedTypingIndicator,\n) as typeof UnMemoizedTypingIndicator;\n","import React from 'react';\n\nimport { useCallLoadMore } from './hooks/useCallLoadMore';\nimport { useEnrichedMessages } from './hooks/useEnrichedMessages';\nimport { useMessageListElements } from './hooks/useMessageListElements';\nimport { useScrollLocationLogic } from './hooks/useScrollLocationLogic';\n\nimport { Center } from './Center';\nimport { MessageNotification as DefaultMessageNotification } from './MessageNotification';\nimport { MessageListNotifications as DefaultMessageListNotifications } from './MessageListNotifications';\n\nimport {\n  ChannelActionContextValue,\n  useChannelActionContext,\n} from '../../context/ChannelActionContext';\nimport {\n  ChannelStateContextValue,\n  useChannelStateContext,\n} from '../../context/ChannelStateContext';\nimport { useChatContext } from '../../context/ChatContext';\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { EmptyStateIndicator as DefaultEmptyStateIndicator } from '../EmptyStateIndicator';\nimport { InfiniteScroll, InfiniteScrollProps } from '../InfiniteScrollPaginator';\nimport { LoadingIndicator as DefaultLoadingIndicator } from '../Loading';\nimport { defaultPinPermissions, MESSAGE_ACTIONS } from '../Message/utils';\nimport { TypingIndicator as DefaultTypingIndicator } from '../TypingIndicator';\n\nimport type { GroupStyle } from './utils';\n\nimport type { MessageProps } from '../Message/types';\n\nimport type { StreamMessage } from '../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nconst useInternalInfiniteScrollProps = (\n  props: Pick<\n    MessageListWithContextProps,\n    'hasMore' | 'internalInfiniteScrollProps' | 'loadMore' | 'loadingMore' | 'messageLimit'\n  >,\n) => {\n  const { LoadingIndicator = DefaultLoadingIndicator } = useComponentContext(\n    'useInternalInfiniteScrollProps',\n  );\n\n  return {\n    hasMore: props.hasMore,\n    isLoading: props.loadingMore,\n    loader: (\n      <Center key='loadingindicator'>\n        <LoadingIndicator size={20} />\n      </Center>\n    ),\n    loadMore: useCallLoadMore(props.loadMore, props.messageLimit || 100),\n    ...props.internalInfiniteScrollProps,\n  };\n};\n\ntype MessageListWithContextProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = Omit<ChannelStateContextValue<At, Ch, Co, Ev, Me, Re, Us>, 'members' | 'mutes' | 'watchers'> &\n  MessageListProps<At, Ch, Co, Ev, Me, Re, Us>;\n\nconst MessageListWithContext = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: MessageListWithContextProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const {\n    channel,\n    disableDateSeparator = false,\n    groupStyles,\n    hideDeletedMessages = false,\n    hideNewMessageSeparator = false,\n    messageActions = Object.keys(MESSAGE_ACTIONS),\n    messages = [],\n    notifications,\n    noGroupByUser = false,\n    pinPermissions = defaultPinPermissions, // @deprecated in favor of `channelCapabilities` - TODO: remove in next major release\n    returnAllReadData = false,\n    threadList = false,\n    unsafeHTML = false,\n    headerPosition,\n    read,\n  } = props;\n\n  const { customClasses } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('MessageList');\n\n  const {\n    EmptyStateIndicator = DefaultEmptyStateIndicator,\n    MessageListNotifications = DefaultMessageListNotifications,\n    MessageNotification = DefaultMessageNotification,\n    TypingIndicator = DefaultTypingIndicator,\n  } = useComponentContext<At, Ch, Co, Ev, Me, Re, Us>('MessageList');\n\n  const {\n    hasNewMessages,\n    listRef,\n    onMessageLoadCaptured,\n    onScroll,\n    scrollToBottom,\n    wrapperRect,\n  } = useScrollLocationLogic({\n    messages,\n    scrolledUpThreshold: props.scrolledUpThreshold,\n  });\n\n  const { messageGroupStyles, messages: enrichedMessages } = useEnrichedMessages({\n    channel,\n    disableDateSeparator,\n    groupStyles,\n    headerPosition,\n    hideDeletedMessages,\n    hideNewMessageSeparator,\n    messages,\n    noGroupByUser,\n    threadList,\n  });\n\n  const elements = useMessageListElements({\n    enrichedMessages,\n    internalMessageProps: {\n      additionalMessageInputProps: props.additionalMessageInputProps,\n      closeReactionSelectorOnClick: props.closeReactionSelectorOnClick,\n      customMessageActions: props.customMessageActions,\n      disableQuotedMessages: props.disableQuotedMessages,\n      formatDate: props.formatDate,\n      getDeleteMessageErrorNotification: props.getDeleteMessageErrorNotification,\n      getFlagMessageErrorNotification: props.getFlagMessageErrorNotification,\n      getFlagMessageSuccessNotification: props.getFlagMessageSuccessNotification,\n      getMuteUserErrorNotification: props.getMuteUserErrorNotification,\n      getMuteUserSuccessNotification: props.getMuteUserSuccessNotification,\n      getPinMessageErrorNotification: props.getPinMessageErrorNotification,\n      Message: props.Message,\n      messageActions,\n      messageListRect: wrapperRect,\n      onlySenderCanEdit: props.onlySenderCanEdit,\n      onMentionsClick: props.onMentionsClick,\n      onMentionsHover: props.onMentionsHover,\n      onUserClick: props.onUserClick,\n      onUserHover: props.onUserHover,\n      openThread: props.openThread,\n      pinPermissions,\n      renderText: props.renderText,\n      retrySendMessage: props.retrySendMessage,\n      unsafeHTML,\n    },\n    messageGroupStyles,\n    onMessageLoadCaptured,\n    read,\n    returnAllReadData,\n    threadList,\n  });\n\n  const finalInternalInfiniteScrollProps = useInternalInfiniteScrollProps(props);\n\n  const messageListClass = customClasses?.messageList || 'str-chat__list';\n  const threadListClass = threadList ? customClasses?.threadList || 'str-chat__list--thread' : '';\n\n  return (\n    <>\n      <div className={`${messageListClass} ${threadListClass}`} onScroll={onScroll} ref={listRef}>\n        {!elements.length ? (\n          <EmptyStateIndicator listType='message' />\n        ) : (\n          <InfiniteScroll\n            className='str-chat__reverse-infinite-scroll'\n            data-testid='reverse-infinite-scroll'\n            isReverse\n            useWindow={false}\n            {...finalInternalInfiniteScrollProps}\n          >\n            <ul className='str-chat__ul'>{elements}</ul>\n            <TypingIndicator threadList={threadList} />\n            <div key='bottom' />\n          </InfiniteScroll>\n        )}\n      </div>\n      <MessageListNotifications\n        hasNewMessages={hasNewMessages}\n        MessageNotification={MessageNotification}\n        notifications={notifications}\n        scrollToBottom={scrollToBottom}\n      />\n    </>\n  );\n};\n\ntype PropsDrilledToMessage =\n  | 'additionalMessageInputProps'\n  | 'closeReactionSelectorOnClick'\n  | 'customMessageActions'\n  | 'disableQuotedMessages'\n  | 'formatDate'\n  | 'getDeleteMessageErrorNotification'\n  | 'getFlagMessageErrorNotification'\n  | 'getFlagMessageSuccessNotification'\n  | 'getMuteUserErrorNotification'\n  | 'getMuteUserSuccessNotification'\n  | 'getPinMessageErrorNotification'\n  | 'Message'\n  | 'messageActions'\n  | 'onlySenderCanEdit'\n  | 'onMentionsClick'\n  | 'onMentionsHover'\n  | 'onUserClick'\n  | 'onUserHover'\n  | 'openThread'\n  | 'pinPermissions' // @deprecated in favor of `channelCapabilities` - TODO: remove in next major release\n  | 'renderText'\n  | 'retrySendMessage'\n  | 'unsafeHTML';\n\nexport type MessageListProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = Partial<Pick<MessageProps<At, Ch, Co, Ev, Me, Re, Us>, PropsDrilledToMessage>> & {\n  /** Disables the injection of date separator components, defaults to `false` */\n  disableDateSeparator?: boolean;\n  /** Callback function to set group styles for each message */\n  groupStyles?: (\n    message: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n    previousMessage: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n    nextMessage: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>,\n    noGroupByUser: boolean,\n  ) => GroupStyle;\n  /** Whether or not the list has more items to load */\n  hasMore?: boolean;\n  /** Position to render HeaderComponent */\n  headerPosition?: number;\n  /** Hides the MessageDeleted components from the list, defaults to `false` */\n  hideDeletedMessages?: boolean;\n  /** Hides the DateSeparator component when new messages are received in a channel that's watched but not active, defaults to false */\n  hideNewMessageSeparator?: boolean;\n  /** Overrides the default props passed to [InfiniteScroll](https://github.com/GetStream/stream-chat-react/blob/master/src/components/InfiniteScrollPaginator/InfiniteScroll.tsx) */\n  internalInfiniteScrollProps?: InfiniteScrollProps;\n  /** Whether or not the list is currently loading more items */\n  loadingMore?: boolean;\n  /** Function called when more messages are to be loaded, defaults to function stored in [ChannelActionContext](https://getstream.io/chat/docs/sdk/react/contexts/channel_action_context/) */\n  loadMore?: ChannelActionContextValue['loadMore'] | (() => Promise<void>);\n  /** The limit to use when paginating messages */\n  messageLimit?: number;\n  /** The messages to render in the list, defaults to messages stored in [ChannelStateContext](https://getstream.io/chat/docs/sdk/react/contexts/channel_state_context/) */\n  messages?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>[];\n  /** If true, turns off message UI grouping by user */\n  noGroupByUser?: boolean;\n  /** If true, `readBy` data supplied to the `Message` components will include all user read states per sent message */\n  returnAllReadData?: boolean;\n  /** The pixel threshold to determine whether or not the user is scrolled up in the list, defaults to 200px */\n  scrolledUpThreshold?: number;\n  /** If true, indicates the message list is a thread  */\n  threadList?: boolean;\n};\n\n/**\n * The MessageList component renders a list of Messages.\n * It is a consumer of the following contexts:\n * - [ChannelStateContext](https://getstream.io/chat/docs/sdk/react/contexts/channel_state_context/)\n * - [ChannelActionContext](https://getstream.io/chat/docs/sdk/react/contexts/channel_action_context/)\n * - [ComponentContext](https://getstream.io/chat/docs/sdk/react/contexts/component_context/)\n * - [TypingContext](https://getstream.io/chat/docs/sdk/react/contexts/typing_context/)\n */\nexport const MessageList = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: MessageListProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const { loadMore } = useChannelActionContext<At, Ch, Co, Ev, Me, Re, Us>('MessageList');\n\n  const {\n    members: membersPropToNotPass, // eslint-disable-line @typescript-eslint/no-unused-vars\n    mutes: mutesPropToNotPass, // eslint-disable-line @typescript-eslint/no-unused-vars\n    watchers: watchersPropToNotPass, // eslint-disable-line @typescript-eslint/no-unused-vars\n    ...restChannelStateContext\n  } = useChannelStateContext<At, Ch, Co, Ev, Me, Re, Us>('MessageList');\n\n  return (\n    <MessageListWithContext<At, Ch, Co, Ev, Me, Re, Us>\n      loadMore={loadMore}\n      {...restChannelStateContext}\n      {...props}\n    />\n  );\n};\n","import { useEffect, useState } from 'react';\n\nimport { useChatContext } from '../../../context/ChatContext';\n\nimport type { EventHandler } from 'stream-chat';\n\nimport type { StreamMessage } from '../../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport const useGiphyPreview = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  separateGiphyPreview: boolean,\n) => {\n  const [giphyPreviewMessage, setGiphyPreviewMessage] = useState<\n    StreamMessage<At, Ch, Co, Ev, Me, Re, Us>\n  >();\n\n  const { client } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('useGiphyPreview');\n\n  useEffect(() => {\n    const handleEvent: EventHandler<At, Ch, Co, Ev, Me, Re, Us> = (event) => {\n      const { message, user } = event;\n\n      if (message?.command === 'giphy' && user?.id === client.userID) {\n        setGiphyPreviewMessage(undefined);\n      }\n    };\n\n    if (separateGiphyPreview) client.on('message.new', handleEvent);\n    return () => client.off('message.new', handleEvent);\n  }, [separateGiphyPreview]);\n\n  return { giphyPreviewMessage, setGiphyPreviewMessage };\n};\n","import { useEffect, useRef, useState } from 'react';\n\nimport type { StreamMessage } from '../../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport function useNewMessageNotification<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(messages: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>[], currentUserId?: string) {\n  const [newMessagesNotification, setNewMessagesNotification] = useState(false);\n  /**\n   * use the flag to avoid the initial \"new messages\" quick blink\n   */\n  const didMount = useRef(false);\n\n  const lastMessageId = useRef('');\n  const atBottom = useRef(false);\n\n  useEffect(() => {\n    /* handle scrolling behavior for new messages */\n    if (!messages?.length) return;\n\n    const lastMessage = messages[messages.length - 1];\n    const prevMessageId = lastMessageId.current;\n    lastMessageId.current = lastMessage.id || ''; // update last message id\n\n    /* do nothing if new messages are loaded from top(loadMore)  */\n    if (lastMessage.id === prevMessageId) return;\n\n    /* if list is already at the bottom return, followOutput will do the job */\n    if (atBottom.current) return;\n\n    /* if the new message belongs to current user scroll to bottom */\n    if (lastMessage.user?.id !== currentUserId && didMount.current) {\n      /* otherwise just show newMessage notification  */\n      setNewMessagesNotification(true);\n    }\n    didMount.current = true;\n  }, [currentUserId, messages]);\n\n  return { atBottom, newMessagesNotification, setNewMessagesNotification };\n}\n","import { useMemo, useRef } from 'react';\n\nimport type { StreamMessage } from '../../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport function usePrependedMessagesCount<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(messages: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>[]) {\n  const currentFirstMessageId = messages?.[0]?.id;\n  const firstMessageId = useRef(currentFirstMessageId);\n  const earliestMessageId = useRef(currentFirstMessageId);\n  const previousNumItemsPrepended = useRef(0);\n\n  const numItemsPrepended = useMemo(() => {\n    if (!messages || !messages.length) {\n      return 0;\n    }\n    // if no new messages were prepended, return early (same amount as before)\n    if (currentFirstMessageId === earliestMessageId.current) {\n      return previousNumItemsPrepended.current;\n    }\n\n    if (!firstMessageId.current) {\n      firstMessageId.current = currentFirstMessageId;\n    }\n    earliestMessageId.current = currentFirstMessageId;\n    // if new messages were prepended, find out how many\n    // start with this number because there cannot be fewer prepended items than before\n    for (let i = previousNumItemsPrepended.current; i < messages.length; i += 1) {\n      if (messages[i].id === firstMessageId.current) {\n        previousNumItemsPrepended.current = i;\n        return i;\n      }\n    }\n    return 0;\n    // TODO: there's a bug here, the messages prop is the same array instance (something mutates it)\n    // that's why the second dependency is necessary\n  }, [messages, messages?.length]);\n\n  return numItemsPrepended;\n}\n","import { useEffect, useRef } from 'react';\n\nimport type { StreamMessage } from '../../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../../types/types';\n\nexport function useShouldForceScrollToBottom<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(messages: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>[], currentUserId?: string) {\n  const lastFocusedOwnMessage = useRef('');\n  const initialFocusRegistered = useRef(false);\n\n  function recheckForNewOwnMessage() {\n    if (messages && messages.length > 0) {\n      const lastMessage = messages[messages.length - 1];\n\n      if (\n        lastMessage.user?.id === currentUserId &&\n        lastFocusedOwnMessage.current !== lastMessage.id\n      ) {\n        lastFocusedOwnMessage.current = lastMessage.id;\n        return true;\n      }\n    }\n    return false;\n  }\n\n  useEffect(() => {\n    if (messages && messages.length && !initialFocusRegistered.current) {\n      initialFocusRegistered.current = true;\n      recheckForNewOwnMessage();\n    }\n  }, [messages, messages?.length]);\n\n  return recheckForNewOwnMessage;\n}\n","import React, { useCallback, useEffect, useMemo, useRef } from 'react';\nimport {\n  Components,\n  ScrollSeekConfiguration,\n  ScrollSeekPlaceholderProps,\n  Virtuoso,\n  VirtuosoHandle,\n  VirtuosoProps,\n} from 'react-virtuoso';\n\nimport { GiphyPreviewMessage as DefaultGiphyPreviewMessage } from './GiphyPreviewMessage';\nimport { useGiphyPreview } from './hooks/useGiphyPreview';\nimport { useNewMessageNotification } from './hooks/useNewMessageNotification';\nimport { usePrependedMessagesCount } from './hooks/usePrependMessagesCount';\nimport { useShouldForceScrollToBottom } from './hooks/useShouldForceScrollToBottom';\nimport { MessageNotification as DefaultMessageNotification } from './MessageNotification';\nimport { MessageListNotifications as DefaultMessageListNotifications } from './MessageListNotifications';\nimport { processMessages } from './utils';\n\nimport { DateSeparator as DefaultDateSeparator } from '../DateSeparator/DateSeparator';\nimport { EmptyStateIndicator as DefaultEmptyStateIndicator } from '../EmptyStateIndicator/EmptyStateIndicator';\nimport { EventComponent } from '../EventComponent/EventComponent';\nimport { LoadingIndicator as DefaultLoadingIndicator } from '../Loading/LoadingIndicator';\nimport { Message, MessageProps, MessageSimple, MessageUIComponentProps } from '../Message';\n\nimport {\n  ChannelActionContextValue,\n  useChannelActionContext,\n} from '../../context/ChannelActionContext';\nimport {\n  ChannelNotifications,\n  StreamMessage,\n  useChannelStateContext,\n} from '../../context/ChannelStateContext';\nimport { useChatContext } from '../../context/ChatContext';\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { isDate } from '../../context/TranslationContext';\n\nimport type { Channel } from 'stream-chat';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n  UnknownType,\n} from '../../types/types';\n\nconst PREPEND_OFFSET = 10 ** 7;\n\ntype VirtualizedMessageListWithContextProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = VirtualizedMessageListProps<At, Ch, Co, Ev, Me, Re, Us> & {\n  channel: Channel<At, Ch, Co, Ev, Me, Re, Us>;\n  hasMore: boolean;\n  loadingMore: boolean;\n  notifications: ChannelNotifications;\n};\n\nconst VirtualizedMessageListWithContext = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: VirtualizedMessageListWithContextProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const {\n    additionalVirtuosoProps,\n    channel,\n    closeReactionSelectorOnClick,\n    customMessageRenderer,\n    defaultItemHeight,\n    disableDateSeparator = true,\n    hasMore,\n    hideDeletedMessages = false,\n    hideNewMessageSeparator = false,\n    loadingMore,\n    loadMore,\n    Message: propMessage,\n    messageLimit = 100,\n    messages,\n    notifications,\n    overscan = 0,\n    // TODO: refactor to scrollSeekPlaceHolderConfiguration and components.ScrollSeekPlaceholder, like the Virtuoso Component\n    scrollSeekPlaceHolder,\n    scrollToLatestMessageOnFocus = false,\n    separateGiphyPreview = false,\n    shouldGroupByUser = false,\n    stickToBottomScrollBehavior = 'smooth',\n  } = props;\n\n  const {\n    DateSeparator = DefaultDateSeparator,\n    EmptyStateIndicator = DefaultEmptyStateIndicator,\n    GiphyPreviewMessage = DefaultGiphyPreviewMessage,\n    LoadingIndicator = DefaultLoadingIndicator,\n    MessageListNotifications = DefaultMessageListNotifications,\n    MessageNotification = DefaultMessageNotification,\n    MessageSystem = EventComponent,\n    TypingIndicator = null,\n    VirtualMessage: contextMessage = MessageSimple,\n  } = useComponentContext<At, Ch, Co, Ev, Me, Re, Us>('VirtualizedMessageList');\n\n  const { client, customClasses } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'VirtualizedMessageList',\n  );\n\n  const lastRead = useMemo(() => channel.lastRead?.(), [channel]);\n\n  const MessageUIComponent = propMessage || contextMessage;\n\n  const { giphyPreviewMessage, setGiphyPreviewMessage } = useGiphyPreview<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us\n  >(separateGiphyPreview);\n\n  const processedMessages = useMemo(() => {\n    if (typeof messages === 'undefined') {\n      return [];\n    }\n\n    if (\n      disableDateSeparator &&\n      !hideDeletedMessages &&\n      hideNewMessageSeparator &&\n      !separateGiphyPreview\n    ) {\n      return messages;\n    }\n\n    return processMessages({\n      disableDateSeparator,\n      hideDeletedMessages,\n      hideNewMessageSeparator,\n      lastRead,\n      messages,\n      separateGiphyPreview,\n      setGiphyPreviewMessage,\n      userId: client.userID || '',\n    });\n  }, [\n    disableDateSeparator,\n    hideDeletedMessages,\n    hideNewMessageSeparator,\n    lastRead,\n    messages,\n    messages?.length,\n    client.userID,\n  ]);\n\n  const virtuoso = useRef<VirtuosoHandle>(null);\n\n  const {\n    atBottom,\n    newMessagesNotification,\n    setNewMessagesNotification,\n  } = useNewMessageNotification(processedMessages, client.userID);\n\n  const scrollToBottom = useCallback(() => {\n    if (virtuoso.current) {\n      virtuoso.current.scrollToIndex(processedMessages.length - 1);\n    }\n\n    setNewMessagesNotification(false);\n  }, [virtuoso, processedMessages, setNewMessagesNotification, processedMessages.length]);\n\n  const scrollToBottomIfConfigured = useCallback(\n    (event: Event) => {\n      if (scrollToLatestMessageOnFocus && event.target === window) {\n        setTimeout(scrollToBottom, 100);\n      }\n    },\n    [scrollToLatestMessageOnFocus, scrollToBottom],\n  );\n\n  useEffect(() => {\n    if (typeof window !== 'undefined') {\n      window.addEventListener('focus', scrollToBottomIfConfigured);\n    }\n\n    return () => window.removeEventListener('focus', scrollToBottomIfConfigured);\n  }, [scrollToBottomIfConfigured]);\n\n  const numItemsPrepended = usePrependedMessagesCount(processedMessages);\n\n  const shouldForceScrollToBottom = useShouldForceScrollToBottom(processedMessages, client.userID);\n\n  const followOutput = (isAtBottom: boolean) => {\n    if (shouldForceScrollToBottom()) {\n      return isAtBottom ? stickToBottomScrollBehavior : 'auto';\n    }\n    // a message from another user has been received - don't scroll to bottom unless already there\n    return isAtBottom ? stickToBottomScrollBehavior : false;\n  };\n\n  const messageRenderer = useCallback(\n    (messageList: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>[], virtuosoIndex: number) => {\n      const streamMessageIndex = virtuosoIndex + numItemsPrepended - PREPEND_OFFSET;\n      // use custom renderer supplied by client if present and skip the rest\n      if (customMessageRenderer) {\n        return customMessageRenderer(messageList, streamMessageIndex);\n      }\n\n      const message = messageList[streamMessageIndex];\n\n      if (message.customType === 'message.date' && message.date && isDate(message.date)) {\n        return <DateSeparator date={message.date} unread={message.unread} />;\n      }\n\n      if (!message) return <div style={{ height: '1px' }}></div>; // returning null or zero height breaks the virtuoso\n\n      if (message.type === 'system') {\n        return <MessageSystem message={message} />;\n      }\n\n      const groupedByUser =\n        shouldGroupByUser &&\n        streamMessageIndex > 0 &&\n        message.user?.id === messageList[streamMessageIndex - 1].user?.id;\n\n      const firstOfGroup =\n        shouldGroupByUser && message.user?.id !== messageList[streamMessageIndex - 1]?.user?.id;\n\n      const endOfGroup =\n        shouldGroupByUser && message.user?.id !== messageList[streamMessageIndex + 1]?.user?.id;\n\n      return (\n        <Message\n          closeReactionSelectorOnClick={closeReactionSelectorOnClick}\n          customMessageActions={props.customMessageActions}\n          endOfGroup={endOfGroup}\n          firstOfGroup={firstOfGroup}\n          groupedByUser={groupedByUser}\n          message={message}\n          Message={MessageUIComponent}\n          messageActions={props.messageActions}\n        />\n      );\n    },\n    [customMessageRenderer, shouldGroupByUser, numItemsPrepended],\n  );\n\n  const virtuosoComponents: Partial<Components> = useMemo(() => {\n    const EmptyPlaceholder: Components['EmptyPlaceholder'] = () => (\n      <>{EmptyStateIndicator && <EmptyStateIndicator listType='message' />}</>\n    );\n\n    const Header: Components['Header'] = () =>\n      loadingMore ? (\n        <div className='str-chat__virtual-list__loading'>\n          <LoadingIndicator size={20} />\n        </div>\n      ) : (\n        <></>\n      );\n\n    const virtualMessageClass =\n      customClasses?.virtualMessage || 'str-chat__virtual-list-message-wrapper';\n\n    // using 'display: inline-block' traps CSS margins of the item elements, preventing incorrect item measurements\n    const Item: Components['Item'] = (props) => <div {...props} className={virtualMessageClass} />;\n\n    const Footer: Components['Footer'] = () =>\n      TypingIndicator ? <TypingIndicator avatarSize={24} /> : <></>;\n\n    return {\n      EmptyPlaceholder,\n      Footer,\n      Header,\n      Item,\n    };\n  }, [loadingMore]);\n\n  const atBottomStateChange = (isAtBottom: boolean) => {\n    atBottom.current = isAtBottom;\n    if (isAtBottom && newMessagesNotification) {\n      setNewMessagesNotification(false);\n    }\n  };\n\n  const startReached = () => {\n    if (hasMore && loadMore) {\n      loadMore(messageLimit);\n    }\n  };\n\n  if (!processedMessages) return null;\n\n  const virtualizedMessageListClass =\n    customClasses?.virtualizedMessageList || 'str-chat__virtual-list';\n\n  return (\n    <>\n      <div className={virtualizedMessageListClass}>\n        <Virtuoso\n          atBottomStateChange={atBottomStateChange}\n          components={virtuosoComponents}\n          firstItemIndex={PREPEND_OFFSET - numItemsPrepended}\n          followOutput={followOutput}\n          initialTopMostItemIndex={processedMessages.length ? processedMessages.length - 1 : 0}\n          itemContent={(i) => messageRenderer(processedMessages, i)}\n          overscan={overscan}\n          ref={virtuoso}\n          startReached={startReached}\n          style={{ overflowX: 'hidden' }}\n          totalCount={processedMessages.length}\n          {...additionalVirtuosoProps}\n          {...(scrollSeekPlaceHolder ? { scrollSeek: scrollSeekPlaceHolder } : {})}\n          {...(defaultItemHeight ? { defaultItemHeight } : {})}\n        />\n      </div>\n      <MessageListNotifications\n        hasNewMessages={newMessagesNotification}\n        MessageNotification={MessageNotification}\n        notifications={notifications}\n        scrollToBottom={scrollToBottom}\n      />\n      {giphyPreviewMessage && <GiphyPreviewMessage message={giphyPreviewMessage} />}\n    </>\n  );\n};\n\nexport type VirtualizedMessageListProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = Partial<\n  Pick<MessageProps<At, Ch, Co, Ev, Me, Re, Us>, 'customMessageActions' | 'messageActions'>\n> & {\n  /** Additional props to be passed the underlying [`react-virtuoso` virtualized list dependency](https://virtuoso.dev/virtuoso-api-reference/) */\n  additionalVirtuosoProps?: VirtuosoProps<UnknownType>;\n  /** If true, picking a reaction from the `ReactionSelector` component will close the selector */\n  closeReactionSelectorOnClick?: boolean;\n  /** Custom render function, if passed, certain UI props are ignored */\n  customMessageRenderer?: (\n    messageList: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>[],\n    index: number,\n  ) => React.ReactElement;\n  /** If set, the default item height is used for the calculation of the total list height. Use if you expect messages with a lot of height variance */\n  defaultItemHeight?: number;\n  /** Disables the injection of date separator components, defaults to `true` */\n  disableDateSeparator?: boolean;\n  /** Whether or not the list has more items to load */\n  hasMore?: boolean;\n  /** Hides the `MessageDeleted` components from the list, defaults to `false` */\n  hideDeletedMessages?: boolean;\n  /** Hides the `DateSeparator` component when new messages are received in a channel that's watched but not active, defaults to false */\n  hideNewMessageSeparator?: boolean;\n  /** Whether or not the list is currently loading more items */\n  loadingMore?: boolean;\n  /** Function called when more messages are to be loaded, defaults to function stored in [ChannelActionContext](https://getstream.io/chat/docs/sdk/react/contexts/channel_action_context/) */\n  loadMore?: ChannelActionContextValue['loadMore'] | (() => Promise<void>);\n  /** Custom UI component to display a message, defaults to and accepts same props as [FixedHeightMessage](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Message/FixedHeightMessage.tsx) */\n  Message?: React.ComponentType<MessageUIComponentProps<At, Ch, Co, Ev, Me, Re, Us>>;\n  /** The limit to use when paginating messages */\n  messageLimit?: number;\n  /** Optional prop to override the messages available from [ChannelStateContext](https://getstream.io/chat/docs/sdk/react/contexts/channel_state_context/) */\n  messages?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>[];\n  /** The amount of extra content the list should render in addition to what's necessary to fill in the viewport */\n  overscan?: number;\n  /**\n   * Performance improvement by showing placeholders if user scrolls fast through list.\n   * it can be used like this:\n   * ```\n   *  {\n   *    enter: (velocity) => Math.abs(velocity) > 120,\n   *    exit: (velocity) => Math.abs(velocity) < 40,\n   *    change: () => null,\n   *    placeholder: ({index, height})=> <div style={{height: height + \"px\"}}>{index}</div>,\n   *  }\n   *  ```\n   */\n  scrollSeekPlaceHolder?: ScrollSeekConfiguration & {\n    placeholder: React.ComponentType<ScrollSeekPlaceholderProps>;\n  };\n  /** When `true`, the list will scroll to the latest message when the window regains focus */\n  scrollToLatestMessageOnFocus?: boolean;\n  /** If true, the Giphy preview will render as a separate component above the `MessageInput`, rather than inline with the other messages in the list */\n  separateGiphyPreview?: boolean;\n  /** If true, group messages belonging to the same user, otherwise show each message individually */\n  shouldGroupByUser?: boolean;\n  /** The scrollTo behavior when new messages appear. Use `\"smooth\"` for regular chat channels, and `\"auto\"` (which results in instant scroll to bottom) if you expect high throughput. */\n  stickToBottomScrollBehavior?: 'smooth' | 'auto';\n  /** If true, indicates the message list is a thread  */\n  threadList?: boolean;\n};\n\n/**\n * The VirtualizedMessageList component renders a list of messages in a virtualized list.\n * It is a consumer of the React contexts set in [Channel](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Channel/Channel.tsx).\n *\n * **Note**: It works well when there are thousands of messages in a channel, it has a shortcoming though - the message UI should have a fixed height.\n */\nexport function VirtualizedMessageList<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(props: VirtualizedMessageListProps<At, Ch, Co, Ev, Me, Re, Us>) {\n  const { loadMore } = useChannelActionContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'VirtualizedMessageList',\n  );\n  const {\n    channel,\n    hasMore,\n    loadingMore,\n    messages: contextMessages,\n    notifications,\n  } = useChannelStateContext<At, Ch, Co, Ev, Me, Re, Us>('VirtualizedMessageList');\n\n  const messages = props.messages || contextMessages;\n\n  return (\n    <VirtualizedMessageListWithContext\n      channel={channel}\n      hasMore={!!hasMore}\n      loadingMore={!!loadingMore}\n      loadMore={loadMore}\n      messages={messages}\n      notifications={notifications}\n      {...props}\n    />\n  );\n}\n","import React, { useEffect, useRef } from 'react';\n\nimport { FixedHeightMessage } from '../Message/FixedHeightMessage';\nimport { Message } from '../Message/Message';\nimport { MessageInput, MessageInputProps } from '../MessageInput/MessageInput';\nimport { MessageInputSmall } from '../MessageInput/MessageInputSmall';\nimport { MessageList, MessageListProps } from '../MessageList/MessageList';\nimport {\n  VirtualizedMessageList,\n  VirtualizedMessageListProps,\n} from '../MessageList/VirtualizedMessageList';\n\nimport { useChannelActionContext } from '../../context/ChannelActionContext';\nimport { StreamMessage, useChannelStateContext } from '../../context/ChannelStateContext';\nimport { useChatContext } from '../../context/ChatContext';\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { useTranslationContext } from '../../context/TranslationContext';\n\nimport type { MessageProps, MessageUIComponentProps } from '../Message/types';\n\nimport type {\n  CustomTrigger,\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type ThreadProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n> = {\n  /** Additional props for `MessageInput` component: [available props](https://getstream.io/chat/docs/sdk/react/message-input-components/message_input/#props) */\n  additionalMessageInputProps?: MessageInputProps<At, Ch, Co, Ev, Me, Re, Us, V>;\n  /** Additional props for `MessageList` component: [available props](https://getstream.io/chat/docs/sdk/react/core-components/message_list/#props) */\n  additionalMessageListProps?: MessageListProps<At, Ch, Co, Ev, Me, Re, Us>;\n  /** Additional props for `Message` component of the parent message: [available props](https://getstream.io/chat/docs/sdk/react/message-components/message/#props) */\n  additionalParentMessageProps?: MessageProps<At, Ch, Co, Ev, Me, Re, Us>;\n  /** Additional props for `VirtualizedMessageList` component: [available props](https://getstream.io/chat/docs/sdk/react/core-components/virtualized_list/#props) */\n  additionalVirtualizedMessageListProps?: VirtualizedMessageListProps<At, Ch, Co, Ev, Me, Re, Us>;\n  /** If true, focuses the `MessageInput` component on opening a thread */\n  autoFocus?: boolean;\n  /** Display the thread on 100% width of its parent container. Useful for mobile style view */\n  fullWidth?: boolean;\n  /** Custom thread input UI component used to override the default `Input` value stored in `ComponentContext` or the [MessageInputSmall](https://github.com/GetStream/stream-chat-react/blob/master/src/components/MessageInput/MessageInputSmall.tsx) default */\n  Input?: React.ComponentType;\n  /** Custom thread message UI component used to override the default `Message` value stored in `ComponentContext` */\n  Message?: React.ComponentType<MessageUIComponentProps<At, Ch, Co, Ev, Me, Re, Us>>;\n  /** If true, render the `VirtualizedMessageList` instead of the standard `MessageList` component */\n  virtualized?: boolean;\n};\n\n/**\n * The Thread component renders a parent Message with a list of replies\n */\nexport const Thread = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>(\n  props: ThreadProps<At, Ch, Co, Ev, Me, Re, Us, V>,\n) => {\n  const { channel, channelConfig, thread } = useChannelStateContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'Thread',\n  );\n\n  if (!thread || channelConfig?.replies === false) return null;\n\n  // The wrapper ensures a key variable is set and the component recreates on thread switch\n  return <ThreadInner {...props} key={`thread-${thread.id}-${channel?.cid}`} />;\n};\n\nexport type ThreadHeaderProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  closeThread: (event: React.BaseSyntheticEvent) => void;\n  thread: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>;\n};\n\nconst DefaultThreadHeader = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: ThreadHeaderProps<At, Ch, Co, Ev, Me, Re, Us>,\n) => {\n  const { closeThread, thread } = props;\n\n  const { t } = useTranslationContext('Thread');\n\n  const getReplyCount = () => {\n    if (!thread.reply_count) return '';\n    if (thread.reply_count === 1) return t('1 reply');\n    return t('{{ replyCount }} replies', {\n      replyCount: thread.reply_count,\n    });\n  };\n\n  return (\n    <div className='str-chat__thread-header'>\n      <div className='str-chat__thread-header-details'>\n        <strong>{t('Thread')}</strong>\n        <small>{getReplyCount()}</small>\n      </div>\n      <button\n        aria-label='Close thread'\n        className='str-chat__square-button'\n        data-testid='close-button'\n        onClick={(event) => closeThread(event)}\n      >\n        <svg height='10' width='10' xmlns='http://www.w3.org/2000/svg'>\n          <path\n            d='M9.916 1.027L8.973.084 5 4.058 1.027.084l-.943.943L4.058 5 .084 8.973l.943.943L5 5.942l3.973 3.974.943-.943L5.942 5z'\n            fillRule='evenodd'\n          />\n        </svg>\n      </button>\n    </div>\n  );\n};\n\nconst DefaultThreadStart: React.FC = () => {\n  const { t } = useTranslationContext('Thread');\n\n  return <div className='str-chat__thread-start'>{t('Start of a new thread')}</div>;\n};\n\nconst ThreadInner = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType,\n  V extends CustomTrigger = CustomTrigger\n>(\n  props: ThreadProps<At, Ch, Co, Ev, Me, Re, Us, V> & { key: string },\n) => {\n  const {\n    additionalMessageInputProps,\n    additionalMessageListProps,\n    additionalParentMessageProps,\n    additionalVirtualizedMessageListProps,\n    autoFocus = true,\n    fullWidth = false,\n    Input: PropInput,\n    Message: PropMessage,\n    virtualized,\n  } = props;\n\n  const { thread, threadHasMore, threadLoadingMore, threadMessages } = useChannelStateContext<\n    At,\n    Ch,\n    Co,\n    Ev,\n    Me,\n    Re,\n    Us\n  >('Thread');\n  const { closeThread, loadMoreThread } = useChannelActionContext<At, Ch, Co, Ev, Me, Re, Us>(\n    'Thread',\n  );\n  const { customClasses } = useChatContext<At, Ch, Co, Ev, Me, Re, Us>('Thread');\n  const {\n    ThreadInput: ContextInput,\n    Message: ContextMessage,\n    ThreadHeader = DefaultThreadHeader,\n    ThreadStart = DefaultThreadStart,\n    VirtualMessage = FixedHeightMessage,\n  } = useComponentContext<At, Ch, Co, Ev, Me, Re, Us>('Thread');\n\n  const messageList = useRef<HTMLDivElement | null>(null);\n\n  const ThreadInput =\n    PropInput || additionalMessageInputProps?.Input || ContextInput || MessageInputSmall;\n\n  const ThreadMessage = PropMessage || additionalMessageListProps?.Message;\n  const FallbackMessage = virtualized ? VirtualMessage : ContextMessage;\n\n  const ThreadMessageList = virtualized ? VirtualizedMessageList : MessageList;\n\n  useEffect(() => {\n    if (thread?.id && thread?.reply_count) {\n      loadMoreThread();\n    }\n  }, []);\n\n  useEffect(() => {\n    if (messageList.current && threadMessages?.length) {\n      const { clientHeight, scrollHeight, scrollTop } = messageList.current;\n      const scrollDown = clientHeight + scrollTop !== scrollHeight;\n\n      if (scrollDown) {\n        messageList.current.scrollTop = scrollHeight - clientHeight;\n      }\n    }\n  }, [threadMessages?.length]);\n\n  if (!thread) return null;\n\n  const threadClass = customClasses?.thread || 'str-chat__thread';\n\n  return (\n    <div className={`${threadClass} ${fullWidth ? 'str-chat__thread--full' : ''}`}>\n      <ThreadHeader closeThread={closeThread} thread={thread} />\n      <div className='str-chat__thread-list' ref={messageList}>\n        <Message\n          initialMessage\n          message={thread}\n          Message={ThreadMessage || FallbackMessage}\n          threadList\n          {...additionalParentMessageProps}\n        />\n        <ThreadStart />\n        <ThreadMessageList\n          hasMore={threadHasMore}\n          loadingMore={threadLoadingMore}\n          loadMore={loadMoreThread}\n          Message={ThreadMessage || FallbackMessage}\n          messages={threadMessages || []}\n          threadList\n          {...(virtualized ? additionalVirtualizedMessageListProps : additionalMessageListProps)}\n        />\n      </div>\n      <MessageInput\n        focus={autoFocus}\n        Input={ThreadInput}\n        parent={thread}\n        publishTypingEvent={false}\n        {...additionalMessageInputProps}\n      />\n    </div>\n  );\n};\n","import React, { PropsWithChildren } from 'react';\n\nimport { StreamMessage, useChannelStateContext } from '../../context/ChannelStateContext';\n\nimport type {\n  DefaultAttachmentType,\n  DefaultChannelType,\n  DefaultCommandType,\n  DefaultEventType,\n  DefaultMessageType,\n  DefaultReactionType,\n  DefaultUserType,\n} from '../../types/types';\n\nexport type WindowProps<\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Ev extends DefaultEventType = DefaultEventType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n> = {\n  /** show or hide the window when a thread is active */\n  hideOnThread?: boolean;\n  /** optional prop to manually trigger the opening of a thread*/\n  thread?: StreamMessage<At, Ch, Co, Ev, Me, Re, Us>;\n};\n\nconst UnMemoizedWindow = <\n  At extends DefaultAttachmentType = DefaultAttachmentType,\n  Ch extends DefaultChannelType = DefaultChannelType,\n  Co extends DefaultCommandType = DefaultCommandType,\n  Me extends DefaultMessageType = DefaultMessageType,\n  Re extends DefaultReactionType = DefaultReactionType,\n  Us extends DefaultUserType<Us> = DefaultUserType\n>(\n  props: PropsWithChildren<WindowProps<At, Ch, Co, Me, Re, Us>>,\n) => {\n  const { children, hideOnThread = false } = props;\n\n  const { thread } = useChannelStateContext<At, Ch, Co, Me, Re, Us>('Window');\n\n  return (\n    <div\n      className={`str-chat__main-panel   ${\n        hideOnThread && thread ? 'str-chat__main-panel--hideOnThread' : ''\n      }`}\n    >\n      {children}\n    </div>\n  );\n};\n\n/**\n * A UI component for conditionally displaying a Thread or Channel\n */\nexport const Window = React.memo(UnMemoizedWindow) as typeof UnMemoizedWindow;\n"],"names":["React","useState","useRef","useCallback","useEffect","sanitizeUrl","Dayjs","calendar","localizedFormat","useContext","FileIcon","prettybytes","ImageGallery","useMemo","ModalWrapper","AttachmentActions","DefaultAttachmentActions","Gallery","DefaultGallery","DefaultImage","Card","DefaultCard","DefaultFile","Audio","DefaultAudio","ReactPlayer","Item","forwardRef","props","innerRef","className","Component","component","item","onClickHandler","onSelectHandler","selected","style","selectItem","emojiRegex","findAndReplace","uniqBy","linkify","ReactMarkdown","RootReactMarkdown","KEY_CODES","ESC","UP","DOWN","ENTER","TAB","SPACE","keycodeMap","Listener","refCount","document","addEventListener","f","removeEventListener","keyCodes","fn","keyCode","_typeof","listeners","index","ids","Object","entries","key","e","code","which","type","values","forEach","length","every","keycode","includes","List","currentTrigger","dropdownScroll","getSelectedItem","getTextToReplace","PropHeader","Header","itemClassName","itemStyle","onSelect","selectionEnd","PropSuggestionItem","SuggestionItem","propValue","value","useComponentContext","AutocompleteSuggestionHeader","AutocompleteSuggestionItem","SuggestionHeader","DefaultSuggestionListHeader","undefined","selectedItem","setSelectedItem","itemsRef","isSelected","findIndex","getId","textToReplace","text","modifyText","handleClick","preventDefault","id","name","handleKeyDown","event","prevSelected","newID","restructureItem","matched","textBeforeCursor","slice","triggerIndex","lastIndexOf","editedPropValue","escapeRegExp","parts","split","RegExp","itemNameParts","match","map","i","ref","DEFAULT_CARET_POSITION","defaultScrollToItem","container","itemHeight","parseInt","getComputedStyle","getPropertyValue","containerHight","actualScrollTop","scrollTop","itemOffsetTop","offsetTop","errorMessage","message","console","error","triggerPropsCheck","trigger","Error","triggers","triggerChar","settings","triggerSetting","callback","dataProvider","output","isValidElementType","Avatar","DefaultAvatar","ReactTextareaAutocomplete","textareaRef","selectionStart","state","substr","position","focus","setSelectionRange","arrayOfCodes","submitValue","shiftE","keycodeSubmitShiftE","Listeners","add","_onEnter","hasFocus","matches","shiftKey","keycodeSubmitKeys","data","_replaceWord","handleSubmit","_closeAutocomplete","replaceWord","lastWordRegex","exec","getCaretPosition","lastWord","spaces","newWord","textBeforeWord","textAfterCaret","newText","setState","CustomEvent","bubbles","dispatchEvent","onChange","newToken","closeCommandsList","closeMentionsList","showCommandsList","showMentionsList","stateTrigger","textareaValue","computeCaretPosition","token","startToken","Number","isInteger","textToModify","startOfTokenPosition","newTokenString","caretPosition","newCaretPosition","modifiedText","substring","valueToReplace","replace","dataLoading","setCaretPosition","paramTrigger","triggerSettings","_getCurrentTriggerSettings","actualToken","String","Array","isArray","left","top","notSafe","prop","tokens","minChar","movePopupAsYouType","onCaretPositionChange","textarea","target","persist","lastToken","_isCommand","triggerTokens","keys","join","triggerNorWhitespace","regex","tokenMatch","trim","find","a","getCaretCoordinates","newLeft","newTop","_getValuesFromProvider","err","closeOnClickOutside","onBlur","el","relatedTarget","dropdownRef","Node","contains","scrollToItem","_getItemOnSelect","suggestionData","_getSuggestions","_getTextToReplace","triggerProps","currentCommands","getCommands","CommandItem","UserItem","loadingComponent","listenerIndex","_onSpace","newSubmitKeys","keycodeIndex","addKeycodeSubmitListeners","enterIndex","startListen","stopListen","remove","disableMentions","dropdownClassName","dropdownStyle","listClassName","SuggestionList","DefaultSuggestionList","getTriggerProps","_dropdownScroll","_onSelect","containerClassName","containerStyle","maxRows","grow","renderSuggestionListContainer","Textarea","_cleanUpProps","_onClickAndBlurHandler","_changeHandler","onFocus","_onScrollHandler","_selectHandler","additionalTextareaProps","propsValue","propTypes","PropTypes","string","bool","object","array","listStyle","loaderClassName","loaderStyle","elementType","number","func","deepequal","ActionsIcon","DefaultActionsIcon","ReactionIcon","DefaultReactionIcon","ThreadIcon","DefaultThreadIcon","throttle","QuotedMessage","DefaultQuotedMessage","renderText","defaultRenderText","createContext","DefaultEmojiIndex","Suspense","ImagePreviewer","FilePreviewer","AutoCompleteTextarea","DefaultEmojiIcon","FileUploadIcon","DefaultFileUploadIcon","ImageDropzone","FileUploadButton","logChatPromiseExecution","dataTransferItemsHaveFiles","dataTransferItemsToFiles","useReducer","CooldownTimer","DefaultCooldownTimer","QuotedMessagePreview","DefaultQuotedMessagePreview","SendButton","DefaultSendButton","DefaultEditMessageForm","MessageDeleted","DefaultMessageDeleted","MessageOptions","DefaultMessageOptions","MessageRepliesCountButton","DefaultMessageRepliesCountButton","MessageStatus","DefaultMessageStatus","MessageTimestamp","DefaultMessageTimestamp","ReactionSelector","DefaultReactionSelector","ReactionsList","DefaultReactionList","LoadingErrorIndicator","DefaultLoadingErrorIndicator","LoadingIndicator","DefaultLoadingIndicator","useLayoutEffect","uuidv4","debounce","DefaultAttachment","placeholder","SearchInput","DefaultSearchInput","LoadMoreButton","DefaultLoadMoreButton","ChannelSearch","DefaultChannelSearch","EmptyStateIndicator","DefaultEmptyStateIndicator","updateLocale","i18n","LocalizedFormat","localeData","relativeTime","DefaultReactionsList","PinIndicator","DefaultPinIndicator","DefaultTimestamp","DateSeparator","DefaultDateSeparator","MessageListNotifications","DefaultMessageListNotifications","MessageNotification","DefaultMessageNotification","TypingIndicator","DefaultTypingIndicator","GiphyPreviewMessage","DefaultGiphyPreviewMessage","Virtuoso"],"mappings":"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"}