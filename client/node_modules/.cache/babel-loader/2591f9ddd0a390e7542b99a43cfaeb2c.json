{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _ = require(\"..\");\n\nvar _data = require(\"../data\");\n\nvar _store = _interopRequireDefault(require(\"../store\"));\n\nvar NimbleEmojiIndex = /*#__PURE__*/function () {\n  function NimbleEmojiIndex(data, set) {\n    (0, _classCallCheck2[\"default\"])(this, NimbleEmojiIndex);\n\n    if (data.compressed) {\n      (0, _data.uncompress)(data);\n    }\n\n    this.data = data || {};\n    this.set = set || null;\n    this.originalPool = {};\n    this.index = {};\n    this.emojis = {};\n    this.emoticons = {};\n    this.customEmojisList = [];\n    this.buildIndex();\n  }\n\n  (0, _createClass2[\"default\"])(NimbleEmojiIndex, [{\n    key: \"buildIndex\",\n    value: function buildIndex() {\n      var _this = this;\n\n      var _loop = function _loop(emoji) {\n        var emojiData = _this.data.emojis[emoji],\n            short_names = emojiData.short_names,\n            emoticons = emojiData.emoticons,\n            skin_variations = emojiData.skin_variations,\n            id = short_names[0];\n\n        if (emoticons) {\n          emoticons.forEach(function (emoticon) {\n            if (_this.emoticons[emoticon]) {\n              return;\n            }\n\n            _this.emoticons[emoticon] = id;\n          });\n        } // If skin variations include them\n\n\n        if (skin_variations) {\n          _this.emojis[id] = {};\n\n          for (var skinTone = 1; skinTone <= 6; skinTone++) {\n            _this.emojis[id][skinTone] = (0, _.getSanitizedData)({\n              id: id,\n              skin: skinTone\n            }, skinTone, _this.set, _this.data);\n          }\n        } else {\n          _this.emojis[id] = (0, _.getSanitizedData)(id, null, _this.set, _this.data);\n        }\n\n        _this.originalPool[id] = emojiData;\n      };\n\n      for (var emoji in this.data.emojis) {\n        _loop(emoji);\n      }\n    }\n  }, {\n    key: \"clearCustomEmojis\",\n    value: function clearCustomEmojis(pool) {\n      var _this2 = this;\n\n      this.customEmojisList.forEach(function (emoji) {\n        var emojiId = emoji.id || emoji.short_names[0];\n        delete pool[emojiId];\n        delete _this2.emojis[emojiId];\n      });\n    }\n  }, {\n    key: \"addCustomToPool\",\n    value: function addCustomToPool(custom, pool) {\n      var _this3 = this;\n\n      if (this.customEmojisList.length) this.clearCustomEmojis(pool);\n      custom.forEach(function (emoji) {\n        var emojiId = emoji.id || emoji.short_names[0];\n\n        if (emojiId && !pool[emojiId]) {\n          pool[emojiId] = (0, _.getData)(emoji, null, null, _this3.data);\n          _this3.emojis[emojiId] = (0, _.getSanitizedData)(emoji, null, null, _this3.data);\n        }\n      });\n      this.customEmojisList = custom;\n      this.index = {};\n    }\n  }, {\n    key: \"search\",\n    value: function search(value) {\n      var _this4 = this;\n\n      var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n          emojisToShowFilter = _ref.emojisToShowFilter,\n          maxResults = _ref.maxResults,\n          include = _ref.include,\n          exclude = _ref.exclude,\n          _ref$custom = _ref.custom,\n          custom = _ref$custom === void 0 ? [] : _ref$custom;\n\n      if (this.customEmojisList != custom) this.addCustomToPool(custom, this.originalPool);\n      var skinTone = _store[\"default\"].get('skin') || 1;\n      maxResults || (maxResults = 75);\n      include || (include = []);\n      exclude || (exclude = []);\n      var results = null,\n          pool = this.originalPool;\n\n      if (value.length) {\n        if (value == '-' || value == '-1') {\n          return [this.emojis['-1'][skinTone]];\n        }\n\n        var values = value.toLowerCase().split(/[\\s|,|\\-|_]+/),\n            allResults = [];\n\n        if (values.length > 2) {\n          values = [values[0], values[1]];\n        }\n\n        if (include.length || exclude.length) {\n          pool = {};\n          this.data.categories.forEach(function (category) {\n            var isIncluded = include && include.length ? include.indexOf(category.id) > -1 : true;\n            var isExcluded = exclude && exclude.length ? exclude.indexOf(category.id) > -1 : false;\n\n            if (!isIncluded || isExcluded) {\n              return;\n            }\n\n            category.emojis.forEach(function (emojiId) {\n              return pool[emojiId] = _this4.data.emojis[emojiId];\n            });\n          });\n\n          if (custom.length) {\n            var customIsIncluded = include && include.length ? include.indexOf('custom') > -1 : true;\n            var customIsExcluded = exclude && exclude.length ? exclude.indexOf('custom') > -1 : false;\n\n            if (customIsIncluded && !customIsExcluded) {\n              this.addCustomToPool(custom, pool);\n            }\n          }\n        }\n\n        allResults = values.map(function (value) {\n          var aPool = pool,\n              aIndex = _this4.index,\n              length = 0;\n\n          for (var charIndex = 0; charIndex < value.length; charIndex++) {\n            var _char = value[charIndex];\n            length++;\n            aIndex[_char] || (aIndex[_char] = {});\n            aIndex = aIndex[_char];\n\n            if (!aIndex.results) {\n              (function () {\n                var scores = {};\n                aIndex.results = [];\n                aIndex.pool = {};\n\n                for (var id in aPool) {\n                  var emoji = aPool[id],\n                      search = emoji.search,\n                      sub = value.substr(0, length),\n                      subIndex = search.indexOf(sub);\n\n                  if (subIndex != -1) {\n                    var score = subIndex + 1;\n                    if (sub == id) score = 0;\n\n                    if (_this4.emojis[id] && _this4.emojis[id][skinTone]) {\n                      aIndex.results.push(_this4.emojis[id][skinTone]);\n                    } else {\n                      aIndex.results.push(_this4.emojis[id]);\n                    }\n\n                    aIndex.pool[id] = emoji;\n                    scores[id] = score;\n                  }\n                }\n\n                aIndex.results.sort(function (a, b) {\n                  var aScore = scores[a.id],\n                      bScore = scores[b.id];\n\n                  if (aScore == bScore) {\n                    return a.id.localeCompare(b.id);\n                  } else {\n                    return aScore - bScore;\n                  }\n                });\n              })();\n            }\n\n            aPool = aIndex.pool;\n          }\n\n          return aIndex.results;\n        }).filter(function (a) {\n          return a;\n        });\n\n        if (allResults.length > 1) {\n          results = _.intersect.apply(null, allResults);\n        } else if (allResults.length) {\n          results = allResults[0];\n        } else {\n          results = [];\n        }\n      }\n\n      if (results) {\n        if (emojisToShowFilter) {\n          results = results.filter(function (result) {\n            return emojisToShowFilter(pool[result.id]);\n          });\n        }\n\n        if (results && results.length > maxResults) {\n          results = results.slice(0, maxResults);\n        }\n      }\n\n      return results;\n    }\n  }]);\n  return NimbleEmojiIndex;\n}();\n\nexports[\"default\"] = NimbleEmojiIndex;","map":{"version":3,"sources":["/Users/pedrohenriquemachado/Documents/Projects/multi-tic-tac-toe/client/node_modules/emoji-mart/dist/utils/emoji-index/nimble-emoji-index.js"],"names":["_interopRequireDefault","require","Object","defineProperty","exports","value","_classCallCheck2","_createClass2","_","_data","_store","NimbleEmojiIndex","data","set","compressed","uncompress","originalPool","index","emojis","emoticons","customEmojisList","buildIndex","key","_this","_loop","emoji","emojiData","short_names","skin_variations","id","forEach","emoticon","skinTone","getSanitizedData","skin","clearCustomEmojis","pool","_this2","emojiId","addCustomToPool","custom","_this3","length","getData","search","_this4","_ref","arguments","undefined","emojisToShowFilter","maxResults","include","exclude","_ref$custom","get","results","values","toLowerCase","split","allResults","categories","category","isIncluded","indexOf","isExcluded","customIsIncluded","customIsExcluded","map","aPool","aIndex","charIndex","_char","scores","sub","substr","subIndex","score","push","sort","a","b","aScore","bScore","localeCompare","filter","intersect","apply","result","slice"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _ = require(\"..\");\n\nvar _data = require(\"../data\");\n\nvar _store = _interopRequireDefault(require(\"../store\"));\n\nvar NimbleEmojiIndex =\n/*#__PURE__*/\nfunction () {\n  function NimbleEmojiIndex(data, set) {\n    (0, _classCallCheck2[\"default\"])(this, NimbleEmojiIndex);\n\n    if (data.compressed) {\n      (0, _data.uncompress)(data);\n    }\n\n    this.data = data || {};\n    this.set = set || null;\n    this.originalPool = {};\n    this.index = {};\n    this.emojis = {};\n    this.emoticons = {};\n    this.customEmojisList = [];\n    this.buildIndex();\n  }\n\n  (0, _createClass2[\"default\"])(NimbleEmojiIndex, [{\n    key: \"buildIndex\",\n    value: function buildIndex() {\n      var _this = this;\n\n      var _loop = function _loop(emoji) {\n        var emojiData = _this.data.emojis[emoji],\n            short_names = emojiData.short_names,\n            emoticons = emojiData.emoticons,\n            skin_variations = emojiData.skin_variations,\n            id = short_names[0];\n\n        if (emoticons) {\n          emoticons.forEach(function (emoticon) {\n            if (_this.emoticons[emoticon]) {\n              return;\n            }\n\n            _this.emoticons[emoticon] = id;\n          });\n        } // If skin variations include them\n\n\n        if (skin_variations) {\n          _this.emojis[id] = {};\n\n          for (var skinTone = 1; skinTone <= 6; skinTone++) {\n            _this.emojis[id][skinTone] = (0, _.getSanitizedData)({\n              id: id,\n              skin: skinTone\n            }, skinTone, _this.set, _this.data);\n          }\n        } else {\n          _this.emojis[id] = (0, _.getSanitizedData)(id, null, _this.set, _this.data);\n        }\n\n        _this.originalPool[id] = emojiData;\n      };\n\n      for (var emoji in this.data.emojis) {\n        _loop(emoji);\n      }\n    }\n  }, {\n    key: \"clearCustomEmojis\",\n    value: function clearCustomEmojis(pool) {\n      var _this2 = this;\n\n      this.customEmojisList.forEach(function (emoji) {\n        var emojiId = emoji.id || emoji.short_names[0];\n        delete pool[emojiId];\n        delete _this2.emojis[emojiId];\n      });\n    }\n  }, {\n    key: \"addCustomToPool\",\n    value: function addCustomToPool(custom, pool) {\n      var _this3 = this;\n\n      if (this.customEmojisList.length) this.clearCustomEmojis(pool);\n      custom.forEach(function (emoji) {\n        var emojiId = emoji.id || emoji.short_names[0];\n\n        if (emojiId && !pool[emojiId]) {\n          pool[emojiId] = (0, _.getData)(emoji, null, null, _this3.data);\n          _this3.emojis[emojiId] = (0, _.getSanitizedData)(emoji, null, null, _this3.data);\n        }\n      });\n      this.customEmojisList = custom;\n      this.index = {};\n    }\n  }, {\n    key: \"search\",\n    value: function search(value) {\n      var _this4 = this;\n\n      var _ref = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {},\n          emojisToShowFilter = _ref.emojisToShowFilter,\n          maxResults = _ref.maxResults,\n          include = _ref.include,\n          exclude = _ref.exclude,\n          _ref$custom = _ref.custom,\n          custom = _ref$custom === void 0 ? [] : _ref$custom;\n\n      if (this.customEmojisList != custom) this.addCustomToPool(custom, this.originalPool);\n      var skinTone = _store[\"default\"].get('skin') || 1;\n      maxResults || (maxResults = 75);\n      include || (include = []);\n      exclude || (exclude = []);\n      var results = null,\n          pool = this.originalPool;\n\n      if (value.length) {\n        if (value == '-' || value == '-1') {\n          return [this.emojis['-1'][skinTone]];\n        }\n\n        var values = value.toLowerCase().split(/[\\s|,|\\-|_]+/),\n            allResults = [];\n\n        if (values.length > 2) {\n          values = [values[0], values[1]];\n        }\n\n        if (include.length || exclude.length) {\n          pool = {};\n          this.data.categories.forEach(function (category) {\n            var isIncluded = include && include.length ? include.indexOf(category.id) > -1 : true;\n            var isExcluded = exclude && exclude.length ? exclude.indexOf(category.id) > -1 : false;\n\n            if (!isIncluded || isExcluded) {\n              return;\n            }\n\n            category.emojis.forEach(function (emojiId) {\n              return pool[emojiId] = _this4.data.emojis[emojiId];\n            });\n          });\n\n          if (custom.length) {\n            var customIsIncluded = include && include.length ? include.indexOf('custom') > -1 : true;\n            var customIsExcluded = exclude && exclude.length ? exclude.indexOf('custom') > -1 : false;\n\n            if (customIsIncluded && !customIsExcluded) {\n              this.addCustomToPool(custom, pool);\n            }\n          }\n        }\n\n        allResults = values.map(function (value) {\n          var aPool = pool,\n              aIndex = _this4.index,\n              length = 0;\n\n          for (var charIndex = 0; charIndex < value.length; charIndex++) {\n            var _char = value[charIndex];\n            length++;\n            aIndex[_char] || (aIndex[_char] = {});\n            aIndex = aIndex[_char];\n\n            if (!aIndex.results) {\n              (function () {\n                var scores = {};\n                aIndex.results = [];\n                aIndex.pool = {};\n\n                for (var id in aPool) {\n                  var emoji = aPool[id],\n                      search = emoji.search,\n                      sub = value.substr(0, length),\n                      subIndex = search.indexOf(sub);\n\n                  if (subIndex != -1) {\n                    var score = subIndex + 1;\n                    if (sub == id) score = 0;\n\n                    if (_this4.emojis[id] && _this4.emojis[id][skinTone]) {\n                      aIndex.results.push(_this4.emojis[id][skinTone]);\n                    } else {\n                      aIndex.results.push(_this4.emojis[id]);\n                    }\n\n                    aIndex.pool[id] = emoji;\n                    scores[id] = score;\n                  }\n                }\n\n                aIndex.results.sort(function (a, b) {\n                  var aScore = scores[a.id],\n                      bScore = scores[b.id];\n\n                  if (aScore == bScore) {\n                    return a.id.localeCompare(b.id);\n                  } else {\n                    return aScore - bScore;\n                  }\n                });\n              })();\n            }\n\n            aPool = aIndex.pool;\n          }\n\n          return aIndex.results;\n        }).filter(function (a) {\n          return a;\n        });\n\n        if (allResults.length > 1) {\n          results = _.intersect.apply(null, allResults);\n        } else if (allResults.length) {\n          results = allResults[0];\n        } else {\n          results = [];\n        }\n      }\n\n      if (results) {\n        if (emojisToShowFilter) {\n          results = results.filter(function (result) {\n            return emojisToShowFilter(pool[result.id]);\n          });\n        }\n\n        if (results && results.length > maxResults) {\n          results = results.slice(0, maxResults);\n        }\n      }\n\n      return results;\n    }\n  }]);\n  return NimbleEmojiIndex;\n}();\n\nexports[\"default\"] = NimbleEmojiIndex;"]},"metadata":{},"sourceType":"script"}