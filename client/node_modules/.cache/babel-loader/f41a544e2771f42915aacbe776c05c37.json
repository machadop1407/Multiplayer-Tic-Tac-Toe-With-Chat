{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nimport React, { useCallback, useEffect, useMemo, useRef } from 'react';\nimport { Virtuoso } from 'react-virtuoso';\nimport { GiphyPreviewMessage as DefaultGiphyPreviewMessage } from './GiphyPreviewMessage';\nimport { useGiphyPreview } from './hooks/useGiphyPreview';\nimport { useNewMessageNotification } from './hooks/useNewMessageNotification';\nimport { usePrependedMessagesCount } from './hooks/usePrependMessagesCount';\nimport { useShouldForceScrollToBottom } from './hooks/useShouldForceScrollToBottom';\nimport { MessageNotification as DefaultMessageNotification } from './MessageNotification';\nimport { MessageListNotifications as DefaultMessageListNotifications } from './MessageListNotifications';\nimport { processMessages } from './utils';\nimport { DateSeparator as DefaultDateSeparator } from '../DateSeparator/DateSeparator';\nimport { EmptyStateIndicator as DefaultEmptyStateIndicator } from '../EmptyStateIndicator/EmptyStateIndicator';\nimport { EventComponent } from '../EventComponent/EventComponent';\nimport { LoadingIndicator as DefaultLoadingIndicator } from '../Loading/LoadingIndicator';\nimport { Message, MessageSimple } from '../Message';\nimport { useChannelActionContext } from '../../context/ChannelActionContext';\nimport { useChannelStateContext } from '../../context/ChannelStateContext';\nimport { useChatContext } from '../../context/ChatContext';\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { isDate } from '../../context/TranslationContext';\nvar PREPEND_OFFSET = Math.pow(10, 7);\n\nvar VirtualizedMessageListWithContext = function (props) {\n  var additionalVirtuosoProps = props.additionalVirtuosoProps,\n      channel = props.channel,\n      closeReactionSelectorOnClick = props.closeReactionSelectorOnClick,\n      customMessageRenderer = props.customMessageRenderer,\n      defaultItemHeight = props.defaultItemHeight,\n      _a = props.disableDateSeparator,\n      disableDateSeparator = _a === void 0 ? true : _a,\n      hasMore = props.hasMore,\n      _b = props.hideDeletedMessages,\n      hideDeletedMessages = _b === void 0 ? false : _b,\n      _c = props.hideNewMessageSeparator,\n      hideNewMessageSeparator = _c === void 0 ? false : _c,\n      loadingMore = props.loadingMore,\n      loadMore = props.loadMore,\n      propMessage = props.Message,\n      _d = props.messageLimit,\n      messageLimit = _d === void 0 ? 100 : _d,\n      messages = props.messages,\n      notifications = props.notifications,\n      _e = props.overscan,\n      overscan = _e === void 0 ? 0 : _e,\n      // TODO: refactor to scrollSeekPlaceHolderConfiguration and components.ScrollSeekPlaceholder, like the Virtuoso Component\n  scrollSeekPlaceHolder = props.scrollSeekPlaceHolder,\n      _f = props.scrollToLatestMessageOnFocus,\n      scrollToLatestMessageOnFocus = _f === void 0 ? false : _f,\n      _g = props.separateGiphyPreview,\n      separateGiphyPreview = _g === void 0 ? false : _g,\n      _h = props.shouldGroupByUser,\n      shouldGroupByUser = _h === void 0 ? false : _h,\n      _j = props.stickToBottomScrollBehavior,\n      stickToBottomScrollBehavior = _j === void 0 ? 'smooth' : _j;\n\n  var _k = useComponentContext('VirtualizedMessageList'),\n      _l = _k.DateSeparator,\n      DateSeparator = _l === void 0 ? DefaultDateSeparator : _l,\n      _m = _k.EmptyStateIndicator,\n      EmptyStateIndicator = _m === void 0 ? DefaultEmptyStateIndicator : _m,\n      _o = _k.GiphyPreviewMessage,\n      GiphyPreviewMessage = _o === void 0 ? DefaultGiphyPreviewMessage : _o,\n      _p = _k.LoadingIndicator,\n      LoadingIndicator = _p === void 0 ? DefaultLoadingIndicator : _p,\n      _q = _k.MessageListNotifications,\n      MessageListNotifications = _q === void 0 ? DefaultMessageListNotifications : _q,\n      _r = _k.MessageNotification,\n      MessageNotification = _r === void 0 ? DefaultMessageNotification : _r,\n      _s = _k.MessageSystem,\n      MessageSystem = _s === void 0 ? EventComponent : _s,\n      _t = _k.TypingIndicator,\n      TypingIndicator = _t === void 0 ? null : _t,\n      _u = _k.VirtualMessage,\n      contextMessage = _u === void 0 ? MessageSimple : _u;\n\n  var _v = useChatContext('VirtualizedMessageList'),\n      client = _v.client,\n      customClasses = _v.customClasses;\n\n  var lastRead = useMemo(function () {\n    var _a;\n\n    return (_a = channel.lastRead) === null || _a === void 0 ? void 0 : _a.call(channel);\n  }, [channel]);\n  var MessageUIComponent = propMessage || contextMessage;\n\n  var _w = useGiphyPreview(separateGiphyPreview),\n      giphyPreviewMessage = _w.giphyPreviewMessage,\n      setGiphyPreviewMessage = _w.setGiphyPreviewMessage;\n\n  var processedMessages = useMemo(function () {\n    if (typeof messages === 'undefined') {\n      return [];\n    }\n\n    if (disableDateSeparator && !hideDeletedMessages && hideNewMessageSeparator && !separateGiphyPreview) {\n      return messages;\n    }\n\n    return processMessages({\n      disableDateSeparator: disableDateSeparator,\n      hideDeletedMessages: hideDeletedMessages,\n      hideNewMessageSeparator: hideNewMessageSeparator,\n      lastRead: lastRead,\n      messages: messages,\n      separateGiphyPreview: separateGiphyPreview,\n      setGiphyPreviewMessage: setGiphyPreviewMessage,\n      userId: client.userID || ''\n    });\n  }, [disableDateSeparator, hideDeletedMessages, hideNewMessageSeparator, lastRead, messages, messages === null || messages === void 0 ? void 0 : messages.length, client.userID]);\n  var virtuoso = useRef(null);\n\n  var _x = useNewMessageNotification(processedMessages, client.userID),\n      atBottom = _x.atBottom,\n      newMessagesNotification = _x.newMessagesNotification,\n      setNewMessagesNotification = _x.setNewMessagesNotification;\n\n  var scrollToBottom = useCallback(function () {\n    if (virtuoso.current) {\n      virtuoso.current.scrollToIndex(processedMessages.length - 1);\n    }\n\n    setNewMessagesNotification(false);\n  }, [virtuoso, processedMessages, setNewMessagesNotification, processedMessages.length]);\n  var scrollToBottomIfConfigured = useCallback(function (event) {\n    if (scrollToLatestMessageOnFocus && event.target === window) {\n      setTimeout(scrollToBottom, 100);\n    }\n  }, [scrollToLatestMessageOnFocus, scrollToBottom]);\n  useEffect(function () {\n    if (typeof window !== 'undefined') {\n      window.addEventListener('focus', scrollToBottomIfConfigured);\n    }\n\n    return function () {\n      return window.removeEventListener('focus', scrollToBottomIfConfigured);\n    };\n  }, [scrollToBottomIfConfigured]);\n  var numItemsPrepended = usePrependedMessagesCount(processedMessages);\n  var shouldForceScrollToBottom = useShouldForceScrollToBottom(processedMessages, client.userID);\n\n  var followOutput = function (isAtBottom) {\n    if (shouldForceScrollToBottom()) {\n      return isAtBottom ? stickToBottomScrollBehavior : 'auto';\n    } // a message from another user has been received - don't scroll to bottom unless already there\n\n\n    return isAtBottom ? stickToBottomScrollBehavior : false;\n  };\n\n  var messageRenderer = useCallback(function (messageList, virtuosoIndex) {\n    var _a, _b, _c, _d, _e, _f, _g, _h;\n\n    var streamMessageIndex = virtuosoIndex + numItemsPrepended - PREPEND_OFFSET; // use custom renderer supplied by client if present and skip the rest\n\n    if (customMessageRenderer) {\n      return customMessageRenderer(messageList, streamMessageIndex);\n    }\n\n    var message = messageList[streamMessageIndex];\n\n    if (message.customType === 'message.date' && message.date && isDate(message.date)) {\n      return React.createElement(DateSeparator, {\n        date: message.date,\n        unread: message.unread\n      });\n    }\n\n    if (!message) return React.createElement(\"div\", {\n      style: {\n        height: '1px'\n      }\n    }); // returning null or zero height breaks the virtuoso\n\n    if (message.type === 'system') {\n      return React.createElement(MessageSystem, {\n        message: message\n      });\n    }\n\n    var groupedByUser = shouldGroupByUser && streamMessageIndex > 0 && ((_a = message.user) === null || _a === void 0 ? void 0 : _a.id) === ((_b = messageList[streamMessageIndex - 1].user) === null || _b === void 0 ? void 0 : _b.id);\n    var firstOfGroup = shouldGroupByUser && ((_c = message.user) === null || _c === void 0 ? void 0 : _c.id) !== ((_e = (_d = messageList[streamMessageIndex - 1]) === null || _d === void 0 ? void 0 : _d.user) === null || _e === void 0 ? void 0 : _e.id);\n    var endOfGroup = shouldGroupByUser && ((_f = message.user) === null || _f === void 0 ? void 0 : _f.id) !== ((_h = (_g = messageList[streamMessageIndex + 1]) === null || _g === void 0 ? void 0 : _g.user) === null || _h === void 0 ? void 0 : _h.id);\n    return React.createElement(Message, {\n      closeReactionSelectorOnClick: closeReactionSelectorOnClick,\n      customMessageActions: props.customMessageActions,\n      endOfGroup: endOfGroup,\n      firstOfGroup: firstOfGroup,\n      groupedByUser: groupedByUser,\n      message: message,\n      Message: MessageUIComponent,\n      messageActions: props.messageActions\n    });\n  }, [customMessageRenderer, shouldGroupByUser, numItemsPrepended]);\n  var virtuosoComponents = useMemo(function () {\n    var EmptyPlaceholder = function () {\n      return React.createElement(React.Fragment, null, EmptyStateIndicator && React.createElement(EmptyStateIndicator, {\n        listType: 'message'\n      }));\n    };\n\n    var Header = function () {\n      return loadingMore ? React.createElement(\"div\", {\n        className: 'str-chat__virtual-list__loading'\n      }, React.createElement(LoadingIndicator, {\n        size: 20\n      })) : React.createElement(React.Fragment, null);\n    };\n\n    var virtualMessageClass = (customClasses === null || customClasses === void 0 ? void 0 : customClasses.virtualMessage) || 'str-chat__virtual-list-message-wrapper'; // using 'display: inline-block' traps CSS margins of the item elements, preventing incorrect item measurements\n\n    var Item = function (props) {\n      return React.createElement(\"div\", __assign({}, props, {\n        className: virtualMessageClass\n      }));\n    };\n\n    var Footer = function () {\n      return TypingIndicator ? React.createElement(TypingIndicator, {\n        avatarSize: 24\n      }) : React.createElement(React.Fragment, null);\n    };\n\n    return {\n      EmptyPlaceholder: EmptyPlaceholder,\n      Footer: Footer,\n      Header: Header,\n      Item: Item\n    };\n  }, [loadingMore]);\n\n  var atBottomStateChange = function (isAtBottom) {\n    atBottom.current = isAtBottom;\n\n    if (isAtBottom && newMessagesNotification) {\n      setNewMessagesNotification(false);\n    }\n  };\n\n  var startReached = function () {\n    if (hasMore && loadMore) {\n      loadMore(messageLimit);\n    }\n  };\n\n  if (!processedMessages) return null;\n  var virtualizedMessageListClass = (customClasses === null || customClasses === void 0 ? void 0 : customClasses.virtualizedMessageList) || 'str-chat__virtual-list';\n  return React.createElement(React.Fragment, null, React.createElement(\"div\", {\n    className: virtualizedMessageListClass\n  }, React.createElement(Virtuoso, __assign({\n    atBottomStateChange: atBottomStateChange,\n    components: virtuosoComponents,\n    firstItemIndex: PREPEND_OFFSET - numItemsPrepended,\n    followOutput: followOutput,\n    initialTopMostItemIndex: processedMessages.length ? processedMessages.length - 1 : 0,\n    itemContent: function (i) {\n      return messageRenderer(processedMessages, i);\n    },\n    overscan: overscan,\n    ref: virtuoso,\n    startReached: startReached,\n    style: {\n      overflowX: 'hidden'\n    },\n    totalCount: processedMessages.length\n  }, additionalVirtuosoProps, scrollSeekPlaceHolder ? {\n    scrollSeek: scrollSeekPlaceHolder\n  } : {}, defaultItemHeight ? {\n    defaultItemHeight: defaultItemHeight\n  } : {}))), React.createElement(MessageListNotifications, {\n    hasNewMessages: newMessagesNotification,\n    MessageNotification: MessageNotification,\n    notifications: notifications,\n    scrollToBottom: scrollToBottom\n  }), giphyPreviewMessage && React.createElement(GiphyPreviewMessage, {\n    message: giphyPreviewMessage\n  }));\n};\n/**\n * The VirtualizedMessageList component renders a list of messages in a virtualized list.\n * It is a consumer of the React contexts set in [Channel](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Channel/Channel.tsx).\n *\n * **Note**: It works well when there are thousands of messages in a channel, it has a shortcoming though - the message UI should have a fixed height.\n */\n\n\nexport function VirtualizedMessageList(props) {\n  var loadMore = useChannelActionContext('VirtualizedMessageList').loadMore;\n\n  var _a = useChannelStateContext('VirtualizedMessageList'),\n      channel = _a.channel,\n      hasMore = _a.hasMore,\n      loadingMore = _a.loadingMore,\n      contextMessages = _a.messages,\n      notifications = _a.notifications;\n\n  var messages = props.messages || contextMessages;\n  return React.createElement(VirtualizedMessageListWithContext, __assign({\n    channel: channel,\n    hasMore: !!hasMore,\n    loadingMore: !!loadingMore,\n    loadMore: loadMore,\n    messages: messages,\n    notifications: notifications\n  }, props));\n}","map":{"version":3,"sources":["/Users/pedrohenriquemachado/Documents/Projects/multi-tic-tac-toe/client/node_modules/stream-chat-react/dist/components/MessageList/VirtualizedMessageList.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","React","useCallback","useEffect","useMemo","useRef","Virtuoso","GiphyPreviewMessage","DefaultGiphyPreviewMessage","useGiphyPreview","useNewMessageNotification","usePrependedMessagesCount","useShouldForceScrollToBottom","MessageNotification","DefaultMessageNotification","MessageListNotifications","DefaultMessageListNotifications","processMessages","DateSeparator","DefaultDateSeparator","EmptyStateIndicator","DefaultEmptyStateIndicator","EventComponent","LoadingIndicator","DefaultLoadingIndicator","Message","MessageSimple","useChannelActionContext","useChannelStateContext","useChatContext","useComponentContext","isDate","PREPEND_OFFSET","Math","pow","VirtualizedMessageListWithContext","props","additionalVirtuosoProps","channel","closeReactionSelectorOnClick","customMessageRenderer","defaultItemHeight","_a","disableDateSeparator","hasMore","_b","hideDeletedMessages","_c","hideNewMessageSeparator","loadingMore","loadMore","propMessage","_d","messageLimit","messages","notifications","_e","overscan","scrollSeekPlaceHolder","_f","scrollToLatestMessageOnFocus","_g","separateGiphyPreview","_h","shouldGroupByUser","_j","stickToBottomScrollBehavior","_k","_l","_m","_o","_p","_q","_r","_s","MessageSystem","_t","TypingIndicator","_u","VirtualMessage","contextMessage","_v","client","customClasses","lastRead","MessageUIComponent","_w","giphyPreviewMessage","setGiphyPreviewMessage","processedMessages","userId","userID","virtuoso","_x","atBottom","newMessagesNotification","setNewMessagesNotification","scrollToBottom","current","scrollToIndex","scrollToBottomIfConfigured","event","target","window","setTimeout","addEventListener","removeEventListener","numItemsPrepended","shouldForceScrollToBottom","followOutput","isAtBottom","messageRenderer","messageList","virtuosoIndex","streamMessageIndex","message","customType","date","createElement","unread","style","height","type","groupedByUser","user","id","firstOfGroup","endOfGroup","customMessageActions","messageActions","virtuosoComponents","EmptyPlaceholder","Fragment","listType","Header","className","size","virtualMessageClass","virtualMessage","Item","Footer","avatarSize","atBottomStateChange","startReached","virtualizedMessageListClass","virtualizedMessageList","components","firstItemIndex","initialTopMostItemIndex","itemContent","ref","overflowX","totalCount","scrollSeek","hasNewMessages","VirtualizedMessageList","contextMessages"],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport React, { useCallback, useEffect, useMemo, useRef } from 'react';\nimport { Virtuoso, } from 'react-virtuoso';\nimport { GiphyPreviewMessage as DefaultGiphyPreviewMessage } from './GiphyPreviewMessage';\nimport { useGiphyPreview } from './hooks/useGiphyPreview';\nimport { useNewMessageNotification } from './hooks/useNewMessageNotification';\nimport { usePrependedMessagesCount } from './hooks/usePrependMessagesCount';\nimport { useShouldForceScrollToBottom } from './hooks/useShouldForceScrollToBottom';\nimport { MessageNotification as DefaultMessageNotification } from './MessageNotification';\nimport { MessageListNotifications as DefaultMessageListNotifications } from './MessageListNotifications';\nimport { processMessages } from './utils';\nimport { DateSeparator as DefaultDateSeparator } from '../DateSeparator/DateSeparator';\nimport { EmptyStateIndicator as DefaultEmptyStateIndicator } from '../EmptyStateIndicator/EmptyStateIndicator';\nimport { EventComponent } from '../EventComponent/EventComponent';\nimport { LoadingIndicator as DefaultLoadingIndicator } from '../Loading/LoadingIndicator';\nimport { Message, MessageSimple } from '../Message';\nimport { useChannelActionContext, } from '../../context/ChannelActionContext';\nimport { useChannelStateContext, } from '../../context/ChannelStateContext';\nimport { useChatContext } from '../../context/ChatContext';\nimport { useComponentContext } from '../../context/ComponentContext';\nimport { isDate } from '../../context/TranslationContext';\nvar PREPEND_OFFSET = Math.pow(10, 7);\nvar VirtualizedMessageListWithContext = function (props) {\n    var additionalVirtuosoProps = props.additionalVirtuosoProps, channel = props.channel, closeReactionSelectorOnClick = props.closeReactionSelectorOnClick, customMessageRenderer = props.customMessageRenderer, defaultItemHeight = props.defaultItemHeight, _a = props.disableDateSeparator, disableDateSeparator = _a === void 0 ? true : _a, hasMore = props.hasMore, _b = props.hideDeletedMessages, hideDeletedMessages = _b === void 0 ? false : _b, _c = props.hideNewMessageSeparator, hideNewMessageSeparator = _c === void 0 ? false : _c, loadingMore = props.loadingMore, loadMore = props.loadMore, propMessage = props.Message, _d = props.messageLimit, messageLimit = _d === void 0 ? 100 : _d, messages = props.messages, notifications = props.notifications, _e = props.overscan, overscan = _e === void 0 ? 0 : _e, \n    // TODO: refactor to scrollSeekPlaceHolderConfiguration and components.ScrollSeekPlaceholder, like the Virtuoso Component\n    scrollSeekPlaceHolder = props.scrollSeekPlaceHolder, _f = props.scrollToLatestMessageOnFocus, scrollToLatestMessageOnFocus = _f === void 0 ? false : _f, _g = props.separateGiphyPreview, separateGiphyPreview = _g === void 0 ? false : _g, _h = props.shouldGroupByUser, shouldGroupByUser = _h === void 0 ? false : _h, _j = props.stickToBottomScrollBehavior, stickToBottomScrollBehavior = _j === void 0 ? 'smooth' : _j;\n    var _k = useComponentContext('VirtualizedMessageList'), _l = _k.DateSeparator, DateSeparator = _l === void 0 ? DefaultDateSeparator : _l, _m = _k.EmptyStateIndicator, EmptyStateIndicator = _m === void 0 ? DefaultEmptyStateIndicator : _m, _o = _k.GiphyPreviewMessage, GiphyPreviewMessage = _o === void 0 ? DefaultGiphyPreviewMessage : _o, _p = _k.LoadingIndicator, LoadingIndicator = _p === void 0 ? DefaultLoadingIndicator : _p, _q = _k.MessageListNotifications, MessageListNotifications = _q === void 0 ? DefaultMessageListNotifications : _q, _r = _k.MessageNotification, MessageNotification = _r === void 0 ? DefaultMessageNotification : _r, _s = _k.MessageSystem, MessageSystem = _s === void 0 ? EventComponent : _s, _t = _k.TypingIndicator, TypingIndicator = _t === void 0 ? null : _t, _u = _k.VirtualMessage, contextMessage = _u === void 0 ? MessageSimple : _u;\n    var _v = useChatContext('VirtualizedMessageList'), client = _v.client, customClasses = _v.customClasses;\n    var lastRead = useMemo(function () { var _a; return (_a = channel.lastRead) === null || _a === void 0 ? void 0 : _a.call(channel); }, [channel]);\n    var MessageUIComponent = propMessage || contextMessage;\n    var _w = useGiphyPreview(separateGiphyPreview), giphyPreviewMessage = _w.giphyPreviewMessage, setGiphyPreviewMessage = _w.setGiphyPreviewMessage;\n    var processedMessages = useMemo(function () {\n        if (typeof messages === 'undefined') {\n            return [];\n        }\n        if (disableDateSeparator &&\n            !hideDeletedMessages &&\n            hideNewMessageSeparator &&\n            !separateGiphyPreview) {\n            return messages;\n        }\n        return processMessages({\n            disableDateSeparator: disableDateSeparator,\n            hideDeletedMessages: hideDeletedMessages,\n            hideNewMessageSeparator: hideNewMessageSeparator,\n            lastRead: lastRead,\n            messages: messages,\n            separateGiphyPreview: separateGiphyPreview,\n            setGiphyPreviewMessage: setGiphyPreviewMessage,\n            userId: client.userID || '',\n        });\n    }, [\n        disableDateSeparator,\n        hideDeletedMessages,\n        hideNewMessageSeparator,\n        lastRead,\n        messages,\n        messages === null || messages === void 0 ? void 0 : messages.length,\n        client.userID,\n    ]);\n    var virtuoso = useRef(null);\n    var _x = useNewMessageNotification(processedMessages, client.userID), atBottom = _x.atBottom, newMessagesNotification = _x.newMessagesNotification, setNewMessagesNotification = _x.setNewMessagesNotification;\n    var scrollToBottom = useCallback(function () {\n        if (virtuoso.current) {\n            virtuoso.current.scrollToIndex(processedMessages.length - 1);\n        }\n        setNewMessagesNotification(false);\n    }, [virtuoso, processedMessages, setNewMessagesNotification, processedMessages.length]);\n    var scrollToBottomIfConfigured = useCallback(function (event) {\n        if (scrollToLatestMessageOnFocus && event.target === window) {\n            setTimeout(scrollToBottom, 100);\n        }\n    }, [scrollToLatestMessageOnFocus, scrollToBottom]);\n    useEffect(function () {\n        if (typeof window !== 'undefined') {\n            window.addEventListener('focus', scrollToBottomIfConfigured);\n        }\n        return function () { return window.removeEventListener('focus', scrollToBottomIfConfigured); };\n    }, [scrollToBottomIfConfigured]);\n    var numItemsPrepended = usePrependedMessagesCount(processedMessages);\n    var shouldForceScrollToBottom = useShouldForceScrollToBottom(processedMessages, client.userID);\n    var followOutput = function (isAtBottom) {\n        if (shouldForceScrollToBottom()) {\n            return isAtBottom ? stickToBottomScrollBehavior : 'auto';\n        }\n        // a message from another user has been received - don't scroll to bottom unless already there\n        return isAtBottom ? stickToBottomScrollBehavior : false;\n    };\n    var messageRenderer = useCallback(function (messageList, virtuosoIndex) {\n        var _a, _b, _c, _d, _e, _f, _g, _h;\n        var streamMessageIndex = virtuosoIndex + numItemsPrepended - PREPEND_OFFSET;\n        // use custom renderer supplied by client if present and skip the rest\n        if (customMessageRenderer) {\n            return customMessageRenderer(messageList, streamMessageIndex);\n        }\n        var message = messageList[streamMessageIndex];\n        if (message.customType === 'message.date' && message.date && isDate(message.date)) {\n            return React.createElement(DateSeparator, { date: message.date, unread: message.unread });\n        }\n        if (!message)\n            return React.createElement(\"div\", { style: { height: '1px' } }); // returning null or zero height breaks the virtuoso\n        if (message.type === 'system') {\n            return React.createElement(MessageSystem, { message: message });\n        }\n        var groupedByUser = shouldGroupByUser &&\n            streamMessageIndex > 0 &&\n            ((_a = message.user) === null || _a === void 0 ? void 0 : _a.id) === ((_b = messageList[streamMessageIndex - 1].user) === null || _b === void 0 ? void 0 : _b.id);\n        var firstOfGroup = shouldGroupByUser && ((_c = message.user) === null || _c === void 0 ? void 0 : _c.id) !== ((_e = (_d = messageList[streamMessageIndex - 1]) === null || _d === void 0 ? void 0 : _d.user) === null || _e === void 0 ? void 0 : _e.id);\n        var endOfGroup = shouldGroupByUser && ((_f = message.user) === null || _f === void 0 ? void 0 : _f.id) !== ((_h = (_g = messageList[streamMessageIndex + 1]) === null || _g === void 0 ? void 0 : _g.user) === null || _h === void 0 ? void 0 : _h.id);\n        return (React.createElement(Message, { closeReactionSelectorOnClick: closeReactionSelectorOnClick, customMessageActions: props.customMessageActions, endOfGroup: endOfGroup, firstOfGroup: firstOfGroup, groupedByUser: groupedByUser, message: message, Message: MessageUIComponent, messageActions: props.messageActions }));\n    }, [customMessageRenderer, shouldGroupByUser, numItemsPrepended]);\n    var virtuosoComponents = useMemo(function () {\n        var EmptyPlaceholder = function () { return (React.createElement(React.Fragment, null, EmptyStateIndicator && React.createElement(EmptyStateIndicator, { listType: 'message' }))); };\n        var Header = function () {\n            return loadingMore ? (React.createElement(\"div\", { className: 'str-chat__virtual-list__loading' },\n                React.createElement(LoadingIndicator, { size: 20 }))) : (React.createElement(React.Fragment, null));\n        };\n        var virtualMessageClass = (customClasses === null || customClasses === void 0 ? void 0 : customClasses.virtualMessage) || 'str-chat__virtual-list-message-wrapper';\n        // using 'display: inline-block' traps CSS margins of the item elements, preventing incorrect item measurements\n        var Item = function (props) { return React.createElement(\"div\", __assign({}, props, { className: virtualMessageClass })); };\n        var Footer = function () {\n            return TypingIndicator ? React.createElement(TypingIndicator, { avatarSize: 24 }) : React.createElement(React.Fragment, null);\n        };\n        return {\n            EmptyPlaceholder: EmptyPlaceholder,\n            Footer: Footer,\n            Header: Header,\n            Item: Item,\n        };\n    }, [loadingMore]);\n    var atBottomStateChange = function (isAtBottom) {\n        atBottom.current = isAtBottom;\n        if (isAtBottom && newMessagesNotification) {\n            setNewMessagesNotification(false);\n        }\n    };\n    var startReached = function () {\n        if (hasMore && loadMore) {\n            loadMore(messageLimit);\n        }\n    };\n    if (!processedMessages)\n        return null;\n    var virtualizedMessageListClass = (customClasses === null || customClasses === void 0 ? void 0 : customClasses.virtualizedMessageList) || 'str-chat__virtual-list';\n    return (React.createElement(React.Fragment, null,\n        React.createElement(\"div\", { className: virtualizedMessageListClass },\n            React.createElement(Virtuoso, __assign({ atBottomStateChange: atBottomStateChange, components: virtuosoComponents, firstItemIndex: PREPEND_OFFSET - numItemsPrepended, followOutput: followOutput, initialTopMostItemIndex: processedMessages.length ? processedMessages.length - 1 : 0, itemContent: function (i) { return messageRenderer(processedMessages, i); }, overscan: overscan, ref: virtuoso, startReached: startReached, style: { overflowX: 'hidden' }, totalCount: processedMessages.length }, additionalVirtuosoProps, (scrollSeekPlaceHolder ? { scrollSeek: scrollSeekPlaceHolder } : {}), (defaultItemHeight ? { defaultItemHeight: defaultItemHeight } : {})))),\n        React.createElement(MessageListNotifications, { hasNewMessages: newMessagesNotification, MessageNotification: MessageNotification, notifications: notifications, scrollToBottom: scrollToBottom }),\n        giphyPreviewMessage && React.createElement(GiphyPreviewMessage, { message: giphyPreviewMessage })));\n};\n/**\n * The VirtualizedMessageList component renders a list of messages in a virtualized list.\n * It is a consumer of the React contexts set in [Channel](https://github.com/GetStream/stream-chat-react/blob/master/src/components/Channel/Channel.tsx).\n *\n * **Note**: It works well when there are thousands of messages in a channel, it has a shortcoming though - the message UI should have a fixed height.\n */\nexport function VirtualizedMessageList(props) {\n    var loadMore = useChannelActionContext('VirtualizedMessageList').loadMore;\n    var _a = useChannelStateContext('VirtualizedMessageList'), channel = _a.channel, hasMore = _a.hasMore, loadingMore = _a.loadingMore, contextMessages = _a.messages, notifications = _a.notifications;\n    var messages = props.messages || contextMessages;\n    return (React.createElement(VirtualizedMessageListWithContext, __assign({ channel: channel, hasMore: !!hasMore, loadingMore: !!loadingMore, loadMore: loadMore, messages: messages, notifications: notifications }, props)));\n}\n"]},"metadata":{},"sourceType":"module"}